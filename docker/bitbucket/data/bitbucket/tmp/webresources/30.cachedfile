;
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--57570d46fb', location = 'aui.chunk.a003a33fe4a4b9909587--909721a86b83c949a90d.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--57570d46fb"],{Btyd:function(t,n,e){var r;"undefined"!=typeof self&&self,void 0===(r=function(){return function(){var t=/\{([^\}]+)\}/g,n=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,e=function(t,e,r,i){var u=r;return e.replace(n,function(t,n,e,r,o){n=n||r,u&&(n+":html"in u?(u=u[n+":html"],i=!0):n in u&&(u=u[n]),o&&"function"==typeof u&&(u=u()))}),null!=u&&u!==r||(u=t),u=String(u),i||(u=o.escape(u)),u},r=function(n){return this.template=this.template.replace(t,function(t,r){return e(t,r,n,!0)}),this},i=function(n){return this.template=this.template.replace(t,function(t,r){return e(t,r,n)}),this},u=function(){return this.template},o=function(t){function n(){return n.template}return n.template=String(t),n.toString=n.valueOf=u,n.fill=i,n.fillHtml=r,n},l={},c=[];o.load=function(t){if(t=String(t),!l.hasOwnProperty(t)){c.length>=1e3&&delete l[c.shift()],c.push(t);var n=function(t){return document.querySelector('script[title="'+t+'"]')}(t);n&&(l[t]=n.text)}return this(l[t])};var f={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;","`":"&#96;"},a=new RegExp("["+Object.keys(f).join("")+"]","g");return o.escape=function(t){return String(t||"").replace(a,function(t){return f[t]})},o}()}.call(n,e,n,t))||(t.exports=r)}}]);
//# sourceMappingURL=aui.chunk.a003a33fe4a4b9909587--909721a86b83c949a90d.js.map;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.deprecated.behaviour.template', location = 'aui.chunk.46a6baffe7e3860b6028--f8af50ff0fab84c0609c.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.deprecated.behaviour.template"],{Dpsd:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=o(t("KloK")),u=t("bPPT"),n=o(t("Btyd"));function o(e){return e&&e.__esModule?e:{default:e}}var l={sinceVersion:"8.0.0",removeInVersion:"9.0.0",extraInfo:'We recommend use of other open-source templating engines, such as "lit-html" or "react". If you cannot do without this templating function, it is available as its own Node package: "@atlassian/aui-template".'},s=(0,u.fn)(n.default,"AJS.template",l);s.load=n.default.load,s.escapeHtml=n.default.escapeHtml,(0,u.prop)(s,"load",l),(0,u.prop)(s,"escapeHtml",l),(0,i.default)("template",s),a.default=s,e.exports=a.default}},[["Dpsd","runtime","aui.splitchunk.vendors--57570d46fb","aui.splitchunk.172ffb6da7","aui.splitchunk.a16cabd587","aui.splitchunk.fbd1a5ab27","aui.splitchunk.54d3f16c20"]]]);
//# sourceMappingURL=aui.chunk.46a6baffe7e3860b6028--f8af50ff0fab84c0609c.js.map;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:lodash-noconflict', location = 'applinks/internal/lib/lodash.underscore.js' */
/**
 * @license
 * Lo-Dash 2.4.2 (Custom Build) lodash.com/license | Underscore.js 1.5.2 underscorejs.org/LICENSE
 * Build: `lodash underscore exports="amd,commonjs,global,node" -o ./dist/lodash.underscore.js`
 */
;(function(){function n(n,r,t){t=(t||0)-1;for(var e=n?n.length:0;++t<e;)if(n[t]===r)return t;return-1}function r(n,r){for(var t=n.m,e=r.m,u=-1,o=t.length;++u<o;){var i=t[u],f=e[u];if(i!==f){if(i>f||typeof i=="undefined")return 1;if(i<f||typeof f=="undefined")return-1}}return n.n-r.n}function t(n){return"\\"+yr[n]}function e(n,r,t){r||(r=0),typeof t=="undefined"&&(t=n?n.length:0);var e=-1;t=t-r||0;for(var u=Array(0>t?0:t);++e<t;)u[e]=n[r+e];return u}function u(n){return n instanceof u?n:new o(n)}function o(n,r){this.__chain__=!!r,this.__wrapped__=n
}function i(n){function r(){if(u){var n=e(u);Rr.apply(n,arguments)}if(this instanceof r){var i=f(t.prototype),n=t.apply(i,n||arguments);return O(n)?n:i}return t.apply(o,n||arguments)}var t=n[0],u=n[2],o=n[4];return r}function f(n){return O(n)?Br(n):{}}function a(n,r,t){if(typeof n!="function")return Y;if(typeof r=="undefined"||!("prototype"in n))return n;switch(t){case 1:return function(t){return n.call(r,t)};case 2:return function(t,e){return n.call(r,t,e)};case 3:return function(t,e,u){return n.call(r,t,e,u)
};case 4:return function(t,e,u,o){return n.call(r,t,e,u,o)}}return L(n,r)}function l(n){function r(){var n=p?a:this;if(o){var y=e(o);Rr.apply(y,arguments)}return(i||g)&&(y||(y=e(arguments)),i&&Rr.apply(y,i),g&&y.length<c)?(u|=16,l([t,h?u:-4&u,y,null,a,c])):(y||(y=arguments),s&&(t=n[v]),this instanceof r?(n=f(t.prototype),y=t.apply(n,y),O(y)?y:n):t.apply(n,y))}var t=n[0],u=n[1],o=n[2],i=n[3],a=n[4],c=n[5],p=1&u,s=2&u,g=4&u,h=8&u,v=t;return r}function c(n,r){for(var t=-1,e=m(),u=n?n.length:0,o=[];++t<u;){var i=n[t];
0>e(r,i)&&o.push(i)}return o}function p(n,r,t,e){e=(e||0)-1;for(var u=n?n.length:0,o=[];++e<u;){var i=n[e];if(i&&typeof i=="object"&&typeof i.length=="number"&&(Cr(i)||b(i))){r||(i=p(i,r,t));var f=-1,a=i.length,l=o.length;for(o.length+=a;++f<a;)o[l++]=i[f]}else t||o.push(i)}return o}function s(n,r,t,e){if(n===r)return 0!==n||1/n==1/r;if(n===n&&!(n&&vr[typeof n]||r&&vr[typeof r]))return false;if(null==n||null==r)return n===r;var o=Er.call(n),i=Er.call(r);if(o!=i)return false;switch(o){case lr:case cr:return+n==+r;
case pr:return n!=+n?r!=+r:0==n?1/n==1/r:n==+r;case gr:case hr:return n==r+""}if(i=o==ar,!i){var f=n instanceof u,a=r instanceof u;if(f||a)return s(f?n.__wrapped__:n,a?r.__wrapped__:r,t,e);if(o!=sr)return false;if(o=n.constructor,f=r.constructor,o!=f&&!(A(o)&&o instanceof o&&A(f)&&f instanceof f)&&"constructor"in n&&"constructor"in r)return false}for(t||(t=[]),e||(e=[]),o=t.length;o--;)if(t[o]==n)return e[o]==r;var l=true,c=0;if(t.push(n),e.push(r),i){if(c=r.length,l=c==n.length)for(;c--&&(l=s(n[c],r[c],t,e)););}else Kr(r,function(r,u,o){return Nr.call(o,u)?(c++,!(l=Nr.call(n,u)&&s(n[u],r,t,e))&&er):void 0
}),l&&Kr(n,function(n,r,t){return Nr.call(t,r)?!(l=-1<--c)&&er:void 0});return t.pop(),e.pop(),l}function g(n,r,t){for(var e=-1,u=m(),o=n?n.length:0,i=[],f=t?[]:i;++e<o;){var a=n[e],l=t?t(a,e,n):a;(r?!e||f[f.length-1]!==l:0>u(f,l))&&(t&&f.push(l),i.push(a))}return i}function h(n){return function(r,t,e){var u={};t=X(t,e,3),e=-1;var o=r?r.length:0;if(typeof o=="number")for(;++e<o;){var i=r[e];n(u,i,t(i,e,r),r)}else Lr(r,function(r,e,o){n(u,r,t(r,e,o),o)});return u}}function v(n,r,t,e,u,o){var f=16&r,a=32&r;
if(!(2&r||A(n)))throw new TypeError;return f&&!t.length&&(r&=-17,t=false),a&&!e.length&&(r&=-33,e=false),(1==r||17===r?i:l)([n,r,t,e,u,o])}function y(n){return Vr[n]}function m(){var r=(r=u.indexOf)===G?n:r;return r}function _(n){return typeof n=="function"&&Ar.test(n)}function d(n){return Gr[n]}function b(n){return n&&typeof n=="object"&&typeof n.length=="number"&&Er.call(n)==fr||false}function w(n){if(!n)return n;for(var r=1,t=arguments.length;r<t;r++){var e=arguments[r];if(e)for(var u in e)n[u]=e[u]}return n
}function j(n){if(!n)return n;for(var r=1,t=arguments.length;r<t;r++){var e=arguments[r];if(e)for(var u in e)"undefined"==typeof n[u]&&(n[u]=e[u])}return n}function x(n){var r=[];return Kr(n,function(n,t){A(n)&&r.push(t)}),r.sort()}function T(n){for(var r=-1,t=Ur(n),e=t.length,u={};++r<e;){var o=t[r];u[n[o]]=o}return u}function E(n){if(!n)return true;if(Cr(n)||N(n))return!n.length;for(var r in n)if(Nr.call(n,r))return false;return true}function A(n){return typeof n=="function"}function O(n){return!(!n||!vr[typeof n])
}function S(n){return typeof n=="number"||n&&typeof n=="object"&&Er.call(n)==pr||false}function N(n){return typeof n=="string"||n&&typeof n=="object"&&Er.call(n)==hr||false}function R(n){for(var r=-1,t=Ur(n),e=t.length,u=Array(e);++r<e;)u[r]=n[t[r]];return u}function k(n,r){var t=m(),e=n?n.length:0,u=false;return e&&typeof e=="number"?u=-1<t(n,r):Lr(n,function(n){return(u=n===r)&&er}),u}function B(n,r,t){var e=true;r=X(r,t,3),t=-1;var u=n?n.length:0;if(typeof u=="number")for(;++t<u&&(e=!!r(n[t],t,n)););else Lr(n,function(n,t,u){return!(e=!!r(n,t,u))&&er
});return e}function F(n,r,t){var e=[];r=X(r,t,3),t=-1;var u=n?n.length:0;if(typeof u=="number")for(;++t<u;){var o=n[t];r(o,t,n)&&e.push(o)}else Lr(n,function(n,t,u){r(n,t,u)&&e.push(n)});return e}function q(n,r,t){r=X(r,t,3),t=-1;var e=n?n.length:0;if(typeof e!="number"){var u;return Lr(n,function(n,t,e){return r(n,t,e)?(u=n,er):void 0}),u}for(;++t<e;){var o=n[t];if(r(o,t,n))return o}}function D(n,r,t){var e=-1,u=n?n.length:0;if(r=r&&typeof t=="undefined"?r:a(r,t,3),typeof u=="number")for(;++e<u&&r(n[e],e,n)!==er;);else Lr(n,r)
}function I(n,r){var t=n?n.length:0;if(typeof t=="number")for(;t--&&false!==r(n[t],t,n););else{var e=Ur(n),t=e.length;Lr(n,function(n,u,o){return u=e?e[--t]:--t,false===r(o[u],u,o)&&er})}}function M(n,r,t){var e=-1,u=n?n.length:0;if(r=X(r,t,3),typeof u=="number")for(var o=Array(u);++e<u;)o[e]=r(n[e],e,n);else o=[],Lr(n,function(n,t,u){o[++e]=r(n,t,u)});return o}function $(n,r,t){var e=-1/0,u=e;typeof r!="function"&&t&&t[r]===n&&(r=null);var o=-1,i=n?n.length:0;if(null==r&&typeof i=="number")for(;++o<i;)t=n[o],t>u&&(u=t);
else r=X(r,t,3),D(n,function(n,t,o){t=r(n,t,o),t>e&&(e=t,u=n)});return u}function W(n,r,t,e){if(!n)return t;var u=3>arguments.length;r=X(r,e,4);var o=-1,i=n.length;if(typeof i=="number")for(u&&(t=n[++o]);++o<i;)t=r(t,n[o],o,n);else Lr(n,function(n,e,o){t=u?(u=false,n):r(t,n,e,o)});return t}function z(n,r,t,e){var u=3>arguments.length;return r=X(r,e,4),I(n,function(n,e,o){t=u?(u=false,n):r(t,n,e,o)}),t}function C(n){var r=-1,t=n?n.length:0,e=Array(typeof t=="number"?t:0);return D(n,function(n){var t;t=++r,t=0+Sr(Wr()*(t-0+1)),e[r]=e[t],e[t]=n
}),e}function P(n,r,t){var e;r=X(r,t,3),t=-1;var u=n?n.length:0;if(typeof u=="number")for(;++t<u&&!(e=r(n[t],t,n)););else Lr(n,function(n,t,u){return(e=r(n,t,u))&&er});return!!e}function U(n,r,t){return t&&E(r)?rr:(t?q:F)(n,r)}function V(n,r,t){var u=0,o=n?n.length:0;if(typeof r!="number"&&null!=r){var i=-1;for(r=X(r,t,3);++i<o&&r(n[i],i,n);)u++}else if(u=r,null==u||t)return n?n[0]:rr;return e(n,0,$r(Mr(0,u),o))}function G(r,t,e){if(typeof e=="number"){var u=r?r.length:0;e=0>e?Mr(0,u+e):e||0}else if(e)return e=J(r,t),r[e]===t?e:-1;
return n(r,t,e)}function H(n,r,t){if(typeof r!="number"&&null!=r){var u=0,o=-1,i=n?n.length:0;for(r=X(r,t,3);++o<i&&r(n[o],o,n);)u++}else u=null==r||t?1:Mr(0,r);return e(n,u)}function J(n,r,t,e){var u=0,o=n?n.length:u;for(t=t?X(t,e,1):Y,r=t(r);u<o;)e=u+o>>>1,t(n[e])<r?u=e+1:o=e;return u}function K(n,r,t,e){return typeof r!="boolean"&&null!=r&&(e=t,t=typeof r!="function"&&e&&e[r]===n?null:r,r=false),null!=t&&(t=X(t,e,3)),g(n,r,t)}function L(n,r){return 2<arguments.length?v(n,17,e(arguments,2),null,r):v(n,1,null,null,r)
}function Q(n,r,t){var e,u,o,i,f,a,l,c=0,p=false,s=true;if(!A(n))throw new TypeError;if(r=Mr(0,r)||0,true===t)var g=true,s=false;else O(t)&&(g=t.leading,p="maxWait"in t&&(Mr(r,t.maxWait)||0),s="trailing"in t?t.trailing:s);var h=function(){var t=r-(nt()-i);0<t?a=setTimeout(h,t):(u&&clearTimeout(u),t=l,u=a=l=rr,t&&(c=nt(),o=n.apply(f,e),a||u||(e=f=null)))},v=function(){a&&clearTimeout(a),u=a=l=rr,(s||p!==r)&&(c=nt(),o=n.apply(f,e),a||u||(e=f=null))};return function(){if(e=arguments,i=nt(),f=this,l=s&&(a||!g),false===p)var t=g&&!a;
else{u||g||(c=i);var y=p-(i-c),m=0>=y;m?(u&&(u=clearTimeout(u)),c=i,o=n.apply(f,e)):u||(u=setTimeout(v,y))}return m&&a?a=clearTimeout(a):a||r===p||(a=setTimeout(h,r)),t&&(m=true,o=n.apply(f,e)),!m||a||u||(e=f=null),o}}function X(n,r,t){var e=typeof n;if(null==n||"function"==e)return a(n,r,t);if("object"!=e)return nr(n);var u=Ur(n);return function(r){for(var t=u.length,e=false;t--&&(e=r[u[t]]===n[u[t]]););return e}}function Y(n){return n}function Z(n){D(x(n),function(r){var t=u[r]=n[r];u.prototype[r]=function(){var n=[this.__wrapped__];
return Rr.apply(n,arguments),n=t.apply(u,n),this.__chain__?new o(n,true):n}})}function nr(n){return function(r){return r[n]}}var rr,tr=0,er={},ur=+new Date+"",or=/($^)/,ir=/['\n\r\t\u2028\u2029\\]/g,fr="[object Arguments]",ar="[object Array]",lr="[object Boolean]",cr="[object Date]",pr="[object Number]",sr="[object Object]",gr="[object RegExp]",hr="[object String]",vr={"boolean":false,"function":true,object:true,number:false,string:false,undefined:false},yr={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"},mr=vr[typeof window]&&window||this,_r=vr[typeof exports]&&exports&&!exports.nodeType&&exports,dr=vr[typeof module]&&module&&!module.nodeType&&module,br=dr&&dr.exports===_r&&_r,wr=vr[typeof global]&&global;
!wr||wr.global!==wr&&wr.window!==wr||(mr=wr);var jr=[],xr=Object.prototype,Tr=mr._,Er=xr.toString,Ar=RegExp("^"+(Er+"").replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Or=Math.ceil,Sr=Math.floor,Nr=xr.hasOwnProperty,Rr=jr.push,kr=xr.propertyIsEnumerable,Br=_(Br=Object.create)&&Br,Fr=_(Fr=Array.isArray)&&Fr,qr=mr.isFinite,Dr=mr.isNaN,Ir=_(Ir=Object.keys)&&Ir,Mr=Math.max,$r=Math.min,Wr=Math.random;o.prototype=u.prototype;var zr={};!function(){var n={0:1,length:1};zr.spliceObjects=(jr.splice.call(n,0,1),!n[0])
}(1),u.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,variable:""},Br||(f=function(){function n(){}return function(r){if(O(r)){n.prototype=r;var t=new n;n.prototype=null}return t||mr.Object()}}()),b(arguments)||(b=function(n){return n&&typeof n=="object"&&typeof n.length=="number"&&Nr.call(n,"callee")&&!kr.call(n,"callee")||false});var Cr=Fr||function(n){return n&&typeof n=="object"&&typeof n.length=="number"&&Er.call(n)==ar||false},Pr=function(n){var r,t=[];
if(!n||!vr[typeof n])return t;for(r in n)Nr.call(n,r)&&t.push(r);return t},Ur=Ir?function(n){return O(n)?Ir(n):[]}:Pr,Vr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},Gr=T(Vr),Hr=RegExp("("+Ur(Gr).join("|")+")","g"),Jr=RegExp("["+Ur(Vr).join("")+"]","g"),Kr=function(n,r){var t;if(!n||!vr[typeof n])return n;for(t in n)if(r(n[t],t,n)===er)break;return n},Lr=function(n,r){var t;if(!n||!vr[typeof n])return n;for(t in n)if(Nr.call(n,t)&&r(n[t],t,n)===er)break;return n};A(/x/)&&(A=function(n){return typeof n=="function"&&"[object Function]"==Er.call(n)
});var Qr=h(function(n,r,t){Nr.call(n,t)?n[t]++:n[t]=1}),Xr=h(function(n,r,t){(Nr.call(n,t)?n[t]:n[t]=[]).push(r)}),Yr=h(function(n,r,t){n[t]=r}),Zr=M,nt=_(nt=Date.now)&&nt||function(){return(new Date).getTime()};u.after=function(n,r){if(!A(r))throw new TypeError;return function(){return 1>--n?r.apply(this,arguments):void 0}},u.bind=L,u.bindAll=function(n){for(var r=1<arguments.length?p(arguments,true,false,1):x(n),t=-1,e=r.length;++t<e;){var u=r[t];n[u]=v(n[u],1,null,null,n)}return n},u.chain=function(n){return n=new o(n),n.__chain__=true,n
},u.compact=function(n){for(var r=-1,t=n?n.length:0,e=[];++r<t;){var u=n[r];u&&e.push(u)}return e},u.compose=function(){for(var n=arguments,r=n.length;r--;)if(!A(n[r]))throw new TypeError;return function(){for(var r=arguments,t=n.length;t--;)r=[n[t].apply(this,r)];return r[0]}},u.countBy=Qr,u.debounce=Q,u.defaults=j,u.defer=function(n){if(!A(n))throw new TypeError;var r=e(arguments,1);return setTimeout(function(){n.apply(rr,r)},1)},u.delay=function(n,r){if(!A(n))throw new TypeError;var t=e(arguments,2);
return setTimeout(function(){n.apply(rr,t)},r)},u.difference=function(n){return c(n,p(arguments,true,true,1))},u.filter=F,u.flatten=function(n,r){return p(n,r)},u.forEach=D,u.functions=x,u.groupBy=Xr,u.indexBy=Yr,u.initial=function(n,r,t){var u=0,o=n?n.length:0;if(typeof r!="number"&&null!=r){var i=o;for(r=X(r,t,3);i--&&r(n[i],i,n);)u++}else u=null==r||t?1:r||u;return e(n,0,$r(Mr(0,o-u),o))},u.intersection=function(){for(var n=[],r=-1,t=arguments.length;++r<t;){var e=arguments[r];(Cr(e)||b(e))&&n.push(e)
}var u=n[0],o=-1,i=m(),f=u?u.length:0,a=[];n:for(;++o<f;)if(e=u[o],0>i(a,e)){for(r=t;--r;)if(0>i(n[r],e))continue n;a.push(e)}return a},u.invert=T,u.invoke=function(n,r){var t=e(arguments,2),u=-1,o=typeof r=="function",i=n?n.length:0,f=Array(typeof i=="number"?i:0);return D(n,function(n){f[++u]=(o?r:n[r]).apply(n,t)}),f},u.keys=Ur,u.map=M,u.max=$,u.memoize=function(n,r){var t={};return function(){var e=r?r.apply(this,arguments):ur+arguments[0];return Nr.call(t,e)?t[e]:t[e]=n.apply(this,arguments)
}},u.min=function(n,r,t){var e=1/0,u=e;typeof r!="function"&&t&&t[r]===n&&(r=null);var o=-1,i=n?n.length:0;if(null==r&&typeof i=="number")for(;++o<i;)t=n[o],t<u&&(u=t);else r=X(r,t,3),D(n,function(n,t,o){t=r(n,t,o),t<e&&(e=t,u=n)});return u},u.omit=function(n){var r=[];Kr(n,function(n,t){r.push(t)});for(var r=c(r,p(arguments,true,false,1)),t=-1,e=r.length,u={};++t<e;){var o=r[t];u[o]=n[o]}return u},u.once=function(n){var r,t;if(!A(n))throw new TypeError;return function(){return r?t:(r=true,t=n.apply(this,arguments),n=null,t)
}},u.pairs=function(n){for(var r=-1,t=Ur(n),e=t.length,u=Array(e);++r<e;){var o=t[r];u[r]=[o,n[o]]}return u},u.partial=function(n){return v(n,16,e(arguments,1))},u.pick=function(n){for(var r=-1,t=p(arguments,true,false,1),e=t.length,u={};++r<e;){var o=t[r];o in n&&(u[o]=n[o])}return u},u.pluck=Zr,u.range=function(n,r,t){n=+n||0,t=+t||1,null==r&&(r=n,n=0);var e=-1;r=Mr(0,Or((r-n)/t));for(var u=Array(r);++e<r;)u[e]=n,n+=t;return u},u.reject=function(n,r,t){return r=X(r,t,3),F(n,function(n,t,e){return!r(n,t,e)
})},u.rest=H,u.shuffle=C,u.sortBy=function(n,t,e){var u=-1,o=n?n.length:0,i=Array(typeof o=="number"?o:0);for(t=X(t,e,3),D(n,function(n,r,e){i[++u]={m:[t(n,r,e)],n:u,o:n}}),o=i.length,i.sort(r);o--;)i[o]=i[o].o;return i},u.tap=function(n,r){return r(n),n},u.throttle=function(n,r,t){var e=true,u=true;if(!A(n))throw new TypeError;return false===t?e=false:O(t)&&(e="leading"in t?t.leading:e,u="trailing"in t?t.trailing:u),t={},t.leading=e,t.maxWait=r,t.trailing=u,Q(n,r,t)},u.times=function(n,r,t){n=-1<(n=+n)?n:0;
var e=-1,u=Array(n);for(r=a(r,t,1);++e<n;)u[e]=r(e);return u},u.toArray=function(n){return Cr(n)?e(n):n&&typeof n.length=="number"?M(n):R(n)},u.union=function(){return g(p(arguments,true,true))},u.uniq=K,u.values=R,u.where=U,u.without=function(n){return c(n,e(arguments,1))},u.wrap=function(n,r){return v(r,16,[n])},u.zip=function(){for(var n=-1,r=$(Zr(arguments,"length")),t=Array(0>r?0:r);++n<r;)t[n]=Zr(arguments,n);return t},u.collect=M,u.drop=H,u.each=D,u.extend=w,u.methods=x,u.object=function(n,r){var t=-1,e=n?n.length:0,u={};
for(r||!e||Cr(n[0])||(r=[]);++t<e;){var o=n[t];r?u[o]=r[t]:o&&(u[o[0]]=o[1])}return u},u.select=F,u.tail=H,u.unique=K,u.clone=function(n){return O(n)?Cr(n)?e(n):w({},n):n},u.contains=k,u.escape=function(n){return null==n?"":(n+"").replace(Jr,y)},u.every=B,u.find=q,u.has=function(n,r){return n?Nr.call(n,r):false},u.identity=Y,u.indexOf=G,u.isArguments=b,u.isArray=Cr,u.isBoolean=function(n){return true===n||false===n||n&&typeof n=="object"&&Er.call(n)==lr||false},u.isDate=function(n){return n&&typeof n=="object"&&Er.call(n)==cr||false
},u.isElement=function(n){return n&&1===n.nodeType||false},u.isEmpty=E,u.isEqual=function(n,r){return s(n,r)},u.isFinite=function(n){return qr(n)&&!Dr(parseFloat(n))},u.isFunction=A,u.isNaN=function(n){return S(n)&&n!=+n},u.isNull=function(n){return null===n},u.isNumber=S,u.isObject=O,u.isRegExp=function(n){return n&&vr[typeof n]&&Er.call(n)==gr||false},u.isString=N,u.isUndefined=function(n){return typeof n=="undefined"},u.lastIndexOf=function(n,r,t){var e=n?n.length:0;for(typeof t=="number"&&(e=(0>t?Mr(0,e+t):$r(t,e-1))+1);e--;)if(n[e]===r)return e;
return-1},u.mixin=Z,u.noConflict=function(){return mr._=Tr,this},u.random=function(n,r){return null==n&&null==r&&(r=1),n=+n||0,null==r?(r=n,n=0):r=+r||0,n+Sr(Wr()*(r-n+1))},u.reduce=W,u.reduceRight=z,u.result=function(n,r){if(n){var t=n[r];return A(t)?n[r]():t}},u.size=function(n){var r=n?n.length:0;return typeof r=="number"?r:Ur(n).length},u.some=P,u.sortedIndex=J,u.template=function(n,r,e){var o=u,i=o.templateSettings;n=(n||"")+"",e=j({},e,i);var f=0,a="__p+='",i=e.variable;n.replace(RegExp((e.escape||or).source+"|"+(e.interpolate||or).source+"|"+(e.evaluate||or).source+"|$","g"),function(r,e,u,o,i){return a+=n.slice(f,i).replace(ir,t),e&&(a+="'+_.escape("+e+")+'"),o&&(a+="';"+o+";\n__p+='"),u&&(a+="'+((__t=("+u+"))==null?'':__t)+'"),f=i+r.length,r
}),a+="';",i||(i="obj",a="with("+i+"||{}){"+a+"}"),a="function("+i+"){var __t,__p='',__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}"+a+"return __p}";try{var l=Function("_","return "+a)(o)}catch(c){throw c.source=a,c}return r?l(r):(l.source=a,l)},u.unescape=function(n){return null==n?"":(n+"").replace(Hr,d)},u.uniqueId=function(n){var r=++tr+"";return n?n+r:r},u.all=B,u.any=P,u.detect=q,u.findWhere=function(n,r){return U(n,r,true)},u.foldl=W,u.foldr=z,u.include=k,u.inject=W,u.first=V,u.last=function(n,r,t){var u=0,o=n?n.length:0;
if(typeof r!="number"&&null!=r){var i=o;for(r=X(r,t,3);i--&&r(n[i],i,n);)u++}else if(u=r,null==u||t)return n?n[o-1]:rr;return e(n,Mr(0,o-u))},u.sample=function(n,r,t){return n&&typeof n.length!="number"&&(n=R(n)),null==r||t?n?n[0+Sr(Wr()*(n.length-1-0+1))]:rr:(n=C(n),n.length=$r(Mr(0,r),n.length),n)},u.take=V,u.head=V,Z(u),u.VERSION="2.4.2",u.prototype.chain=function(){return this.__chain__=true,this},u.prototype.value=function(){return this.__wrapped__},D("pop push reverse shift sort splice unshift".split(" "),function(n){var r=jr[n];
u.prototype[n]=function(){var n=this.__wrapped__;return r.apply(n,arguments),zr.spliceObjects||0!==n.length||delete n[0],this}}),D(["concat","join","slice"],function(n){var r=jr[n];u.prototype[n]=function(){var n=r.apply(this.__wrapped__,arguments);return this.__chain__&&(n=new o(n),n.__chain__=true),n}}),typeof define=="function"&&typeof define.amd=="object"&&define.amd?(mr._=u, define(function(){return u})):_r&&dr?br?(dr.exports=u)._=u:_r._=u:mr._=u}).call(this);;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:lodash-noconflict', location = 'applinks/internal/lib/lodash-amd-noconflict-global.js' */
define('applinks/lib/lodash', function() {
    if (!window._) {
        throw "lodash not found";
    }
    return window._.noConflict();
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/lib-version.js' */
// NOTE: this is in "lib" because it's required by aui-amd.js. This module _cannot_ have any dependencies on non-lib
// modules (like "common")
define('applinks/lib/version', [
    'applinks/lib/lodash'
], function(
    _
) {

    function checkIntValue(value, desc) {
        if (_.isUndefined(value)) {
            return 0;
        } else if (typeof value !== 'number' || isNaN(value)) {
            throw new Error(desc + ': expected a number, was: <' + value + '>');
        } else {
            return Math.floor(value);
        }
    }

    function checkVersionObject(object, desc) {
        if (!object || !(object instanceof Version)) {
            throw new Error(desc + ': expected a Version object, was: <' + object + '>');
        }
        return object;
    }

    function compareInt(intOne, intTwo) {
        return intOne > intTwo ? 1 : intOne == intTwo ? 0 : -1;
    }

    /**
     * Constructs a version object that contains version information and can be compared with other version objects.
     *
     * @param major major version component
     * @param minor minor version component
     * @param bugfix bugfix version component
     * @constructor
     */
    function Version(major, minor, bugfix) {
        this.major = checkIntValue(major, 'major');
        this.minor = checkIntValue(minor, 'minor');
        this.bugfix = checkIntValue(bugfix, 'bugfix');
    }

    /**
     * Constructs a Version by parsing a version string.
     *
     * @param versionString version string to parse, expected to be in the form of <major>.<minor>.<bugfix>
     * @param versionDesc what version does the `versionString` represent
     */
    Version.parse = function(versionString, versionDesc) {
        versionDesc = versionDesc || 'versionString';
        if (!versionString) {
            throw new Error(versionDesc + ': expected a non-empty string');
        }
        var versionSplit = versionString.split('.');
        if (versionSplit.length !== 3) {
            throw new Error(versionDesc + ': expected <major>.<minor>.<bugfix> string, was: <' + versionString + '>');
        }
        return new Version(parseInt(versionSplit[0]), parseInt(versionSplit[1]), parseInt(versionSplit[2]));
    };

    /**
     * Comparator function to sort Version objects.
     *
     * @param versionOne first version object
     * @param versionTwo second version object
     * @returns {Number} comparison result
     * @see Version.compareTo(that)
     */
    Version.comparator = function(versionOne, versionTwo) {
        return checkVersionObject(versionOne, 'versionOne').compareTo(checkVersionObject(versionTwo, 'versionTwo'));
    };

    /**
     * Return -1, 0 or 1 as this Version object represents a version less than, equal to, or greater than `that`.
     *
     * @param that the other version to compare to
     * @returns {Number} comparison result
     */
    Version.prototype.compareTo = function(that) {
        checkVersionObject(that, 'that');
        var majorResult = compareInt(this.major, that.major);
        if (majorResult != 0) {
            return majorResult;
        }
        var minorResult = compareInt(this.minor, that.minor);
        if (minorResult != 0) {
            return minorResult;
        }
        return compareInt(this.bugfix, that.bugfix);
    };

    Version.prototype.greaterThan = function(that) {
        return this.compareTo(that) > 0;
    };

    Version.prototype.greaterThanOrEqual = function(that) {
        return this.compareTo(that) >= 0;
    };

    Version.prototype.lessThan = function(that) {
        return this.compareTo(that) < 0;
    };

    Version.prototype.lessThanOrEqual = function(that) {
        return this.compareTo(that) <= 0;
    };

    Version.prototype.equals = function(that) {
        return this.compareTo(that) == 0;
    };

    Version.prototype.toMinor = function() {
        return new Version(this.major, this.minor);
    };

    Version.prototype.toMajor = function() {
        return new Version(this.major);
    };

    Version.prototype.toString = function() {
        return this.major + '.' + this.minor + '.' + this.bugfix;
    };

    return Version;
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/aui-version-details.js' */
define('applinks/lib/aui-version-details', [
    'applinks/lib/version'
], function(
    Version
) {
    // minimum 5.9.x AUI versions - lower versions ship with bugs that break some of the Applinks functionality.
    var MINIMUM_59_VERSION = new Version(5, 9, 13);
    var VERSION_58 = new Version(5, 8);
    var VERSION_59 = new Version(5, 9);

    function checkVersion(version) {
        // if 5.9, must be >= the minimum required 5.9.x version
        if (version.lessThan(MINIMUM_59_VERSION) || version.lessThan(VERSION_59)) {
            throw new Error('AUI version ' + version + ' is too low, you need to upgrade AUI to ' + MINIMUM_59_VERSION
                + ' for Applinks to work');
        }
    }

    function addVersionDetails(AJS) {
        var ajsVersion = Version.parse(AJS.version, 'AUI version');
        checkVersion(ajsVersion);

        AJS.versionDetails = ajsVersion;
        AJS.versionDetails.is58 = ajsVersion.toMinor().equals(VERSION_58);
        AJS.versionDetails.is59 = ajsVersion.toMinor().equals(VERSION_59);

        return AJS;
    }

    return  {
        /**
         * Check AUI version for compatibility with Applinks and add `versionDetails` field.
         */
        addVersionDetails: addVersionDetails
    };
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/console-amd.js' */
define('applinks/lib/console', function() {
    return window.console;
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/jquery-amd.js' */
define('applinks/lib/jquery', function() {
   return window.jQuery;
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/aui-amd.js' */
define('applinks/lib/aui', [
    'applinks/lib/window',
    'applinks/lib/aui-version-details'
], function(
    window,
    VersionDetails
) {
    var AJS = window.AJS;
    if (!AJS) {
        throw new Error('window.AJS not defined, cannot load AUI');
    }

    return VersionDetails.addVersionDetails(AJS);
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/wrm-amd.js' */
/**
 * Define Web resource manager as an AMD dependency. This should also be present in apps using Atlassian Plugins Web
 * Resources framework.
 */
define('applinks/lib/wrm', function() {
   return window.WRM;
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/skate-amd.js' */
define('applinks/lib/skate', function() {
   // window.skate is not exposed as a global from AUI 5.9, this will return undefined with that version or later
   return window.skate;
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/window-amd.js' */
/**
 * Define window as AMD module to facilitate unit testing of some modules
 */
define('applinks/lib/window', function() {
    return window;
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/spi-amd.js' */
/**
 * Define the Applinks SPI functions as AMD module to facilitate unit testing of some modules
 */
define('applinks/lib/spi', function() {
    return {get:
        function (){
            //required since code that depends on this global is run before the global is defined,
            // can be eliminated once this module is made properly AMD
            return AppLinks.SPI;
    }}
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/applinks-creation-amd.js' */
/**
 * Define the Applinks creation resources  as AMD module to facilitate unit testing of some modules
 */
define('applinks/lib/creation', function() {
    return {
        get: function () {
            //required since code that depends on this global is run before the global is defined,
            // can be eliminated once this module is made properly AMD
            return AppLinks.Creation;
        }
    }
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common-exported', location = 'applinks/internal/common/docs.js' */
define('applinks/common/docs', [
    'applinks/lib/jquery',
    'applinks/lib/aui',
    'applinks/common/help-paths'
], function(
    $,
    AJS,
    ApplinksHelpPaths
) {
    // NOTE: should be moved to applinks/feature/help-link, see APLDEV-593

    return {
        /**
         * NOTE: this is a dynamically generated version of the link build in _help_link.vm, any update here should be
         * applied there.
         * @method createDocLink
         * @param pageKey a key that maps to a page in ual-help-paths.properties
         * @param sectionKey (Optional) a key that maps to an anchor section id in ual-help-paths.properties
         * @param classNames (Optional) Whitespace separated list of additional class names
         * @return an html &lt;a&gt; element targeting the specified page & section
         */
        createDocLink: function(pageKey, sectionKey, classNames) {
            if (!classNames) {
                classNames = '';
            } else {
                classNames = ' ' + classNames;
            }
            return $('<a/>', {
                'class': 'ual-help-link help-link' + classNames,
                href: this.getDocHref(pageKey, sectionKey),
                target: '_blank',
                'data-help-link-key': pageKey,
                text: "Help",
                title: "Help"
            });
        },
        /**
         * @method getDocHref
         * @param pageKey a key that maps to a page in ual-help-paths.properties
         * @param sectionKey (Optional) a key that maps to an anchor section id in ual-help-paths.properties
         * @return the url of the given page and section (if specified)
         */
        getDocHref: function(pageKey, sectionKey) {
            var link = ApplinksHelpPaths.getFullPath(pageKey);
            if (sectionKey) {
                link += '#' + ApplinksHelpPaths.getPath(sectionKey);
            }
            return link;
        }
    };

});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common-exported', location = 'applinks/internal/common/help-paths.js' */
define('applinks/common/help-paths', [
    'applinks/lib/console',
    'applinks/lib/wrm',
    'applinks/lib/lodash',
    'applinks/common/modules',
    'applinks/common/preconditions'
], function(
    console,
    WRM,
    _,
    ApplinksModules,
    Preconditions
) {
    // NOTE: should be moved to applinks/feature/help-link, see APLDEV-593

    // lazy-load help paths, facilitates unit-testing
    var allHelpPaths = _.memoize(function() {
        var helpPaths = WRM.data.claim(ApplinksModules.dataFqn(ApplinksModules.COMMON_EXPORTED, 'applinks-help-paths'));
        if (!helpPaths.entries) {
            console.warn('Help paths not found, all help links are likely to be broken.');
        }
        return helpPaths.entries || {};
    });

    var getPath = function(key, sectionKey) {
        Preconditions.nonEmptyString(key, 'key');
        var path = allHelpPaths()[key] || key;
        if (sectionKey) {
            Preconditions.nonEmptyString(sectionKey, 'sectionKey');
            var prefix = path.replace(/\+/g, ''); // "g" flag to remove _all_ '+' signs
            path += '#' +prefix + '-' + sectionKey;
        }
        return path;
    };

    function endsWith(string, suffix) {
        return string.indexOf(suffix, string.length - suffix.length) !== -1;
    }

    function addSuffixIfRequired(string, suffix) {
        return endsWith(string, suffix) ? string : string + suffix;
    }

    return {
        /**
         * @param key {string} key to get the path for
         * @returns {string} relative help path that can be appended to any relevant docs base URL
         */
        getPath: getPath,

        /**
         * @param key {string} key to get the path for
         * @param sectionKey {string} optional key of the anchor on the target page
         * @returns {string} full help path including the base URL
         */
        getFullPath: function(key, sectionKey) {
            var baseUrl = this.baseUrl();
            return addSuffixIfRequired(baseUrl, '/') + this.getPath(key, sectionKey);
        },

        /**
         * @returns {string} configured base URL for the help paths
         */
        baseUrl: _.partial(getPath, 'applinks.docs.root')
    }
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common-exported', location = 'applinks/internal/common/events.js' */
define('applinks/common/events', [
    'applinks/lib/jquery',
    'applinks/lib/lodash',
    'applinks/lib/window',
    'applinks/common/preconditions'
], function(
    $,
    _,
    window,
    Preconditions
) {
    var PREFIX = 'applinks.event.';

    function applinksEvent(eventId) {
        return PREFIX + Preconditions.nonEmptyString(eventId, 'eventId');
    }

    /**
     * Provides common Applinks event IDs and a simple event system facade API. This is a preferred way to subscribe to
     * and raise Applinks-specific events as it does not depend on a specific event bus or event target (such as
     * `document`), as well as facilitates unit testing.
     */
    return {
        PREREADY: applinksEvent('preready'),
        READY: applinksEvent('ready'),

        /**
         * Raised when applinks list is first loaded
         */
        APPLINKS_LOADED: applinksEvent('loaded'),
        /**
         * Raised when applinks list is updated
         */
        APPLINKS_UPDATED: applinksEvent('updated'),

        /**
         * This event is only raised when linking to Atlassian applications
         * Can be consumed by other plugins
         */
        NEW_APPLINK_CREATED: applinksEvent('created'),

        /**
         * Raised when orphaned upgrade operation succeeds in creating a new Applink from the orphaned relationship
         */
        ORPHANED_UPGRADE: applinksEvent('orphaned.upgrade'),

        /**
         * Raised when v3 onboarding has finished or, or has never run on the current page (and won't).
         */
        V3_ONBOARDING_FINISHED: applinksEvent('v3-onboarding-finished'),

        // legacy events
        Legacy: {
            MESSAGE_BOX_DISPLAYED: applinksEvent('message-box-displayed')
        },

        applinksEvent: applinksEvent,

        on: function(events, handler, context) {
            var handlerWithContext = context ? _.bind(handler, context) : handler;
            $(window.document).on(events, handlerWithContext);
        },

        off: function(events, handler) {
            $(window.document).off(events, handler);
        },

        trigger: function(event, data) {
            $(window.document).trigger(event, data);
        }
    }
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common-exported', location = 'applinks/internal/common/i18n.js' */
define('applinks/common/i18n', [
    'applinks/lib/lodash',
    'applinks/lib/jquery',
    'applinks/lib/wrm',
    'applinks/common/modules',
    'applinks/common/preconditions',
    'applinks/common/products'
], function(
    _,
    $,
    WRM,
    ApplinksModules,
    Preconditions,
    ApplinksProducts
) {
    var getAllEntityTypes = _.memoize(function() {
        var val = WRM.data.claim(ApplinksModules.dataFqn(ApplinksModules.COMMON_EXPORTED, 'entity-types'));
        return Preconditions.hasValue(val, 'entity-types', 'Entity Types data not found');
    });

    var getAllAuthTypes = _.memoize(function() {
        var val = WRM.data.claim(ApplinksModules.dataFqn(ApplinksModules.COMMON_EXPORTED, 'authentication-types'));
        return Preconditions.hasValue(val, 'authentication-types', 'Authentication Types data not found');
    });

    return {
        
        /**
         * @param typeId ID of the application type to resolve
         * @returns {string} resolved i18n-ed type name, or the original `typeId` if there is no mapping
         */
        getApplicationTypeName: function(typeId) {
            return ApplinksProducts.getTypeName(typeId);
        },

        /**
         * @param typeId ID of the entity type to resolve
         * @returns {string} resolved i18n-ed singular entity type name, or the original `typeId` if there is no mapping
         */
        getEntityTypeName: function(typeId) {
            return getAllEntityTypes().singular[typeId] || typeId;
        },

        /**
         * @param typeId ID of the entity type to resolve
         * @returns {string} resolved i18n-ed plural entity type name, or the original `typeId` if there is no mapping
         */
        getPluralizedEntityTypeName: function(typeId) {
            return getAllEntityTypes().plural[typeId] || typeId;
        },

        /**
         * @param type ID of the authentication type to resolve (usually in a form of full class name)
         * @returns {string} resolved i18n-ed authentication type name, or the original `type` if there is no mapping
         */
        getAuthenticationTypeName: function(type) {
            return getAllAuthTypes()[type] || type;
        }
    };
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common-exported', location = 'applinks/internal/common/modules.js' */
/**
 * Applinks plugin modules core constants and definitions.
 */
define('applinks/common/modules', function() {
    return {
        /**
         * Applinks plugin key
         */
        PLUGIN_KEY: 'com.atlassian.applinks.applinks-plugin',

        // key web resource keys
        COMMON_EXPORTED: 'applinks-common-exported',
        COMMON: 'applinks-common',

        /**
         * Fully qualifies a module name using the plugin key.
         *
         * @param {string} moduleName module name to qualify
         * @returns {string} fully qualified name
         */
        fqn: function(moduleName) {
            return this.PLUGIN_KEY + ':' + moduleName;
        },

        /**
         * Fully qualifies web-resource data using module name and data key.
         *
         * @param {string} moduleName module name
         * @param {string} dataKey key of the data element
         * @returns {string} fully qualified name
         */
        dataFqn: function(moduleName, dataKey) {
            return this.fqn(moduleName) + '.' + dataKey;
        }
    };
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common-exported', location = 'applinks/internal/common/preconditions.js' */
define('applinks/common/preconditions', [
    'applinks/lib/lodash'
], function(
    _
) {
    function nonEmptyString(value, varName, customMessage) {
        return _checkArgument(
            _.isString(value) && !_.isEmpty(value),
            customMessage,
            _withVarName(varName, ': expected a non-empty string, was: <' + value + '>'),
            value
        );
    }

    function isFunction(value, varName, customMessage) {
        return _checkArgument(
            _.isFunction(value),
            customMessage,
            _withVarName(varName, ': expected a function, was: ' + value),
            value
        );
    }

    function isArray(value, varName, customMessage) {
        return _checkArgument(
            _.isArray(value),
            customMessage,
            _withVarName(varName, ': expected an array, was: ' + value),
            value
        );
    }

    function hasValue(value, varName, customMessage) {
        return _checkArgument(
            value,
            customMessage,
            _withVarName(varName, ': expected a value'),
            value
        );
    }

    function _checkArgument(test, message, defaultMessage, actualValue) {
        var actualMessage = message ? message : defaultMessage;
        if (!test) {
            throw new Error(actualMessage)
        }
        return actualValue || test;
    }

    function _withVarName(varName, msg) {
        return (varName || '[unspecified]') + msg;
    }

    return {
        checkArgument: _.partial(_checkArgument, _, _, '', _),
        nonEmptyString: nonEmptyString,
        isArray: isArray,
        isFunction: isFunction,
        hasValue: hasValue
    };
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common-exported', location = 'applinks/internal/common/products.js' */
define('applinks/common/products', [
    'applinks/lib/lodash',
    'applinks/lib/wrm',
    'applinks/common/modules',
    'applinks/common/preconditions'
], function(
    _,
    WRM,
    ApplinksModules,
    Preconditions
) {
    var getAllTypes = _.memoize(function() {
        var val = WRM.data.claim(ApplinksModules.dataFqn(ApplinksModules.COMMON_EXPORTED, 'applinks-types'));
        return Preconditions.hasValue(val, 'types', 'Application Types data not found');
    });

    /**
     * @param typeId ID of the application type to resolve
     * @returns {string} resolved i18n-ed type name, or the original `typeId` if there is no mapping
     */
    function getTypeName(typeId) {
        return getAllTypes()[typeId] || typeId;
    }

    /**
     * Map of Atlassian product keys to application type IDs
     */
    return {
        BAMBOO: 'bamboo',
        BITBUCKET: 'stash', // special case, see java class com.atlassian.applinks.application.bitbucket.BitbucketApplicationTypeImpl.TYPE_ID
        CONFLUENCE: 'confluence',
        FECRU: 'fecru',
        JIRA: 'jira',
        REFAPP: 'refapp',
        STASH: 'stash',
        getTypeName: getTypeName
    };
});;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.component.message', location = 'aui.chunk.a964845c8c28eb2c04e4--e89c2eaac3adc03c8081.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.message"],[],[["e8H2","runtime","aui.splitchunk.vendors--1df5b34e16","aui.splitchunk.172ffb6da7","aui.splitchunk.b0831cc7d0","aui.splitchunk.572a8bf5cd","aui.splitchunk.a16cabd587","aui.splitchunk.fbd1a5ab27","aui.splitchunk.d49cf794d2","aui.splitchunk.54d3f16c20","aui.splitchunk.1659111a3c","aui.splitchunk.bc4873e5f9","aui.splitchunk.1df5b34e16","aui.splitchunk.56dfb54d0c","aui.splitchunk.462ee5f9ef","aui.splitchunk.e7c127e2cc","aui.splitchunk.ec75f48bb8"]]]);
//# sourceMappingURL=aui.chunk.a964845c8c28eb2c04e4--e89c2eaac3adc03c8081.js.map;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.89403fec76', location = 'aui.chunk.e3ac2f65f1f52a285a46--824c9cae70b600cfcd7d.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.89403fec76"],{VjKg:function(n,t,i){"use strict";jQuery.fn.throbber=function(n){return function(){var t=[],i={isLatentThreshold:100,minThrobberDisplay:200,loadingClass:"loading"};return n(document).ajaxComplete(function(i,e){n(t).each(function(n){e===this.get(0)&&(this.hideThrobber(),t.splice(n,1))})}),function(e){var o,s,r=function n(t,i){n.t=setTimeout(function(){clearTimeout(n.t),n.t=void 0,t()},i)};return(e=n.extend(i,e||{})).target?(s=jQuery(e.target),t.push(n.extend(this,{showThrobber:function(){r(function(){o||(s.addClass(e.loadingClass),r(function(){o&&o()},e.minThrobberDisplay))},e.isLatentThreshold)},hideThrobber:function(){o=function(){s.removeClass(e.loadingClass),e.end&&e.end()},r.t||o()}})),this.showThrobber(),this):this}}()}(jQuery)}}]);
//# sourceMappingURL=aui.chunk.e3ac2f65f1f52a285a46--824c9cae70b600cfcd7d.js.map;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.deprecated.component.dropdown1', location = 'aui.chunk.1c0814e154a221e3cfc9--3fb9d1bcf4f55afbadd0.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.deprecated.component.dropdown1"],{"8dXc":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n("+x/D"));n("WCtk"),n("VjKg");var r=o(n("bPPT")),i=o(n("JFi+")),u=l(n("KloK"));function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function l(e){return e&&e.__esModule?e:{default:e}}function s(e,t){var n=null,r=[],u=!1,o=(0,a.default)(document),l={item:"li:has(a)",activeClass:"active",alignment:"right",displayHandler:function(e){return e.name},escapeHandler:function(){return this.hide("escape"),!1},hideHandler:function(){},moveHandler:function(){},useDisabled:!1};if(a.default.extend(l,t),l.alignment={left:"left",right:"right"}[l.alignment.toLowerCase()]||"left",e&&e.jquery)n=e;else if("string"==typeof e)n=(0,a.default)(e);else{if(!e||e.constructor!==Array)throw new Error("dropDown function was called with illegal parameter. Should be $ object, $ selector or array.");n=(0,a.default)("<div></div>").addClass("aui-dropdown").toggleClass("hidden",!!l.isHiddenByDefault);for(var d=0,c=e.length;d<c;d++){for(var f=(0,a.default)("<ol></ol>"),h=0,p=e[d].length;h<p;h++){var g=(0,a.default)("<li></li>"),v=e[d][h];v.href?(g.append((0,a.default)("<a></a>").html("<span>"+l.displayHandler(v)+"</span>").attr({href:v.href}).addClass(v.className)),a.default.data((0,a.default)("a > span",g)[0],"properties",v)):g.html(v.html).addClass(v.className),v.icon&&g.prepend((0,a.default)("<img />").attr("src",v.icon)),v.insideSpanIcon&&g.children("a").prepend((0,a.default)("<span></span>").attr("class","icon")),v.iconFontClass&&g.children("a").prepend((0,a.default)("<span></span>").addClass("aui-icon aui-icon-small aui-iconfont-"+v.iconFontClass)),a.default.data(g[0],"properties",v),f.append(g)}d===c-1&&f.addClass("last"),n.append(f)}(0,a.default)("body").append(n)}var m=function(){w(1)},y=function(){w(-1)},w=function(e){var t=!u,n=s.current.$[0],r=s.current.links,o=n.focused;if(u=!0,0!==r.length){if(n.focused="number"==typeof o?o:-1,!s.current)return i.log("move - not current, aborting"),!0;n.focused+=e,n.focused<0?n.focused=r.length-1:n.focused>=r.length&&(n.focused=0),l.moveHandler((0,a.default)(r[n.focused]),e<0?"up":"down"),t&&r.length?((0,a.default)(r[n.focused]).addClass(l.activeClass),u=!1):r.length||(u=!1)}},b=function(e){if(!s.current)return!0;var t=e.which,n=s.current.$[0],r=s.current.links;switch(s.current.cleanActive(),t){case 40:m();break;case 38:y();break;case 27:return l.escapeHandler.call(s.current,e);case 13:return!(n.focused>=0)||(l.selectionHandler?l.selectionHandler.call(s.current,e,(0,a.default)(r[n.focused])):"a"!=(0,a.default)(r[n.focused]).attr("nodeName")?(0,a.default)("a",r[n.focused]).trigger("focus"):(0,a.default)(r[n.focused]).trigger("focus"));default:return r.length&&(0,a.default)(r[n.focused]).addClass(l.activeClass),!0}return e.stopPropagation(),e.preventDefault(),!1},C=function(e){e&&e.which&&3==e.which||e&&e.button&&2==e.button||s.current&&s.current.hide("click")},k=function(e){return function(){s.current&&(s.current.cleanFocus(),this.originalClass=this.className,(0,a.default)(this).addClass(l.activeClass),s.current.$[0].focused=e)}},x=function(e){if(e.button||e.metaKey||e.ctrlKey||e.shiftKey)return!0;s.current&&l.selectionHandler&&l.selectionHandler.call(s.current,e,(0,a.default)(this))};return n.each(function(){var e=this,t=(0,a.default)(this),n={},i={reset:function(){(n=a.default.extend(n,{$:t,links:(0,a.default)(l.item||"li:has(a)",e),cleanActive:function(){e.focused+1&&n.links.length&&(0,a.default)(n.links[e.focused]).removeClass(l.activeClass)},cleanFocus:function(){n.cleanActive(),e.focused=-1},moveDown:m,moveUp:y,moveFocus:b,getFocusIndex:function(){return"number"==typeof e.focused?e.focused:-1}})).links.each(function(e){var t=(0,a.default)(this);(function(e){var t=!1;return e.data("events")&&a.default.each(e.data("events"),function(e,n){a.default.each(n,function(e,n){if(x===n)return t=!0,!1})}),t})(t)||(t.hover(k(e),n.cleanFocus),t.click(x))})},appear:function(e){e?(t.removeClass("hidden"),t.addClass("aui-dropdown-"+l.alignment)):t.addClass("hidden")},fade:function(e){e?t.fadeIn("fast"):t.fadeOut("fast")},scroll:function(e){e?t.slideDown("fast"):t.slideUp("fast")}};n.reset=i.reset,n.reset(),n.addControlProcess=function(e,t){a.default.aop.around({target:this,method:e},t)},n.addCallback=function(e,t){return a.default.aop.after({target:this,method:e},t)},n.show=function(t){l.useDisabled&&this.$.closest(".aui-dd-parent").hasClass("disabled")||(this.alignment=l.alignment,C(),s.current=this,this.method=t||this.method||"appear",this.timer=setTimeout(function(){o.click(C)},0),o.keydown(b),l.firstSelected&&this.links[0]&&k(0).call(this.links[0]),(0,a.default)(e.offsetParent).css({zIndex:2e3}),i[this.method](!0),(0,a.default)(document).trigger("showLayer",["dropdown",s.current]))},n.hide=function(e){return this.method=this.method||"appear",(0,a.default)(t.get(0).offsetParent).css({zIndex:""}),this.cleanFocus(),i[this.method](!1),o.unbind("click",C).unbind("keydown",b),(0,a.default)(document).trigger("hideLayer",["dropdown",s.current]),s.current=null,e},n.addCallback("reset",function(){l.firstSelected&&this.links[0]&&k(0).call(this.links[0])}),s.iframes||(s.iframes=[]),s.createShims=function e(){return(0,a.default)("iframe").each(function(e){this.shim||(this.shim=(0,a.default)("<div />").addClass("shim hidden").appendTo("body"),s.iframes.push(this))}),e}(),n.addCallback("show",function(){(0,a.default)(s.iframes).each(function(){var e=(0,a.default)(this);if(e.is(":visible")){var t=e.offset();t.height=e.height(),t.width=e.width(),this.shim.css({left:t.left+"px",top:t.top+"px",height:t.height+"px",width:t.width+"px"}).removeClass("hidden")}})}),n.addCallback("hide",function(){(0,a.default)(s.iframes).each(function(){this.shim.addClass("hidden")}),l.hideHandler()}),r.push(n)}),r}s.getAdditionalPropertyValue=function(e,t){var n=e[0];n&&"string"==typeof n.tagName&&"li"===n.tagName.toLowerCase()||i.log("dropDown.getAdditionalPropertyValue : item passed in should be an LI element wrapped by jQuery");var r=a.default.data(n,"properties");return r?r[t]:null},s.removeAllAdditionalProperties=function(e){},s.Standard=function(e){var t=[],n={selector:".aui-dd-parent",dropDown:".aui-dropdown",trigger:".aui-dd-trigger"};a.default.extend(n,e);var r=function(e,t,r,i){a.default.extend(i,{trigger:e}),t.addClass("dd-allocated"),r.addClass("hidden"),0==n.isHiddenByDefault&&i.show(),i.addCallback("show",function(){t.addClass("active")}),i.addCallback("hide",function(){t.removeClass("active")})},i=function(e,t,n,a){a!=s.current&&(n.css({top:t.outerHeight()}),a.show(),e.stopImmediatePropagation()),e.preventDefault()};if(n.useLiveEvents){var u=[],o=[];(0,a.default)(n.trigger).live("click",function(e){var t,l,d,c,f=(0,a.default)(this);if((c=a.default.inArray(this,u))>=0){var h=o[c];t=h.parent,l=h.dropdown,d=h.ddcontrol}else{if(0===(l=(t=f.closest(n.selector)).find(n.dropDown)).length)return;if(!(d=s(l,n)[0]))return;u.push(this),h={parent:t,dropdown:l,ddcontrol:d},r(f,t,l,d),o.push(h)}i(e,f,l,d)})}else(this instanceof a.default?this:(0,a.default)(n.selector)).not(".dd-allocated").filter(":has("+n.dropDown+")").filter(":has("+n.trigger+")").each(function(){var e=(0,a.default)(this),u=(0,a.default)(n.dropDown,this),o=(0,a.default)(n.trigger,this),l=s(u,n)[0];a.default.extend(l,{trigger:o}),r(o,e,u,l),o.on("click",function(e){i(e,o,u,l)}),t.push(l)});return t},s.Ajax=function(e){var t,n={cache:!0};return a.default.extend(n,e||{}),t=s.Standard.call(this,n),(0,a.default)(t).each(function(){var e=this;a.default.extend(e,{getAjaxOptions:function(t){var r=function(t){n.formatResults&&(t=n.formatResults(t)),n.cache&&e.cache.set(e.getAjaxOptions(),t),e.refreshSuccess(t)};return n.ajaxOptions?a.default.isFunction(n.ajaxOptions)?a.default.extend(n.ajaxOptions.call(e),{success:r}):a.default.extend(n.ajaxOptions,{success:r}):a.default.extend(t,{success:r})},refreshSuccess:function(e){this.$.html(e)},cache:function(){var e={};return{get:function(t){var n=t.data||"";return e[(t.url+n).replace(/[\?\&]/gi,"")]},set:function(t,n){var a=t.data||"";e[(t.url+a).replace(/[\?\&]/gi,"")]=n},reset:function(){e={}}}}(),show:function(t){return function(){n.cache&&e.cache.get(e.getAjaxOptions())?(e.refreshSuccess(e.cache.get(e.getAjaxOptions())),t.call(e)):((0,a.default)(a.default.ajax(e.getAjaxOptions())).throbber({target:e.$,end:function(){e.reset()}}),t.call(e),e.iframeShim&&e.iframeShim.hide())}}(e.show),resetCache:function(){e.cache.reset()}}),e.addCallback("refreshSuccess",function(){e.reset()})}),t},a.default.fn.dropDown=function(e,t){return s[e=(e||"Standard").replace(/^([a-z])/,function(e){return e.toUpperCase()})].call(this,t)},a.default.fn.dropDown=r.construct(a.default.fn.dropDown,"Dropdown constructor",{alternativeName:"Dropdown2"}),(0,u.default)("dropDown",s),t.default=s,e.exports=t.default},F4aK:function(e,t,n){},WCtk:function(e,t){!function(){var e=!0,t=function(){for(var e=Object.prototype.toString,t={},n={1:"element",3:"textnode",9:"document",11:"fragment"},a="Arguments Array Boolean Date Document Element Error Fragment Function NodeList Null Number Object RegExp String TextNode Undefined Window".split(" "),r=a.length;r--;){var i=a[r],u=window[i];if(u)try{t[e.call(new u)]=i.toLowerCase()}catch(e){}}return function(a){return null==a&&(void 0===a?"undefined":"null")||a.nodeType&&n[a.nodeType]||"number"==typeof a.length&&((a.callee?"arguments":a.alert&&"window")||a.item&&"nodelist")||t[e.call(a)]}}(),n=function(e){return"function"==t(e)},a=function(e,t,n){var a,r=e[t];return 1==n.type||2==n.type||3==n.type?a=function(){var e,a=null;try{e=r.apply(this,arguments)}catch(e){a=e}if(1==n.type){if(null!=a)throw a;e=n.value.apply(this,[e,t])}else 2==n.type&&null!=a?e=n.value.apply(this,[a,t]):3==n.type&&(e=n.value.apply(this,[e,a,t]));return e}:4==n.type?a=function(){return n.value.apply(this,[arguments,t]),r.apply(this,arguments)}:6==n.type?a=function(){return n.value.apply(this,arguments)}:5==n.type&&(a=function(){var e={object:this,args:Array.prototype.slice.call(arguments)};return n.value.apply(e.object,[{arguments:e.args,method:t,proceed:function(){return r.apply(e.object,e.args)}}])}),a.unweave=function(){e[t]=r,pointcut=e=a=r=null},e[t]=a,a},r=function(e,t,a){var r=[];for(var i in e){var u=null;try{u=e[i]}catch(e){}null!=u&&i.match(t.method)&&n(u)&&(r[r.length]={source:e,method:i,advice:a})}return r},i=function(t,n){var i=void 0!==t.target.prototype?t.target.prototype:t.target,u=[];if(6!=n.type&&void 0===i[t.method]){var o=r(t.target,t,n);for(var l in 0==o.length&&(o=r(i,t,n)),o)u[u.length]=a(o[l].source,o[l].method,o[l].advice)}else u[0]=a(i,t.method,n);return e?u:u[0]};jQuery.aop={after:function(e,t){return i(e,{type:1,value:t})},afterThrow:function(e,t){return i(e,{type:2,value:t})},afterFinally:function(e,t){return i(e,{type:3,value:t})},before:function(e,t){return i(e,{type:4,value:t})},around:function(e,t){return i(e,{type:5,value:t})},introduction:function(e,t){return i(e,{type:6,value:t})},setup:function(t){e=t.regexMatch}}}()},bjPS:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("8dXc");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}),n("F4aK")}},[["bjPS","runtime","aui.splitchunk.172ffb6da7","aui.splitchunk.a16cabd587","aui.splitchunk.fbd1a5ab27","aui.splitchunk.54d3f16c20","aui.splitchunk.1659111a3c","aui.splitchunk.89403fec76"]]]);
//# sourceMappingURL=aui.chunk.1c0814e154a221e3cfc9--3fb9d1bcf4f55afbadd0.js.map;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.core', location = 'aui.chunk.39a994133657732e6e5a--a3ddf42712d200fc7ff3.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.core"],[],[["7KGX","runtime","aui.splitchunk.172ffb6da7","aui.splitchunk.a16cabd587","aui.splitchunk.fbd1a5ab27","aui.splitchunk.1659111a3c","aui.splitchunk.792781e698","aui.splitchunk.8771ceac91","aui.splitchunk.e7c127e2cc","aui.splitchunk.7873ba9060","aui.splitchunk.0fc208f3fe","aui.splitchunk.2a34183e72"]]]);
//# sourceMappingURL=aui.chunk.39a994133657732e6e5a--a3ddf42712d200fc7ff3.js.map;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/non-amd/rest-service.js' */
// NOTE: this is used outside of Applinks. See atlassian-plugin.xml for more details about the associated restrictions

(function(AppLinksI18n, ApplinksDocs, ApplinksEvents) {
    var $ = AJS.$;

    /**
     * The triggering of AppLinks initialisation can be customised by setting a function on
     * AJS.AppLinksInitialisationBinder. The binder function should take a single argument which is a zero-arg function to
     * run and should execute this function when appropriate.
     */
    AppLinks = $.extend(window.AppLinks || {}, {
        Event: {
            NAMESPACE: 'applinks'
        },
        I18n: AppLinksI18n,
        Docs: ApplinksDocs
    });
    AppLinks.Event = $.extend(window.AppLinks.Event, ApplinksEvents);

    // Is there an overridden initialisation binder?
    if (AJS.AppLinksInitialisationBinder) {
        AppLinks.initialisationBinder = AJS.AppLinksInitialisationBinder;
    } else {
        // The default bind if no specific binder is specified
        AppLinks.initialisationBinder = function(f) {
            AJS.toInit(f);
        }
    }

    function parseJsonResponse(xhr) {
        var respJSON = xhr.responseText;
        var respObj;
        try {
            respObj = JSON.parse(respJSON);
        } catch (e) {
            console && console.error && console.error('invalid JSON response', respJSON, xhr);
        }
        return respObj || {};
    }

    var restUrlVersionMatch = new RegExp('rest/applinks(?:.*?)/(\\d\\.\\d|\\d)/');
    /**
     * Determine the REST endpoint version of a given URL.
     * @param url
     */
    function versionOf(url) {
        var results = restUrlVersionMatch.exec(url);
        return results && results.length === 2 ? results[1] : false;
    }

    AppLinks.initialisationBinder(function() {
        AppLinks = $.extend(window.AppLinks || {}, {
            failure: function(data) {
                if (data.status == 401) {
                    window.location.reload();
                } else {
                    var message = AppLinks.parseError(data);
                    var errorDivs = $('.page-error');

                    if (errorDivs.length > 0) {
                        errorDivs.html(message).fadeIn('slow');
                    } else {
                        alert('REST request failed: ' + message);
                    }
                }
            },
            jsonRequest: function(url, type, data, success, error) {
                if (data) {
                    data = JSON.stringify(data);
                }
                $(".page-error").fadeOut('fast');
                if (!error) error = AppLinks.failure;
                return jQuery.ajax({
                    url: url,
                    type: type,
                    data: data,
                    dataType: 'json',
                    contentType: "application/json; charset=utf-8",
                    cache: false,
                    success: success,
                    error: error,
                    jsonp: false
                });
            },
            xmlRequest: function(url, type, data, success, error) {
                if (data) {
                    data = JSON.stringify(data);
                }
                $(".page-error").fadeOut('fast');
                if (!error) error = AppLinks.failure;
                return jQuery.ajax({
                    url: url,
                    type: type,
                    data: data,
                    dataType: 'xml',
                    contentType: "application/xml; charset=utf-8",
                    cache: false,
                    success: success,
                    error: error
                });
            },
            parseError: function(errorData) {
                var error = parseJsonResponse(errorData);
                var message = error && error.message;
                if (message) {
                    return $.isArray(message) ? message.join(' ') : message;
                }
                if (errorData) {
                    return errorData.statusText ? errorData.statusText : errorData;
                }
                return 'An unknown error occurred. Check the console logs for details.';
            },
            put: function(url, data, success, error) {
                return AppLinks.jsonRequest(url, 'PUT', data, success, error);
            },
            post: function(url, data, success, error) {
                return AppLinks.jsonRequest(url, 'POST', data, success, error);
            },
            update: function(data, success, error) {
                var selfLink = AppLinks.self_link(data);
                /**
                 * Adapt to the version of the endpoint and the HTTP verb it uses.
                 * yes, this is not "REST-ful". The verb is wrong. It has been wrong since 2014.
                 * It is simpler to adapt than it is to release a new endpoint.
                 */
                var restMethod = versionOf(selfLink) === '1.0' ? AppLinks.put : AppLinks.post;
                restMethod(selfLink, data, success, error);
            },
            get: function(url, success, error) {
                return AppLinks.jsonRequest(url, 'GET', null, success, error);
            },
            getXml: function(url, success, error) {
                return AppLinks.xmlRequest(url, 'GET', null, success, error);
            },
            self_link: function(item) {
                for (var i = 0, _i = item.link.length; i < _i; i++) {
                    var link = item.link[i];
                    if (link.rel == "self") return link.href;
                }

                throw "No self-link found";
            },
            del: function(urlOrObject, success, error) {
                var url;
                if (typeof(urlOrObject) == 'string') url = urlOrObject;
                else url = AppLinks.self_link(urlOrObject);
                return AppLinks.jsonRequest(url, 'DELETE', null, success, error);
            },
            SPI: $.extend({}, {
                API_VERSION: "1.0",
                REST_RESOURCE_URL: AJS.contextPath() + "/rest/applinks/",
                BASE_URL: AJS.contextPath() + "/rest/applinks/1.0",
                OAUTH_REST_RESOURCE_URL: AJS.contextPath() + "/rest/applinks-oauth/",
                OAUTH_BASE_URL: AJS.contextPath() + "/rest/applinks-oauth/1.0",

                /**
                 * Update the API version and associated urls.
                 * @param version
                 */
                setApiVersion: function(version){
                    AppLinks.SPI.API_VERSION = version;
                    AppLinks.SPI.setBaseUrl(AppLinks.SPI.REST_RESOURCE_URL + AppLinks.SPI.API_VERSION);
                },
                setBaseUrl: function(url){
                    AppLinks.SPI.BASE_URL = url;
                },
                setOAuthBaseUrl: function(url){
                    AppLinks.SPI.OAUTH_BASE_URL = url;
                },
                /**
                 * Build a base URL for rest calls using the specified baseUrl.
                 * @param baseUrl
                 * @returns {string}
                 */
                getRemoteRestBaseUrl: function(baseUrl) {
                    return baseUrl + "/rest/applinks/" + AppLinks.SPI.API_VERSION;
                },
                /**
                 * Build a base URL for plugin servlet calls using the specified baseUrl.
                 * @param baseUrl
                 * @returns {string}
                 */
                getRemotePluginServletBaseUrl: function(baseUrl) {
                    return baseUrl + "/plugins/servlet";
                },
                getAllLinks: function(success, failure) {
                    var url = AppLinks.SPI.BASE_URL + "/applicationlink";
                    return AppLinks.get(url, success, failure);
                },
                getAllLinksWithAuthInfo: function(success, failure) {
                    var url = AppLinks.SPI.BASE_URL + "/listApplicationlinks";
                    return AppLinks.get(url, success, failure);
                },
                getApplicationLinkState: function(id, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + "/listApplicationlinkstates/id/" + id;
                    return AppLinks.get(url, success, failure);
                },
                getLinksOfType: function(typeId, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + "/applicationlink/type/" + typeId;
                    return AppLinks.get(url, success, failure);
                },
                tryToFetchManifest: function(url, success, failure) {
                    var restUrl = AppLinks.SPI.BASE_URL + '/applicationlinkForm/manifest.json?url=' + encodeURIComponent(url);
                    return AppLinks.get(restUrl, success, failure);
                },
                getManifestFor: function(id, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/manifest/' + id + ".json";
                    return AppLinks.get(url, success, failure);
                },
                getLocalManifest: function(success, failure){
                    var url = AppLinks.SPI.BASE_URL + '/manifest.json';
                    return AppLinks.get(url, success, failure);
                },
                /**
                 * Attempt to get the Manifest of the remote application, via a direct REST call.
                 * Requires CORS enabled on the REST resource.
                 * @param url
                 * @param success
                 * @param failure
                 * @returns {*}
                 */
                getRemoteManifest: function(remoteBaseUrl, success, failure){
                    var remoteManifestUrl = AppLinks.SPI.getRemoteRestBaseUrl(remoteBaseUrl) + '/manifest.json';
                    return AppLinks.get(remoteManifestUrl, success, failure);
                },
                /**
                 * Attempt to get the OAuth Consumer Info of the remote application, via a direct call.
                 * Requires CORS enabled on the REST resource.
                 * @param url
                 * @param success
                 * @param failure
                 * @returns {*}
                 */
                getRemoteOAuthConsumerInfo: function(remoteBaseUrl, success, failure){
                    var remoteManifestUrl = AppLinks.SPI.getRemotePluginServletBaseUrl(remoteBaseUrl) + '/oauth/consumer-info';
                    return AppLinks.getXml(remoteManifestUrl, success, failure);
                },
                getApplinkStatus: function (applinkId, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/status/' + applinkId;
                    return AppLinks.get(url, success, failure);
                },
                createStaticUrlAppLink: function(applicationType, success, failure) {
                    var restUrl = AppLinks.SPI.BASE_URL + '/applicationlinkForm/createStaticUrlAppLink?typeId=' + applicationType;
                    return AppLinks.post(restUrl, null, success, failure);
                },
                createLink: function(applicationLink, username, password, createTwoWayLink, customRpcUrl, rpcUrl, configFormValues, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/applicationlinkForm/createAppLink';
                    var data = {
                        applicationLink: applicationLink,
                        username: username,
                        password: password,
                        createTwoWayLink: createTwoWayLink,
                        customRpcURL: customRpcUrl,
                        rpcUrl: rpcUrl,
                        configFormValues: configFormValues
                    };
                    return AppLinks.post(url, data, success, failure);
                },
                createLinkWithOrphanedTrust : function(applicationLink, username, password, createTwoWayLink, customRpcUrl, rpcUrl, configFormValues, orphanedTrust, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/applicationlinkForm/createAppLink';
                    var data = {
                        applicationLink: applicationLink,
                        username: username,
                        password: password,
                        createTwoWayLink: createTwoWayLink,
                        customRpcURL: customRpcUrl,
                        rpcUrl: rpcUrl,
                        configFormValues: configFormValues,
                        orphanedTrust: orphanedTrust
                    };
                    return AppLinks.post(url, data, success, failure);
                },
                verifyTwoWayLinkDetails : function (remoteUrl, rpcUrl, username, password, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/applicationlinkForm/details';
                    var data = {
                        username: username,
                        password: password,
                        remoteUrl: remoteUrl,
                        rpcUrl: rpcUrl
                    };
                    return AppLinks.post(url, data, success, failure);
                },
                getApplicationLinkInfo: function (appId, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/applicationlinkInfo/id/" + appId;
                    return AppLinks.get(url, success, error);
                },
                deleteLink: function(applicationLink, reciprocate, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/applicationlink/" + applicationLink.id;
                    if (reciprocate) url += "?reciprocate=true";
                    return AppLinks.del(url, success, error);
                },
                makePrimary: function(applicationLink, success) {
                    var url = AppLinks.SPI.BASE_URL + "/applicationlink/primary/" + applicationLink.id;
                    return AppLinks.post(url, null, success);
                },
                relocate: function(applicationLink, newUrl, suppressWarnings, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/relocateApplicationlink/" + applicationLink.id + "?newUrl=" + encodeURIComponent(newUrl) +
                        "&nowarning=" + (suppressWarnings ? "true" : "false");
                    return AppLinks.post(url, null, success, error);
                },
                legacyUpgrade: function(applicationLink, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/upgrade/legacy/" + applicationLink.id;
                    return AppLinks.post(url, null, success, error);
                },
                ualUpgrade: function(applicationLink, body, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/upgrade/ual/" + applicationLink.id;
                    return AppLinks.post(url, body, success, error);
                },
                getEntityTypesForApplicationType: function(applicationType, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/type/entity/" + applicationType;
                    return AppLinks.get(url, success, error);
                },
                getLocalEntitiesWithLinksToApplication: function(applicationLinkId, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entitylink/localEntitiesWithLinksTo/" + applicationLinkId + ".json";
                    return AppLinks.get(url, success, error);
                },
                getEntityLinksForApplication: function(applicationLinkId, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entities/" + applicationLinkId + ".json";
                    AppLinks.get(url, success, error);
                },
                getEntityLinksForApplicationUsingAnonymousAccess: function(applicationLinkId, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entities/anonymous/" + applicationLinkId + ".json";
                    return AppLinks.get(url, success, error);
                },
                createNonUalEntityLink: function(localType, localKey, applicationId, remoteTypeId, remoteKey, name, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entitylink/" + localType + "/" + localKey + "?reciprocate=false";
                    var data = {
                        applicationId: applicationId,
                        typeId: remoteTypeId,
                        key: remoteKey,
                        name: name,
                        isPrimary: false
                    };
                    return AppLinks.put(url, data, success, error);
                },
                createEntityLink: function(localType, localKey, entity, reciprocate, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + "/entitylink/" + localType + "/" + localKey + "?reciprocate=";
                    url += (reciprocate ? "true" : "false");
                    return AppLinks.put(url, entity, success, failure);
                },
                getConfiguredEntityLinks: function(localType, localKey, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entitylink/primaryLinks/" + localType + "/" + localKey + ".json";
                    return AppLinks.get(url, success, error);
                },
                deleteEntityLink: function(localTypeId, localKey, entity, reciprocate, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entitylink/" + localTypeId + "/" + localKey + "?typeId=" + entity.typeId + "&key=" + entity.key + "&applicationId=" + entity.applicationId + "&reciprocate=" + reciprocate;
                    return AppLinks.del(url, success, error);
                },
                makePrimaryEntityLink: function(localTypeID, localKey, entity, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entitylink/primary/" + localTypeID + "/" + localKey + "?typeId=" + entity.typeId + "&key=" + entity.key + "&applicationId=" + entity.applicationId;
                    return AppLinks.post(url, null, success, error);
                },
                canDeleteAppLink: function(applicationId, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/permission/reciprocate-application-delete/" + applicationId;
                    return AppLinks.get(url, success, error);
                },
                canDeleteEntityLink: function(localTypeId, localKey, entity, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/permission/reciprocate-entity-delete/" + entity.applicationId + "/" + localTypeId + "/" + localKey + "/" + entity.typeId + "/" + entity.key;
                    return AppLinks.get(url, success, error);
                },
                canCreateReciprocateEntityLink: function(applicationId, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/permission/reciprocate-entity-create/" + applicationId;
                    return AppLinks.get(url, success, error);
                },
                processPermissionCode: function(settings) {
                    var config = {
                        noPermission: function() {},
                        missing: function() {},
                        credentialsRequired: function(authUrl) {},
                        authenticationFailed: function(authUrl) {},
                        noAuthentication: function(authUrl) {},
                        noAuthenticationConfigured: function() {},
                        noConnection: function() {},
                        allowed: function() {},
                        unrecognisedCode: function(code) {},
                        updateView: function(message, icon, button) {}
                    };

                    if (!settings) settings = {};

                    settings = $.extend(config, settings);

                    return function(data) {
                        var code = data.code;
                        if (code == "NO_PERMISSION") {
                            settings.noPermission();
                        } else if (code == "MISSING") {
                            settings.missing();
                        } else if (code == "CREDENTIALS_REQUIRED") {
                            settings.credentialsRequired(data.url);
                        } else if (code == "AUTHENTICATION_FAILED") {
                            settings.authenticationFailed(data.url);
                        } else if (code == "NO_AUTHENTICATION") {
                            settings.noAuthentication(data.url);
                        } else if (code == "NO_AUTHENTICATION_CONFIGURED") {
                            settings.noAuthenticationConfigured();
                        } else if (code == "NO_CONNECTION") {
                            settings.noConnection();
                        } else if (code == "ALLOWED") {
                            settings.allowed();
                        } else {
                            settings.unrecognisedCode(data.code);
                        }
                    };
                },
                addAuthenticationTrigger: function(target, authUrl, callbacks) {
                    if (!callbacks) {
                        callbacks = {};
                    }

                    if (typeof callbacks.onSuccess == "undefined") {
                        callbacks.onSuccess = function() {
                            location.reload();
                        }
                    }

                    if (typeof callbacks.onFailure == "undefined") {
                        callbacks.onFailure = function() {
                            return true;
                        }
                    }
                    //Unbind previous click listener, otherwise we might end up opening multiple windows.
                    $(target).off('click.applinks');
                    $(target).on('click.applinks', function() {
                        if (callbacks.before) {
                            callbacks.before();
                        }
                        AppLinks.authenticateRemoteCredentials(authUrl, callbacks.onSuccess, callbacks.onFailure);
                    });
                },
                deleteOrphanedTrust: function(id, type, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/orphaned-trust/" + type + "/" + id;
                    return AppLinks.del(url, success, error);
                },
                getOrphanedTrust: function(success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/orphaned-trust/";
                    return AppLinks.get(url, success, error);
                },
                showCreateEntityLinkSuggestion: function() {
                    return true;
                },
                getApplicationLink: function(id, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/applicationlink/' + id;
                    return AppLinks.get(url, success, failure);
                },
                createApplicationLink: function(id, name, rpcUrl, displayUrl, typeId, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/applicationlink';
                    var data = {
                        id: id,
                        name: name,
                        rpcUrl: rpcUrl,
                        displayUrl: displayUrl,
                        typeId: typeId
                    };
                    return AppLinks.put(url, data, success, failure);
                },
// TODO APLDEV-3 extract OAuth creation code into OAuth specific js files in the Oauth plugin.
                createConsumer: function(id, key, name, description, sharedSecret, publicKey, twoLOAllowed, executingTwoLOUser, twoLOImpersonationAllowed, outgoing, success, failure) {
                    var url = AppLinks.SPI.OAUTH_BASE_URL + '/applicationlink/' + id + '/authentication/consumer';
                    var data = {
                        key: key,
                        name: name,
                        description: description,
                        sharedSecret: sharedSecret,
                        publicKey: publicKey,
                        outgoing: outgoing,
                        twoLOAllowed: twoLOAllowed,
                        executingTwoLOUser: executingTwoLOUser,
                        twoLOImpersonationAllowed: twoLOImpersonationAllowed
                    };
                    return AppLinks.put(url, data, success, failure);
                },
                createConsumerAutoConfigure: function(id, twoLOAllowed, executingTwoLOUser, twoLOImpersonationAllowed, success, failure) {
                    var url = AppLinks.SPI.OAUTH_BASE_URL + '/applicationlink/' + id + '/authentication/consumer?autoConfigure=true';
                    var data = {
                        twoLOAllowed: twoLOAllowed,
                        executingTwoLOUser: executingTwoLOUser,
                        twoLOImpersonationAllowed: twoLOImpersonationAllowed
                    };
                    return AppLinks.put(url, data, success, failure);
                },
                registerProvider: function(id, provider, config, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/applicationlink/' + id + '/authentication/provider';
                    var data = {
                        config : config,
                        provider : provider
                    };
                    return AppLinks.put(url, data, success, failure);
                },
                enableFeature: function(featureName, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/features/' + featureName;
                    return AppLinks.put(url, {}, success, failure);
                },
                disableFeature: function(featureName, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/features/' + featureName;
                    return AppLinks.del(url, success, failure);
                }
            }, (window.AppLinks && window.AppLinks.SPI) || {})
        });

        AppLinks.UI = {
            showInfoBox: function(message) {
                $('.aui-message.aui-message-success').remove();
                AppLinks.UI.createMessage('success', message, 'page-info');
            },
            hideInfoBox: function() {
                $('.aui-message.aui-message-success').remove();
            },
            showErrorBox: function(message) {
                AppLinks.UI.createMessage('error', message, 'page-error');
            },
            hideErrorBox: function() {
                $('.aui-message.aui-message-error').remove();
            },
            showWarningBox: function(messages) {
                if ($.isArray(messages) && messages.length > 0) {
                    var ulEl = $("<ul></ul>");
                    $(messages).each(function(index) {
                        ulEl.append($("<li/>", {
                            text: messages[index]
                        }));
                    });
                    var messageEl = $('<div class="page-warning"></div>').append(ulEl);
                    AppLinks.UI.createMessage('warning', messageEl.html(), 'page-warning');
                } else {
                    AppLinks.UI.createMessage('warning', messages, 'page-warning');
                }
            },
            hideWarningBox: function() {
                $('.aui-message.aui-message-warning').remove();
            },
            shortenString: function(message, maxLength) {
                if (message.length  > maxLength) {
                    message = message.substring(0, maxLength) + "...";
                }
                return message;
            },
            createMessage: function(type, message, cssClass) {
                var messageEl = $('<div class="' + cssClass + '">');
                messageEl.html(message);
                AJS.messages[type](".applinks-message-bar", {
                    title: "",
                    body: messageEl.wrap('<div></div>').parent().html(),
                    closeable: true
                });
                $(document).trigger(AppLinks.Event.Legacy.MESSAGE_BOX_DISPLAYED);
            },
            displayValidationErrorMessages: function (errorClass, rootEl, messages) {
                if ($.isArray(messages)) {
                    $(messages).each(function(i,v) {
                        var d = $('<div class="error applinks-error">');
                        d.text(v);
                        $(rootEl).find("." + errorClass).append(d);
                    });
                } else if(typeof messages != 'undefined'){
                    var d = $('<div class="error applinks-error">');
                    d.text(messages.toString());
                    $(rootEl).find("." + errorClass).append(d);
                }
            },
            displayValidationError: function(errorClass, rootEl, errorFn) {
                return function(xhr) {
                    if (xhr.status == 401) {
                        window.location.reload();
                        return;
                    }
                    $('.applinks-error').remove();
                    $('.loading').remove();

                    var respObj = parseJsonResponse(xhr);
                    var messages = respObj.message;

                    if (typeof respObj.fields == "undefined") {
                        AppLinks.UI.displayValidationErrorMessages(errorClass, rootEl, messages);
                    } else {
                        var fields = respObj.fields;
                        $(fields).each(function(index) {
                            var d = $('<div class="error applinks-error" id="' + fields[index] + '-error">');
                            d.text(messages[index]);
                            if ($(rootEl).find('.' + fields[index]).length > 0) {
                                d.insertAfter($(rootEl).find('.' + fields[index]));
                            } else {
                                d.insertAfter($(rootEl).find('.' + errorClass).append(d));
                            }
                        });
                    }
                    $(rootEl).find('.' + errorClass).addClass("fully-populated-errors");
                    if (errorFn) {
                        errorFn();
                    }
                }
            },
            addProtocolToURL : function(url) {
                var newUrl = $.trim(url);
                var tempURL = newUrl.toLowerCase();
                var hasProtocol = false;
                if (tempURL.length >= 7) {
                    if (tempURL.substring(0,7).indexOf('http') != -1) {
                        hasProtocol = true;
                    }
                }
                //default protocol is http
                if (!hasProtocol) {
                    newUrl = 'http://' + newUrl;
                }
                return newUrl;
            },
            /**
             * Similar to the standard Javascript join() method, but nicer in that
             * it uses a different delimiter for the last node (by default "and"),
             * so that:
             * {code}
             * "1, 2 and 3" == prettyJoin(['1', '2', '3'], function(value) {return value;});
             * {code}
             *
             * @param inputArray
             * @param resolveFn
             * @param finalDelimiter
             */
            prettyJoin : function(inputArray, resolveFn, finalDelimiter) {
                if (!finalDelimiter) {
                    finalDelimiter = "and";
                }
                var maxLength = inputArray.length;
                var message = "";
                $.each(inputArray, function(index, value) {
                    if (index == (maxLength - 1) && maxLength > 1) {
                        message += " " + finalDelimiter + "  " + resolveFn(value);
                    } else {
                        message += resolveFn(value);
                        if (index + 2 < maxLength) {
                            message += ", ";
                        }
                    }
                });
                return message;
            },
            showLoadingIcon: function(element) {
                $('<span class="loading">&nbsp;</span>').insertAfter(element);
            },
            hideLoadingIcon: function(element) {
                $(element).next('.loading').remove();
            },
            findUrl: function(text) {
                var url = undefined;
                var lcText = text.toLowerCase();
                var startOfUrl = lcText.indexOf('http:');
                if (startOfUrl == -1) {
                    startOfUrl = lcText.indexOf('https:');
                }
                if (startOfUrl > -1) {
                    var endOfUrl = lcText.indexOf(' ', startOfUrl);
                    if (endOfUrl == -1) {
                        endOfUrl = lcText.length;
                    }
                    url = text.substring(startOfUrl, endOfUrl); // use _case-sensitive_ version to retrieve the actual URL
                }
                return url;
            },
            findApplicationType : function(id) {
                id = id.toLowerCase();
                if (id.indexOf("jira") != -1) {
                    return "jira";
                } else if (id.indexOf("fisheye") != -1) {
                    return "fecru";
                } else if (id.indexOf("confluence") != -1) {
                    return "confluence";
                } else if (id.indexOf("refapp") != -1) {
                    return "refapp";
                } else {
                    return undefined;
                }
            },
            escapeSelector: function(selector) {
                // based on http://samuelsjoberg.com/archive/2009/09/escape-jquery-selectors
                return selector.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g, "\\$1");
            },
            sanitiseHTML: function(input) {
                var replacements = {
                    "<": "&lt;",
                    '"': "&quot;",
                    "&": "&amp;"
                };
                return input.replace(/[<"&]/g, function(match) {
                    return replacements[match];
                });
            },
            refreshOrphanedTrust: function() {
                // post dialog -- check whether we need to remove any orphaned-trust entries
                var updateOrphanedTrust = function(data) {
                    $("tr.orphaned-trust-row").each(function() {
                        var $this = $(this);
                        var id = $this.attr("data-id");
                        var type = $this.attr("data-type");
                        var stillExists = false;
                        for (var i = 0; i < data.orphanedTrust.length; i++) {
                            var ot = data.orphanedTrust[i];
                            if (id == ot.id && type == ot.type) {
                                stillExists = true;
                                break;
                            }
                        }
                        if (!stillExists) {
                            $this.remove();
                            if (data.orphanedTrust.length == 0) {
                                // we just removed the last orphaned trust cert, hide warning!
                                $(".orphaned-trust-warning").hide();
                            }
                        }
                    });
                };

                AppLinks.SPI.getOrphanedTrust(updateOrphanedTrust);
            },
            removeCssClass: function(element, prefix) {
                $(element).removeClass( function(index, className) {
                    var classes = className.split(' ');
                    var classToRemove = "";
                    $.each(classes, function(index, value) {
                        if (value.indexOf(prefix) != -1) {
                            classToRemove = value;
                        }
                    });
                    return classToRemove;
                } );
            }
        };

        /**
         * Add jQuery event system to AppLinks.UI namespace.
         */
        (function(){
            var eventBus = $({});
            $.each(['bind', 'unbind', 'trigger'], function(i, current){
                AppLinks.UI[current] = function(){
                    return eventBus[current].apply(eventBus, arguments);
                }
            });
        })();

        $(document).trigger(AppLinks.Event.PREREADY);
        $(document).trigger(AppLinks.Event.READY);
    });
})(require('applinks/common/i18n'), require('applinks/common/docs'), require('applinks/common/events'));
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/non-amd/autocomplete.js' */
// NOTE: this is used outside of Applinks. See atlassian-plugin.xml for more details about the associated restrictions

AJS.$(document).bind(AppLinks.Event.READY, function() {
/**
 * TODO: THIS CODE IS COPIED FROM CONFLUENCE and should be part of AUI/AJS.
 * IF AUI comes with the InputDrivenDropDown when can remove this file.
 * https://studio.atlassian.com/browse/AJS-471
 *
 * A simple cache manager that supports a
 * FIFO cache invalidation strategy.
 *
 * @class cacheManager
 * @namespace AJS.Confluence
 * @constructor
 * @param cacheSize the size of the cache before keys are invalidated
 */
AppLinks.autoComplete = {
        cacheManager : function (cacheSize) {
    var cache = {},
        cacheStack = [],
        cacheSize = cacheSize || 30;

    return {
        /**
         * Return the value stored in the cache for the given key
         * @method get
         * @param key {String}
         */
        get: function(key) {
            return cache[key];
        },
        /**
         * Put the given key, value in the cache
         * @method put
         * @param key {String}
         * @param value {Object}
         */
        put: function(key, value) {
            cache[key] = value;
            cacheStack.push(key);
            if (cacheStack.length > cacheSize) {
                delete cache[cacheStack.shift()];
            }
        },
        /**
         * Clear the cache.
         */
        clear : function() {
            cache = {};
            cacheStack = [];
        }
    };
}};


(function($){
    /**
     * Check that all items in the drop down can be displayed - show ellipses at the end of any that
     * are too long. Also remove any unused properties that the dropDown may have stored for each
     * item in the list.
     *
     * @method truncateText
     * @private
     */
    var truncateText = function (dd) {
        AJS.log("InputDrivenDropDown: truncating text");
        var width = dd.$.closest(".aui-dropdown").width(),
            rightPadding = 20; // add some padding so the ellipsis doesn't run over the edge of the box

        $("a span:not(.icon)", dd.$).each(function () {
            var $a = $(this),
                elpss = $("<var></var>").html("&#8230;"),
                elwidth = elpss.width(),
                isLong = false;

            $a.wrapInner($("<em>"));
            $("em", $a).each(function () {
                var $label = $(this);

                $label.show();
                if (this.offsetLeft + this.offsetWidth > width) {
                    var childNodes = this.childNodes,
                        success = false;

                    for (var j = childNodes.length - 1; j >= 0; j--) {
                        var childNode = childNodes[j],
                            truncatedChars = 1,
                            valueAttr = (childNode.nodeType == 3) ? "nodeValue" : "innerHTML",
                            nodeText = childNode[valueAttr];

                        do {
                            if (truncatedChars <= nodeText.length) {
                                childNode[valueAttr] = nodeText.substr(0, nodeText.length - truncatedChars++);
                            } else { // if we cannot fit even one character of the next word, then try truncating the node just previous to this
                                break;
                            }
                        } while (this.offsetLeft + this.offsetWidth + elwidth > width - rightPadding);

                        if (truncatedChars <= nodeText.length) {
                            // we've managed truncate part of the word and fit it in
                            success = true;
                            break;
                        }
                    }

                    if (success) {
                        isLong = true;
                    } else {
                        $label.hide();
                    }
                }
            });
            if (isLong) {
                $a.append(elpss);
                this.elpss = elpss;
            }
        });
    };

    var highlightTokens = function(dd, tokens) {
        if (!tokens.length || !tokens[0]) return;

        AJS.log("InputDrivenDropDown: highlighting tokens");

        // escape regex chars .*+?|()[]{}\ first
        for (var i = 0, ii = tokens.length; i < ii; i++) {
            var token = tokens[i];
            tokens[i] = token ? token.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g, "\\$") : "";
        }

        var regex = new RegExp("(" + tokens.join("|") + ")", "gi");

        $("li a:not(.dropdown-prevent-highlight) span", dd.$).each(function() {
            var span = $(this),
                html = span.html().replace(regex, "<strong>$1</strong>");
            span.html(html);
        });
    };

    /**
     * Builds and shows the dropdown.
     *
     * @param idd the InputDrivenDropdown
     * @param dropdownData in the form { matrix, query, queryTokens }
     * @private
     */
    var makeDropdown = function (idd, dropdownData) {
        var options = idd.options,
            old_dd = idd.dd;

        if (old_dd) {
            old_dd.hide();
            old_dd.$.remove();
        }

        options.ajsDropDownOptions = options.ajsDropDownOptions || {};
        if (options.ajsDropDownOptions && !options.ajsDropDownOptions.alignment) { // default to left alignment
            options.ajsDropDownOptions.alignment = "left";
        }
        //this needs to be moved into aui
        options.ajsDropDownOptions.selectionHandler = options.ajsDropDownOptions.selectionHandler || function(e, element) {
            if(e.type != "click") {
                e.preventDefault();
                $("a",element).click();
                document.location = $("a",element).attr("href");
            }
        };

        /* Fixing an AUI bug in here:  AJS.dropdown puts the raw 'matrix[i].name' as html, without escaping it !
           The solution is to override their displayHandler
         */
        /**
         * Escape obj.name and return it
         */
        options.ajsDropDownOptions.displayHandler = function (obj) {
            return AJS.escapeHtml(obj.name);
        }

        var dd = idd.dd = new AJS.dropDown(dropdownData.matrix, options.ajsDropDownOptions)[0];

        // could move into dropdown.js in AUI
        if (options.ajsDropDownOptions && options.ajsDropDownOptions.className) {
            dd.$.addClass(options.ajsDropDownOptions.className);
        }

        // place the created drop down using the configured dropdownPlacement function
        // if there is none then use a default behaviour
        if (options.dropdownPlacement) {
            options.dropdownPlacement(dd.$);
        } else {
            AJS.log("No dropdownPlacement function specified. Appending dropdown to the body.");
            $("body").append(dd.$);
        }

        highlightTokens(dd, dropdownData.queryTokens || [dropdownData.query]);
        truncateText(dd);

        if (options.dropdownPostprocess) {
            options.dropdownPostprocess(dd.$);
        }
        dd.show(idd._effect);

        if (typeof options.onShow == "function") {
            options.onShow.call(dd, dd.$);
        }

        return dd;
    };

    /**
     * Provides a controller-agnostic object that listens for controller changes and populates a dropdown
     * via a callback. Most aspects can be customized via the options object parameter.
     * <br>
     * Options are:
     * <li>
     *   getDataAndRunCallback - (required) callback method used to provide data for the dropdown. It must take
     *                          two parameters, user input value and the callback function to execute.
     * </li>
     * <li>
     *   onShow - function to call when the drop-down is displayed
     * </li>
     * <li>
     *   dropdownPlacement - a function that will be called with the drop down and which should place it in the
     *                          correct place on the page. The supplied arguments are 1) the input that issued the
     *                          search, 2) the dropDown to be placed.
     * </li>
     * <li>
     *   ajsDropDownOptions - any options the underlying dropDown component can handle expects
     * </li>
     * <li>
     *   onDeath - callback to run when dropdown dies
     * </li>
     * @class InputDrivenDropDown
     * @namespace AJS
     */
    function InputDrivenDropDown(id, options) {
        this._effect = "appear";
        this._timer = null;

        this.id = id;
        this.options = options;
        this.inactive = false;
        this.busy = false;
        this.cacheManager = AppLinks.autoComplete.cacheManager();
    }

    /**
     * Clears the cache.
     */
    InputDrivenDropDown.prototype.clearCache = function () {
        this.cacheManager.clear();
    };

    /**
     * This method should be called when the user input for this dropdown has changed.
     * It will check the cache before fetching data (via options.getDataAndRunCallback)
     * and displaying the dropdown.
     *
     * @param value {String} the new value of the user input
     * @param force {Boolean} force a change to occur regardless of user input
     */
    InputDrivenDropDown.prototype.change = function (value, force) {
        var t = this;
        if (value != t._value || force) {
            t._value = value;
            t.busy = false;

            clearTimeout(t._timer);

            if (force || (/\S{0,}/).test(value)) {
                var cachedVal = t.cacheManager.get(value);
                if (cachedVal) {
                    makeDropdown(t, cachedVal);
                } else {
                    t.busy = true;
                    t._timer = setTimeout(function () { // delay sending a request to give the user a chance to finish typing their search term(s)
                        t.options.getDataAndRunCallback.call(t, value, t.show);
                    }, 200);
                }
            } else {
                t.dd && t.dd.hide();
            }
        }
    };

    /**
     * Gets the number of visible options in the dropdown.
     */
    InputDrivenDropDown.prototype.dropDownLength = function () {
        return this.dd.links ? this.dd.links.length : 0;
    };
    
    /**
     * Gets the specified menu item from the dropdown list.
     * 
     * @param index {Integer} the 0-based index of the dropdown option list
     */
    InputDrivenDropDown.prototype.dropDownItem = function (index) {
        return this.dropDownLength() > index ? this.dd.links[index] : null;
    };
    
    /**
     * Hides the drop down
     */
    InputDrivenDropDown.prototype.hide = function () {
        this.dd && this.dd.hide();
    };

    /**
     * Hides and removes the drop down from the DOM.
     */
    InputDrivenDropDown.prototype.remove = function () {
        var dd = this.dd;
        if (dd) {
            this.hide();
            dd.$.remove();
        }
        this.inactive = true;
        this.options.onDeath && this.options.onDeath();
    };

    /**
     * Shows the drop down with the given matrix data and query.
     * <br>
     * Matrix property should be an array of arrays, where the sub-arrays represent the different
     * search categories.
     *
     * Expected properties of category sub-array objects are:
     *  - href
     *  - name
     *  - className
     *  - html (optional, replaces href and name)
     *  - icon (optional)
     *
     *
     * @param matrix {Array} matrix to populate the drop down from
     * @param query {String} the user input string that triggered this show
     * @param queryTokens {Array} an array of strings of the query tokens. Use for highlighting search terms.
     */
    InputDrivenDropDown.prototype.show = function (matrix, query, queryTokens) {
        if (this.inactive) {
            AJS.log("Quick search abandoned before server response received, ignoring. " + this);
            return;
        }

        var dropdownData = {
            matrix: matrix,
            query: query,
            queryTokens: queryTokens
        };
        this.cacheManager.put(query, dropdownData);

        makeDropdown(this, dropdownData);
        this.busy = false;
    };

    /**
     * Returns an InputDrivenDropDown. See InputDrivenDropDown for more documentation.
     * @param options {Object} options for the InputDrivenDropDown
     * @constructor
     */
    AppLinks.inputDrivenDropdown = function (options) {
        return new InputDrivenDropDown("inputdriven-dropdown", options);
    };

})(jQuery);
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/fecru-compatibility.js' */
if (jQuery != undefined && AJS != undefined) jQuery = AJS.$; // make sure we're extending the correct jQuery;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.deprecated.component.dialog1', location = 'aui.chunk.6771b621d578ec6cb6b7--1d6402a7904479d1b53e.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.deprecated.component.dialog1"],{meK1:function(u,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t=e("tDS8");Object.keys(t).forEach(function(u){"default"!==u&&"__esModule"!==u&&Object.defineProperty(i,u,{enumerable:!0,get:function(){return t[u]}})}),e("tJ25")},tJ25:function(u,i,e){}},[["meK1","runtime","aui.splitchunk.172ffb6da7","aui.splitchunk.a16cabd587","aui.splitchunk.fbd1a5ab27","aui.splitchunk.54d3f16c20","aui.splitchunk.1659111a3c","aui.splitchunk.bc4873e5f9","aui.splitchunk.8659b532c1","aui.splitchunk.d0110a864f","aui.splitchunk.8771ceac91","aui.splitchunk.6e1680ef6a"]]]);
//# sourceMappingURL=aui.chunk.6771b621d578ec6cb6b7--1d6402a7904479d1b53e.js.map;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-wizard', location = 'applinks/internal/non-amd/wizard.js' */
AJS.$(document).bind(AppLinks.Event.PREREADY, function() {

    (function($) {

        $.fn.wizard = function(settings) {
            var config = {
                width: 500,
                height: 350,
                onshow: function(popup, configuration) {
                    return true;
                },
                aftershow: function() {
                    return true;
                },
                oncancel: function() {
                    return true;
                },
                onsubmit: function() {
                    return true;
                },
                aftersubmit: function() {
                    return true;
                },
                onnext: function() {
                    return true;
                },
                onprevious: function() {
                    return true;
                },
                cancelLabel: "Cancel",
                submitLabel: "Create",
                nextLabel: "Next",
                previousLabel: "Previous",
                id: ''
            };

            if (!settings) settings = {};

            settings = $.extend(config, settings);

            var result = this;

            this.each(function() {
                var obj = $(this);
                var popup = new AJS.Dialog(settings.width, settings.height, settings.id);
                var showFn = show(popup, settings.onshow, settings.aftershow);
                var cancelFn = cancel(popup, settings.oncancel);
                var submitFn = submit(popup, settings.onsubmit, settings.aftersubmit);
                var previousFn = previous(popup, settings.onprevious)
                var nextFn = next(popup, settings.onnext);

                var disableNextFn = disableNext(popup);
                var enableNextFn  = enableNext(popup);

                var disableSubmitFn = disableSubmit(popup);
                var enableSubmitFn  = enableSubmit(popup);

                var disablePreviousFn = disablePrevious(popup);
                var enablePreviousFn  = enablePrevious(popup);

                if (settings.showButtonId) {
                    $('#' + settings.showButtonId).click(showFn);
                }

                var pages = findPages(obj);


                for (var pageIndex = 0; pageIndex < pages.length; pageIndex++) {
                    var page = pages[pageIndex];
                    createPage(popup, page);
                    if (page.className) {
                        popup.addHeader(page.title, page.className + '-header');
                    } else {
                        popup.addHeader(page.title);
                    }

                    if (pageIndex != 0 && $(page.div).attr('previous') != 'false') {
                        popup.addButton(settings.previousLabel, previousFn, 'applinks-previous-button');
                    }

                    if (pageIndex < pages.length - 1 && $(page.div).attr('submit') != 'true' && $(page.div).attr('next') != 'false') {
                        popup.addButton(settings.nextLabel, nextFn, 'applinks-next-button');
                    }

                    if ($(page.div).attr('submit') == 'true') {
                        popup.addButton(settings.submitLabel, submitFn, 'wizard-submit');
                    }

                    if (!popup.getPage(pageIndex).buttonpanel) {
                        //THIS IS A DUMMY BUTTON, which gets remove afterwards
                        //THE DUMMY BUTTON will cause the cancel text link to appear on the correct position.
                        //IT IS A WORKAROUND so I don't have to change the dialog.js code
                        popup.addButton('', null);
                        $(popup.getPage(pageIndex).buttonpanel).empty();
                        var cancelLink = $('<button class="aui-button aui-button-link button-panel-button applinks-cancel-link">' + settings.cancelLabel + '</button>');
                        popup.getPage(pageIndex).buttonpanel.append(cancelLink);
                        cancelLink.click(cancelFn);
                    } else {
                        var cancelLink = $('<button class="aui-button aui-button-link button-panel-link button-panel-cancel-link applinks-cancel-link">' + settings.cancelLabel + '</button>');
                        $(popup.getPage(pageIndex).buttonpanel).append(cancelLink);
                        cancelLink.click(cancelFn);
                    }

                    if (pageIndex < pages.length - 1) {
                        popup.addPage();
                    }
                }

                result = {
                    dialog: popup,
                    nextPage: nextFn,
                    prevPage: previousFn,
                    submit: submitFn,
                    cancel: cancelFn,
                    show: showFn,
                    disableNextBtn     : disableNextFn,
                    enableNextBtn      : enableNextFn,
                    disableSubmitBtn   : disableSubmitFn,
                    enableSubmitBtn    : enableSubmitFn,
                    disablePreviousBtn : disablePreviousFn,
                    enablePreviousBtn  : enablePreviousFn
                };
                popup.gotoPage(0);
                popup.gotoPanel(0);
            });

            return result;
        };

        function disablePrevious(popup) {
            return function() {
                disable(getButton(popup, 'applinks-previous-button'));
            }
        }

        function enablePrevious(popup) {
            return function() {
                enable(getButton(popup, 'applinks-previous-button'));
            }
        }

        function disableNext(popup) {
            return function() {
                disable(getButton(popup, 'applinks-next-button'));
            }
        }

        function enableNext(popup) {
            return function() {
                enable(getButton(popup, 'applinks-next-button'));
            }
        }

        function disableSubmit(popup) {
            return function(showLoading) {
                var buttonEl = getButton(popup, 'wizard-submit');
                disable(buttonEl);
                if (typeof(showLoading) == 'undefined' || showLoading) {
                    $('<span class="loading">&nbsp;</span>').insertBefore(buttonEl);
                } else {
                    buttonEl.parent().find('.loading').remove();
                }
            }
        }

        function enableSubmit(popup) {
            return function() {
                var buttonEl = getButton(popup, 'wizard-submit');
                enable(buttonEl);
                buttonEl.parent().find('.loading').remove();
            }
        }

        function getButton(popup, cssClass) {
            return $(popup.getPage(popup.curpage).buttonpanel).find('.' + cssClass);
        }

        function resetForms(popup) {
             $(popup.popup.element).find('form').each( function() {
                  this.reset();
             });
        }

        function enable(element) {
            element.attr('disabled', false);
        }

        function disable(element) {
            element.attr('disabled', true);
        }
		
        function show(popup, onshow, aftershow) {
            return function(configuration) {
				if (onshow(popup, configuration) !== false) {
                    popup.gotoPage(0);
                    popup.gotoPanel(0);
                    $(document).unbind('keydown.ual.dialog');
                    $(document).bind('keydown.ual.dialog', attachKeypressListener(popup));
					popup.show();
                    aftershow();
                }
            }
        }

        function cancel(popup, oncancel) {
            return function() {
                if (oncancel(popup) !== false) {
                    popup.hide();
                    resetForms(popup);
                }
            }
        }

        function previous(popup, onprevious) {
            return function() {
                if (onprevious(popup) !== false) {
                    popup.prevPage();
                }
            }
        }

        function next(popup, onnext) {
            return function() {
                if (onnext(popup) !== false) {
                    popup.nextPage();
                }
            }
        }

        function attachKeypressListener(popup) {
            return function(e) {
                if (e.keyCode === 27) {
                    resetForms(popup);
                    $(document).unbind('keydown.ual.dialog');
                }
            }
        }

        function submit(popup, onSubmit, afterSubmit) {
            return function() {
                if (onSubmit(popup) !== false) {
                    afterSubmit(popup);
                    resetForms(popup);
                }
            }
        }

        function createPage(popup, page) {
            var panelDivs = $('> div[panel]', page.div);
            if (panelDivs.length > 0) {
                panelDivs.each(function(index, panelDiv) {
                    var popupPage = popup.addPanel(panelDiv.title, null, panelDiv.className, 'menu-' + panelDiv.id);
                    popupPage.getCurrentPanel().body.append(panelDivs[index]);
                });
            }
            else {
                var popupPage = popup.addPanel(page.title);
                popupPage.getCurrentPanel().body.append(page.div);
            }
        }


        function findPages(containerDiv) {
            var pagesDivs = $(' > div', containerDiv);
            var pages = [];
            pagesDivs.each(function(index) {
                var pageDiv = $(this);
                pages[index] = {
                    title: pageDiv.attr('title') || null,
                    className: pageDiv.attr('class'),
                    div: pageDiv
                };
            });
            return pages;
        }
    })(jQuery)
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-wizard', location = 'applinks/internal/non-amd/applinkwizard.js' */
(function($) {
    AppLinks.Wizard = {
        getWizard: function(){
            return $("#create-application-link-container").data('wizard');
        },
        initAuthenticationUI: function(element) {
            var root = $(element);
            var createTwoWayLinkCheckbox = root.find('.create-reciprocal-link');
            var ualArrow = root.find('.ual-arrow');
            var linkDetails = root.find('.two-way-link-details');
            var linkDescription = root.find('.reciprocal-link-description');
            var noLinkDescription = root.find('.no-reciprocal-link-description');
            createTwoWayLinkCheckbox.on('click', function() {
                if (createTwoWayLinkCheckbox.is(':checked')) {
                    ualArrow.removeClass('no-background');
                    linkDetails.show();
                    linkDescription.show();
                    noLinkDescription.hide();
                } else {
                    ualArrow.addClass('no-background');
                    linkDetails.hide();
                    linkDescription.hide();
                    noLinkDescription.show();
                }
            });
            var sameUserBtn = root.find('.same-user-radio-btn');
            var differentUserBtn = root.find('.different-user-radio-btn');
            var differentUserBaseImage = root.find('.different-userbase-image');
            var sameUserBaseImage = root.find('.same-userbase-image');

            sameUserBtn.on('click', function() {
                differentUserBaseImage.addClass('different-userbase-image-grey');
                sameUserBaseImage.removeClass('same-userbase-image-grey');
            });

            differentUserBtn.on('click', function() {
                sameUserBaseImage.addClass('same-userbase-image-grey');
                differentUserBaseImage.removeClass('different-userbase-image-grey');
            });
        },

        initNonUALUI : function(element) {
            var root = $(element);
            var applicationTypesEl = root.find('.application-types');
            for (var i = 0; i < nonAppLinksApplicationTypes.length; i++) {
                $('<option value=\"' + nonAppLinksApplicationTypes[i].typeId + '\">' + nonAppLinksApplicationTypes[i].label + '</option>').appendTo(applicationTypesEl);
            }
        },
        fetchManifest : function(wizard, dialogRootEl, ualAppCallbackFn, nonUALAppCallbackFn) {
            var applicationURLEl = dialogRootEl.find('#application-url');
            if (applicationURLEl.val() == '') {
                var applicationTypeEl = dialogRootEl.find('#application-types');
                if (applicationTypeEl.val() == '') {
                    $('<div class="error applinks-error">' + "URL cannot be empty." + '</div>').insertAfter(applicationURLEl);
                    return false;
                }
                var success = function(data) {
                    wizard.enableSubmitBtn();
                    wizard.enablePreviousBtn();
                    wizard.cancel();
                    AppLinks.UI.listApplicationLinks(data.applicationLink.id, 'new', data);
                };
                AppLinks.SPI.createStaticUrlAppLink(applicationTypeEl.val(), success, null);
                return true;
            }
            var appUrl = AppLinks.UI.addProtocolToURL(applicationURLEl.val());

            AppLinks.UI.showLoadingIcon(applicationURLEl);
            var success = function(data) {
                var manifest = data;
                wizard.enableNextBtn();
                dialogRootEl.find('.loading').remove();
                dialogRootEl.find('.reciprocal-rpc-url').val($('#baseUrl').val());
                if (typeof data.typeId != "undefined") {
                    AppLinks.Wizard.handleUALManifest(manifest, dialogRootEl);
                    wizard.dialog.gotoPage(2);
                    dialogRootEl.find('.reciprocal-link-username').focus();
                    if (ualAppCallbackFn) {
                      ualAppCallbackFn(manifest);
                    }
                }
                else {
                    if (data.code == 'applinks.warning.redirected.host' && !applicationURLEl.data('hasWarnedAboutRedirection')) {
                        // The host requires a redirection. Stay on the same page, ask for a confirmation.
                        AppLinks.UI.displayValidationErrorMessages('manifest-validation-errors', dialogRootEl, data.warning);
                        applicationURLEl.data('hasWarnedAboutRedirection', 'true');
                        var unsetRedirectionWarning = function () {
                            $(applicationURLEl).removeData('hasWarnedAboutRedirection');
                            $(applicationURLEl).unbind('change', unsetRedirectionWarning);
                        };
                        applicationURLEl.bind('change', unsetRedirectionWarning);
                    }
                	else if (data.code == 'applinks.warning.unknown.host' && !applicationURLEl.data('forceWhenHostIsOffline')) {
                	    // The host doesn't ping. Stay on the same page, ask for a confirmation.
                	    AppLinks.UI.displayValidationErrorMessages('manifest-validation-errors', dialogRootEl, data.warning);
                	    applicationURLEl.data('forceWhenHostIsOffline', 'true');
                	    var unsetForceWhenHostIsOffline = function () {
                	        $(applicationURLEl).removeData('forceWhenHostIsOffline');
                	        $(applicationURLEl).unbind('change', unsetForceWhenHostIsOffline);
                	    };
                	    applicationURLEl.bind('change', unsetForceWhenHostIsOffline);
            		}
                	else {
                        if (manifest.code == 'applinks.warning.unknown.host' || manifest.code == "applinks.warning.redirected.host") {
                	        // The user has already been notified of this warning.
                	        delete manifest.warning;
                	        delete manifest.code;
                	    }
                	    AppLinks.Wizard.handleNonUALManifest(manifest, appUrl, dialogRootEl);
                        wizard.dialog.gotoPage(1);
                        dialogRootEl.find('.application-name').focus();
                        if (nonUALAppCallbackFn) {
                          nonUALAppCallbackFn(manifest);
                        }
                	}
                }
            };
            wizard.disableNextBtn();
            AppLinks.SPI.tryToFetchManifest(appUrl, success, AppLinks.UI.displayValidationError('manifest-validation-errors', dialogRootEl, function() {
                wizard.enableNextBtn();
            }));
            return appUrl;
        },
        handleUALManifest : function(manifest, element) {
            var root = $(element);
            root.find('.remote-app-image').removeClass( function(index, className) {
            var classes = className.split(' ');
            var classToRemove = "";
                $.each(classes, function(index, value) {
                    if (value.indexOf('application-type-image-') != -1) {
                        classToRemove = value;
                    }
                });
                return classToRemove;
            });
            root.find('.remote-app-image').addClass('application-type-image-' + manifest.typeId);
            root.find('.link-to-app-type').html(AJS.format("Link to {0}", AppLinks.I18n.getApplicationTypeName(manifest.typeId)));
            root.find('.remote-app-name').text(AppLinks.UI.shortenString(manifest.name, 20));
            root.find('.create-reciprocal-link').attr('checked', true);
            root.find('#reciprocal-link-back-to-server').html(AJS.format("Also create a link from \u0027\u0027{0}\u0027\u0027 back to this server.", AJS.escapeHtml(manifest.name)));
            // For the two way link text, we need to specify different roles for the credentials depending on the remote app
            // For JIRA and Confluence version < 3.10, it is system administrator
            // For everything else, it is administrator
            var twoWayLinkParams = ["administrator", AJS.escapeHtml(manifest.name),
                             '<a target="_blank" href="' + AppLinks.Docs.getDocHref("applinks.docs.adding.application.link") + '">', '</a>'];
            if(manifest.applinksVersion != undefined) {
                var remoteVersion = manifest.applinksVersion.split(".");
                var majorVersion = parseInt(remoteVersion[0]);
                var minorVersion = parseInt(remoteVersion[1]);
                // we don't have to check for versions < 3 since those won't have the manifest.
                if ((manifest.typeId == "jira" || manifest.typeId == "confluence") && (majorVersion == 3 && minorVersion < 10)) {
                    twoWayLinkParams[0] = "system administrator";
                }
            }
            root.find('.reciprocal-link-description').html(AJS.format("To do this, you must provide {0} credentials for \u0027\u0027{1}\u0027\u0027. These credentials are only used to authenticate you against \u0027\u0027{1}\u0027\u0027 and will not be stored on this server. {2}Read More.{3}", twoWayLinkParams));
            root.find('.no-reciprocal-link-description').hide();
            root.find('.no-reciprocal-link-description').html(AJS.format("Tick this box to create a link from \u0027\u0027{0}\u0027\u0027 back to this server, otherwise clicking on next will create the Application Link to \u0027\u0027{0}\u0027\u0027 without any pre-configured authentication.", AJS.escapeHtml(manifest.name)));
            root.find('.reciprocal-link-username').val('');
            root.find('.reciprocal-link-password').val('');
            root.find('.ual-arrow').removeClass('no-background');
            root.find('.two-way-link-details').show();
            root.find('.reciprocal-link-description').show();
            root.find('.no-reciprocal-link-description').hide();
        },
        handleNonUALManifest : function(data, appUrl, element) {
            var root = $(element);
            root.find('.application-name').val('');
            root.find(".application-types option:first-child").attr("selected", "selected");
            root.find('.non-ual-application-url').text(appUrl);
            if (data.warning) {
                root.find('.create-non-ual-warning').show();
                root.find('.create-non-ual-warning').html(data.warning);
            } else {
                root.find('.create-non-ual-warning').hide();
            }
        },
        checkReciprocalLinkFormThreeStepMode : function(element, handleOneWayLinkFn, handleTwoWayLinkDetailsSuccess, appUrl, errorFn) {
            var root = $(element);
            if (root.find('.create-reciprocal-link').is(':checked')) {
                var reciprocalRPCURL = $.trim(root.find('.reciprocal-rpc-url').val());
                if (reciprocalRPCURL == '') {
                    $("<div class='error applinks-error'>" + "URL cannot be empty." + "</div>").insertAfter(root.find('.reciprocal-rpc-url'))
                    if (errorFn) {
                        errorFn();
                    }
                    return;
                }
                var reciprocalLinkUsername = root.find('.reciprocal-link-username');
                var reciprocalLinkPwd = root.find('.reciprocal-link-password');
                if (reciprocalLinkUsername.val() == '') {
                    $('<div class="error applinks-error">'+ "Username cannot be empty" +'</div>').insertAfter(reciprocalLinkUsername);
                    if (errorFn) {
                        errorFn();
                    }
                    return false;
                }

                //verify user has admin rights.
                var successFn = function(data) {
                    root.find('.same-user-description').find('input').attr('checked', true);
                    root.find(".trust-radio-btn").attr('checked', true);
                    root.find('.same-user-radio-btn').click();
                    handleTwoWayLinkDetailsSuccess(data);
                };
                reciprocalRPCURL = AppLinks.UI.addProtocolToURL(reciprocalRPCURL);
                AppLinks.SPI.verifyTwoWayLinkDetails(appUrl, reciprocalRPCURL, reciprocalLinkUsername.val(), reciprocalLinkPwd.val(), successFn, AppLinks.UI.displayValidationError('two-way-link-errors', element, errorFn));
                return false;
            } else {
                handleOneWayLinkFn();
                return false;
            }
        },
        checkReciprocalLinkFormTwoStepMode : function(element, appUrl, successFn, errorFn) {
            var root = $(element);
            var reciprocalRPCURL = $.trim(root.find('.reciprocal-rpc-url').val());
            if (reciprocalRPCURL == '') {
                $("<div class='error applinks-error'>" + "URL cannot be empty." + "</div>").insertAfter(root.find('.reciprocal-rpc-url'))
                if (errorFn) {
                    errorFn();
                }
                return;
            }
            var reciprocalLinkUsername = root.find('.reciprocal-link-username');
            var reciprocalLinkPwd = root.find('.reciprocal-link-password');
            if (reciprocalLinkUsername.val() == '') {
                $('<div class="error applinks-error">'+ "Username cannot be empty" +'</div>').insertAfter(reciprocalLinkUsername);
                if (errorFn) {
                    errorFn();
                }
                return false;
            }

            reciprocalRPCURL = AppLinks.UI.addProtocolToURL(reciprocalRPCURL);
            AppLinks.SPI.verifyTwoWayLinkDetails(appUrl, reciprocalRPCURL, reciprocalLinkUsername.val(), reciprocalLinkPwd.val(), successFn, AppLinks.UI.displayValidationError('two-way-link-errors', element, errorFn));
            return false;
        }
    }
})(AJS.$);
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-oauth-dance', location = 'applinks/internal/feature/oauth/oauth-callback.js' */
define('applinks/feature/oauth-callback', [
    'applinks/lib/window',
    'applinks/lib/lodash',
    'applinks/common/preconditions'
], function(
    window,
    _,
    Preconditions
) {
    function OAuthCallback(url) {
        Preconditions.nonEmptyString(url, 'url');
        this._url = url;
    }

    OAuthCallback.prototype.source = function(source) {
        Preconditions.hasValue(source, 'source');
        this._source = source;
        return this;
    };

    OAuthCallback.prototype.onSuccess = function(callback) {
        Preconditions.isFunction(callback, 'onSuccess');
        this._onSuccess = callback;
        return this;
    };

    OAuthCallback.prototype.onFailure = function(callback) {
        Preconditions.isFunction(callback, 'onFailure');
        this._onFailure = callback;
        return this;
    };

    // API for OAuth to invoke callbacks
    OAuthCallback.prototype.success = function() {
        this.oauthWindow.close();
        if (this._onSuccess) {
            this._onSuccess(this._source);
        }
        // free up the oauthCallback object
        delete window.oauthCallback;
    };

    OAuthCallback.prototype.failure = function() {
        this.oauthWindow.close();
        if (this._onFailure) {
            this._onFailure(this._source);
        }
        // free up the oauthCallback object
        delete window.oauthCallback;
    };

    // start the dance
    OAuthCallback.prototype.open = function() {
        // required for OAuth callbacks to fire
        window.oauthCallback = this;
        this.oauthWindow = window.open(this._url, 'com_atlassian_applinks_authentication');
    };

    return OAuthCallback;
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-oauth-dance', location = 'applinks/internal/feature/oauth/oauth-dance.js' */
define('applinks/feature/oauth-dance', [
    'applinks/lib/console',
    'applinks/lib/jquery',
    'applinks/lib/lodash',
    'applinks/lib/window',
    'applinks/common/events',
    'applinks/common/preconditions',
    'applinks/feature/oauth-callback'
], function(
    console,
    $,
    _,
    window,
    ApplinksEvents,
    Preconditions,
    OAuthCallback
) {
    /**
     * Creates a new OAuth Dance. This initializes elements found by `selector` within `scope` to initiate the OAuth
     * dance on click. The elements need to have a `data-authorisation-uri` attribute that points to the authorisation
     * page to open.
     *
     * @param scope {string} optional selector for scope, if not defined then global `document` will be used
     * @param selector {string} selector for the DOM elements to initialize OAuth dance for. If not defined then scope will be used
     * @constructor
     */
    function OAuthDance(scope, selector) {
        this._scope = scope || window.document;
        this._selector = selector;
    }

    OAuthDance.prototype.onSuccess = function(callback) {
        Preconditions.isFunction(callback, 'onSuccess');
        this._onSuccess = callback;
        return this;
    };

    OAuthDance.prototype.onFailure = function(callback) {
        Preconditions.isFunction(callback, 'onFailure');
        this._onFailure = callback;
        return this;
    };

    OAuthDance.prototype.defaultSuccess = function() {
        return this.onSuccess(function() {
            window.location.reload()
        });
    };

    OAuthDance.prototype.defaultFailure = function() {
        return this.onFailure(function() { return true });
    };

    /**
     * Wire up click events for the selected elements to initiate OAuth dance.
     */
    OAuthDance.prototype.initialize = function() {
        var that = this;
        if (this._selector) {
            $(this._scope).on('click', this._selector, function(e) {
                e.preventDefault();
                that._open($(this));
            });
        } else {
            $(this._scope).on('click', function(e) {
                e.preventDefault();
                that._open($(this));
            });
        }
    };

    /**
     * Start the OAuth dance for the given selector/scope.
     */
    OAuthDance.prototype.start = function() {
        var $scope = $(this._scope);
        var $element = this._selector ? $scope.find(this._selector) : $scope;
        this._open($element);
    };

    OAuthDance.prototype._open = function(element) {
        if (element.length !== 1) {
            console.warn('Could not trigger OAuth dance, the source is not a single HTML element: ' + element);
            return;
        }
        
        var authorisationUri = element.attr('data-authorisation-uri');

        if (authorisationUri) {
            this._onSuccess || this.defaultSuccess();
            this._onFailure || this.defaultFailure();
            new OAuthCallback(authorisationUri)
                .source(element)
                .onSuccess(this._onSuccess)
                .onFailure(this._onFailure)
                .open();
        } else {
            console.warn('Could not trigger OAuth dance, data-authorisation-uri missing for: ' + element);
        }
    };

    return OAuthDance;
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-oauth-ui', location = 'js/oauth-dialog.js' */
// NOTE: this is used outside of Applinks. See atlassian-plugin.xml for more details about the associated restrictions

/**
 * @deprecated use applinks/feature/oauth-callback and applinks/feature/oauth-dance AMD module
 */
(function($, ApplinksEvents, OAuthCallback) {
    // rest-service.js will load the AppLinks name space
    AppLinks.authenticateRemoteCredentials = function (url, onSuccess, onFailure) {
        $('.applinks-error').remove();
        new OAuthCallback(url).onSuccess(onSuccess).onFailure(onFailure).open();
    };
})(require('applinks/lib/jquery'), require('applinks/common/events'), require('applinks/feature/oauth-callback'));
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-ui', location = 'js/confirm-dialog.js' */
AJS.$(document).bind(AppLinks.Event.PREREADY, function() {
    AppLinks = AJS.$.extend(window.AppLinks || {}, {
        confirmDialog: function(title, message, confirm, cancel) {
            if (!cancel) cancel = function() {};

            var popup = new AJS.Dialog({
                width: 450,
                height: 180,
                id: 'confirm-dialog',
                onCancel: cancel
            });

            popup.addHeader(title);
            popup.addPanel(title);
            popup.getCurrentPanel().html(message);

            var complete = function(callback) {
                popup.remove();
                callback.call(popup);
            };

            popup.addButton(AJS.params.statusDialogAddButtonLabel || "Confirm", function() {
                complete(confirm);
            }, "confirm");
            popup.addButton(AJS.params.statusDialogCancelButtonLabel || "Cancel", function() {
                complete(cancel);
            }, "cancel");

            popup.show();
            popup.popup.element.addClass('aui-dialog-content-ready');
        }
    });

});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-ui', location = 'js/delete-link-dialog.js' */
AJS.$(document).bind(AppLinks.Event.READY, function() {
    var $ = AJS.$;
    var $deleteLinkDialog = $("#delete-link-dialog");

    if (!$deleteLinkDialog.size()) {
        // this page does not have the dialog on it, therefore we don't need to initialise it.
        // pages like the permissions error page don't include this dialog.
        return;
    }

    var dialogSettings,
        showDeleteReciprocalLink,
        userHasToAuthenticate,
        authenticationUrl,
        removeLoadingIcon = function() {
            $('.delete-applink-loading').hide();
            wizard.enableSubmitBtn();
        },
        wizardSettings = {
            showButtonId: "delete-application-link",
            cancelLabel: "Cancel",
            oncancel: function(){
                var dialog = wizard.dialog.popup.element;
                dialog.find('h2').empty();
            },
            submitLabel: "Confirm",
            width: 420,
            height: 330,
            id: "delete-application-link-dialog",
            aftershow: function() {

                dialogRootEl.find('.applinks-error').remove();
                var dialog = wizard.dialog.popup.element;

                var helpLink = $("<a/>", {
                    "class": "ual-help-link dialog-help-link help-link",
                    href: AppLinks.Docs.getDocHref(dialogSettings.helpKey, null),
                    target: "_blank",
                    title: "Help",
                    "data-help-link-key": dialogSettings.helpKey

                }).append($('<span/>', {
                        "class": 'aui-icon aui-icon-small aui-iconfont-help',
                        "text": 'Help'
                    }));

                dialog.find("h2").append($('<span>').text(dialogSettings.title)).append(helpLink);
                var confirmMessage = dialogSettings.confirmMessage;
                $('#delete-applink-text').html(confirmMessage);

                if (showDeleteReciprocalLink == false) {
                    var processManifest = function(manifest) {
                        var isUAL = manifest.applinksVersion && true;

                        if (isUAL) {
                            var authenticationRequired = function(authUrl) {
                                showDeleteReciprocalLink = true;
                                userHasToAuthenticate = true;
                                authenticationUrl = authUrl;
                                removeLoadingIcon();
                            };
                            var noReciprocalLinkToDelete = function(errorMsg) {
                                showDeleteReciprocalLink = false;
                                userHasToAuthenticate = false;
                                removeLoadingIcon();
                            };
                            var reciprocalLinkToDelete = function() {
                                showDeleteReciprocalLink = true;
                                userHasToAuthenticate = false;
                                removeLoadingIcon();
                            };
                            AppLinks.checkPermission(dialogSettings.doPermissionCheck, reciprocalLinkToDelete, authenticationRequired, noReciprocalLinkToDelete, AppLinks.UI.displayValidationError('delete-applink-error', dialogRootEl))
                        } else {
                            removeLoadingIcon();
                        }
                    };
                    $('.delete-applink-loading').show();
                    wizard.disableSubmitBtn(false);
                    AppLinks.SPI.getManifestFor(dialogSettings.applicationId, processManifest, AppLinks.UI.displayValidationError('delete-applink-error', dialogRootEl));
                }
            },
            onnext: function(popup) {
                $('.delete-reciprocal-applink-form').hide();
                $('.no-reciprocal-applink-form').hide();
                $('.authenticate-applink-form').hide();

                var showDeleteReciprocalLinkForm = function(){
                    $('.authenticate-applink-form').hide();
                    $('.delete-reciprocal-applink-form').show();
                    $('#delete-reciprocal-applink-text').text(dialogSettings.reciprocalLinkMessage);
                    $('.yes-delete-reciprocal-link').text(dialogSettings.deleteYesMessage);
                    $('.no-delete-reciprocal-link').text(dialogSettings.deleteNoMessage);
                    $('#yes-delete-reciprocal-link').attr('checked', true);
                    $('.delete-reciprocal-applink-form').show();
                };

                if (userHasToAuthenticate) {
                    $('.authenticate-applink-form').show();
                    $('.authenticate-message').text(dialogSettings.authenticationMessage);
                    AppLinks.SPI.addAuthenticationTrigger("#authenticate-link", authenticationUrl, {
                        before: function() {
                            popup.hide();
                        },
                        onSuccess: function() {
                            popup.show();
                            var reciprocalLinkToDelete = function() {
                                showDeleteReciprocalLinkForm();
                            }
                            var noReciprocalLinkToDelete = function(errorMsg) {
                                $('.authenticate-applink-form').hide();
                                $('.no-reciprocal-applink-form').show();
                                if (!errorMsg) {
                                    $('.no-link-message').text(dialogSettings.noReciprocalLinkMessage);
                                } else {
                                    $('.no-link-message').text(dialogSettings.failedToDetectReciprocalLinkMessage + " " + errorMsg);
                                }
                            }
                            AppLinks.checkPermission(dialogSettings.doPermissionCheck, reciprocalLinkToDelete, userHasToAuthenticate, noReciprocalLinkToDelete, AppLinks.UI.displayValidationError('delete-reciprocal-applink-error', dialogRootEl))
                        },
                        onFailure: function() {
                            popup.show();
                            $('.authenticate-applink-form').hide();
                            $('.no-reciprocal-applink-form').show();
                            $('.no-link-message').text(dialogSettings.authenticationFailedMessage);
                        }
                    });
                } else {
                  showDeleteReciprocalLinkForm();
                }
            },
            onsubmit: function(popup) {
                var success = function() {
                    wizard.enableSubmitBtn();
                    if (dialogSettings.callback()) {
                        popup.hide();
                    }
                };
                if (wizard.dialog.curpage == 1) {
                    var reciprocal = false;
                    var yesElement = $('#yes-delete-reciprocal-link');
                    var yesVisible = yesElement.is(':visible');
                    var yesChecked = yesElement.is(':checked');
                    if (yesVisible && yesChecked) {
                        reciprocal = true;
                    }
                    wizard.disableSubmitBtn();
                    dialogSettings.doDelete(reciprocal, success, AppLinks.UI.displayValidationError('delete-applink-error', dialogRootEl, function() {
                        wizard.enableSubmitBtn();
                    }));
                } else {
                    if (showDeleteReciprocalLink) {
                        wizard.nextPage();
                    } else {
                        wizard.disableSubmitBtn();
                        dialogSettings.doDelete(false, success, AppLinks.UI.displayValidationError('delete-applink-error', dialogRootEl, function() {
                            wizard.enableSubmitBtn();
                        }));
                    }
                }
                return false;
            }
        };

    var wizard = $deleteLinkDialog.wizard(wizardSettings);
    var dialogRootEl = $(wizard.dialog.popup.element);

    AppLinks.showDeleteLinkDialog = function(settings) {
        showDeleteReciprocalLink = false;
        userHasToAuthenticate = false;
        dialogSettings = settings;
        wizard.show();
    };

    AppLinks.bindDeleteLink = function(e) {
        var application = e.data.application;
        e.preventDefault();
        AppLinks.UI.hideInfoBox();
        AppLinks.SPI.getApplicationLinkInfo(application.id, function(appLinkInfo) {
            var confirmMessage = $('<div>');
            confirmMessage.append($('<div>').text(AJS.format("Confirm that you want to delete the Application Link to \u0027\u0027{0}\u0027\u0027 ({1}).", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId))));
            if (appLinkInfo.configuredAuthProviders.length > 0){
                var authProviderMessage = AppLinks.UI.prettyJoin(appLinkInfo.configuredAuthProviders, function(value) {
                    return AppLinks.I18n.getAuthenticationTypeName(value);
                });
                confirmMessage.append($('<div>').text(AJS.format("The authentication information stored for {0} will be deleted.", authProviderMessage)));

                if (appLinkInfo.numConfiguredEntities > 0) {
                    var linkI18nKey;
                    if (appLinkInfo.numConfiguredEntities > 1){
                        linkI18nKey = "applinks.dialog.delete.entity.links.plural";
                    } else {
                        linkI18nKey = "applinks.dialog.delete.entity.links.singular";
                    }

                    var hostEntityTypeLabel = AppLinks.UI.prettyJoin(appLinkInfo.hostEntityTypes, function(value) {
                        if (appLinkInfo.numConfiguredEntities > 1) {
                            return AppLinks.I18n.getPluralizedEntityTypeName(value);
                        } else {
                            return AppLinks.I18n.getEntityTypeName(value);
                        }
                    });
                    var remoteEntityTypeLabel = AppLinks.UI.prettyJoin(appLinkInfo.remoteEntityTypes, function(value) {
                        return AppLinks.I18n.getPluralizedEntityTypeName(value);
                    });
                    var entityLinksMsg = AJS.I18n.getText(linkI18nKey, appLinkInfo.numConfiguredEntities, hostEntityTypeLabel, remoteEntityTypeLabel, application.name);
                    confirmMessage.append($('<div>').text(entityLinksMsg));
                }
            }
            var deleteDialogSettings = {
                title: AJS.format("Delete Link to \u0027\u0027{0}\u0027\u0027", application.name),
                applicationId: application.id,
                confirmMessage: confirmMessage,
                reciprocalLinkMessage: AJS.format("{0} ({1}) has a link to this Application. Do you want to delete this link as well?", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                noReciprocalLinkMessage: AJS.format("{0} ({1}) doesn\u0027\u0027t have a link to this application. Click confirm to delete only the link from this application to {0} ({1}).", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                deleteYesMessage: AJS.format("Yes, delete the link from {0} ({1}) to this application.", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                deleteNoMessage: AJS.format("No, do not delete the link from {0} ({1}) to this application.", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                authenticationMessage: AJS.format("We can check if {0} ({1}) has a link to this application and delete this link as well. To do this you must authenticate. Click confirm to delete only the local link to {0} ({1}).", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                noConnectionMessage: "There was a problem when contacting the remote application.",
                authenticationFailedMessage: AJS.format("Unable to check if {0} ({1}) has a link to this application, because the authorization failed. Click confirm to delete only the local Application Link to {0} ({1})", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                failedToDetectReciprocalLinkMessage : AJS.format("A problem occurred when trying to check if a link from {0} ({1}) to this application exists.", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                helpKey: 'applinks.docs.delete.application.link',
                doPermissionCheck: function(success, error) {
                    AppLinks.SPI.canDeleteAppLink(application.id, success, error);
                },
                doDelete: function(reciprocate, success, error) {
                    AppLinks.SPI.deleteLink(application, reciprocate, success, error);
                },
                callback: function() {
                    AppLinks.UI.listApplicationLinks(application.name, 'delete');
                    return true;
                }
            };
            AppLinks.showDeleteLinkDialog(deleteDialogSettings);
        });
    }
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-ui', location = 'js/permission-check-util.js' */
AJS.$(document).bind(AppLinks.Event.PREREADY, function() {
    (function($) {
        AppLinks = AJS.$.extend(window.AppLinks || {}, {
            checkPermission: function(permissionFn, link, authRequired, noLink, errorFn) {
                var permSettings = {
                    noPermission:               function() {
                        noLink("You don\u0027t have sufficient permissions to perform this operation.");
                    },
                    missing:                    noLink,
                    noAuthenticationConfigured: noLink,
                    noAuthentication:           noLink,
                    authenticationFailed:       noLink,
                    credentialsRequired:        authRequired,
                    noConnection: function() {
                        noLink("There was a problem when contacting the remote application.");
                    },
                    allowed: link,
                    unrecognisedCode: function(code) {
                        noLink(AJS.format("An error has occurred, unexpected permission check response: {0}", code))
                    }
                };
                permissionFn(AppLinks.SPI.processPermissionCode(permSettings), errorFn);
            }
        })
    })(AJS.$)
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-new-ui-utils', location = 'js/new/applinks-util.js' */
define('applinks/js/util', [
    'applinks/lib/aui',
    'applinks/lib/jquery',
    'applinks/lib/window'
], function(
    AJS,
    jQuery,
    window
) {
    window.AppLinks = window.AppLinks || {};

    // Maintain backwards compatibility with pre-AMD conversion by assigning to the global
    window.AppLinks.Util = {
        /**
         * In the (possible) absence of an AUI way to do this check if the browser is IE8
         * @returns {*|boolean}
         */
        isPreIE9: function() {
            return jQuery.browser.msie && jQuery.browser.version <= 8;
        },
        manifestToApplication: function(manifest) {
            return {
                url: manifest.url,
                rpcUrl: manifest.url,
                name: manifest.name,
                product: manifest.typeId ? AppLinks.I18n.getApplicationTypeName(manifest.typeId) : undefined,
                logoUrl: manifest.iconUri ? manifest.iconUri : manifest.iconUrl,
                typeId: manifest.typeId,
                id: manifest.id,
                applinksVersion: manifest.applinksVersion,
                publicSignUp: manifest.publicSignup,
                inboundAuthenticationTypes: manifest.inboundAuthenticationTypes,
                outboundAuthenticationTypes: manifest.outboundAuthenticationTypes
            }
        },
        applicationSupportsIncomingThreeLeggedOAuth: function(application) {
            return this.applicationSupportsIncomingAuth(application, "com.atlassian.applinks.api.auth.types.OAuthAuthenticationProvider");
        },
        applicationSupportsIncomingTwoLeggedOAuth: function(application) {
            return this.applicationSupportsIncomingAuth(application, "com.atlassian.applinks.api.auth.types.TwoLeggedOAuthAuthenticationProvider");
        },
        applicationSupportsIncomingTwoLeggedOAuthWithImpersonation: function(application) {
            return this.applicationSupportsIncomingAuth(application, "com.atlassian.applinks.api.auth.types.TwoLeggedOAuthWithImpersonationAuthenticationProvider");
        },
        applicationSupportsOutgoingThreeLeggedOAuth: function(application) {
            return this.applicationSupportsOutgoingAuth(application, "com.atlassian.applinks.api.auth.types.OAuthAuthenticationProvider");
        },
        applicationSupportsOutgoingTwoLeggedOAuth: function(application) {
            return this.applicationSupportsOutgoingAuth(application, "com.atlassian.applinks.api.auth.types.TwoLeggedOAuthAuthenticationProvider");
        },
        applicationSupportsOutgoingTwoLeggedOAuthWithImpersonation: function(application) {
            return this.applicationSupportsOutgoingAuth(application, "com.atlassian.applinks.api.auth.types.TwoLeggedOAuthWithImpersonationAuthenticationProvider");
        },
        applicationSupportsIncomingAuth: function(application, authProvider) {
            return this.applicationSupportsAuth(application.inboundAuthenticationTypes, authProvider);
        },
        applicationSupportsOutgoingAuth: function(application, authProvider) {
            return this.applicationSupportsAuth(application.outboundAuthenticationTypes, authProvider);
        },
        applicationSupportsAuth: function(authProviders, authProvider) {
            return AJS.$.inArray(authProvider,authProviders) >= 0 ? true : false;
        },
        waitUntilDone: function(callback){
            var callbacks = callback(),
                wait = callbacks.wait,
                done = callbacks.done;

            var deferred = new AJS.$.Deferred();
            wait();
            setTimeout(function(){
                deferred.resolve();
            }, 2000);

            return function(){
                deferred.done(done);
            };
        },
        getFieldValueFromQueryString: function (queryString, fieldName) {
            var fieldIndex = window.location.search.indexOf(fieldName);
            if (fieldIndex<0) {
                return null;
            }
            var fieldValueString;
            var nextParamIndex = queryString.slice(fieldIndex).indexOf("&");
            if (nextParamIndex > 0) {
                fieldValueString = queryString.slice(fieldIndex + fieldName.length + "=".length, fieldIndex + nextParamIndex);
            } else {
                fieldValueString = queryString.slice(fieldIndex + fieldName.length + "=".length);
            }

            var decodedFieldValue = decodeURIComponent(fieldValueString);
            try {
                return JSON.parse(decodedFieldValue);
            } catch(e) {
                console.log('Unable to JSON parse: [' + decodedFieldValue + "], using as is");
                return decodedFieldValue;
            }
        },
        /**
         * Find the value for the named parameter.
         * Checks first in sessionStorage and then in the queryString.
         * @param fieldName the name of the parameter.
         * @param clean flag indicating if the value should be read and then cleared for sessionStorage.
         */
        getParameterValue: function (fieldName, clean)
        {
            // check sessionstorage first
            if(typeof(Storage)!=="undefined") {
                var value = window.sessionStorage.getItem(fieldName);
                if(typeof value !== 'undefined'
                    && value != null ) {
                    if(clean === true) {
                        window.sessionStorage.removeItem(fieldName);
                    }
                    return JSON.parse(value);
                }
            }

            // if not there try querystring
            return this.getFieldValueFromQueryString(window.location.search, fieldName);
        },

        /**
         * Put a pair (fieldName, fieldValue) into sessionStorage (if it exists)
         * or in the given parametersMap
         */
        putParameter: function (fieldName, fieldValue, parametersMap) {
            if(typeof(Storage)!=="undefined") {
                window.sessionStorage.setItem(fieldName, JSON.stringify(fieldValue));
            } else {
                parametersMap[fieldName] = fieldValue;
            }
        },

        /**
         * Check the data-sysadmin-flag from list_application_links vm.
         * @returns {*|jQuery}
         */
        isSysAdmin: function(){
            return AJS.$('#ual.list-links').data("sysadminFlag")
        },
        /**
         * Remove the disabled attribute and any sibling spinner from the button.
         * @param button
         */
        enableButton: function(button){
            button.prop("disabled", false);

            if(button.siblings('.aui-icon-wait').length != 0) {
                button.siblings('.aui-icon-wait').remove();
            }

        },
        /**
         * Mark the button as disabled, and if it is busy add a sibling spinner.
         * The spinner can be optionally before or after the button.
         * @param button
         * @param busy
         * @param after
         */
        disableButton: function(button, busy, after){
            var spinner = '<span class="aui-icon aui-icon-wait aui-icon-wait-padding"></span>';
            if(busy && button.siblings('.aui-icon-wait').length == 0) {
                if(after){
                    button.after(spinner);
                } else {
                    button.before(spinner);
                }
            }

            button.prop("disabled", true);
        },
        /**
         * set the specified button to be enabled or disabled.
         * A disabled button can shown with a spinner if it is busy.
         * @param button
         * @param enabled
         * @param busy
         */
        setButtonEnabledState: function(button, enabled, busy) {
            if(enabled) {
                this.enableButton(button);
            } else {
                this.disableButton(button, busy, true);
            }
        },
        /**
         * check the receivedVersion string implies a version equal to or greater than v4.0.0
         * expects a string in the form '([0-9]\.[0-9]\.[0-9])(\.*[0-9A-Za-z-]*)'
         * @param receivedVersion
         * @returns {boolean} true if 4.0.0 or higher, false otherwise.
         */
        isVersion4OrHigher: function(receivedVersion) {
            var receivedVersionParts = receivedVersion.match('([0-9]\.[0-9]\.[0-9])(\.*[0-9A-Za-z-]*)');

            if(receivedVersionParts == null) {
                console.log('Received version is in an unrecognized format ' + receivedVersion );
                return false;
            }

            var majorMinorPatchString = receivedVersionParts[1];
            var prereleaseString = receivedVersionParts[2];
            var majorMinorPatchParts = majorMinorPatchString.split('.');

            // check major version is at least 4
            if(parseFloat(majorMinorPatchParts[0]) < 4) {
                return false;
            }

            if(parseFloat(majorMinorPatchParts[0]) > 4) {
                return true;
            }

            // we have a v4.#.#

            // check minor version is greater than 0
            if(parseFloat(majorMinorPatchParts[1]) > 0) {
                return true;
            }

            // check patch version is greater than 0
            if(parseFloat(majorMinorPatchParts[2]) > 0) {
                return true;
            }

            // we have a 4.0.0 version is it prerelease?
            if(prereleaseString == null
                || prereleaseString === ''
                || prereleaseString === '.SNAPSHOT') {
                // not a prerelease so run with it.
                return true;
            }

            // if in doubt not compatible.
            return false;
        }
    };

    return window.AppLinks.Util;
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/browser.js' */
define('applinks/common/browser', [
    'applinks/lib/window'
], function(Window) {

    var browser = {
        isMicrosoft: function () {
            var userAgent = Window.navigator.userAgent;
            return userAgent.indexOf("MSIE") > 0 ||     // IE < 11
                !!userAgent.match(/Trident\/7\./) || // IE == 11
                userAgent.indexOf('Edge/') > 0;      // Edge
        }
    };
    return browser;
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/context.js' */
define('applinks/common/context', [
    'applinks/lib/console',
    'applinks/lib/window',
    'applinks/lib/wrm',
    'applinks/common/modules'
], function(
    console,
    window,
    WRM,
    ApplinksModules
) {
    var context = WRM.data.claim(ApplinksModules.dataFqn('applinks-common', 'applinks-context'));

    return {
        currentUser: function() {
            return context.currentUser
        },

        /**
         * @returns {object} host application containing `id` and `type` properties
         */
        hostApplication: function() {
            return context.hostApplication
        },

        validateCurrentUser: function() {
            if (!this.currentUser()) {
                console.log('No user context, reloading the page to trigger redirect to the login screen');
                window.location.reload();
            }
        }
    };
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/dialog-focus.js' */
define('applinks/common/dialog-focus', [
    'applinks/lib/lodash',
    'applinks/common/preconditions'
], function(
    _,
    Preconditions
){
    return {
        defaultFocus: function($el) {
            Preconditions.hasValue($el, '$el');
            _.defer(function() {
                $el.find('.applinks-default-focus').first().focus();
            });
        }
    }
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/dialog-helper.js' */
define('applinks/common/dialog-helper', [
    'applinks/lib/aui',
    'applinks/lib/jquery',
    'applinks/lib/lodash',
    'applinks/common/dialog-focus'
], function(
    AJS,
    $,
    _,
    DialogFocus
) {
    var globalDialogShown = false;
    var container = 'body';

    function isAnyDialogOpen() {
        return globalDialogShown;
    }

    function getContainer() {
        return container;
    }

    function _registerGlobalListeners() {
        // AJS.dialog2.on() can't be mocked in the right context in the rest-response-handlers.js, beforeEach() is executed after _registerGlobalListeners()
        if (_.isUndefined(AJS.dialog2) || _.isUndefined(AJS.dialog2.on)) {
            return;
        }

        AJS.dialog2.on("show", function() {
            DialogFocus.defaultFocus($('section.aui-dialog2'));
            globalDialogShown = true;
        });

        AJS.dialog2.on("hide", function() {
            globalDialogShown = false;
        });
    }

    _.defer(_registerGlobalListeners);

    return {
        isAnyDialogOpen: isAnyDialogOpen,
        getContainer: getContainer
    };
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/features.js' */
define('applinks/common/features', [
    'applinks/lib/wrm',
    'applinks/lib/lodash',
    'applinks/common/modules',
    'applinks/common/context',
    'applinks/common/rest'
], function(
    WRM,
    _,
    ApplinksModules,
    ApplinksContext,
    ApplinksRest
) {
    var enabledFeatures, discoveredFeatures;

    function _getEnabledFeatures() {
        if (_.isUndefined(enabledFeatures)) {
            enabledFeatures = WRM.data.claim(ApplinksModules.dataFqn('applinks-common', 'applinks-features'));
        }
        return enabledFeatures;
    }

    function _getDiscoveredFeatures() {
        if (_.isUndefined(discoveredFeatures)) {
            discoveredFeatures = WRM.data.claim(ApplinksModules.dataFqn('applinks-common', 'applinks-discovered-features'));
        }
        return discoveredFeatures;
    }

    function isDiscovered(featureKey) {
        return (_.includes ? _.includes : _.contains)(_getDiscoveredFeatures(), featureKey.toLowerCase());
    }

    function addEnabledFeatures(features) {
        _.extend(_getEnabledFeatures(), features);
    }

    function addDiscoveredFeatures(featureKeys) {
        featureKeys.forEach(function(featureKey){
            if (!isDiscovered(featureKey)) {
                _getDiscoveredFeatures().push(featureKey.toLowerCase());
            }
        });
    }

    /**
     * Allows to query for, enable and discover Applinks features.
     */
    return {

        BITBUCKET_REBRAND: 'BITBUCKET_REBRAND',
        V3_UI_OPT_IN: 'V3_UI_OPT_IN',
        V3_UI: 'V3_UI',

        /**
         * @returns {Object.<string, Object>} all enabled features mapped by key
         */
        getEnabledFeatures: function() {
            return _getEnabledFeatures();
        },

        isEnabled: function(featureName) {
            return this.getEnabledFeatures()[featureName];
        },

        /**
         * Disable `featureName`, requires user context and admin permissions.
         *
         * @param featureName {string} feature name to enable
         * @return the request promise to hook callbacks to
         */
        disable: function(featureName) {
            ApplinksContext.validateCurrentUser();
            return ApplinksRest.V3.features(featureName).del()
                .done(function() {
                    _getEnabledFeatures()[featureName] = false;
                });
        },

        /**
         * Enable `featureName`, requires user context and admin permissions.
         *
         * @param featureName {string} feature name to enable
         * @return the request promise to hook callbacks to
         */
        enable: function(featureName) {
            ApplinksContext.validateCurrentUser();
            return ApplinksRest.V3.features(featureName).put()
                .done(function(feature) {
                    addEnabledFeatures(feature);
                });
        },

        /**
         * @returns {string[]} an array of discovered feature keys
         */
        getDiscoveredFeatures: function() {
            return _getDiscoveredFeatures();
        },

        isDiscovered: isDiscovered,

        /**
         * Discover `featureKey`, requires user context.
         *
         * @param featureKey {string} key to discover
         */
        discover: function(featureKey) {
            ApplinksContext.validateCurrentUser();
            ApplinksRest.V3.featureDiscovery(featureKey).put()
                .fail(function(req) {
                    throw 'Feature discovery request failed: ' + req.status + ': ' + req.responseText;
                }).done(function(featureKey) {
                    addDiscoveredFeatures(featureKey);
                });
        }
    }
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/initializer.js' */
define('applinks/common/initializer', [
    'applinks/lib/jquery',
    'applinks/lib/lodash'
], function(
    $,
    _
) {
    function _callInitCallback(module) {
        if (module && _.isFunction(module.init)) {
            module.init();
        }
        if (module && _.isFunction(module.initialize)) {
            module.initialize();
        }
    }

    return {

        /**
         * Init each module in the arguments list. If the module contains an `init` or `initialize` function,
         * it will be called immediately. If both functions are present, both will be called.
         *
         * @param arguments list modules to initialize
         */
        init: function() {
            _.each(arguments, function(module) {
                _callInitCallback(module);
            });

        },

        /**
         * Init each module in the arguments list on DOM ready. If the module contains an `init` or `initialize`
         * function, it will be called on DOM ready event. Those functions should contain code that performs UI
         * initialization dependent on the state of the DOM. If both functions are present, both will be called.
         *
         * @param arguments list modules to initialize
         */
        initOnDomReady: function() {
            _.each(arguments, function(module) {
                $(function() {
                    _callInitCallback(module);
                });
            });
        }
    }
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/response-status.js' */
define('applinks/common/response-status', [
    'applinks/lib/lodash'
], function(
    _
) {

    function StatusFamily(familyCode) {
        this.familyCode = familyCode;
    }

    StatusFamily.prototype.matches = function(code) {
        return Math.floor(_getStatusCode(code) / 100) == this.familyCode;
    };

    var StatusFamilies = {
        INFORMATIONAL: new StatusFamily(1),
        SUCCESSFUL: new StatusFamily(2),
        REDIRECTION: new StatusFamily(3),
        CLIENT_ERROR: new StatusFamily(4),
        SERVER_ERROR: new StatusFamily(5),

        forCode: function(code) {
            return _.find(StatusFamilies.all(), function(family) {
                return family.matches(code);
            });
        },

        all: function() {
            return [
                StatusFamilies.INFORMATIONAL,
                StatusFamilies.SUCCESSFUL,
                StatusFamilies.REDIRECTION,
                StatusFamilies.CLIENT_ERROR,
                StatusFamilies.SERVER_ERROR
            ];
        }
    };

    function ResponseStatus(code) {
        this.code = code;
        this.family = StatusFamilies.forCode(code);
    }

    ResponseStatus.prototype.matches = function(code) {
        return _getStatusCode(code) == this.code;
    };

    function _getStatusCode(object) {
        if (object && object.status && _.isNumber(object.status)) {
            return object.status;
        } else if (_.isNumber(object)) {
            return object;
        } else {
            return 0;
        }
    }

    return {
        OK: new ResponseStatus(200),
        CREATED: new ResponseStatus(201),
        NO_CONTENT: new ResponseStatus(204),

        BAD_REQUEST: new ResponseStatus(400),
        UNAUTHORIZED: new ResponseStatus(401),
        FORBIDDEN: new ResponseStatus(403),
        NOT_FOUND: new ResponseStatus(404),
        CONFLICT: new ResponseStatus(409),

        SERVER_ERROR: new ResponseStatus(500),

        Family: StatusFamilies
    }
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/rest-response-handlers.js' */
define('applinks/common/response-handlers', [
    'applinks/lib/aui',
    'applinks/lib/console',
    'applinks/lib/window',
    'applinks/lib/jquery',
    'applinks/lib/lodash',
    'applinks/common/preconditions',
    'applinks/common/dialog-helper',
    'applinks/common/response-status'
], function(
    AJS,
    console,
    window,
    $,
    _,
    Preconditions,
    DialogHelper,
    ResponseStatus
) {
    var ERROR_DIALOG_ID = 'applinks-error-dialog';
    var ERROR_DIALOG_CLOSE_BTN_ID = ERROR_DIALOG_ID + '-close-button';

    function _toArray() {
        return _.isArray(arguments[0]) ? arguments[0] : _.toArray(arguments);
    }

    function _parseResponseText(request) {
        if (!request.responseText) {
            return null;
        }
        try {
            return JSON.parse(request.responseText)
        } catch(error) {
            console.warn('Unable to parse REST error response text - not a JSON response.');
            return null;
        }
    }

    function _showDialog(request) {
        if (DialogHelper.isAnyDialogOpen()) {
            console.debug('Not showing REST error dialog - another modal dialog already open');
            return;
        }
        var jsonResponse = _parseResponseText(request);
        var responseErrors = jsonResponse && jsonResponse.errors && jsonResponse.errors.length > 0 ? jsonResponse.errors : null;
        var dialogContents = applinks.common.resterror.dialogContents({id: ERROR_DIALOG_ID, errors: responseErrors});

        $(DialogHelper.getContainer()).append(dialogContents);
        var dialog = AJS.dialog2('#' + ERROR_DIALOG_ID);

        $('#'+ERROR_DIALOG_CLOSE_BTN_ID).on('click', function(e) {
            e.preventDefault();
            dialog.hide();
            dialog.remove();
        });
        dialog.show();
    }

    /**
     * Create a success handler for ajax calls decorated with expected statuses.
     *
     * @param {Array} arguments can be an array of statuses or statuses as multiple arguments, e.g. :
     *          done([ResponseStatus.Family.SUCCESSFUL, ResponseStatus.NOT_FOUND])
     *          done(ResponseStatus.Family.SUCCESSFUL, ResponseStatus.NOT_FOUND)
     *
     * @returns {Function(data, textStatus, request)} success handler for ajax call decorated with expected statuses
     */
    function done() {
        var statuses = _toArray.apply(this, arguments);

        return function(data, textStatus, request) {
            if (!_.some(statuses, function(status) { return status.matches(request) })) {
                console.error('Unexpected response status: ' + request.status + ': ' + request.responseText);
            }
        }
    }

    /**
     * Create a failure handler for ajax calls decorated with expected statuses.
     *
     * @param {Array} arguments can be an array of statuses or statuses as multiple arguments, e.g. :
     *          fail([ResponseStatus.Family.SUCCESSFUL, ResponseStatus.NOT_FOUND])
     *          fail(ResponseStatus.Family.SUCCESSFUL, ResponseStatus.NOT_FOUND)
     *
     * @returns {Function(request, textStatus, error)} failure handler for ajax call decorated with expected statuses
     */
    function fail() {
        var statuses = _toArray.apply(this, arguments);

        return function(request, textStatus, error) {
            if (!_.some(statuses, function (status) { return status.matches(request) })) {
                console.error('Unexpected response status: ' + request.status + ': ' + request.responseText);

                if (ResponseStatus.UNAUTHORIZED.matches(request)) {
                    window.location.reload();
                } else {
                    _showDialog(request);
                }
            }
        }
    }

    return {
        done: done,
        fail: fail
    };
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/rest-request.js' */
define('applinks/common/rest-request', [
    'applinks/lib/console',
    'applinks/lib/window',
    'applinks/lib/jquery',
    'applinks/lib/lodash',
    'applinks/common/preconditions',
    'applinks/common/response-status',
    'applinks/common/response-handlers'
], function(
    console,
    window,
    $,
    _,
    Preconditions,
    ResponseStatus,
    ResponseHandlers
) {
    var defaultRequestSettings = {
        dataType: 'json',
        contentType: 'application/json'
    };

    // construct the target URL by adding query params
    function _toUrl(url, queryParams) {
        if (_.isEmpty(queryParams)) {
            return url;
        }
        var separator = url.indexOf('?') > -1 ? '&' : '?';
        return url + separator + $.param(queryParams);
    }

    function _toQueryParams(paramsObject) {
        if (!paramsObject) {
            return [];
        } else if (_.isArray(paramsObject)) {
            return paramsObject;
        } else {
            var result = [];
            _.each(paramsObject, function(value, key) {
                result.push({name: key, value: value});
            });
            return result;
        }
    }

    /**
     * Creates a new instance of `ApplinksRestRequest`.
     *
     * @param url URL to request to. NOTE: URLs with fragments (`#`) are not supported
     * @param {Object} params query parameters to add to the request URL. Can be an object, or an array of objects
     *                 containing `name` and `value` property
     * @constructor
     */
    function ApplinksRestRequest(url, params) {
        Preconditions.nonEmptyString(url, 'url');
        Preconditions.checkArgument(url.indexOf('#') == -1, 'url: "#" fragments not supported');
        this._url = url;
        this._queryParams = _toQueryParams(params);
        this._expectedStatus = [ResponseStatus.Family.SUCCESSFUL];
    }

    ApplinksRestRequest.GET = 'GET';
    ApplinksRestRequest.PUT = 'PUT';
    ApplinksRestRequest.POST = 'POST';
    ApplinksRestRequest.DELETE = 'DELETE';

    ApplinksRestRequest.prototype.get = function() {
        return this._execute(this._requestSettings(ApplinksRestRequest.GET));
    };

    ApplinksRestRequest.prototype.del = function() {
        return this._execute(this._requestSettings(ApplinksRestRequest.DELETE));
    };

    ApplinksRestRequest.prototype.put = function(data) {
        var settings = this._requestSettings(ApplinksRestRequest.PUT);
        if (data) {
            settings.data = data;
        }
        return this._execute(settings);
    };

    ApplinksRestRequest.prototype.post = function(data) {
        var settings = this._requestSettings(ApplinksRestRequest.POST);
        if (data) {
            settings.data = data;
        }
        return this._execute(settings);
    };

    ApplinksRestRequest.prototype.getUrl = function() {
        return _toUrl(this._url, this._queryParams);
    };

    /**
     * Add query param to this request.
     *
     * @param {string} name param name
     * @param {string} value param value
     * @return {ApplinksRestRequest} this request
     */
    ApplinksRestRequest.prototype.queryParam = function(name, value) {
        this._queryParams.push({name: name, value: value});
        return this;
    };

    /**
     * Add query params to this request.
     *
     * @param {Object} params query parameters to add to the request URL. Can be an object, or an array of objects
     *                 containing `name` and `value` property
     * @returns {ApplinksRestRequest} this request
     */
    ApplinksRestRequest.prototype.queryParams = function(params) {
        this._queryParams = this._queryParams.concat(_toQueryParams(params));
        return this;
    };

    /**
     * Add `authorisationCallback` query parameter to this request, this is useful for resources that are expected to
     * respond with `authorisationUri`
     *
     * @param {string} callback URI to call back once authorisation is done
     * @return {ApplinksRestRequest} this request
     */
    ApplinksRestRequest.prototype.authorisationCallback = function(callback) {
        this.queryParam('authorisationCallback', callback);
        return this;
    };

    /**
     * Expect a specific status (or status family). Use a specific number or one of the members defined in
     * `applinks/common/response-status`. By default a successful 20x response is expected. If the response does not
     * meet this expectation, a default error handler will be invoked.
     *
     * Invoke this method with any number of of statuses expressed as an object that contains `matches` method (using
     * the ones in `applinks/lib/response-status` is highly recommended).
     * @returns {ApplinksRestRequest} this request
     */
    ApplinksRestRequest.prototype.expectStatus = function() {
        this._expectedStatus = _.isArray(arguments[0]) ? arguments[0] : _.toArray(arguments);
        return this;
    };

    ApplinksRestRequest.prototype._requestSettings = function(requestType) {
        var that = this;
        return _.defaults({
            url: _toUrl(that._url, that._queryParams),
            type: requestType
        }, defaultRequestSettings);
    };

    ApplinksRestRequest.prototype._execute = function(settings) {
        return $.ajax(settings)
            .done(ResponseHandlers.done(this._expectedStatus))
            .fail(ResponseHandlers.fail(this._expectedStatus));
    };

    return ApplinksRestRequest;
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/rest.js' */
define('applinks/common/rest', [
    'applinks/lib/aui',
    'applinks/common/preconditions',
    'applinks/common/rest-request',
    'applinks/common/rest-oauth'
], function(
    AJS,
    Preconditions,
    ApplinksRestRequest,
    ApplinksOAuthRest
) {
    var PARAM_DATA = 'data';

    function ApplinksRestModule(version) {
        Preconditions.hasValue(version, 'version');
        this._version = version;
    }

    ApplinksRestModule.prototype.baseUrl = function() {
        return AJS.contextPath() + '/rest/applinks/' + this._version;
    };

    ApplinksRestModule.prototype.withPath = function(path) {
        return this.baseUrl() + '/' + path;
    };

    function ApplinksV1RestModule() {
        this.module = new ApplinksRestModule('1.0');
    }

    ApplinksV1RestModule.prototype.applink = function(applinkId) {
        Preconditions.hasValue(applinkId, 'applinkId');
        return new ApplinksRestRequest(this.module.withPath('applicationlink/' + applinkId));
    };

    function ApplinksV2RestModule() {
        this.module = new ApplinksRestModule('2.0');
    }

    function ApplinksV3RestModule() {
        this.module = new ApplinksRestModule('3.0');
    }

    ApplinksV3RestModule.prototype.applink = function(applinkId, dataKeys) {
        Preconditions.hasValue(applinkId, 'applinkId');
        var request = new ApplinksRestRequest(this.module.withPath('applinks/' + applinkId));
        return _addDataKeys(request, dataKeys);
    };

    ApplinksV3RestModule.prototype.applinks = function(dataKeys) {
        var request = new ApplinksRestRequest(this.module.withPath('applinks'));
        return _addDataKeys(request, dataKeys);
    };

    ApplinksV3RestModule.prototype.featureDiscovery = function(featureKey) {
        Preconditions.hasValue(featureKey, 'featureKey');
        return new ApplinksRestRequest(this.module.withPath('feature-discovery/' + featureKey));
    };

    ApplinksV3RestModule.prototype.features = function(featureName) {
        Preconditions.hasValue(featureName, 'featureName');
        return new ApplinksRestRequest(this.module.withPath('features/' + featureName));
    };

    ApplinksV3RestModule.prototype.status = function(applinkId) {
        Preconditions.hasValue(applinkId, 'applinkId');
        return new ApplinksRestRequest(this.module.withPath('status/' + applinkId));
    };

    ApplinksV3RestModule.prototype.oAuthStatus = function(applinkId) {
        Preconditions.hasValue(applinkId, 'applinkId');
        return new ApplinksRestRequest(this.module.withPath('status/' + applinkId + '/oauth'));

    };

    ApplinksV3RestModule.prototype.migration = function(applinkId) {
        Preconditions.hasValue(applinkId, 'applinkId');
        return new ApplinksRestRequest(this.module.withPath('migration/' + applinkId));
    };

    function _addDataKeys(request, dataKeys) {
        if (dataKeys) {
            Preconditions.isArray(dataKeys, 'dataKeys');
            _.each(dataKeys, function (dataKey) {
                request = request.queryParam(PARAM_DATA, dataKey);
            });
        }
        return request;
    }

    var V3Module = new ApplinksV3RestModule();

    /**
     * Data keys supported by the Applinks V3 resource
     */
    V3Module.ApplinkData = {
        APPLICATION_VERSION: 'applicationVersion',
        ATLASSIAN: 'atlassian',
        CAPABILITIES: 'capabilities',
        CONFIG_URL: 'configUrl',
        ICON_URI: 'iconUri',
        EDITABLE: 'editable',
        V3_EDITABLE: 'v3Editable',
        WEB_ITEMS: 'webItems'
    };

    return {
        V1: new ApplinksV1RestModule(),
        V2: new ApplinksV2RestModule(),
        V3: V3Module,
        OAuth: ApplinksOAuthRest
    }
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/rest-oauth.js' */
define('applinks/common/rest-oauth', [
    'applinks/lib/aui',
    'applinks/common/rest-request',
    'applinks/common/preconditions'
], function(
    AJS,
    ApplinksRestRequest,
    Preconditions
) {
    function ApplinksOAuthRestModule(version) {
        Preconditions.hasValue(version, 'version');
        this.baseUrl =  AJS.contextPath() + '/rest/applinks-oauth/' + version + '/';
    }

    ApplinksOAuthRestModule.prototype._withPath = function(path) {
        return this.baseUrl + path;
    };

    function ApplinksOAuthV1RestModule() {
        this.module = new ApplinksOAuthRestModule('1.0');
    }

    ApplinksOAuthV1RestModule.prototype.consumerToken = function(applinkId) {
        Preconditions.hasValue(applinkId, 'applinkId');
        return new ApplinksRestRequest(this.module._withPath('consumer-token/' + applinkId));
    };

    return {
        V1: new ApplinksOAuthV1RestModule()
    }
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/urls.js' */
define('applinks/common/urls', [
    'applinks/lib/aui',
    'applinks/lib/lodash',
    'applinks/common/products'
], function(
    AJS,
    _,
    Products
) {
    var APPLINKS_SERVLET_PATH = '/plugins/servlet/applinks';

    var baseServletPath = _.memoize(function() {
        return AJS.contextPath() + APPLINKS_SERVLET_PATH;
    });

    /**
     * Utility functions for generating URLs in JS, including a link to applinks admin screen.
     */
    var ApplinksUrls = {

        /**
         * Generate a URL from the base and parameters.
         * @param baseUrl the baseUrl
         * @param parametersMap a map of parameters to add, in the form of { parameterName :  parameterValue }
         * @return {String}
         */
        generateUrl: function(baseUrl, parametersMap) {
            var redirectUrl = baseUrl;

            if(_.isUndefined(parametersMap)) {
                return redirectUrl;
            } else {
                _.each(parametersMap, function(value, key) {
                    if(redirectUrl.indexOf('?') < 0) {
                        redirectUrl = redirectUrl + '?';
                    } else {
                        redirectUrl = redirectUrl + '&';
                    }
                    redirectUrl = redirectUrl + key + "=" + encodeURIComponent(JSON.stringify(value))
                });

                return redirectUrl;
            }
        }
    };

    ApplinksUrls.Local = {

        admin: function(params) {
            var url = baseServletPath() + '/listApplicationLinks';
            return ApplinksUrls.generateUrl(url, params);
        },
        edit: function(applinkId, params) {
            var url = baseServletPath() + '/edit/' + applinkId;
            return ApplinksUrls.generateUrl(url, params);
        }
    };

    ApplinksUrls.Remote = {

        /**
         * Generate a URL to remote Applinks Admin screen. For compatibility it needs to accept `applicationTypeId`.
         *
         * @param remoteBaseUrl
         * @param applicationTypeId
         * @param params extra URL params
         * @returns {String}
         */
        admin: function(remoteBaseUrl, applicationTypeId, params) {
            var suffix = applicationTypeId === Products.CONFLUENCE ?
                '/admin/listapplicationlinks.action' :
            APPLINKS_SERVLET_PATH + '/listApplicationLinks';
            var url = remoteBaseUrl + suffix;

            return ApplinksUrls.generateUrl(url, params);
        }
    };

    return ApplinksUrls;
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common', location = 'applinks/internal/common/rest-error.soy' */
// This file was automatically generated from rest-error.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace applinks.common.resterror.
 */

if (typeof applinks == 'undefined') { var applinks = {}; }
if (typeof applinks.common == 'undefined') { applinks.common = {}; }
if (typeof applinks.common.resterror == 'undefined') { applinks.common.resterror = {}; }


applinks.common.resterror.dialogContents = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="' + soy.$$escapeHtml(opt_data.id) + '" class="aui-layer aui-dialog2 aui-dialog2-small aui-dialog2-warning" aria-hidden="true" data-aui-modal="true" data-aui-remove-on-hide="true" data-aui-focus-selector="' + soy.$$escapeHtml(opt_data.id) + '-close-button"><!-- Dialog header --><header class="aui-dialog2-header"><!-- The dialog\'s title --><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Something went wrong') + '</h2><!-- Close icon --><a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Close') + '</span></a></header><!-- Main dialog content --><div class="aui-dialog2-content">' + ((opt_data.errors != null && opt_data.errors.length > 0) ? '\u2028' + applinks.common.resterror.detailedMessage(opt_data) + '\u2028' : applinks.common.resterror.genericMessage(null) + '\u2028') + '</div><!-- Dialog footer --><footer class="aui-dialog2-footer"><!-- Actions to render on the right of the footer --><div class="aui-dialog2-footer-actions"><button id="' + soy.$$escapeHtml(opt_data.id) + '-close-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Close') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  applinks.common.resterror.dialogContents.soyTemplateName = 'applinks.common.resterror.dialogContents';
}


applinks.common.resterror.detailedMessage = function(opt_data, opt_ignored) {
  var output = '<p>' + soy.$$escapeHtml('When contacting the server we received the following error:') + '</p>';
  if (opt_data.errors.length > 1) {
    output += '<ul>';
    var errorList33 = opt_data.errors;
    var errorListLen33 = errorList33.length;
    for (var errorIndex33 = 0; errorIndex33 < errorListLen33; errorIndex33++) {
      var errorData33 = errorList33[errorIndex33];
      output += '<li>' + soy.$$escapeHtml(errorData33.summary) + '</li>';
    }
    output += '</ul>';
  } else {
    output += '<p>' + soy.$$escapeHtml(opt_data.errors[0].summary) + '</p>';
  }
  output += '<p>' + soy.$$escapeHtml('You can try to refresh the page. If the error persists the application logs might provide additional information or you can reach out to your admin.') + '</p>';
  return output;
};
if (goog.DEBUG) {
  applinks.common.resterror.detailedMessage.soyTemplateName = 'applinks.common.resterror.detailedMessage';
}


applinks.common.resterror.genericMessage = function(opt_data, opt_ignored) {
  return '<p>' + soy.$$escapeHtml('The server returned a bad response.') + '</p><p>' + soy.$$escapeHtml('You can try to refresh the page. If the error persists the application logs might provide additional information or you can reach out to your admin.') + '</p>';
};
if (goog.DEBUG) {
  applinks.common.resterror.genericMessage.soyTemplateName = 'applinks.common.resterror.genericMessage';
}
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-new-ui-creation', location = 'js/new/applinks-creation.js' */
(function($, applinksUrls, applinksUtil) {
    AppLinks.Creation = {
        // parameter key names
        CREATION_REMOTE_URL : "applinkStartingUrl",
        CREATION_REMOTE_TYPE : "applinkStartingType",
        ORIGINAL_APPLINK_ID_KEY : "applinkOriginalCreatedId",
        CREATION_STATUS_KEY : "applinkCreationStatus",
        CREATION_STATUS_LOG_KEY : "applinkCreationStatusLog",
        CREATION_STATUS_REASON_KEY : "applinkCreationStatusReason",
        CREATION_SHAREDUSERBASE_KEY : "sharedUserbase",
        CREATION_RESULT_INFO_KEY : "applinkCreationResultInfo",
        CREATION_RESULT_WARN_KEY : "applinkCreationResultWarn",
        CREATION_RESULT_ERROR_KEY : "applinkCreationResultError",
        CREATION_IGNORE_REDIRECTS : "applinkIgnoreRedirects",
        CREATION_CONFIGURE_INCOMING_USER_AUTH : "applinkConfigInUserAuth",
        CREATION_CONFIGURE_INCOMING_SERVER_AUTH : "applinkConfigInServerAuth",
        CREATION_CONFIGURE_INCOMING_PRE_AUTH : "applinkConfigInPreAuth",
        CREATION_CONFIGURE_OUTGOING_USER_AUTH : "applinkConfigOutUserAuth",
        CREATION_CONFIGURE_OUTGOING_SERVER_AUTH : "applinkConfigOutServerAuth",
        CREATION_CONFIGURE_OUTGOING_PRE_AUTH : "applinkConfigOutPreAuth",
        CREATION_EVENT_NEW_APPLINK_TYPE: "applinkCreatedEventNewType",
        CREATION_EVENT_NEW_APPLINK_ID: "applinkCreatedEventNewId",

        // statuses
        STATUS_CREATION_SUCCESS : "completed.creation",
        STATUS_CREATION_FAILURE : "failed.creation",
        STATUS_CREATION_INPROGRESS : "inprogress.creation",
        STATUS_LOCAL_SUCCESS : "completed.creation.local",
        STATUS_RECIPROCAL_SUCCESS : "completed.creation.reciprocal",
        STATUS_RECIPROCAL_INPROGRESS : "inprogress.creation.reciprocal",
        STATUS_LOCAL_FAILURE : "failed.creation.local",
        STATUS_RECIPROCAL_FAILURE : "failed.creation.reciprocal",
        STATUS_REGISTERPROVIDER_2LOI_FAILURE: "failed.registerprovider.2loi",

        // UI features
        userDefinedUrlField: {},
        createAppLinkButton: {},
        // a global holder of the current creation state
        // only used during initiation and "out of process".
        // "in process" the creation state is passed as parameters.
        globalCreationState: null,
        /**
         * Generate a url from the base and parameters.
         * @param baseUrl the baseUrl
         * @param parametersMap a map of parameters to add, in the form of { parameterName :  parameterValue }f
         * @return {*}
         */
        generateUrl: function(baseUrl, parametersMap) {
            return applinksUrls.generateUrl(baseUrl, parametersMap);
        },
        /**
         * Generate a URL to the Applinks Admin screen.
         * @param remoteBaseUrl
         * @param parametersMap
         * @returns {*}
         */
        generateApplinksAdminUrl : function(remoteBaseUrl, remoteTypeId, parametersMap) {
            return applinksUrls.Remote.admin(remoteBaseUrl, remoteTypeId, parametersMap);
        },
        /**
         * Generate the url to use to redirect the user between application during applink creation.
         * @return {*}
         */
        generateApplinksCreationRedirectionUrl: function (allowRedirectionBack, creationState) {
            if(creationState.getIncompatibleApplinksVersion()) {
                return AppLinks.Creation.generateApplinksAdminUrl(creationState.getRemoteApplicationUrl(), creationState.getRemoteApplicationType());
            } else {
                var parametersMap = {};

                if(creationState.getStatusLog().length > 0) {
                    parametersMap[AppLinks.Creation.CREATION_STATUS_LOG_KEY] = JSON.stringify(creationState.getStatusLog());
                }

                // track the ID of the new application link created on the local (application 1)
                if(creationState.getOriginalCreatedApplicationLinkId() !== null) {
                    parametersMap[AppLinks.Creation.ORIGINAL_APPLINK_ID_KEY] = creationState.getOriginalCreatedApplicationLinkId();
                }

                // if the process was started externally make sure we carry the initiatorRedirect around with us.
                if(creationState.getInitiatorRedirect() !== null) {
                    parametersMap[AppLinks.ExternalInitiation.INITIATOR_REDIRECT_KEY] =creationState.getInitiatorRedirect();
                }

                parametersMap[AppLinks.Creation.CREATION_SHAREDUSERBASE_KEY] = creationState.getSharedUserbase();

                parametersMap[AppLinks.Creation.CREATION_CONFIGURE_INCOMING_USER_AUTH] = creationState.getConfigureIncomingUserAuthentication();
                parametersMap[AppLinks.Creation.CREATION_CONFIGURE_INCOMING_SERVER_AUTH] = creationState.getConfigureIncomingServerAuthentication();
                parametersMap[AppLinks.Creation.CREATION_CONFIGURE_INCOMING_PRE_AUTH] = creationState.getConfigureIncomingPreAuthentication();

                parametersMap[AppLinks.Creation.CREATION_CONFIGURE_OUTGOING_USER_AUTH] = creationState.getConfigureOutgoingUserAuthentication();
                parametersMap[AppLinks.Creation.CREATION_CONFIGURE_OUTGOING_SERVER_AUTH] = creationState.getConfigureOutgoingServerAuthentication();
                parametersMap[AppLinks.Creation.CREATION_CONFIGURE_OUTGOING_PRE_AUTH] = creationState.getConfigureOutgoingPreAuthentication();

                if (creationState.isCreatingReciprocal() == true) {
                    //inReciprocalCreation is true when we've come here from another application so we just need to go back there, no url
                    // parameters.
                    return AppLinks.Creation.generateApplinksAdminUrl(creationState.getRemoteApplicationUrl(), creationState.getRemoteApplicationType(), parametersMap);
                }

                if(creationState.getLocalApplication() !== null) {
                    parametersMap[AppLinks.Creation.CREATION_REMOTE_URL] = creationState.getLocalApplication().url;
                    parametersMap[AppLinks.Creation.CREATION_REMOTE_TYPE] = creationState.getLocalApplication().typeId;
                }

                if(allowRedirectionBack != true) {
                    parametersMap[AppLinks.Creation.CREATION_IGNORE_REDIRECTS] = true;
                }

                return AppLinks.Creation.generateApplinksAdminUrl(creationState.getRemoteApplicationUrl(), creationState.getRemoteApplicationType(), parametersMap);
            }
        },
        /**
         * Redirect back to Application, display informational dialog to the user.
         * @return {{wait: Function, done: Function}}
         */
        redirectUserWithDialog: function(allowRedirectionBack, creationState) {
            return {
                'wait': function() {
                    // TODO why is this fixed to be false?
                    AppLinks.Creation.Dialogs.showRedirectPauseDialog(false, creationState.getRemoteApplicationName());
                },
                'done': function(){
                    var redirectUrl = AppLinks.Creation.generateApplinksCreationRedirectionUrl(allowRedirectionBack, creationState);
                    window.location = redirectUrl;
                }};
        },
        /**
         * get the remoteUrl passed to the page
         * @returns {string}
         */
        getSubmittedRemoteUrl: function () {
            return applinksUtil.getParameterValue(AppLinks.Creation.CREATION_REMOTE_URL);
        },
        /**
         * get the statusLog passed to the page
         * @returns {string}
         */
        getSubmittedStatusLog: function () {
            var log = JSON.parse(applinksUtil.getParameterValue(AppLinks.Creation.CREATION_STATUS_LOG_KEY));
            if( log == null) {
                return [];
            }
            return log;
        },
        /**
         * get the sharedUserbase passed to the page
         * @returns {string}
         */
        getSubmittedSharedUserbase: function () {
            var sharedUserbase = applinksUtil.getParameterValue(AppLinks.Creation.CREATION_SHAREDUSERBASE_KEY)
            return sharedUserbase == null ? false : sharedUserbase;
        },
        /**
         * get the original created id passed to the page
         * @returns {string}
         */
        getSubmittedOriginalCreatedId: function () {
            return applinksUtil.getParameterValue(AppLinks.Creation.ORIGINAL_APPLINK_ID_KEY);
        },
        /**
         * Retrieve and Display any outstanding messages
         */
        getAndDisplayOutstandingMessages: function() {
            AppLinks.Creation.displayOutstandingMessages(
                AppLinks.Creation.CREATION_RESULT_INFO_KEY,
                AppLinks.Creation.getOutstandingMessages(AppLinks.Creation.CREATION_RESULT_INFO_KEY));
            AppLinks.Creation.displayOutstandingMessages(
                AppLinks.Creation.CREATION_RESULT_WARN_KEY,
                AppLinks.Creation.getOutstandingMessages(AppLinks.Creation.CREATION_RESULT_WARN_KEY));
            AppLinks.Creation.displayOutstandingMessages(
                AppLinks.Creation.CREATION_RESULT_ERROR_KEY,
                AppLinks.Creation.getOutstandingMessages(AppLinks.Creation.CREATION_RESULT_ERROR_KEY));
        },
        /**
         * Retrieve any outstanding messages
         */
        displayOutstandingMessages: function(key, messages) {
            AJS.$.each(messages, function(index, message) {
                if(key === AppLinks.Creation.CREATION_RESULT_INFO_KEY) {
                    AppLinks.UI.showInfoBox(AppLinks.UI.sanitiseHTML(message));
                }

                if(key === AppLinks.Creation.CREATION_RESULT_WARN_KEY) {
                    AppLinks.UI.showWarningBox(AppLinks.UI.sanitiseHTML(message));
                }

                if(key === AppLinks.Creation.CREATION_RESULT_ERROR_KEY) {
                    AppLinks.UI.showErrorBox(AppLinks.UI.sanitiseHTML(message));
                }
            });

        },
        /**
         * Get any messages for the specified key to display on screen.
         * @param key
         **/
        getOutstandingMessages: function(key) {
            var messageString = applinksUtil.getParameterValue(key, true);
            if (AJS.$.isArray(messageString)) {
                return messageString;
            }
            try {
                var messages = JSON.parse(messageString);
                if(messages != null) {
                return messages;
                }
            }catch(e){
                console.log("Message format invalid:", messageString);
            }
            return [];
        },
        /**
         * Initialize the creation state for the process, regardless of whether there was a creation state before.
         */
        initCreationState: function() {
            AppLinks.Creation.globalCreationState = new CreationState();
        },
        /**
         * get the current global creation state, will initialize it if necessary.
         * @returns {null}
         */
        getCreationState: function() {
            if(AppLinks.Creation.globalCreationState == null) {
                AppLinks.Creation.globalCreationState = new CreationState();
            }
            return AppLinks.Creation.globalCreationState;
        },
        /**
         * Check if processing means the browser will be redirected away form the current page.
         * @returns {boolean}
         */
        aboutToRedirect: function() {
            // no querystring so no processing, so no redirect
            if(window.location.search === "") {
                return false;
            }

            var localCreationState = AppLinks.Creation.getCreationState();

            if(localCreationState.doInitiatorRedirect()) {
                // externally initiated and about to redirect to external target.
                return true;
            } else if(!localCreationState.isCreatingReciprocal() && localCreationState.creationHasCompleted()) {
                // processing has completed so about to redirect to clean the querystring.
                return true;
            } else if(localCreationState.creationInProgress()) {
                // don't load the list if we are mid process as we might be leaving shortly and so might kill the rest call.
                // the completion of the process will cause another re-listing.
                return true;
            } else {
                return false;
            }
        },

        /**
         * Check request parameters and if the specified keys exist fire the event
         */
        fireEventIfApplinkCreated: function() {
            var applinkType = applinksUtil.getParameterValue(AppLinks.Creation.CREATION_EVENT_NEW_APPLINK_TYPE, true);
            var applinkId = applinksUtil.getParameterValue(AppLinks.Creation.CREATION_EVENT_NEW_APPLINK_ID, true);

            if (applinkType && applinkId) {

                var applinkTypeName = AppLinks.I18n.getApplicationTypeName(applinkType);

                /**
                 * devstatus is listening for "applink creation" event, that is fired here.
                 * We have a race condition: sometimes "applinks" fires the event before devstatus is able to register its listener.
                 * The proposed solution is that applinks attaches the required data as body attribute on firing the event,
                 * so in case devstatus finds these attributes it knows the event was already fired and this data can be used.
                 * On the other hand if devstatus could not find the attached attributes
                 * this means that the event is still not fired so it can register the listener
                 */
                var $body = $('body');

                $body.attr("data-created-applink-id", applinkId);
                $body.attr("data-created-applink-type", applinkType);
                $body.attr("data-created-applink-type-name", applinkTypeName);

                $(document).trigger(AppLinks.Event.NEW_APPLINK_CREATED, {
                    id: applinkId,
                    type: applinkType,
                    typeName: applinkTypeName
                });
            }
        }
    };
})(AJS.$, require('applinks/common/urls'), require('applinks/js/util'));
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-new-ui-creation', location = 'js/new/applinks-creation-dialogs.js' */
/**
 * AppLinks.Creation.Dialogs
 * Used to hold the functionality used to build and show create application link dialogs.
 */
(function ($, applinksUtil) {
    AppLinks.Creation.Dialogs = {
        /**
         * Set the enabled/disabled state of the Submit button of the main application links administration page.
         */
        setSubmitStatus: function () {
            var enabled = false;

            // if there is an entry in the application url the submit should be enabled
            if (AppLinks.Creation.userDefinedUrlField.val() !== null
                && AppLinks.Creation.userDefinedUrlField.val() !== ''
                && !AppLinks.Creation.getCreationState().creationInProgress())
            {
                enabled = true;
            }

            applinksUtil.setButtonEnabledState(
                AppLinks.Creation.createAppLinkButton,
                enabled,
                AppLinks.Creation.getCreationState().creationInProgress());
        },

        /**
         * Reset the application links creation process.
         * @param creationState the current creation process state.
         */
        resetProcess: function () {
            AppLinks.Creation.Dialogs.setSubmitStatus();
            AppLinks.Creation.userDefinedUrlField.focus();
        },
        /**
         * Display errors in a ADG error format.
         * @param data the REST response.
         */
        handleRestErrors: function (data) {
            if (data.status == 401) {
                window.location.reload();
            } else {
                var escapedMessage = AJS.escapeHtml(AppLinks.parseError(data));
                AppLinks.UI.showErrorBox(escapedMessage);
            }
        },

        /**
         * Display errors from configuring incoming authentication on Non-UAL in a ADG error format.
         * @param data the REST response.
         */
        handleConfigureIncomingNonUalLinkErrors: function (data) {
            if (data.status == 401) {
                window.location.reload();
            } else {
                // @todo extend error messaging to include a field and then catch 400 errors and highlight the problem field.
                $('.configureIncomingNonUalLinkDialogError')
                    .text(AppLinks.parseError(data)).show();
                $('.aui-icon-wait').remove();
            }
        },

        /**
         * Display errors in a ADG error format.
         * @param data the REST response.
         */
        handleCreateNonUalLinkErrors: function (data) {
            if (data.status == 401) {
                window.location.reload();
            } else {
                var createNonUalLinkDialogError = $('.createNonUalLinkDialogError');
                createNonUalLinkDialogError.text(AppLinks.parseError(data));
                createNonUalLinkDialogError.show();
            }
        },

        /**
         * Display errors in a ADG error format.
         * @param data
         * @param creationState
         */
        handleFetchManifestRestSuccess: function (response, creationState) {
            if (AJS.$.isEmptyObject(response)) {
                //alert('empty response, code set to applinks.warning.host.does-not-support-manifest');
                response.code = "applinks.warning.host.does-not-support-manifest"
                return response;
            }

            if(typeof response.code !== 'undefined') {
                // a success but already contains an error code, so use that.
                return response;
            }

            if (typeof response.applinksVersion == 'undefined' || !applinksUtil.isVersion4OrHigher(response.applinksVersion)) {
                //alert('empty response, code set to applinks.warning.host.does-not-support-manifest');
                response.code = "applinks.warning.incompatible.applinks.version"
                return response;
            }

            // a "good" manifest
            return response;
        },
            /**
         * Display errors in a ADG error format.
         * @param response
         * @param creationState
         */
        handleFetchManifestRestFailure: function (response, creationState) {
            if (response.status == 401) {
                window.location.reload();
            }

            // CORS error. mimic the error handling behaviour of CreateApplicationLinkUIResource.tryToFetchManifest()
            // when unable to retrieve a remote manifest.
            if(response.status == 400) {
                response.warning = "Please enter a valid URL.";
                response.code = 'applinks.error.rpcurl';
                return response;
            }

            // CORS error. mimic the error handling behaviour of CreateApplicationLinkUIResource.tryToFetchManifest()
            // when unable to retrieve a remote manifest.
            if(response.status == 404
                || response.status == 0) {
                response.warning = "No response was received from the URL you entered - it may not be valid. Please fix the URL below, if needed, and click Continue.";
                response.code = 'applinks.warning.unknown.host';
                return response;
            }

            if (response.status == 409) {
                response.warning = AppLinks.parseError(response);
                response.code = 'applinks.warning.host.duplicated';
                return response;
            }

            return response;
        },
        /**
         * Probably only for Dev purposes
         * Display errors in a ADG error format.
         * @param data
         */
        handleRestSuccess: function (data) {

        },
        /**
         * Binds behaviors necessary for applinks-dialogs
         */
        bindDialogBehaviors: function () {
            $('body')
                .on('change', '#applinks-dialog input:checkbox', function (e) {
                    //trigger event for checkbox changes so messages and step indicators get updated.
                    AJS.trigger('checkbox-change.applinks', e.target.id);
                })
                .on('submit', function (event) {
                    //don't submit forms inside of create dialogs.
                    var createDialog = $(event.target).closest('#create-applink-dialog');
                    if (createDialog.length) {
                        event.preventDefault();
                        createDialog.find('.aui-button-primary').click();
                    }
                })
                .on('keydown', function (event) {
                    if (event.keyCode !== 13) {
                        //not enter
                        return;
                    }
                    //don't submit forms inside of create dialogs.
                    var createDialog = $('#create-applink-dialog');
                    if (createDialog.length && createDialog.is(':visible')) {
                        event.preventDefault();
                        createDialog.find('.aui-button-primary').click();
                    }
                })
                .on('keydown', function (event) {
                    if (event.keyCode !== 27) {
                        //not escape
                        return;
                    }
                    var createDialog = $('#create-applink-dialog');
                    if (createDialog.length && createDialog.is(':visible')) {
                        createDialog.find('.applinks-cancel').click();
                    }
                });

            AJS.bind('checkbox-change.applinks', function (event, checkboxId) {
                $('#applinks-dialog').find('.' + checkboxId).toggleClass('hidden');
                $('#applinks-dialog').find('.' + checkboxId + 'Control').prop('disabled', function(idx, oldAttr) {
                    return !oldAttr;
                });
            });

            AJS.bind('remove.dialog', function() {
                AppLinks.Creation.Dialogs.resetProcess();
            });
        },

        showConfigureIncomingNonUalLinkDialog: function (creationState, deferred) {
            var dialog = AppLinks.Creation.Dialogs.buildConfigureIncomingNonUalLinkDialog(creationState)
                .addButton("Continue", function (dialog) {
                    $('.configureIncomingNonUalLinkDialogError').hide();
                    if (AppLinks.Creation.Dialogs.incomingNonUalFieldsAreInvalid() == false) {
                        var consumerName = $('#consumerName').val(),
                            consumerKey = $('#consumerKey').val(),
                            publicKey = $('#publicKey').val(),
                            configuringLink = AppLinks.Creation.Process.configureIncomingNonUalLink(
                                consumerName,
                                consumerKey,
                                publicKey,
                                creationState
                            );

                        applinksUtil.disableButton(dialog.popup.element.find('.aui-button'), true);
                        configuringLink
                            .done(function () {
                                console.log('non-ual incoming link created');
                                dialog.remove();
                                deferred.resolve();
                            })
                            .fail(function(){
                                applinksUtil.enableButton(dialog.popup.element.find('.aui-button'));
                            });
                    }
                }, 'aui-button aui-button-primary')
                .addLink("Cancel", function (dialog) {
                    //cancel
                    console.log('non-ual incoming link cancel');
                    //always set the status to Success because if we are here we must have created the link previously.
                    // And for the same reason don't call AppLinks.Creation.initCreationState() as we need the state from the previous creation.
                    creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_SUCCESS);
                    deferred.resolve();
                    dialog.remove();
                }, 'applinks-cancel');
            $('.configureIncomingNonUalLinkDialogError').hide();
            $('#applinks-configure-incoming-nonual-form .error').hide();
            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        buildConfigureIncomingNonUalLinkDialog: function (creationState) {
            var dialog = new AJS.Dialog({width: 500, height: 500, id: "create-applink-dialog", closeOnOutsideClick: false, keypressListener: $.noop}),
                headerMessage = "Link applications";

            //Create non-ual link dialog
            dialog
                .addHeader(headerMessage)
                .addPanel("Test", applinks.templates.getConfigureIncomingNonUalLinkDialog({
                    fromApp: creationState.getRemoteApplication(),
                    toApp: creationState.getLocalApplication()
                }));

            return dialog;
        },
        showCreateNonUalLinkDialog: function (typeOptions, creationState) {
            // TODO APLDEV-3 if oauth not installed then just create link from url and name
            var dialog = AppLinks.Creation.Dialogs.buildCreateNonUalLinkDialog(creationState, typeOptions)
                .addButton("Continue", function (dialog) {
                    $('.createNonUalLinkDialogError').hide();
                    if (AppLinks.Creation.Dialogs.outgoingNonUalFieldsAreValid()) {
                        var name = $('#application-name-new').val(),
                            typeId = $('#application-types-new').find('option:selected').val(),
                            rpcUrl = AppLinks.UI.addProtocolToURL($('#non-ual-application-url').val()),
                            accessTokenUrl = $('#accessTokenUrl').val(),
                            requestTokenUrl = $('#requestTokenUrl').val(),
                            consumerKey = $('#consumerKey').val(),
                            authorizeUrl = $('#authorizeUrl').val(),
                            sharedSecret = $('#sharedSecret').val(),
                            serviceProvider = $('#serviceProvider').val(),
                            createIncoming = $('#createIncoming').is(':checked');

                        applinksUtil.disableButton(dialog.popup.element.find('.aui-button'), true);
                        var creatingOutgoing = AppLinks.Creation.Process.createOutgoingNonUalLink(
                            name,
                            typeId,
                            rpcUrl,
                            accessTokenUrl,
                            requestTokenUrl,
                            consumerKey,
                            authorizeUrl,
                            sharedSecret,
                            serviceProvider,
                            createIncoming,
                            creationState);

                        creatingOutgoing.progress(function () {
                            dialog.remove();
                        });
                        creatingOutgoing.done(function () {
                            applinksUtil.waitUntilDone(function () {
                                return AppLinks.Creation.Process.successNoRedirect(creationState);
                            })();
                        });
                        creatingOutgoing.fail(function () {
                            applinksUtil.enableButton(dialog.popup.element.find('.aui-button'));
                            //@todo: handle promise rejection, likely an ajax call failure.
                        });
                    }
                }, 'aui-button aui-button-primary');

            // if not initiated locally allow the use to stop the process
            if (!creationState.doInitiatorRedirect()) {
                dialog.addLink("Cancel", function (dialog) {
                    //cancel
                    console.log('non-ual link cancel');
                    // cancelled so clear the state
                    AppLinks.Creation.initCreationState();
                    // the dialog.remove event will trigger a call to resetProcess to reset the UI.
                    dialog.remove();
                }, 'applinks-cancel');
            }
            $('.createNonUalLinkDialogError').hide();
            $('#applinks-create-nonual-form .error').hide();
            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        buildCreateNonUalLinkDialog: function (creationState, typeOptions) {
            var dialog = new AJS.Dialog({width: 500, height: 500, id: "create-applink-dialog", closeOnOutsideClick: false, keypressListener: $.noop}),
                headerMessage = "Link applications";

            //Create non-ual link dialog
            dialog
                .addHeader(headerMessage)
                .addPanel("Test", applinks.templates.getCreateNonUalLinkDialog({
                    fromApp: creationState.getRemoteApplication(),
                    toApp: creationState.getLocalApplication(),
                    typeOptions: typeOptions
                }));

            return dialog;
        },
        /**
         * Get the function to call when the creation process is complete.
         * This will determine if the browser is to be redirected, the local page refreshed etc.
         * @param creationState
         * @param isAdmin
         * @returns {Function}
         */
        getCreationCompleteFunction: function (creationState) {

            // if we are creating a unconfigured link then we are not going to redirect anywhere.
            if(creationState.getCreateUnconfiguredLink()) {
                if (creationState.getIncompatibleApplinksVersion()) {
                    // if the reason is because the remote app is an incompatible version then
                    // complete the process locally.
                    return function() {
                        creationState.updateStatusLog(AppLinks.Creation.STATUS_LOCAL_SUCCESS);
                        return AppLinks.Creation.Process.successNoRedirect(creationState);
                    };
                } else {
                    // if the reason is because the user unchecked the admin option.
                    // the provide them with the url to go and complete the process in that application.
                    return function() {
                        creationState.updateStatusLog(AppLinks.Creation.STATUS_LOCAL_SUCCESS);
                        return AppLinks.Creation.Process.successManualRedirect(creationState);
                    };
                }
            }

            // if we are simply not respecting redirects then complete the process locally.
            if(!creationState.getRespectRedirects()) {
                return function() {
                    return AppLinks.Creation.Process.successNoRedirect(creationState);
                }
            }

            // if we are creating the reciprocal then return to the originating application on completion.
            if(creationState.isCreatingReciprocal()) {
                return function () {
                    return AppLinks.Creation.Process.successRedirectToReturn(creationState);
                }
            }

            // default behaviour is to complete processing on this app and then continue on the remote app.
            return function () {
                        return AppLinks.Creation.Process.successRedirectToCreateReciprocal(creationState);
                    };
        },
        /**
         * Start the Application Link Creation process.
         * Determines which type of link to create, start that process and handles closing the parent dialog when the process is complete.
         * @param creationState
         * @param dialog
         */
        beginApplicationLinkCreation: function (creationState, dialog)
        {
            var completeCreationFunction = AppLinks.Creation.Dialogs.getCreationCompleteFunction(creationState);

            //create the local link.
            applinksUtil.disableButton(dialog.popup.element.find('.aui-button'), true);

            var ualLinkCreation;
            if (!AppLinks.Creation.Process.twoStageCreation) {
                ualLinkCreation = AppLinks.Creation.Process.createUalLinkAndConfigureIncomingAndOutgoing(creationState);
            } else {
                // 2-stage Local Creation: the following would support creation of the link and configure incoming authentication in the local app,
                // before redirecting to the remote app to create a link and configure incoming and outgoing authentication
                // before redirecting to the local app to configure the outgoing authentication.
                // likewise if creating a link with an incompatible version of Applinks confiugre as much as possible before being redirected.
                if (creationState.isCreatingReciprocal()) {
                    ualLinkCreation = AppLinks.Creation.Process.createUalLinkAndConfigureIncomingAndOutgoing(creationState);
                }
                else {
                    if (creationState.getCreateUnconfiguredLink()) {
                        ualLinkCreation = AppLinks.Creation.Process.createUrlLink(creationState);
                    } else {
                        ualLinkCreation = AppLinks.Creation.Process.createUalLinkAndConfigureIncoming(creationState);
                    }
                }
            }

            ualLinkCreation.progress(function () {
                dialog.remove();
            });
            ualLinkCreation.done(function () {
                applinksUtil.waitUntilDone(completeCreationFunction)();
            });
            ualLinkCreation.fail(function () {
                //@todo: handle promise rejection, likely an ajax call failure.
            });
        },
        /**
         * Show a dialogue to confirm the discrepancy between (entered) RPC URL and the one returned from the remote manifest.
         *
         * @param creationState
         */
        showConfirmUrlsDialog: function (creationState) {
            var dialog = AppLinks.Creation.Dialogs.buildConfirmUrlsDialog(creationState)
                .addButton("Continue", function (dialog) {

                    var rpcUrlEdited = $('#application-url-rpc').val();

                    // clear the dialogue regardless
                    dialog.remove();

                    if (rpcUrlEdited != creationState.getCorrectedUrl()) {

                        // url has been updated by the user; restart the process with the new URL
                        creationState.setUserDefinedUrl(rpcUrlEdited);
                        creationState.setCorrectedUrl(rpcUrlEdited);
                        AppLinks.Creation.Process.fetchManifests(false, creationState);
                    } else {

                        // set the RPC url in the remote manifest then create the link
                        creationState.getRemoteApplication().rpcUrl = creationState.getCorrectedUrl();
                        AppLinks.Creation.Dialogs.showCreateApplinkDialog(creationState);
                    }

                }, 'aui-button aui-button-primary')
                .addLink("Cancel", function (dialog) {

                    // cancelled so clear the state
                    AppLinks.Creation.initCreationState();
                    dialog.remove();
                }, 'applinks-cancel');

            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        buildConfirmUrlsDialog: function (creationState) {
            var dialog = new AJS.Dialog({width: 500, height: 500, id: "create-applink-dialog", closeOnOutsideClick: false, keypressListener: $.noop}),
                headerMessage = "Confirm URLs";

            // confirm that RPC URL is different to display URL
            dialog
                .addHeader(headerMessage)
                .addPanel(headerMessage, applinks.templates.getConfirmUrlsDialog({
                        displayUrl: creationState.getRemoteApplication().url,
                        rpcUrl: creationState.getCorrectedUrl()
                    }));

            return dialog;
        },
        showCreateApplinkDialog: function (creationState) {
            var dialog = AppLinks.Creation.Dialogs.buildCreateApplinkDialog(creationState)
                .addButton("Continue", function (dialog) {
                    var isAdmin = $('#isAdmin').is(":checked");
                    // if not an admin then just create an unconfigured link,
                    // but only if not creating a recirocal link, as we can assume we are an admin
                    // and therefore create a full link.
                    creationState.setCreateUnconfiguredLink(!isAdmin && !creationState.isCreatingReciprocal());

                    AppLinks.Creation.Dialogs.beginApplicationLinkCreation(creationState, dialog);
                }, 'aui-button aui-button-primary');

            // if not initiated locally allow the user to cancel the process
            if (!creationState.doInitiatorRedirect()) {
                dialog.addLink("Cancel", function (dialog) {
                    //cancel
                    console.log('ual link cancel');
                    // cancelled so clear the state
                    AppLinks.Creation.initCreationState();
                    if(creationState.isCreatingReciprocal()) {
                        creationState.updateStatusLog(AppLinks.Creation.STATUS_RECIPROCAL_FAILURE, "reciprocalCreationSkipped");
                        AppLinks.Creation.Process.showFinalStatus(creationState);
                    }

                    // the dialog.remove event will trigger a call to resetProcess to reset the UI.
                    dialog.remove();
                }, 'applinks-cancel');
            }
            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        /**
         * Build the create applinks workflow 2.0 dialog.
         *
         * @param creationState
         */
        buildCreateApplinkDialog: function (creationState) {
            var dialog = new AJS.Dialog({width: 500, height: 500, id: "create-applink-dialog", closeOnOutsideClick: false, keypressListener: $.noop}),
                headerMessage = "Link applications";

            console.log('Start creation process');

            //Create application link dialog.
            dialog
                .addHeader(headerMessage)
                .addPanel("Test", applinks.templates.getCreateUalLinkDialog({
                    reciprocal: creationState.isCreatingReciprocal(),
                    fromApp: creationState.getRemoteApplication(),
                    toApp: creationState.getLocalApplication(),
                    isSysAdmin: applinksUtil.isSysAdmin(),
                    sharedUserbase: creationState.getSharedUserbase(),
                    isUsingCors: creationState.getUseCors(),
                    impersonationIsSupported: (applinksUtil.applicationSupportsIncomingTwoLeggedOAuthWithImpersonation(creationState.getLocalApplication()) &&
                    applinksUtil.applicationSupportsIncomingTwoLeggedOAuthWithImpersonation(creationState.getRemoteApplication()))
                }));

            // apply any relevant defaults provided by the intitiator..
            AppLinks.ExternalInitiation.setDialogInitiatorDefaults(creationState);

            // if linking to an older version of AppLinks, hide the admin option
            // to prevent redirecting to the remote application
            if(creationState.getIncompatibleApplinksVersion()) {
                // uncheck
                $('#isAdmin').prop('checked', false);
                // hide checkbox
                $('#isAdmin').hide();
                // hide label
                $('label[for="isAdmin"]').hide();
                // hide any warning messages
                $('.isAdmin').hide();
            }

            return dialog;
        },
        showManuallyCreateReciprocalLinkDialog: function (remoteApplicationName, remoteApplicationUrl, localApplicationUrl, allowRedirectionBack, creationState) {
            var dialog = AppLinks.Creation.Dialogs.buildManuallyCreateReciprocalLinkDialog(remoteApplicationName,
                    AppLinks.Creation.generateApplinksCreationRedirectionUrl(allowRedirectionBack, creationState))
                .addLink("Close", function (dialog) {
                    creationState.updateStatusLog(AppLinks.Creation.STATUS_RECIPROCAL_FAILURE, "reciprocalCreationSkipped");
                    console.log('non-ual link close');
                    dialog.remove();
                    //cancel
                    // don't initCreationState until we've shown the final status.
                    AppLinks.Creation.Process.showFinalStatus(creationState);
                }, 'applinks-cancel');
            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        /**
         * Build the dialog to display manual reciprocal applink..
         */
        buildManuallyCreateReciprocalLinkDialog: function (redirectApp, redirectUrl) {
            var dialog = new AJS.Dialog({width: 500, height: 500, id: "create-applink-dialog", closeOnOutsideClick: false, keypressListener: $.noop}),
                headerMessage = "Create reciprocal link";

            //Create application link dialog.
            dialog
                .addHeader(headerMessage)
                .addPanel("Test", applinks.templates.getManualRedirectDialog({
                    redirectApp: redirectApp,
                    redirectUrl: redirectUrl
                }));

            return dialog;
        },
        /**
         * Show a dialog informing the user that a duplicate link has been found, topping the process and offer them the option of redirecting back to
         * the originating application.
         * @return {*}
         */
        showReciprocalDuplicateDialog: function (remoteUrl, message, creationState) {
            // Creating a reciprocal link but can't read the manifest from the originating application
            // Probably firewall/routing problem
            // e.g. BTF instance trying to set up a reciprocal connection to a OD instance
            var warning = message;
            var information = AJS.format("Click Continue to be redirected back to {0}.", remoteUrl);

            // if initiated locally allow the use to stop the process
            if (!creationState.doInitiatorRedirect()) {
                information = information + " " + "Click Close to remain here.";
            }

            creationState.updateStatusLog(AppLinks.Creation.STATUS_RECIPROCAL_FAILURE, 'reciprocalDuplicateLinkExists');

            var dialog = AppLinks.Creation.Dialogs.buildUnableToCreateReciprocalLinkDialog(warning, information)
                .addButton("Continue", function (dialog) {
                    console.log('Duplicate AppLink. redirect back');
                    // Continue - redirect to the original application
                    applinksUtil.waitUntilDone(function () {
                            // TODO check creationState is reciprocal status == true
                            return AppLinks.Creation.redirectUserWithDialog(false, creationState);
                        }
                    )();
                    dialog.remove();
                }, 'aui-button aui-button-primary');

            // if initiated locally allow the use to stop the process
            if (!creationState.doInitiatorRedirect()) {
                dialog.addLink("Close", function (dialog) {
                    // Cancel - stay inthe current application
                    console.log('Duplicate Applink. cancelled redirect');
                    dialog.remove();
                    // don't initCreationState until we've shown the final status.
                    AppLinks.Creation.Process.showFinalStatus(creationState);
                }, 'applinks-cancel');
            }
            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        /**
         * Show the dialog handling URL configuration
         * @param message
         * @param ignoreErrors assumed to be true, i.e. trust the user if they want this url.
         * @param creationState
         * @returns {*}
         */
        showConfigureUrlDialog: function (message, ignoreErrors, creationState, showSelectOptions) {
            //Display URL problems to the user.
            var dialog = AppLinks.Creation.Dialogs.buildConfigureUrlDialog(message, showSelectOptions, creationState)
                .addButton("Continue", function (dialog) {
                    var applicationUrlEdited = $('#application-url-corrected');

                    var checkedUrl = $('#use-application-url input[type="checkbox"]:checked');
                    if (checkedUrl.length > 0) {
                        // user has decided to ignore the corrected url and just use the user defined one.
                        creationState.setCorrectedUrl(creationState.getUserDefinedUrl())
                        ignoreErrors = true;
                    } else if (applicationUrlEdited.val() != creationState.getCorrectedUrl()) {
                        // user has manually edited the url
                        // so update the correct Url
                        var url = applicationUrlEdited.val();
                        creationState.setCorrectedUrl(url)
                        // make sure it gets rechecked
                        forceWhenHostIsOffline = false;
                        ignoreErrors = false;
                    }

                    dialog.remove();
                    // try to load amended url again...
                    AppLinks.Creation.Process.fetchManifests(ignoreErrors, creationState);
                }, 'aui-button aui-button-primary')
                .addLink("Cancel", function (dialog) {
                    //cancel
                    // cancelled so clear the state
                    AppLinks.Creation.initCreationState();
                    // the dialog.remove event will trigger a call to resetProcess to reset the UI.
                    dialog.remove();
                }, 'applinks-cancel');
            dialog.show();
            dialog.updateHeight();
            $('#application-url-corrected').focus();
            return dialog;
        },
        /**
         * Build the dialog to handle problems with the initial application url.
         *
         * Nominal Step 0 in Create App Link workflow.
         */
        buildConfigureUrlDialog: function (urlErrorMessage, showSelectOptions, creationState) {
            var dialog = new AJS.Dialog({width: 500, height: 500, id: "create-applink-dialog", closeOnOutsideClick: false, keypressListener: $.noop}),
                headerMessage = "Configure Application URL";

            //Create dialog.
            dialog
                .addHeader(headerMessage)
                .addPanel("configure-url", applinks.templates.getConfigureUrlDialog({
                    originalUrl: creationState.getUserDefinedUrl(),
                    correctedUrl: creationState.getCorrectedUrl(),
                    urlErrorMessage: urlErrorMessage,
                    showSelectOptions: showSelectOptions
                }));

            return dialog;
        },
        /**
         * Show a dialog informing the user that an incompatible version of Applinks has been detected,
         * stop the process and offer to redirect them to the other application.
         * @param creationState the configuration of the current creation process.
         * @return {*}
         */
        showIncompatibleApplinksVersionDialog: function (creationState) {
            // Creating a reciprocal link but can't read the manifest from the originating application
            // Probably firewall/routing problem
            // e.g. BTF instance trying to set up a reciprocal connection to a OD instance
            var dialog = AppLinks.Creation.Dialogs.buildIncompatibleApplinksVersionDialog(creationState)
                .addButton("Continue", function (dialog) {
                    // Continue - create local end of the link
                    console.log('Incompatible AppLink Versions. Continue to create local link end');
                    creationState.setIncompatibleApplinksVersion(true);

                    // continue to create a local url only link
                    creationState.setCreateUnconfiguredLink(true);
                    AppLinks.Creation.Dialogs.beginApplicationLinkCreation(creationState, dialog);
                }, 'aui-button aui-button-primary');
            // if initiated locally allow the use to stop the process
            if (!creationState.doInitiatorRedirect()) {
                dialog.addLink("Close", function (dialog) {
                        // Cancel - stay in the current application, do not create anything.
                        console.log('Incompatible AppLink Versions. cancelled creation');
                        // cancelled so clear the state
                        AppLinks.Creation.initCreationState();
                        dialog.remove();
                    }, 'applinks-cancel');
            }
            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        /**
         * Build the dialog to tell the user about incompatible AppLinks versions.
         * @param creationState the current process state including the display name  and url of the remote application.
         * @return {AJS.Dialog}
         */
        buildIncompatibleApplinksVersionDialog: function (creationState) {
            var warning = AJS.format("The remote application, \u0027\u0027{0}\u0027\u0027, is running an older version of the Application Links plugin. It will not be possible to create the remote end of the link from this application. However both ends of the link can be created using the older process in \u0027\u0027{0}\u0027\u0027.", creationState.getRemoteApplicationName());

            var informationLinkText = AJS.format("Click here to transfer to \u0027\u0027{0}\u0027\u0027 to create the link.", AppLinks.UI.sanitiseHTML(creationState.getRemoteApplicationName()));
            var informationLink = '<a href="' + AppLinks.Creation.generateApplinksAdminUrl(creationState.getRemoteApplicationUrl(), creationState.getRemoteApplicationType()) + '">' + informationLinkText + '</a>';
            var informationHtml = informationLink + " " + "Alternatively click Continue to create the local end of the link only.";
            var dialog = new AJS.Dialog({width: 500, height: 500, id: "create-applink-dialog", closeOnOutsideClick: false, keypressListener: $.noop}),
                headerMessage = "Create reciprocal link.";

            //Create application link dialog.
            dialog
                .addHeader(headerMessage)
                .addPanel("applinks-dialog-panel", applinks.templates.getInformationDialog({
                    warningHtml: AppLinks.UI.sanitiseHTML(warning),
                    informationHtml: informationHtml
                }));

            return dialog;
        },
        /**
         * Show a dialog informing the user that creation has completed,
         * Offer to redirect them to the other application.
         * @param creationState the configuration of the current creation process.
         * @return {*}
         */
        showIncompatibleApplinksVersionCompletionDialog: function (creationState) {
            // Creating a reciprocal link but can't read the manifest from the originating application
            // Probably firewall/routing problem
            // e.g. BTF instance trying to set up a reciprocal connection to a OD instance
            var dialog = AppLinks.Creation.Dialogs.buildIncompatibleApplinksVersionCompletionDialog(creationState)
                .addButton("Continue", function (dialog) {
                    console.log('Incompatible AppLink Versions. redirect to other app');
                    // Continue - redirect to the other application
                    applinksUtil.waitUntilDone(function () {
                            // TODO check creationState is reciprocal status == false
                            return AppLinks.Creation.redirectUserWithDialog(false, creationState);
                        }
                    )();
                    dialog.remove();
                }, 'aui-button aui-button-primary')
                .addLink("Close", function (dialog) {
                    // Cancel - stay inthe current application
                    console.log('Incompatible AppLink Versions. cancelled redirect');
                    creationState.updateStatusLog(AppLinks.Creation.STATUS_LOCAL_FAILURE, 'reciprocalIncompatibleVersion');
                    // don't initCreationState until we've shown the final status.
                    AppLinks.Creation.Process.showFinalStatus(creationState);
                    dialog.remove();
                }, 'applinks-cancel');
            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        /**
         * Build the dialog to allow the user to redirect to the remote application after configuring the local link
         * when there are incompatible AppLinks versions.
         * @param creationState the current process state including the display name  and url of the remote application.
         * @return {AJS.Dialog}
         */
        buildIncompatibleApplinksVersionCompletionDialog: function (creationState) {
            var information = AJS.format("Click Continue to redirect to \u0027\u0027{0}\u0027\u0027 where you can create the reciprocal link. Click Close to remain here.", creationState.getRemoteApplicationName());
            var dialog = new AJS.Dialog({width: 500, height: 500, id: "create-applink-dialog", closeOnOutsideClick: false, keypressListener: $.noop}),
                headerMessage = "Create reciprocal link.";

            //Create application link dialog.
            dialog
                .addHeader(headerMessage)
                .addPanel("applinks-dialog-panel", applinks.templates.getInformationDialog({
                    warning: null,
                    informationHtml: AppLinks.UI.sanitiseHTML(information)
                }));

            return dialog;
        },
        showProcessingPauseDialog: function (creationState) {
            var dialog = AppLinks.Creation.Dialogs.buildProcessingPauseDialog(creationState);
            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        buildProcessingPauseDialog: function (creationState) {
            var message = "Completing the configuration of the link.",
                headerMessage = "Processing...";

            return AppLinks.Creation.Dialogs.buildPauseDialog(headerMessage, message);
        },
        /**
         * Show the dialog to pause user between redirects.
         * @param creatingReciprocal flag indicating if "true" that the user is currently creating a a reciprocal link
         *  or "false" the users is creating the originating link.
         * @param remoteApplicationName the name of the remote application.
         * @return {AJS.Dialog}
         */
        showRedirectPauseDialog: function (creatingReciprocal, remoteApplicationName) {
            var dialog = AppLinks.Creation.Dialogs.buildRedirectPauseDialog(creatingReciprocal, remoteApplicationName);
            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        /**
         * Build the dialog to pause user between redirects.
         * @param creatingReciprocal flag indicating if "true" that the user is currently creating a a reciprocal link
         *  or "false" the users is creating the originating link.
         * @param remoteApplicationName the name of the remote application.
         * @return {AJS.Dialog}
         */
        buildRedirectPauseDialog: function (creatingReciprocal, remoteApplicationName) {
            var message,
                headerMessage = "Redirecting...";

            if (creatingReciprocal == true) {
                message = AJS.format("You are now being redirected to {0} to create the reciprocal link.", remoteApplicationName);
            } else {
                message = AJS.format("You are now being redirected to {0}.", remoteApplicationName);
            }

            return AppLinks.Creation.Dialogs.buildPauseDialog(headerMessage, message);
        },
        /**
         * Show a dialog informing the user that a reciprocal link cannot be created and offer them an option to return to
         * the originating application.
         * @param creationState the configuration of the current creation process.
         * @returns {*}
         */
        showReciprocalManifestUnobtainableDialog: function (creationState) {
            var warning = AJS.format("It has not been possible to retrieve the required information from {0}. Therefore the link cannot be created.", creationState.getCorrectedUrl())

            var information = AJS.format("Click Continue to be redirected back to {0}.", creationState.getCorrectedUrl());
            // if initiated locally allow the use to stop the process
            if (!creationState.doInitiatorRedirect()) {
                information = information + " " + "Click Close to remain here.";
            }

            var dialog = AppLinks.Creation.Dialogs.buildUnableToCreateReciprocalLinkDialog(warning, information)
                .addButton("Continue", function (dialog) {
                    console.log('Remote manifest unobtainable. redirect back');
                    // Continue - redirect to the original application
                    applinksUtil.waitUntilDone(function () {
                            creationState.updateStatusLog(AppLinks.Creation.STATUS_RECIPROCAL_FAILURE, 'reciprocalUnableToReadManifest');
                            // TODO check creationState is reciprocal status == true
                            return AppLinks.Creation.redirectUserWithDialog(false, creationState);
                        }
                    )();
                    dialog.remove();
                }, 'aui-button aui-button-primary');

            // if process was initiated externally then don't allow closing/stopping of the process.
            if (!creationState.doInitiatorRedirect()) {
                dialog.addLink("Close", function (dialog) {
                    // Cancel - stay inthe current application
                    console.log('Remote manifest unobtainable. cancelled redirect');
                    if(creationState.isCreatingReciprocal()) {
                        creationState.updateStatusLog(AppLinks.Creation.STATUS_RECIPROCAL_FAILURE, "reciprocalUnableToReadManifest");
                        AppLinks.Creation.Process.showFinalStatus(creationState);
                    }
                    dialog.remove();
                }, 'applinks-cancel');
            }
            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        /**
         * Build the dialog to inform the User that we have been unable to create reciprocal link.
         * Offers them the option to redirect back to their original app.
         * @param warning a warning message specific to the current process.
         * @param information an information message explaining what happens next..
         * @return {AJS.Dialog}
         */
        buildUnableToCreateReciprocalLinkDialog: function (warning, information) {
            var dialog = new AJS.Dialog({width: 500, height: 500, id: "create-applink-dialog", closeOnOutsideClick: false, keypressListener: $.noop}),
                headerMessage = "Unable to create reciprocal link.";

            //Create application link dialog.
            dialog
                .addHeader(headerMessage)
                .addPanel("applinks-dialog-panel", applinks.templates.getInformationDialog({
                    warningHtml: AppLinks.UI.sanitiseHTML(warning),
                    informationHtml: AppLinks.UI.sanitiseHTML(information)
                }));

            return dialog;
        },
        /**
         * Show a dialog informing the user that the applinks creation process is not possible.
         * @param creationState the configuration of the current creation process.
         * @param information an information message explaining what happens next..
         * @returns {*}
         */
        showApplinkCreationWorkflowNotAvailableDialog: function (information, creationState) {
            var warning = "The Application Link creation process is unavailable, possibly because you do not have the required administrator rights on this instance.";
            // if initiated remotely prevent the user stopping the process
            if (creationState.doInitiatorRedirect()) {
                information = information.replace("or Close to remain here", "");
            }

            var dialog = AppLinks.Creation.Dialogs.buildApplicationLinkWorkflowUnavailableDialog(warning, information)
                .addButton("Continue", function (dialog) {
                    console.log('Workflow unavailable. redirect back');
                    // Continue - redirect to the original application
                    applinksUtil.waitUntilDone(function () {
                            creationState.updateStatusLog(AppLinks.Creation.STATUS_RECIPROCAL_FAILURE, 'reciprocalWorkflowUnavailable');
                            // TODO check creationState is reciprocal status == true
                            return AppLinks.Creation.redirectUserWithDialog(false, creationState);
                        }
                    )();
                    dialog.remove();
                }, 'aui-button aui-button-primary');

            // if process was initiated externally then don't allow closing/stopping of the process.
            if (!creationState.doInitiatorRedirect()) {
                dialog.addLink("Close", function (dialog) {
                    // Cancel - stay inthe current application
                    console.log('Workflow unavailable. cancelled redirect');
                    dialog.remove();
                }, 'applinks-cancel');
            }
            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        /**
         * Build the dialog to inform the User the Applink creation workflow is unavailable.
         * Offers them the option to redirect back to their original app.
         * @param warning a warning message specific to the current process.
         * @param information an information message explaining what happens next..
         * @return {AJS.Dialog}
         */
        buildApplicationLinkWorkflowUnavailableDialog: function (warning, information) {
            var dialog = new AJS.Dialog({width: 500, height: 500, id: "create-applink-dialog", closeOnOutsideClick: false, keypressListener: $.noop}),
                headerMessage = "Link creation unavailable";

            //Create application link dialog.
            dialog
                .addHeader(headerMessage)
                .addPanel("applinks-dialog-panel", applinks.templates.getInformationDialog({
                    warningHtml: AppLinks.UI.sanitiseHTML(warning),
                    informationHtml: AppLinks.UI.sanitiseHTML(information)
                }));

            return dialog;
        },
        /**
         * Show a dialog informing the user that a duplicate link has been found, stopping the process.
         * @param warning the warning message
         * @return {*}
         */
        showLocalDuplicateDialog: function (warning, creationState) {
            var dialog = AppLinks.Creation.Dialogs.buildCreateLinkErrorDialog(warning)

            // if the creation process was initiated externally then redirect back
            if (creationState.doInitiatorRedirect()) {
                dialog.addButton("Continue", function (dialog) {
                    creationState.updateStatusLog(AppLinks.Creation.STATUS_LOCAL_FAILURE, 'localDuplicateLinkExists');
                    // redirect to the initiator redirect
                    AppLinks.ExternalInitiation.redirectToInitiatorRedirect(creationState);
                    dialog.remove();
                }, 'aui-button aui-button-primary')
            } else {
                dialog.addLink("Close", function (dialog) {
                    // Cancel - stay inthe current application
                    console.log('Duplicate Applink. cancelled');
                    // cancelled so clear the state
                    AppLinks.Creation.initCreationState();
                    dialog.remove();
                }, 'applinks-cancel');
            }

            dialog.show();
            dialog.updateHeight();
            return dialog;
        },
        /**
         * Build the dialog to inform the User that the url they have entered is a duplicate.
         * @param warning a warning message.
         * @return {AJS.Dialog}
         */
        buildCreateLinkErrorDialog: function (warning) {
            var dialog = new AJS.Dialog({width: 500, height: 500, id: "create-applink-dialog", closeOnOutsideClick: false, keypressListener: $.noop}),
                headerMessage = "Unable to create link.";

            //Create application link dialog.
            dialog
                .addHeader(headerMessage)
                .addPanel("applinks-dialog-panel", applinks.templates.getInformationDialog({
                    warningHtml: AppLinks.UI.sanitiseHTML(warning),
                    informationHtml: null
                }));

            return dialog;
        },
        /**
         * Build the generic Pause dialog
         * @param headerMessage the header message.
         * @param message the mian message.
         * @return {AJS.Dialog}
         */
        buildPauseDialog: function (headerMessage, message) {
            var dialog = new AJS.Dialog({width: 400, height: 200, id: "create-applink-dialog", closeOnOutsideClick: false, keypressListener: $.noop});

            //Create application link dialog.
            dialog
                .addHeader(headerMessage)
                .addPanel("Test", applinks.templates.getPauseDialog({
                    message: AppLinks.UI.sanitiseHTML(message)
                }));

            return dialog;
        },

        // VALIDATION
        setAuthenticationFieldsAsRequired: function () {
            $('#applinks-nonual-oath-configuration').children().find("label").append("<span class='aui-icon icon-required'></span>");
        },

        /**
         * Check user defined authentication fields are valid for submission.
         * @return {boolean}
         */
        authenticationFieldsAreInValid: function () {
            //if they are all empty we don't need to validate
            if ($('#accessTokenUrl').val() == ""
                && $('#requestTokenUrl').val() == ""
                && $('#consumerKey').val() == ""
                && $('#authorizeUrl').val() == ""
                && $('#sharedSecret').val() == ""
                && $('#serviceProvider').val() == "") {
                return false;
            }

            // validate in reverse order so the error field highest up the UI has focus.
            return !AppLinks.Creation.Dialogs.validateFields(['#serviceProvider', '#consumerKey', '#sharedSecret', '#requestTokenUrl', '#accessTokenUrl', '#authorizeUrl']);
        },

        incomingNonUalFieldsAreInvalid: function () {
            var invalid = !AppLinks.Creation.Dialogs.validateFields(['#consumerKey', '#consumerName', '#publicKey']);

            return invalid;
        },

        outgoingNonUalFieldsAreValid: function () {
            if (AppLinks.Creation.Dialogs.applicationLinkFieldsAreInValid()) {
                return false;
            } else if (AppLinks.Creation.Dialogs.authenticationFieldsAreInValid()) {
                AppLinks.Creation.Dialogs.setAuthenticationFieldsAsRequired();
                return false;
            }
            return true
        },

        /**
         * Check user entered ApplicationLink fields are valid for submission.
         * @return {boolean}
         */
        applicationLinkFieldsAreInValid: function () {
            var invalid = !AppLinks.Creation.Dialogs.validateFields(['#application-name-new']);
            return invalid;
        },
        /**
         * Generic Check a field is valid and put focus on it if it isn't
         * @param id field id.
         * @returns {boolean}
         */
        validateField: function (id, setFocus) {
            if ($(id).val() == "") {
                if(setFocus) {
                    $(id).focus();
                }
                $(id).siblings('.error').show();
                return false;
            }
            $(id).siblings('.error').hide();
            return true;
        },

        /**
         * Checks an array of fields for validity. Stops after single invalid field is found.
         * @param ids
         * @returns {boolean}
         */
        validateFields: function (ids) {
            var valid = true;
            var setFocus = true;
            for (var i = 0, length = ids.length; i < length; i++) {
                valid = AppLinks.Creation.Dialogs.validateField(ids[i], setFocus);
                // once focus has been set on the first invalid field don't move it
                setFocus = valid && setFocus;
            }
            return valid;
        }

    }
})(AJS.$, require('applinks/js/util'));
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-new-ui-creation', location = 'js/new/applinks-creation-process.js' */
/**
 * AppLinks.Creation.Process
 * Used to hold the functionality used to create application links.
 */
(function($, applinksUtil) {
    AppLinks.Creation.Process = {
    twoStageCreation: true,
    debug: false,
    /**
     * Create a collection of NonUAL types compatible with aui.form.selectField
     * @return {Array}
     */
    createNonUalTypes: function() {
        var typeOptions = [];
        for (var i = 0; i < nonAppLinksApplicationTypes.length; i++) {
            var option;
            if(nonAppLinksApplicationTypes[i].typeId === 'generic') {
                option = { text : nonAppLinksApplicationTypes[i].label, value : nonAppLinksApplicationTypes[i].typeId, selected : true };

            } else {
                option = { text : nonAppLinksApplicationTypes[i].label, value : nonAppLinksApplicationTypes[i].typeId };
            }
            typeOptions.push(option)
        }
        return typeOptions;
    },
    /**
     * Create an application link.
     * Create an autoconfigured Atlassian 2 Atlassian link if given a manifest file by the remote application.
     * Create a generic link if not given a manifest file.
     * @param  creationState
     */
    createApplicationLink: function (creationState) {
        var typeOptions = AppLinks.Creation.Process.createNonUalTypes();

        if (typeof creationState.getRemoteApplication().typeId !== "undefined") {

            if (creationState.getRemoteApplication().url !== creationState.getCorrectedUrl()) {

                // confirm discrepancy between (entered) RPC URL and the base url return by the manifest
                AppLinks.Creation.Dialogs.showConfirmUrlsDialog(creationState);
            } else {

                //Create UAL link
                AppLinks.Creation.Dialogs.showCreateApplinkDialog( creationState);
            }
        } else {
            // Can't get Manifest so create a 3rd Party link.
            var remoteApplication = {
                                        url: creationState.getCorrectedUrl(),
                                        name: null,
                                        product: null,
                                        logoUrl: null,
                                        typeId: "generic"
                                    };
            creationState.setRemoteApplication(remoteApplication);
            AppLinks.Creation.Dialogs.showCreateNonUalLinkDialog(typeOptions,  creationState);
        }
    },
    /**
     * Take the local and remote manifest's check for errors, if there are non start the create link process.
     * @param remoteManifest
     * @param ignoreErrors
     * @param creationState
     * @param localManifest
     */
    processManifests: function (remoteManifest, ignoreErrors, creationState, localManifest)
    {
        var manifestErrors = AppLinks.Creation.Process.fetchManifestErrorHandler(remoteManifest, ignoreErrors, creationState);

        // if there are no errors in the manifests continue the creation process.
        if (!manifestErrors)
        {
            creationState.setLocalApplication(applinksUtil.manifestToApplication(localManifest));
            creationState.setRemoteApplication(applinksUtil.manifestToApplication(remoteManifest));

            // TODO APLDEV-3 currently these decisions are hardcoded to depend on OAuth support, in principle they
            // should be something more generic.
            creationState.setConfigureIncomingUserAuthentication(applinksUtil.applicationSupportsIncomingThreeLeggedOAuth(localManifest) &&
                applinksUtil.applicationSupportsOutgoingThreeLeggedOAuth(remoteManifest));
            creationState.setConfigureIncomingServerAuthentication(applinksUtil.applicationSupportsIncomingTwoLeggedOAuth(localManifest) &&
                applinksUtil.applicationSupportsOutgoingTwoLeggedOAuth(remoteManifest));
            creationState.setConfigureIncomingPreAuthentication(applinksUtil.applicationSupportsIncomingTwoLeggedOAuthWithImpersonation(localManifest) &&
                applinksUtil.applicationSupportsOutgoingTwoLeggedOAuthWithImpersonation(remoteManifest));

            creationState.setConfigureOutgoingUserAuthentication(applinksUtil.applicationSupportsOutgoingThreeLeggedOAuth(localManifest) &&
                applinksUtil.applicationSupportsIncomingThreeLeggedOAuth(remoteManifest));
            creationState.setConfigureOutgoingServerAuthentication(applinksUtil.applicationSupportsOutgoingTwoLeggedOAuth(localManifest) &&
                applinksUtil.applicationSupportsIncomingTwoLeggedOAuth(remoteManifest));
            creationState.setConfigureOutgoingPreAuthentication(applinksUtil.applicationSupportsOutgoingTwoLeggedOAuthWithImpersonation(localManifest) &&
                applinksUtil.applicationSupportsIncomingTwoLeggedOAuthWithImpersonation(remoteManifest));

            AppLinks.Creation.Process.createApplicationLink(creationState);
        }
    },
    /**
     * Attempt to fetch the local and remote manifests.
     * @param ignoreErrors
     * @param  creationState
     */
    fetchManifests: function(ignoreErrors,  creationState) {
        var remoteManifestRequest;
        if(creationState.getUseCors()) {
            remoteManifestRequest = AppLinks.SPI.getRemoteManifest(creationState.getCorrectedUrl(),
                function(data) {
                    AppLinks.Creation.Dialogs.handleFetchManifestRestSuccess(data,  creationState);
                },
                function(data) {
                    AppLinks.Creation.Dialogs.handleFetchManifestRestFailure(data,  creationState);
                });
        } else {
            remoteManifestRequest = AppLinks.SPI.tryToFetchManifest(creationState.getCorrectedUrl(),
                function(data) {
                    AppLinks.Creation.Dialogs.handleFetchManifestRestSuccess(data,  creationState);
                },
                function(data) {
                    AppLinks.Creation.Dialogs.handleFetchManifestRestFailure(data,  creationState);
                });
        }
        var localManifestRequest = AppLinks.SPI.getLocalManifest(
            function(data) {
                AppLinks.Creation.Dialogs.handleFetchManifestRestSuccess(data,  creationState);
            },
            function(data) {
                AppLinks.Creation.Dialogs.handleFetchManifestRestFailure(data,  creationState);
            });

        var manifestFetch = $.when(remoteManifestRequest, localManifestRequest);

        manifestFetch.done(function (remoteData, localData) {
            var localManifest = localData[0];
            var remoteManifest = remoteData[0];
            AppLinks.Creation.Process.processManifests(remoteManifest, ignoreErrors, creationState, localManifest);
        });

        // Handle CORS failures
        manifestFetch.fail(function (remoteData) {
            // Failed CORS data is not an array
            var remoteManifest = remoteData;

            // We still need to have a handle on the localmanifets so go get it again!
            // @todo we should be able to get the local manifest once and store it instead.
            AppLinks.SPI.getLocalManifest(null, function(data) {
                    AppLinks.Creation.Dialogs.handleUrlErrors(data,  creationState);
                }).done(function(localManifest) {
                        AppLinks.Creation.Process.processManifests(remoteManifest, ignoreErrors, creationState, localManifest);
                });
        });
        return manifestFetch;
    },
    /**
     * Handle errors from the manifest fetching for create applinks workflow 2.0
     *
     * @param manifest
     * @param respectRedirects
     * @param ignoreErrors
     * @param  creationState
     * @param remoteUrl
     */
    fetchManifestErrorHandler: function(manifest, ignoreErrors,  creationState) {
        var removeWarnings = function(){
                forceWhenHostIsOffline = false;
                AppLinks.UI.hideErrorBox();
            },
            forceWhenHostIsOffline;

        //reset warnings when user changes input.
        AppLinks.Creation.userDefinedUrlField.on('change', removeWarnings);

        var handleError = function(manifest){

            if(ignoreErrors) {
                // explicitly decided to ignore errors, e.g. a 3rd party url that does not support manifests.
                removeWarnings();
                return false;
            }

            if (typeof manifest.code === 'undefined') {
                // no code = no errors
                return false;
            }

            // redirection
            if (manifest.code == 'applinks.warning.redirected.host') {
                creationState.incrementRedirectCount();

                // warn user about redirection
                if (manifest.params && manifest.params.redirectedUrl) {
                    if(manifest.params.redirectedUrl.indexOf('rest/applinks/') > 0) {
                        var url = manifest.params.redirectedUrl.substring(0, manifest.params.redirectedUrl.indexOf('rest/applinks/'));
                        creationState.setCorrectedUrl(url)
                    }
                    else {
                        var url = manifest.params.redirectedUrl;
                        creationState.setCorrectedUrl(url)
                    }
                }

                var message;
                if( creationState.getRedirectCount() == 1) {
                    message = AJS.format("The supplied Application URL has redirected once. Please check the redirected URL field to ensure this is a URL that you trust.",  creationState.getRedirectCount())
                } else {
                    message = AJS.format("The supplied Application URL has redirected {0} times. Please check the redirected URL field to ensure this is a URL that you trust.",  creationState.getRedirectCount())
                }

                AppLinks.Creation.Dialogs.showConfigureUrlDialog(message, ignoreErrors,  creationState, true);
            }

            // non existent host, e.g. uncontactable url
            if (manifest.code == 'applinks.warning.unknown.host') {
                if (creationState.isCreatingReciprocal()) {
                    // if in the process of creating a reciprocal link, then stop the process
                    AppLinks.Creation.Dialogs.showReciprocalManifestUnobtainableDialog( creationState);
                } else {
                    // The host doesn't ping. Stay on the same page, ask for a confirmation.
                    // if the user confirms then we can ignore any subsequent errors.
                    AppLinks.Creation.Dialogs.showConfigureUrlDialog(manifest.warning, true,  creationState, false);
                }
            }

            // incompatible applinks versions.
            if(manifest.code == 'applinks.warning.incompatible.applinks.version') {
                creationState.setRemoteApplication(applinksUtil.manifestToApplication(manifest));
                AppLinks.Creation.Dialogs.showIncompatibleApplinksVersionDialog(creationState);
            }

            // 3rd party url
            if(manifest.code == 'applinks.warning.host.does-not-support-manifest') {
                if(creationState.getUseCors()) {
                    if(creationState.isCreatingReciprocal()) {
                        console.log('Unable to retrieve remote Manifest using CORS');
                        // if already tried via cors than bail out.
                        AppLinks.Creation.Dialogs.showReciprocalManifestUnobtainableDialog(creationState);
                    }
                } else {
                    // try using cors
                    console.log('Unable to retrieve remote Manifest. Try again using CORS');
                    creationState.setUseCors(true);
                    AppLinks.Creation.Process.fetchManifests(false, creationState);
                }
            }

            // applink already exists
            if(manifest.code == 'applinks.warning.host.duplicated') {
                if (creationState.isCreatingReciprocal() == true) {
                    AppLinks.Creation.Dialogs.showReciprocalDuplicateDialog(creationState.getCorrectedUrl(), manifest.warning, creationState);
                } else {
                    AppLinks.Creation.Dialogs.showLocalDuplicateDialog(manifest.warning, creationState);
                }
            }

            // invalid url entered
            if(manifest.code == 'applinks.error.rpcurl') {
                AppLinks.Creation.Dialogs.showConfigureUrlDialog(manifest.warning, true, creationState, false);
            }

            return true;
        };

        return handleError(manifest);
    },
    /**
     * Create an OAuth Consumer, created by retrieving the OAuth Consumer info from the remote application,
     * either by server to server communication , or if we've already had to fall back on CORS use that instead.
     * @param creationState
     * @param deferred
     * @returns {*}
     */
    createConsumer: function(creationState, deferred) {
        if(creationState.getUseCors()) {
            return AppLinks.Creation.Process.createConsumerConfiguredFromRemoteConsumerInfo( creationState, deferred);
        } else {
            return AppLinks.Creation.Process.createConsumerAutoConfigured( creationState, deferred);
        }
    },
    /**
     * Create a consumer,
     * i.e. a representation of a remote application with permission to access resources on this application.
     * TODO can be done in Parallel after creation of an application link.
     * @param applicationLink
     */
    createConsumerAutoConfigured: function( creationState, deferred) {
        // always allow a form of 2LO
        var twoLOAllowed = true,
            // by default allow 2LO anonymous
            executingTwoLOUser = null,
            twoLOWithImpersonationAllowed =  creationState.getSharedUserbase();

        //5. add consumer
        AppLinks.SPI.createConsumerAutoConfigure( creationState.getCreatedApplicationLinkId(), twoLOAllowed, executingTwoLOUser, twoLOWithImpersonationAllowed, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleRestErrors)
            .done(function (data) {
                console.log(data, 'Consumer successfully created and autoconfigured.');
                deferred.notify();
                deferred.resolve();
            })
            .fail(function (data) {
                creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "autoConfigureConsumerFailed");
                console.log(data, 'Consumer creation and autoconfigure failed.');
                deferred.reject();
            });
    },
    /**
     * Create a consumer, based on consumer information retrieved via CORS
     * i.e. a representation of a remote application with permission to access resources on this application.
     * @param applicationLink
     */
    createConsumerConfiguredFromRemoteConsumerInfo: function( creationState, deferred) {
        // always allow a form of 2LO
        var twoLOAllowed = true,
        // by default allow 2LO anonymous
            executingTwoLOUser = null,
            twoLOWithImpersonationAllowed =  creationState.getSharedUserbase();

        //5a. get the remote OAuth consumer information
        AppLinks.SPI.getRemoteOAuthConsumerInfo(creationState.getCorrectedUrl(), AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleRestErrors)
            .done(function (data) {
                console.log(data, 'Retrieving remote Consumer Info succeeded.');
                var consumerName = $(data).find("name").text(),
                    consumerKey = $(data).find("key").text(),
                    publicKey = $(data).find("publicKey").text();

                AppLinks.SPI.createConsumer(creationState.getCreatedApplicationLinkId(), consumerKey, consumerName, null, null, publicKey, twoLOAllowed, executingTwoLOUser, twoLOWithImpersonationAllowed, false, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleConfigureIncomingNonUalLinkErrors)
                    .done(function(data){
                        creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_SUCCESS);
                        console.log(data, 'Consumer successfully created.');
                    })
                    .fail(function(data){
                        creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "createConsumerFailed");
                        console.log(data, 'Consumer creation failed.');
                        //@todo handle failure.
                    });
                deferred.notify();
                deferred.resolve();
            })
            .fail(function (data) {
                console.log(data, 'Retrieving remote Consumer Info failed.');
                deferred.reject();
            });
    },
     /**
     * Step 4a register a 2LOi Authentication provider
     * This step is optional, depending on the shareduserbase option.
     * TODO can be done in Parallel after step 2.
     * @param applicationLink
     * @param config
     */
    register2LOiProvider: function(config,  creationState, deferred) {
         var applicationId = creationState.getCreatedApplicationLinkId() == null ? creationState.getOriginalCreatedApplicationLinkId() : creationState.getCreatedApplicationLinkId();
        AppLinks.SPI.registerProvider( applicationId, "com.atlassian.applinks.api.auth.types.TwoLeggedOAuthWithImpersonationAuthenticationProvider", config, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleRestErrors)
            .done(function (data) {
                console.log(data, '2LOi Provider registered.');
                deferred.notify();
                deferred.resolve();
            })
            .fail(function () {
                creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "register2LOiProviderFailed");
                console.log('OAuth 2LOi AuthenticationProvider registration failed.');
                deferred.reject();
            });
    },
    /**
     * Step 4 register 2LO Provider.
     * TODO can be done in Parallel after step 2.
     * @param applicationLink
     * @param config
     */
    register2LOProvider: function( creationState, deferred) {
        var config = {};
        var applicationId = creationState.getCreatedApplicationLinkId() == null ? creationState.getOriginalCreatedApplicationLinkId() : creationState.getCreatedApplicationLinkId();
        AppLinks.SPI.registerProvider(applicationId, "com.atlassian.applinks.api.auth.types.TwoLeggedOAuthAuthenticationProvider", config, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleRestErrors)
            .done(function (data) {
                console.log(data, '2LO Provider registered.');
                if (creationState.getConfigureOutgoingPreAuthentication()) {
                    if (creationState.getSharedUserbase() == true && applinksUtil.isSysAdmin()) {
                        creationState.updateStatusLog(AppLinks.Creation.STATUS_REGISTERPROVIDER_2LOI_FAILURE, 'register2LOiProviderNotSysAdminFailed')
                        AppLinks.Creation.Process.register2LOiProvider(config, creationState, deferred);
                    } else {
                        deferred.notify();
                        deferred.resolve();
                    }
                } else {
                    console.log('Skipped registering outgoing 2LOi as one host does not support it.');
                    deferred.notify();
                    deferred.resolve();
                }
            })
            .fail(function (data) {
                creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "register2LOProviderFailed");
                console.log(data, 'OAuth 2LO AuthenticationProvider registration failed.');
                deferred.reject();
            });
    },
    /**
     * Step 3 Register a 3LO Authentication provider.
     * TODO can be done in Parallel after step 2.
     * @param applicationLink
     */
    register3LOProvider: function( creationState, deferred) {
        //3. register OAuth provider
        var config = {};
        AppLinks.SPI.registerProvider( creationState.getCreatedApplicationLinkId(), "com.atlassian.applinks.api.auth.types.OAuthAuthenticationProvider", config, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleRestErrors)
            .done(function () {
                if (creationState.getConfigureOutgoingServerAuthentication()) {
                    AppLinks.Creation.Process.register2LOProvider(creationState, deferred);
                } else {
                    console.log('Skipped registering outgoing 2LO as one host does not support it.');
                    deferred.notify();
                    deferred.resolve();
                }
            })
            .fail(function () {
                creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "register3LOProviderFailed");
                console.log('OAuth AuthenticationProvider registration failed.');
                deferred.reject();
            });
    },
    /**
     * Step 2 retrieve the newly created Application Link, since we need the ID.
     * @param data
     */
    retrieveApplicationLink: function(data,  creationState, deferred, processLink) {
        var applicationLinkUrl = data['resources-created'][0].href;
        AppLinks.get(applicationLinkUrl, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleRestErrors)
            .done(function (data) {
                console.log(data, 'Application link read.');
                // grab hold of the new applink id
                creationState.setCreatedApplicationLinkId(data.id);
                if(! creationState.isCreatingReciprocal()) {
                     creationState.setOriginalCreatedApplicationLinkId(data.id);
                }

                if(typeof processLink != 'undefined') {
                    processLink( creationState, deferred);
                }
            })
            .fail(function () {
                creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "retrieveApplicationLinkFailed");
                console.log('Application link read failed.');
                deferred.reject();
            });
    },
    createUalLinkAndConfigureIncoming: function ( creationState){
        var deferred = new $.Deferred();

        // if not creating a reciporcal link respect the user's choice about shared user base,
        // otherwise just go with the setting sent as part of reciprocal creation.
        if(! creationState.isCreatingReciprocal()) {
             creationState.setSharedUserbase($('#userbase').is(':checked'));
        }

        /**
         * Step 1 create an Application link.
         */
            // TODO APLDEV-3 determine if the remote actually supports OAuth first, check the manifest, before creating consumer and other OAuth
            // constructs. extract OAuth creation code into OAuth specific js files in the Oauth plugin.
        AppLinks.SPI.createApplicationLink( creationState.getRemoteApplication().id,  creationState.getRemoteApplication().name,  creationState.getRemoteApplication().rpcUrl,  creationState.getRemoteApplication().url,  creationState.getRemoteApplication().typeId, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleRestErrors)
            .done(function(data){
                if(creationState.getConfigureIncomingAuthentication()) {
                    AppLinks.Creation.Process.retrieveApplicationLink(data,
                        creationState,
                        deferred,
                        AppLinks.Creation.Process.createConsumer);
                } else {
                    console.log(data, 'Skipping Consumer creation as local instance does not support 3LO.');
                    deferred.notify();
                    deferred.resolve();
                }
            })
            .fail(function(){
                creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "createApplicationLinkFailed");
                console.log('Application link creation failed.');
                deferred.reject();
            });
        return deferred.promise();

    },
    /**
     * Create a URL only link
     * @param creationState
     * @returns {*}
     */
    createUrlLink: function (creationState){
        var deferred = new $.Deferred();

        /**
         * Step 1 create an Application link.
         */
        AppLinks.SPI.createApplicationLink(creationState.getRemoteApplication().id,  creationState.getRemoteApplication().name,  creationState.getRemoteApplication().rpcUrl,  creationState.getRemoteApplication().url,  creationState.getRemoteApplication().typeId, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleRestErrors)
            .done(function(data){
                console.log('Application link created.');
                AppLinks.Creation.Process.retrieveApplicationLink(data,  creationState, deferred, function() {
                    deferred.notify();
                    deferred.resolve();
                });
            })
            .fail(function(){
                console.log('Application link creation failed.');
                deferred.reject();
            });
        return deferred.promise();

    },
    /**
     * Retrieve a previously created Application Link and configure the outgoing authentication.
     * NB. depends on  creationState.getCreatedApplicationLinkId() and  creationState.getSharedUserbase() being correctly defined.
     * @param  creationState the current creation state.
     */
    retrieveUalLinkAndConfigureOutgoing: function ( creationState){
        var deferred = new $.Deferred();
        var config = {};
        if (creationState.getConfigureOutgoingUserAuthentication()) {
            AppLinks.SPI.registerProvider( creationState.getOriginalCreatedApplicationLinkId(), "com.atlassian.applinks.api.auth.types.OAuthAuthenticationProvider", config, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleRestErrors)
                .done(function (data) {
                    if (creationState.getConfigureOutgoingServerAuthentication()) {
                        AppLinks.Creation.Process.register2LOProvider(creationState, deferred);
                    } else {
                        console.log('Skipped registering outgoing 2LO as one host does not support it.');
                        deferred.notify();
                        deferred.resolve();
                    }
                })
                .fail(function (data) {
                    creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "register3LOProviderFailed");
                    console.log(data, 'OAuth AuthenticationProvider registration failed.');
                    deferred.reject();
                });
        } else {
            console.log('Skipped registering outgoing 3LO as one host does not support it.');
            deferred.notify();
            deferred.resolve();
        }

        return deferred.promise();

    },
    /**
     * Create a new UAL link and complete incoming and outgoing OAuth configuration.
     * Depends on the following being correctly defined:
     *  -  creationState.getRemoteApplication()
     *  -  creationState.getSharedUserbase()
     * @param  creationState the current creation status
     */
    createUalLinkAndConfigureIncomingAndOutgoing: function ( creationState){
        var deferred = new $.Deferred();

        // if not creating a reciprocal link respect the user's choice about shared user base,
        // otherwise just go with the setting sent as part of reciprocal creation.
        if(! creationState.isCreatingReciprocal()) {
             creationState.setSharedUserbase($('#userbase').is(':checked'));
        }

        // Step 1 create an Application link.
        AppLinks.SPI.createApplicationLink( creationState.getRemoteApplication().id,
                                             creationState.getRemoteApplication().name,
                                             creationState.getRemoteApplication().rpcUrl,
                                             creationState.getRemoteApplication().url,
                                             creationState.getRemoteApplication().typeId,
                                            AppLinks.Creation.Dialogs.handleRestSuccess,
                                            AppLinks.Creation.Dialogs.handleRestErrors)
            .done(function(data){
                AppLinks.Creation.Process.retrieveApplicationLink(data,
                                                                     creationState,
                                                                    deferred,
                                                                    function( creationState, deferred) {
// TODO APLDEV-3 determine if the remote actually supports OAuth first, check the manifest
// extract OAuth creation code into OAuth specific js files in the Oauth plugin.
                                                                        var doneNothing = false;
                                                                        if(creationState.getConfigureOutgoingUserAuthentication()) {
                                                                            // step 2a configure outgoing authentication
                                                                            AppLinks.Creation.Process.register3LOProvider(creationState, deferred);
                                                                        } else {
                                                                            console.log(data, 'Skipped configuring outgoing User Authentication.');
                                                                            doneNothing = true;
                                                                        }

                                                                        if(creationState.getConfigureIncomingAuthentication()) {
                                                                            // step 2b configure incoming authentication
                                                                            AppLinks.Creation.Process.createConsumer(creationState, deferred);
                                                                        } else {
                                                                            console.log(data, 'Skipped configuring incoming Authentication.');
                                                                            doneNothing = true;
                                                                        }

                                                                        if( doneNothing) {
                                                                            console.log(data, 'Link retrieved successfully.');
                                                                            deferred.notify();
                                                                            deferred.resolve();
                                                                        }

                                                                    });
            })
            .fail(function(){
                creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "createApplicationLinkFailed");
                console.log('Application link creation failed.');
                deferred.reject();
            });

        return deferred.promise();

    },
        /**
         * Configure the incoming authentication for an application link.
         * @param consumerName
         * @param consumerKey
         * @param publicKey
         * @param creationState
         * @returns {*}
         */
    configureIncomingNonUalLink: function(consumerName, consumerKey, publicKey, creationState) {
        creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_INPROGRESS);
        return AppLinks.SPI.createConsumer(creationState.getCreatedApplicationLinkId(), consumerKey, consumerName, null, null, publicKey, false, null, null, false, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleConfigureIncomingNonUalLinkErrors)
            .done(function(data){
                creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_SUCCESS);
                console.log(data, 'Consumer successfully created.');
            })
            .fail(function(data){
                creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "createConsumerFailed");
                console.log(data, 'Consumer creation failed.');
                //@todo handle failure.
            });
    },
    /**
     * Create a default NON UAL link.
     * and optionally configure Outgoing.
     * @return {*}
     */
    createOutgoingNonUalLink: function(
        name,
        typeId,
        rpcUrl,
        accessTokenUrl,
        requestTokenUrl,
        consumerKey,
        authorizeUrl,
        sharedSecret,
        serviceProvider,
        createIncoming,
         creationState){
        // "global" to hold the newly created applink.
        var deferred = new $.Deferred(),
            applicationLink;

        /**
         * read the newly created applicationlink and if successful register a provider
         * @param data
         */
        function readApplicationLinkAndRegisterProvider(data){

            // creating the applinks goives us backa url to the new resource so go fetch it to get the new applink.
            AppLinks.get(data['resources-created'][0].href, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleCreateNonUalLinkErrors)
                .done(function(data) {
                    // grab hold of the new applink id
                     creationState.setCreatedApplicationLinkId(data.id);
                    if(! creationState.isCreatingReciprocal()) {
                         creationState.setOriginalCreatedApplicationLinkId(data.id)
                    }

                    if( accessTokenUrl == ""
                        && requestTokenUrl == ""
                        && consumerKey == ""
                        && authorizeUrl == ""
                        && sharedSecret == ""
                        && serviceProvider == "")
                    {
                        // SUCCESS completed NON-UAL basic application link.
                        creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_SUCCESS);
                        if(createIncoming != true)
                        {
                            deferred.notify();
                            deferred.resolve();
                        } else {
                            // if nothing was set don't bother trying to configure the outgoing link.
                            // potentially just go and configure the incoming one.
                            runIncomingNonUalLinkDialog();
                        }
                    } else {
                        // if anything was set then do try and configure the link
                        register3rdPartyOauthProviderAndAddConsumer();
                    }
                })
                .fail(function(){
                    creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "retrieveApplicationLinkFailed");
                    console.log('Unable to read ApplicationLink.');
                    deferred.reject();
                });
        }

        /**
         * Register a provider for the specified ApplicationLink and if successful add a consumer
         */
        function register3rdPartyOauthProviderAndAddConsumer() {
            var config = {
                'serviceProvider.accessTokenUrl': accessTokenUrl,
                'serviceProvider.requestTokenUrl': requestTokenUrl,
                'consumerKey.outbound': consumerKey,
                'serviceProvider.authorizeUrl': authorizeUrl
            };

            AppLinks.SPI.registerProvider( creationState.getCreatedApplicationLinkId(), "com.atlassian.applinks.api.auth.types.OAuthAuthenticationProvider", config, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleCreateNonUalLinkErrors)
                .done(addConsumerAndConfigureIncoming)
                .fail(function(){
                    creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "register3LOProviderFailed");
                    console.log('AuthenticationProvider registration failed.');
                    deferred.reject();
                });
        }

        /**
         * Add a Consumer and if successful, and if requested by the user then run the incoming dialog.
         * @param data
         */
        function addConsumerAndConfigureIncoming(data){
            console.log(data, 'AuthenticationProvider successfully registered.');
            AppLinks.SPI.createConsumer( creationState.getCreatedApplicationLinkId(), consumerKey, serviceProvider, null, sharedSecret, null, true, null, null, true, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleCreateNonUalLinkErrors)
                .done(runIncomingNonUalLinkDialog)
                .fail(function(data){
                    creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "createConsumerFailed");
                    console.log(data, 'Consumer creation failed.');
                    deferred.reject();
                });
        }

        /**
         * Run the dialog to configure incoming connections for current applicationlink
         */
        function runIncomingNonUalLinkDialog(){
            deferred.notify();
            console.log('Consumer successfully created.');

            if(!createIncoming) {
                creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_SUCCESS);
                deferred.resolve();
                return;
            }

            var dialog = AppLinks.Creation.Dialogs.showConfigureIncomingNonUalLinkDialog(creationState, deferred);
        }

        // Attempt to submit
        AppLinks.SPI.createApplicationLink(null, name, rpcUrl, rpcUrl, typeId, AppLinks.Creation.Dialogs.handleRestSuccess, AppLinks.Creation.Dialogs.handleCreateNonUalLinkErrors)
            .done(readApplicationLinkAndRegisterProvider)
            .fail(function(){
                creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "createApplicationLinkFailed");
                console.log('Application link creation failed.');
                deferred.reject();
            });
        return deferred.promise();
    },
    /**
     * AppLink successfully Created now redirect to Application 2 to create the reciprocal link.
     * @return {{wait: Function, done: Function}}
     */
    successRedirectToCreateReciprocal: function( creationState) {
         creationState.updateStatusLog(AppLinks.Creation.STATUS_LOCAL_SUCCESS);
         creationState.updateStatusLog(AppLinks.Creation.STATUS_RECIPROCAL_INPROGRESS);
        return {
            'wait': function() {
                AppLinks.Creation.Dialogs.showRedirectPauseDialog(true,  creationState.getRemoteApplication().name)
            },
            'done': function(){
                var redirectUrl = AppLinks.Creation.generateApplinksCreationRedirectionUrl(true,  creationState);
                window.location = redirectUrl;
            }};
    },
    /**
     * AppLink successfully created, optionally display dialog offering to redirect user to the remote application.
     * @return {{wait: Function, done: Function}}
     */
    successIncompatibleApplinksVersion: function ( creationState) {
        creationState.updateStatusLog(AppLinks.Creation.STATUS_LOCAL_SUCCESS);
        return {
            'wait': function(){},
            'done': function(){
                if (creationState.doInitiatorRedirect()) {
                    AppLinks.Creation.Process.showFinalStatus(creationState);
                } else {
                    AppLinks.Creation.Dialogs.showIncompatibleApplinksVersionCompletionDialog(creationState);
                }
            }
        }
    },
    /**
     * AppLink successfully created, display manual reciprocal link to user,and refresh the AppLinks table.
     * @return {{wait: Function, done: Function}}
     */
    successManualRedirect: function ( creationState) {
        creationState.updateStatusLog(AppLinks.Creation.STATUS_LOCAL_SUCCESS);
        return {
            'wait': function(){},
            'done': function(){
                AppLinks.Creation.Dialogs.showManuallyCreateReciprocalLinkDialog( creationState.getRemoteApplication().name,  creationState.getRemoteApplication().url,  creationState.getLocalApplication().url, false,  creationState);
            }
        }
    },
    /**
     * AppLink successfully Created now redirect back to Application 1.
     * @return {{wait: Function, done: Function}}
     */
    successRedirectToReturn: function( creationState) {
         creationState.updateStatusLog(AppLinks.Creation.STATUS_RECIPROCAL_SUCCESS);
        return {
            'wait': function() {
                AppLinks.Creation.Dialogs.showRedirectPauseDialog(false,  creationState.getRemoteApplication().name);
            },
            'done': function(){
                var redirectUrl = AppLinks.Creation.generateApplinksCreationRedirectionUrl(false,  creationState);
                window.location = redirectUrl;
            }};
    },
    /**
     * AppLink successfully created, now need to redirect, so refresh the AppLinks table.
     * @return {{wait: Function, done: Function}}
     */
    successNoRedirect: function( creationState) {
        return {
            'wait': function(){
                AppLinks.Creation.Dialogs.showProcessingPauseDialog(creationState);
            },
            'done': function(){
                AppLinks.Creation.Process.showFinalStatus( creationState);
            }
        }
    },
        /**
         * Display the final status of the creation process to the user.
         */
         showFinalStatus: function( creationState)
        {
            var message, status;
            var createdApplicationLinkId;
            if(creationState.isCreatingReciprocal()) {
                createdApplicationLinkId = creationState.getCreatedApplicationLinkId();
            } else {
                createdApplicationLinkId = creationState.getOriginalCreatedApplicationLinkId();
            }

            if(createdApplicationLinkId === null) {
                // not created anything so no messages to show.
                // just resets the process.
                AppLinks.Creation.Process.doFinalDisplay(status, message,  creationState);
                return;
            }

            AppLinks.SPI.getApplicationLink(createdApplicationLinkId)
                .done(function (applicationLink)
                {
                    // in App 1 after reciprocal process is completed, so log we have completed and tell the user.
                    if ( creationState.localCreationSucceeded() &&  creationState.reciprocalCreationSucceeded()) {
                        status = AppLinks.Creation.CREATION_RESULT_INFO_KEY;
                        message = AJS.format("Application Link \u0027\u0027{0}\u0027\u0027 created successfully.", applicationLink.name);
                    } else if ( creationState.localCreationSucceeded() && ! creationState.getRespectRedirects()) {
                        status = AppLinks.Creation.CREATION_RESULT_WARN_KEY;
                        message = AJS.format("Application Link \u0027\u0027{0}\u0027\u0027 was created successfully locally but creating the reciprocal link was not attempted. Please review the configuration using the Edit option.", applicationLink.name);
                        creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE);
                    } else if ( creationState.localCreationSucceeded() && ! creationState.reciprocalCreationSucceeded()) {
                        status = AppLinks.Creation.CREATION_RESULT_WARN_KEY;
                        message = AJS.format("Application Link \u0027\u0027{0}\u0027\u0027 was created successfully locally but the reciprocal link was not created. Please review the configuration using the Edit option.", applicationLink.name);
                        if(creationState.doInitiatorRedirect()){
                            // for remote initiation we are expecting the remote end to have been created.
                            creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE, "reciprocalCreationNotAttempted");
                        } else {
                            creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE);
                        }
                    } else if (!creationState.localCreationSucceeded() &&  creationState.reciprocalCreationSucceeded()) {
                        // Not sure this can ever happen.
                        status = AppLinks.Creation.CREATION_RESULT_WARN_KEY;
                        message = AJS.format("Application Link \u0027\u0027{0}\u0027\u0027 was \u0027\u0027not\u0027\u0027 created locally but strangely the reciprocal link was created. Please review the configuration on the target server.", applicationLink.name);
                        creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE);
                    } else if ( creationState.creationHasCompletedSuccessfully()) {
                        status = AppLinks.Creation.CREATION_RESULT_INFO_KEY;
                        message = AJS.format("Application Link \u0027\u0027{0}\u0027\u0027 created successfully.", applicationLink.name);
                    } else {
                        // Not sure this can ever happen.
                        status = AppLinks.Creation.CREATION_RESULT_WARN_KEY;
                        message = AJS.format("It has not been possible to determine the state of the link \u0027\u0027{0}\u0027\u0027.", applicationLink.name);
                        creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE);
                    }

                    AppLinks.Creation.Process.doFinalDisplay(status, message, creationState, applicationLink);
                })
                .fail(function (data)
                {
                    status = AppLinks.Creation.CREATION_RESULT_WARN_KEY;
                    message = AJS.format("It has not been possible to find the link \u0027\u0027{0}\u0027\u0027.", createdApplicationLinkId);
                     creationState.updateStatusLog(AppLinks.Creation.STATUS_CREATION_FAILURE);

                    AppLinks.Creation.Process.doFinalDisplay(status, message,  creationState);
                });
        },

        /**
         * Display the final status messages to the user.
         * Possibly redirects back to the applinks admin page to remove any querystring params that trigger functionality.
         */
        doFinalDisplay: function (status, message, creationState, applicationLink) {
            var messages = [];
            messages.push(message);

            if( creationState.isCreatingReciprocal() &&  creationState.getRespectRedirects() && creationState.creationInProgress()) {
                // if in the middle of creating a reciprocal link then just display messages as we're about to redirect away
                AppLinks.Creation.displayOutstandingMessages(status, messages);
                AppLinks.Creation.Dialogs.resetProcess();
            } else if( creationState.doInitiatorRedirect()) {
                // if completing an externally initiated link then just display messages as we're about the redirect away
                AppLinks.Creation.displayOutstandingMessages(status, messages);
                // if the the process was initiated externally and the creation process has completed respect the redirect
                AppLinks.ExternalInitiation.processInitiatorRedirect( creationState);
            } else if(window.location.search === null) {
                // if there is no querystring then there is nothing to tidy up, and we're not going to redirect, so just refresh the
                // current page.
                AppLinks.Creation.displayOutstandingMessages(status, messages);
                AppLinks.UI.listApplicationLinks();
                AppLinks.Creation.Dialogs.resetProcess();
            } else {
                // if there is a query string then tidy it up by redirecting back to the admin page, with just the messages.
                var parametersMap = {};

                applinksUtil.putParameter(status, messages, parametersMap);

                // put successfully created applink data into query string for further processing
                if (applicationLink && creationState.localCreationSucceeded()) {
                    applinksUtil.putParameter(AppLinks.Creation.CREATION_EVENT_NEW_APPLINK_ID, applicationLink.id, parametersMap);
                    applinksUtil.putParameter(AppLinks.Creation.CREATION_EVENT_NEW_APPLINK_TYPE, applicationLink.typeId, parametersMap);
                }

                // redirect back to the current page
                window.location = AppLinks.Creation.generateUrl(window.location.pathname, parametersMap);
            }

            AppLinks.Creation.initCreationState();
        }
    }
})(AJS.$, require('applinks/js/util'));
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-new-ui-creation', location = 'js/new/applinks-creation-state.js' */
(function(applinksUtil) {
    /**
     * define the object used to hold state during the creation process.
     * @constructor
     */
    function CreationState() {

        // TODO tidy this up.
        var startingUrlQuery = AppLinks.Creation.CREATION_REMOTE_URL,
            ignoreRedirectsQuery = AppLinks.Creation.CREATION_IGNORE_REDIRECTS,
            startingUrlIndex = (window.location.search.indexOf(startingUrlQuery) + 1),
            ignoreRedirectsIndex = (window.location.search.indexOf(ignoreRedirectsQuery) + 1),
            ignoreRedirects = !!ignoreRedirectsIndex;
        var respectRedirects = !ignoreRedirects;
        var isCreatingReciprocal = !!startingUrlIndex;

        this.sharedUserbase = AppLinks.Creation.getSubmittedSharedUserbase();
        this.creatingReciprocal = isCreatingReciprocal;

        this.remoteType = applinksUtil.getParameterValue(AppLinks.Creation.CREATION_REMOTE_TYPE);
        this.remoteUrl = applinksUtil.getParameterValue(AppLinks.Creation.CREATION_REMOTE_URL);

        // status log will be empty on creation of new CreationState at the start of the process, or prepopulated if created after a redirect.
        this.statusLog = AppLinks.Creation.getSubmittedStatusLog();

        // the id of the applicationId created on the current host application.
        this.createdApplicationLinkId = null;
        // the id of the applicationId created on the originating host application.
        this.originalCreatedApplicationLinkId = AppLinks.Creation.getSubmittedOriginalCreatedId();

        // the original url entered by the user.
        this.userDefinedUrl = null;

        // the ulr after correction, e.g. pre-pending scheme, handling redirects etc.
        this.correctedUrl = null;

        // parameter values
        this.initiatorRedirect = "",
        this.initiatorRedirectName = "";
        this.initiatorTargetUrl = "";
        this.initiatorSharedUserbase = false;
        this.initiatorIsRemoteAdmin = true;

        this.redirectCount = 0;
        this.respectRedirects = respectRedirects;

        // representation of the local application.
        this.localApplication = null;
        // representation of the remote application.
        this.remoteApplication = null;

        // a flag indicating if CORS has been used to retrieve remote information.
        this.useCors = false;

        // flag indicating whether the link is to a version of AppLinks < 4.0.0
        this.incompatibleApplinksVersion = false;

        // flag indicating if a URL and only the URL should be configured.
        this.createUnconfiguredLink = false;

        // for backwards compatibility default to true for this
        this.configureOutgoingUserAuthentication
            = applinksUtil.getParameterValue(AppLinks.Creation.CREATION_CONFIGURE_OUTGOING_USER_AUTH) == null
                ? true : applinksUtil.getParameterValue(AppLinks.Creation.CREATION_CONFIGURE_OUTGOING_USER_AUTH);

        // for backwards compatibility default to true for this
        this.configureOutgoingServerAuthentication
            = applinksUtil.getParameterValue(AppLinks.Creation.CREATION_CONFIGURE_OUTGOING_SERVER_AUTH) == null
                ? true : applinksUtil.getParameterValue(AppLinks.Creation.CREATION_CONFIGURE_OUTGOING_SERVER_AUTH);

        this.configureOutgoingPreAuthentication
         = applinksUtil.getParameterValue(AppLinks.Creation.CREATION_CONFIGURE_OUTGOING_PRE_AUTH) == null
                ? false : applinksUtil.getParameterValue(AppLinks.Creation.CREATION_CONFIGURE_OUTGOING_PRE_AUTH);

        // for backwards compatibility default to true for this
        this.configureIncomingUserAuthentication
            = applinksUtil.getParameterValue(AppLinks.Creation.CREATION_CONFIGURE_INCOMING_USER_AUTH) == null
                ? true : applinksUtil.getParameterValue(AppLinks.Creation.CREATION_CONFIGURE_INCOMING_USER_AUTH);

        // for backwards compatibility default to true for this
        this.configureIncomingServerAuthentication
            = applinksUtil.getParameterValue(AppLinks.Creation.CREATION_CONFIGURE_INCOMING_SERVER_AUTH) == null
                ? true : applinksUtil.getParameterValue(AppLinks.Creation.CREATION_CONFIGURE_INCOMING_SERVER_AUTH);

        this.configureIncomingPreAuthentication
            = applinksUtil.getParameterValue(AppLinks.Creation.CREATION_CONFIGURE_INCOMING_PRE_AUTH) == null
                ? false : applinksUtil.getParameterValue(AppLinks.Creation.CREATION_CONFIGURE_INCOMING_PRE_AUTH);
    };

    CreationState.prototype.getSharedUserbase =  function() {
        return this.sharedUserbase;
    };

    CreationState.prototype.setSharedUserbase =  function(sharedUserbase) {
        this.sharedUserbase = sharedUserbase;
    };

    CreationState.prototype.isCreatingReciprocal = function() {
        return this.creatingReciprocal;
    };

    CreationState.prototype.getStatusLog = function() {
        if(typeof this.statusLog == 'undefined') {
            this.statusLog = [];
        }
        return this.statusLog;
    };

    CreationState.prototype.getOriginalCreatedApplicationLinkId = function() {
        return this.originalCreatedApplicationLinkId;
    };

    CreationState.prototype.setOriginalCreatedApplicationLinkId = function(id) {
        this.originalCreatedApplicationLinkId = id;
    };

    CreationState.prototype.getCreatedApplicationLinkId = function() {
        return this.createdApplicationLinkId;
    };

    CreationState.prototype.setCreatedApplicationLinkId = function(id) {
        this.createdApplicationLinkId = id;
    };

    CreationState.prototype.getInitiatorRedirect = function() {
        return this.initiatorRedirect;
    };

    CreationState.prototype.setInitiatorRedirect = function(redirectUrl) {
        this.initiatorRedirect = redirectUrl;
    };

    CreationState.prototype.getInitiatorRedirectName = function() {
        return this.initiatorRedirectName;
    };

    CreationState.prototype.setInitiatorRedirectName = function(name) {
        this.initiatorRedirectName = name;
    };

    CreationState.prototype.getInitiatorTargetUrl = function() {
        return this.initiatorTargetUrl;
    };

    CreationState.prototype.setInitiatorTargetUrl = function(url) {
        this.initiatorTargetUrl = url;
    };

    CreationState.prototype.getInitiatorSharedUserbase = function() {
        return this.initiatorSharedUserbase;
    };

    CreationState.prototype.setInitiatorSharedUserbase = function(sharedUserbase) {
        this.initiatorSharedUserbase = sharedUserbase;
    };

    CreationState.prototype.getInitiatorIsRemoteAdmin = function() {
        return this.initiatorIsRemoteAdmin;
    };

    CreationState.prototype.setInitiatorIsRemoteAdmin = function(isRemoteAdmin) {
        this.initiatorIsRemoteAdmin = isRemoteAdmin;
    };

    CreationState.prototype.doInitiatorRedirect = function() {
        return this.getInitiatorRedirect() !== null
            && this.getInitiatorRedirect() !== ''
            && !this.isCreatingReciprocal();
    };

    CreationState.prototype.getRedirectCount = function() {
        return this.redirectCount;
    };

    CreationState.prototype.incrementRedirectCount = function() {
        this.redirectCount++;
    };

    CreationState.prototype.getRespectRedirects = function() {
        return this.respectRedirects;
    };

    /**
     * Get the original URL entered by the user
     * @returns {*}
     */
    CreationState.prototype.getUserDefinedUrl =  function() {
        return this.userDefinedUrl;
    };

    /**
     * Record the original URL entered by the user.
     * @param url
     */
    CreationState.prototype.setUserDefinedUrl =  function(url) {
        this.userDefinedUrl = url;
    };

    /**
     * Get the corrected URL
     * @returns {*}
     */
    CreationState.prototype.getCorrectedUrl =  function() {
        return this.correctedUrl;
    };

    /**
     * Get the remote Application Name.
     * Uses the details retrieved from the Manifest
     * if that is not available uses teh current Url
     * @returns {*}
     */
    CreationState.prototype.getRemoteApplicationUrl =  function() {
        return this.getRemoteApplication() !== null ? this.getRemoteApplication().url : this.correctedUrl;
    };

    /**
     * Get the remote Application TypeId.
     * Uses the details retrieved from the Manifest
     * if unavailable will fallback on information sent in the query.
     * @returns {*}
     */
    CreationState.prototype.getRemoteApplicationType =  function() {
        return this.getRemoteApplication() !== null ? this.getRemoteApplication().typeId : this.remoteType;
    };

    /**
     * Get the remote Application Name.
     * Uses the details retrieved from the Manifest. Name if is available, url otherwise.
     * if neither are available uses the current Url
     * @returns {*}
     */
    CreationState.prototype.getRemoteApplicationName =  function() {
        return this.getRemoteApplication() !== null ?
            this.getRemoteApplication().name !== null ? this.getRemoteApplication().name : this.getRemoteApplication().url
            : this.correctedUrl;
    };

    /**
     * Record the corrected URL.
     * @param url
     */
    CreationState.prototype.setCorrectedUrl =  function(url) {
        this.correctedUrl = url;
    };

    /**
     * Update the current status
     * @param newStatus
     */
    CreationState.prototype.updateStatusLog = function(status, detail) {
        this.getStatusLog().push( { 'status' : status, 'detail' : detail } );
    };

    CreationState.prototype.getCurrentStatus = function() {
        if(this.getStatusLog().length > 0) {
            return this.getStatusLog()[this.getStatusLog().length - 1].status;
        } else {
            return null;
        }

    };

    CreationState.prototype.getCurrentStatusDetail = function() {
        if(this.getStatusLog().length > 0) {
            return this.getStatusLog()[this.getStatusLog().length - 1].detail;
        } else {
            return null;
        }
    };

    CreationState.prototype.getFirstFailureStatus = function() {
        var failureRegExp = new RegExp(AppLinks.Creation.STATUS_CREATION_FAILURE, "i")
        return this.getStatus(failureRegExp);
    };

    CreationState.prototype.getFirstFailureStatusStatus = function() {
        return this.getFirstFailureStatus().status;
    };

    CreationState.prototype.getFirstFailureStatusDetail = function() {
        return this.getFirstFailureStatus().detail;
    };

    CreationState.prototype.getStatus = function(regexp) {
        for (var i = 0; i < this.getStatusLog().length; i++) {
            if (regexp.test(this.getStatusLog()[i].status)) {
                return this.getStatusLog()[i];
            }
        }
        return null;
    };

    /**
     * Check if the reciprocal creation process has been completed, successfully or not.
     * @returns {boolean}
     */
    CreationState.prototype.reciprocalCreationCompleted = function () {
        return this.reciprocalCreationSucceeded() || this.reciprocalCreationFailed();
    };

    /**
     * Check if the reciprocal creation process has succeeded.
     * @returns {boolean}
     */
    CreationState.prototype.reciprocalCreationSucceeded = function () {
        var successRegExp = new RegExp(AppLinks.Creation.STATUS_RECIPROCAL_SUCCESS, "i")
        return this.getStatus(successRegExp) != null;
    };

    /**
     * Check if the reciprocal creation process has failed.
     * @returns {boolean}
     */
    CreationState.prototype.reciprocalCreationFailed = function () {
        var failureRegExp = new RegExp(AppLinks.Creation.STATUS_RECIPROCAL_FAILURE, "i")
        return this.getStatus(failureRegExp) != null;
    };

    /**
     * Check if the local creation process has succeeded.
     * @returns {boolean}
     */
    CreationState.prototype.localCreationSucceeded = function () {
        var successRegExp = new RegExp(AppLinks.Creation.STATUS_LOCAL_SUCCESS, "i")
        return this.getStatus(successRegExp) != null;
    };

    /**
     * Check if the local creation process has failed.
     * @returns {boolean}
     */
    CreationState.prototype.localCreationFailed = function () {
        var failureRegExp = new RegExp(AppLinks.Creation.STATUS_LOCAL_FAILURE, "i")
        return this.getStatus(failureRegExp) != null;
    };

    /**
     * Check if the local creation process has been completed, successfully or not.
     * @returns {boolean}
     */
    CreationState.prototype.localCreationIsComplete = function () {
        var successRegExp = new RegExp(AppLinks.Creation.STATUS_LOCAL_SUCCESS, "i")
        var failureRegExp = new RegExp(AppLinks.Creation.STATUS_LOCAL_FAILURE, "i")
        return this.getStatus(successRegExp) != null || this.getStatus(failureRegExp) != null;
    };

    /**
     * Check if the creation process has completed successfully.
     * @returns {boolean}
     */
    CreationState.prototype.creationHasCompletedSuccessfully = function () {
        var status = this.getCurrentStatus()
        var re = new RegExp(AppLinks.Creation.STATUS_CREATION_SUCCESS, "i")
        return status !== null && re.test(status);
    };

    /**
     * Check if the creation process has completed successfully.
     * @returns {boolean}
     */
    CreationState.prototype.creationHasCompleted = function () {
        var status = this.getCurrentStatus()
        var successRegExp = new RegExp(AppLinks.Creation.STATUS_CREATION_SUCCESS, "i")
        var failureRegExp = new RegExp(AppLinks.Creation.STATUS_CREATION_FAILURE, "i")
        var inProgressRegExp = new RegExp(AppLinks.Creation.STATUS_CREATION_INPROGRESS, "i")
        return status !== null && (successRegExp.test(status) || failureRegExp.test(status))
            && !inProgressRegExp.test(status);
    };

    /**
     * Check if the creation process IS "IN PROGRESS".
     * @returns {boolean}
     */
    CreationState.prototype.creationInProgress = function () {
        return this.getStatusLog().length > 0 && !this.creationHasCompleted();
    };

    /**
     * Get the representation of the local application.
     */
    CreationState.prototype.getLocalApplication =  function() {
        return this.localApplication;
    };

    /**
     * Gets the representation of the local application.
     */
    CreationState.prototype.setLocalApplication =  function(application) {
        this.localApplication = application;
    };

    /**
     * Get the representation of the remote application.
     */
    CreationState.prototype.getRemoteApplication =  function() {
        return this.remoteApplication;
    };

    /**
     * Sets the representation of the remote application.
     */
    CreationState.prototype.setRemoteApplication =  function(application) {
        this.remoteApplication = application;
    };

    /**
     * Gets a flag indicating that the process is trying to create a link with a version of AppLinks < 4.0.0.
     */
    CreationState.prototype.getIncompatibleApplinksVersion =  function() {
        return this.incompatibleApplinksVersion;
    };

    /**
     * Sets a flag indicating that the process is trying to create a link with a version of AppLinks < 4.0.0.
     */
    CreationState.prototype.setIncompatibleApplinksVersion =  function(incompatibleApplinksVersion) {
        this.incompatibleApplinksVersion = incompatibleApplinksVersion;
    };

    /**
     * Sets a flag indicating if CORS should be used to get remote data.
     */
    CreationState.prototype.setUseCors =  function(useCors) {
        this.useCors = useCors;
    };

    /**
     * Gets a flag indicating if CORS should be used to get remote data.
     */
    CreationState.prototype.getUseCors =  function() {
        return this.useCors;
    };

    CreationState.prototype.getCreateUnconfiguredLink =  function() {
        return this.createUnconfiguredLink;
    };

    CreationState.prototype.setCreateUnconfiguredLink =  function(createUnconfiguredLink) {
        this.createUnconfiguredLink = createUnconfiguredLink;
    };

    CreationState.prototype.getConfigureIncomingUserAuthentication =  function() {
        return this.configureIncomingUserAuthentication;
    };

    CreationState.prototype.setConfigureIncomingUserAuthentication =  function(configureUserAuthentication) {
        this.configureIncomingUserAuthentication = configureUserAuthentication;
    };

    CreationState.prototype.getConfigureIncomingServerAuthentication =  function() {
        return this.configureIncomingServerAuthentication;
    };

    CreationState.prototype.setConfigureIncomingServerAuthentication =  function(configureServerAuthentication) {
        this.configureIncomingServerAuthentication = configureServerAuthentication;
    };

    CreationState.prototype.getConfigureIncomingPreAuthentication =  function() {
        return this.configureIncomingPreAuthentication;
    };

    CreationState.prototype.setConfigureIncomingPreAuthentication =  function(configurePreAuthentication) {
        this.configureIncomingPreAuthentication = configurePreAuthentication;
    };

    CreationState.prototype.getConfigureOutgoingUserAuthentication =  function() {
        return this.configureOutgoingUserAuthentication;
    };

    CreationState.prototype.setConfigureOutgoingUserAuthentication =  function(configureUserAuthentication) {
        this.configureOutgoingUserAuthentication = configureUserAuthentication;
    };

    CreationState.prototype.getConfigureOutgoingServerAuthentication =  function() {
        return this.configureOutgoingServerAuthentication;
    };

    CreationState.prototype.setConfigureOutgoingServerAuthentication =  function(configureServerAuthentication) {
        this.configureOutgoingServerAuthentication = configureServerAuthentication;
    };

    CreationState.prototype.getConfigureOutgoingPreAuthentication =  function() {
        return this.configureOutgoingPreAuthentication;
    };

    CreationState.prototype.setConfigureOutgoingPreAuthentication =  function(configurePreAuthentication) {
        this.configureOutgoingPreAuthentication = configurePreAuthentication;
    };

    CreationState.prototype.getConfigureIncomingAuthentication = function() {
        return (this.getConfigureIncomingUserAuthentication()
            || this.getConfigureIncomingServerAuthentication()
            || this.getConfigureIncomingPreAuthentication());
    }
    window.CreationState = CreationState;
}(require('applinks/js/util')));
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-new-ui-creation', location = 'js/new/applinks-externalinitiation.js' */
(function($, applinksUtil){
    /**
     * Functionality covering initiation of the Application links creation workflow from outside the AppLinks Admin page.
     */
    AppLinks.ExternalInitiation = {
        // parameter key names
        INITIATOR_REDIRECT_KEY : "initiatorRedirect",
        INITIATOR_REDIRECTNAME_KEY : "initiatorRedirectName",
        INITIATOR_TARGETURL_KEY : "initiatorTargetUrl",
        INITIATOR_SHAREDUSERBASE_KEY : "initiatorSharedUserbase",
        INITIATOR_ISREMOTEADMIN_KEY : "initiatorIsRemoteAdmin",
        APPLINKS_CREATION_STATUS_KEY: "applinksCreationStatus",
        APPLINKS_CREATION_STATUS_REASON_KEY: "applinksCreationStatusReason",
        APPLINKS_CREATION_ID_KEY: "applinksCreatedId",
        APPLINKS_CREATION_STATUS_SUCCESS: "created",
        APPLINKS_CREATION_STATUS_FAIL: "failed",
        /**
         * Get the redirect parameter
         * @returns {*}
         */
        getRedirectParam: function () {
            return applinksUtil.getParameterValue(AppLinks.ExternalInitiation.INITIATOR_REDIRECT_KEY);
        },
        /**
         * Get the Application target name parameter.
         * @returns {*}
         */
        getRedirectNameParam: function () {
            return applinksUtil.getParameterValue(AppLinks.ExternalInitiation.INITIATOR_REDIRECTNAME_KEY);
        },
        /**
         * Get the Application target url parameter.
         * @returns {*}
         */
        getTargetUrlParam: function () {
            return applinksUtil.getParameterValue(AppLinks.ExternalInitiation.INITIATOR_TARGETURL_KEY);
        },
        /**
         * Get the SharedUserbase parameter.
         * @returns {*}
         */
        getSharedUserbaseParam: function () {
            return applinksUtil.getParameterValue(AppLinks.ExternalInitiation.INITIATOR_SHAREDUSERBASE_KEY);
        },
        /**
         * Get the isRemoteAdmin parameter.
         * @returns {*}
         */
        getIsRemoteAdminParam: function () {
            return applinksUtil.getParameterValue(AppLinks.ExternalInitiation.INITIATOR_ISREMOTEADMIN_KEY);
        },
        /**
         * Initialize the ExternalInitiation fields.
         */
        init: function(creationState) {
            creationState.setInitiatorRedirect(AppLinks.ExternalInitiation.getRedirectParam());
            creationState.setInitiatorRedirectName(AppLinks.ExternalInitiation.getRedirectNameParam());
            creationState.setInitiatorTargetUrl(AppLinks.ExternalInitiation.getTargetUrlParam());
            creationState.setInitiatorSharedUserbase(AppLinks.ExternalInitiation.getSharedUserbaseParam());
            creationState.setInitiatorIsRemoteAdmin(AppLinks.ExternalInitiation.getIsRemoteAdminParam());

            // if passed a target url, set the applicaiton link url entry field.
            if(creationState.getInitiatorTargetUrl() !== null
                && creationState.getInitiatorTargetUrl() !== "") {
                AppLinks.Creation.userDefinedUrlField.val(creationState.getInitiatorTargetUrl());
            }
        },
        /**
         * Redirect the user to the InitiatorRedirect informing the user what is going on.
         */
        redirectToInitiatorRedirect: function (creationState) {
            applinksUtil.waitUntilDone(function() {
                return {
                    'wait': function() {
                        var target = creationState.getInitiatorRedirectName() !== null ? creationState.getInitiatorRedirectName() : creationState.getInitiatorRedirect();
                        AppLinks.Creation.Dialogs.showRedirectPauseDialog(false, target);
                    },
                    'done': function(){
                        window.location = AppLinks.ExternalInitiation.generateInitiatorRedirectionUrl(creationState);
                    }
                };
            })();
        },
        /**
         * Show a dialog informing the user they are being redirected.
         * @returns {{wait: Function, done: Function}}
         */
        showRedirectToRedirect: function(creationState) {
            return {
                'wait': function() {
                    var target = creationState.getInitiatorRedirectName() !== null ? creationState.getInitiatorRedirectName() : creationState.getInitiatorRedirect();
                    AppLinks.Creation.Dialogs.showRedirectPauseDialog(false, target);
                },
                'done': function(){
                    window.location = AppLinks.ExternalInitiation.generateInitiatorRedirectionUrl(creationState);
                }
            };
        },
        /**
         * Apply the initiator provided values to the creation dialog.
         */
        setDialogInitiatorDefaults: function(creationState) {
            if(!creationState.doInitiatorRedirect()) {
                return;
            }
            if (creationState.getInitiatorSharedUserbase() !== null)
            {
                $('#userbase').prop('checked', creationState.getInitiatorSharedUserbase() == 'true');
            }

            if (creationState.getInitiatorIsRemoteAdmin() !== null)
            {
                $('#isAdmin').prop('checked', creationState.getInitiatorIsRemoteAdmin() == 'true');
            }
        },
        /**
         * Generate the url to use to redirect the user back to the initiator
         * @return {*}
         */
        generateInitiatorRedirectionUrl: function (creationState) {
            var parametersMap = {};

            if(creationState.creationHasCompletedSuccessfully()) {
                parametersMap[AppLinks.ExternalInitiation.APPLINKS_CREATION_STATUS_KEY] = AppLinks.ExternalInitiation.APPLINKS_CREATION_STATUS_SUCCESS;
                parametersMap[AppLinks.ExternalInitiation.APPLINKS_CREATION_ID_KEY] = creationState.getOriginalCreatedApplicationLinkId();
            } else {
                parametersMap[AppLinks.ExternalInitiation.APPLINKS_CREATION_STATUS_KEY] = AppLinks.ExternalInitiation.APPLINKS_CREATION_STATUS_FAIL;
                parametersMap[AppLinks.ExternalInitiation.APPLINKS_CREATION_STATUS_REASON_KEY] = creationState.getFirstFailureStatusDetail();
                if(creationState.getOriginalCreatedApplicationLinkId() !== null) {
                    parametersMap[AppLinks.ExternalInitiation.APPLINKS_CREATION_ID_KEY] = creationState.getOriginalCreatedApplicationLinkId();
                }
            }

            // make sure the redirection URL has a protocol, add http if there isn't one
            return AppLinks.Creation.generateUrl(AppLinks.UI.addProtocolToURL(creationState.getInitiatorRedirect()), parametersMap);
        },
        /**
         * Check the redirect status and if required force the redirect.
         */
        processInitiatorRedirect: function(creationState)
        {
            if (creationState.doInitiatorRedirect() && creationState.creationHasCompleted())
            {
                // redirect to the redirect
                AppLinks.ExternalInitiation.redirectToInitiatorRedirect(creationState);
            }
        }
}
})(AJS.$, require('applinks/js/util'));
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-new-ui', location = 'js/new/ui.js' */
(function($, _, applinksUtil, window, applinksSPI, applinksCreation, ApplinksEvents){
    /**
     * Init UI bindings.
     */
    function init() {
        applinksCreation.get().userDefinedUrlField = $('#applinks-url-entered');
        applinksCreation.get().createAppLinkButton = $('#applinks-create-button');

        applinksCreation.get().Dialogs.bindDialogBehaviors();

            applinksCreation.get().userDefinedUrlField.on('input', function() {
                applinksCreation.get().Dialogs.setSubmitStatus();
            });


        applinksCreation.get().Dialogs.resetProcess();

        if (applinksCreation.get().getCreationState().isCreatingReciprocal()) {

            var url = applinksCreation.get().getSubmittedRemoteUrl();
            applinksCreation.get().getCreationState().setCorrectedUrl(url);

            if (!applinksCreation.get().userDefinedUrlField.length) {
                //something is wrong
                AJS.log('Something is wrong. New workflow resources provided but UI elements not found.');
                applinksCreation.get().Dialogs.showApplinkCreationWorkflowNotAvailableDialog(AJS.format("Click Continue to be redirected back to \u0027\u0027{0}\u0027\u0027 or Cancel to remain here.", applinksCreation.get().getCreationState().getCorrectedUrl()), applinksCreation.get().globalCreationState);
                return;
            }
            // in App2 after a redirect from App1
            // start the creation process
            // ignore errors
            // optionally respect redirects
            applinksCreation.get().Process.fetchManifests(false, applinksCreation.get().getCreationState());
        } else {

            // App 1
            $('#createApplicationLink').submit(function(e) {
                //Not always called via an event.
                e && e.preventDefault();

                if(applinksCreation.get().createAppLinkButton.prop('disabled')
                    && applinksCreation.get().getCreationState().getInitiatorTargetUrl() == null) {
                    return;
                }

                AppLinks.UI.hideErrorBox();
                AppLinks.UI.hideInfoBox();

                if (!applinksCreation.get().userDefinedUrlField.length) {
                    //something is wrong
                    AJS.log('Something is wrong. New workflow resources provided but UI elements not found.');
                    applinksCreation.get().Dialogs.showApplinkCreationWorkflowNotAvailableDialog(null, applinksCreation.get().getCreationState());
                    return;
                }

                function createGenericLinkViaDescriptor() {
                    var applinkDescriptor = JSON.parse(applinksCreation.get().userDefinedUrlField.val());

                    if(!applinkDescriptor["consumerKey"]){
                        applinkDescriptor["consumerKey"] = applinkDescriptor["name"];

                    }
                    if(! applinkDescriptor["consumerName"]){
                        applinkDescriptor["consumerName"] = applinkDescriptor["name"];
                    }

                    var applinkCreated = null;
                    applinksSPI.get().createApplicationLink(
                        null,
                        applinkDescriptor["name"],
                        applinkDescriptor["url"],
                        applinkDescriptor["url"],
                        "generic", function () {
                        },
                        applinksCreation.get().Dialogs.handleRestErrors
                    ).success(_.bind(function (data) {
                        applinkCreated = data["resources-created"][0]["href"];
                        var slicedId = applinkCreated.split("/");
                        var id = slicedId[slicedId.length - 1];

                        applinksSPI.get().createConsumer(id,
                            applinkDescriptor["consumerKey"],
                            applinkDescriptor["consumerName"],
                            null,
                            null,
                            applinkDescriptor["publicKey"],
                            false,
                            null,
                            null,
                            false,
                            function () {
                                window.location.reload();
                            },

                            _.bind(function (data) {
                                AppLinks.SPI.deleteLink(id, false, function () {
                                }, function () {
                                });
                                applinksCreation.get().Dialogs.handleRestErrors(data);

                            }), this)
                    }), this);
                }

                //indicates that the user has submitted something that looks like JSON, we'll assume it's an applinkDescriptor
                if( applinksCreation.get().userDefinedUrlField.val()[0] === "{"){
                    createGenericLinkViaDescriptor.call(this);
                    return
                }


                // started a new creation process so explicitly create a new creationState
                applinksCreation.get().initCreationState();

                // start the status log
                applinksCreation.get().getCreationState().updateStatusLog(applinksCreation.get().STATUS_CREATION_INPROGRESS);

                // must be run after as it tweaks the creationState to reflect the external initiation if there is one.
                AppLinks.ExternalInitiation.init(applinksCreation.get().getCreationState());

                // make sure the entered URL has a protocol before going any further.
                var url = AppLinks.UI.addProtocolToURL(applinksCreation.get().userDefinedUrlField.val());
                applinksCreation.get().getCreationState().setUserDefinedUrl(url);
                applinksCreation.get().getCreationState().setCorrectedUrl(applinksCreation.get().getCreationState().getUserDefinedUrl());

                // will disable the form submission button and add a spinner.
                applinksCreation.get().Dialogs.resetProcess();

                // start the creation process
                // don't ignore errors
                // respect redirects
                applinksCreation.get().Process.fetchManifests(false, applinksCreation.get().getCreationState());
            });

            if (applinksCreation.get().getCreationState().reciprocalCreationCompleted()) {
                // 2-stage Local Creation: the following would support creation of the link and configure incoming authentication in the
                // local app, before redirecting to the remote app to create a link and configure incoming and outgoing authentication
                // before redirecting to the local app to configure the outgoing authentication.
                if(applinksCreation.get().Process.twoStageCreation) {
                    var ualLinkCreation = applinksCreation.get().Process.retrieveUalLinkAndConfigureOutgoing(applinksCreation.get().getCreationState());
                    ualLinkCreation.progress(function () {
                        //
                    });
                    ualLinkCreation.done(function () {
                        applinksUtil.waitUntilDone(function() {
                            return applinksCreation.get().Process.successNoRedirect(applinksCreation.get().getCreationState());
                        })();
                    });
                    ualLinkCreation.fail(function () {
                        //@todo: handle promise rejection, likely an ajax call failure.
                    });
                } else {
                    applinksCreation.get().Process.showFinalStatus(applinksCreation.get().getCreationState());
                }
            }
        }
    }

    $(document).bind(ApplinksEvents.READY, function() {
        applinksSPI.get().setApiVersion("3.0");

        applinksCreation.get().getAndDisplayOutstandingMessages();

        init();

        // must be run after init() as it needs everything it sets up.
        AppLinks.ExternalInitiation.init(applinksCreation.get().globalCreationState);

        // if the the process was initiated externally and a starting url was provided, shortcut the first stage of the process
        if(applinksCreation.get().globalCreationState.initiatorTargetUrl !== null) {
            $('#createApplicationLink').submit();
        }

        // if a new applink has just been created - fire the event
        applinksCreation.get().fireEventIfApplinkCreated();
    });
})(require('applinks/lib/jquery'), require('applinks/lib/lodash'), require('applinks/js/util'), require('applinks/lib/window'), require('applinks/lib/spi'), require('applinks/lib/creation'), require('applinks/common/events'));
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-new-table', location = 'js/new/warnings.js' */
(function($){
AppLinks.Warnings = {
    upgradeApplinkWarning: function(application, appLinkState) {
        var upgradeLink = applinks.templates.list.getUpgradeWarning({name: application.name, id: application.id});
        AppLinks.UI.showWarningBox(upgradeLink);

        $('.upgrade-' + application.id).click(appLinkState, function (e) {
            var upgradeDialogSettings;
            e.preventDefault();
            AppLinks.UI.hideInfoBox();
            if (e.data === 'UPGRADED_TO_UAL') {
                upgradeDialogSettings = {
                    application: application,
                    description: AJS.format("The remote application \u0027\u0027{0}\u0027\u0027 appears to have been upgraded. This wizard lets you apply these changes to the application link to ensure your project links keep working properly.", application.name),
                    manifest: {
                        name: application.name,
                        typeId: application.typeId
                    },
                    successCallback: function (upgradedApplicationLink) {
                        // called when the upgrade completed successfully
                        AppLinks.UI.listApplicationLinks(upgradedApplicationLink.applicationLink.name, 'upgrade', upgradedApplicationLink);
                    }
                };
                AppLinks.showUpgradeLinkToUALDialog(upgradeDialogSettings);
            } else {
                var localEntityTypeString = AppLinks.UI.prettyJoin(localEntityTypeIdStrings,
                    function (key) {
                        return AppLinks.I18n.getEntityTypeName(key);
                    }, "and");
                upgradeDialogSettings = {
                    application: application,
                    description: AJS.format("The remote application \u0027\u0027{0}\u0027\u0027 may have been relocated. To ensure our {1} links remain working properly, we can update the Application Link.", application.name, localEntityTypeString),
                    helpKey: 'applinks.docs.upgrade.application.link',
                    submit: function (success, error) {
                        AppLinks.SPI.legacyUpgrade(application, success, error);
                    },
                    callback: function (newApplicationId) {
                        application.applicationId = newApplicationId;
                        AppLinks.UI.listApplicationLinks(application.name, 'upgrade');
                    }
                };
                AppLinks.showUpgradeLinkDialog(upgradeDialogSettings);
            }
        });
    },
    relocateApplinkWarning: function(application) {
        var relocateLink;
        AppLinks.UI.showWarningBox(applinks.templates.list.getRelocateWarning({name:application.name, id:application.id, rpcUrl: application.rpcUrl}));
        relocateLink = $('.relocate-' + application.id);
        relocateLink.on('click', function(e) {
            e.preventDefault();
            AppLinks.UI.hideInfoBox();
            var relocateDialogSettings = {
                description: AJS.format("Relocate Application Link \u0027\u0027{0}\u0027\u0027 to a different URL.", application.name),
                application: application,
                helpKey: 'applinks.docs.relocate.application.link',
                doRelocate: function(newUrl, success, error) {
                    AppLinks.SPI.relocate(application, newUrl, false, success, error);
                },
                doForceRelocate: function(newUrl, success, error) {
                    AppLinks.SPI.relocate(application, newUrl, true, success, error);
                },
                callback: function() {
                    AppLinks.UI.listApplicationLinks(application.name, 'relocate');
                }
            };
            AppLinks.showRelocateLinkDialog(relocateDialogSettings);
        });
    }
};
})(AJS.$);;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-new-table', location = 'js/new/list-applinks-table.js' */
/**
 * NOTE: this file implements Applinks V2 UI, which is no longer in use. Unfortunately some parts of it are still
 * used in V3 UI and therefore it cannot be simply removed without making sure it doesn't break any important 
 * functionality in V3.
 */

AJS.$(document).bind(AppLinks.Event.PREREADY, function() {
    var $ = AJS.$;

    var eventSuccessI18n = {
        "i18n-update": function(applicationName) {
            return AJS.format("Updated Application Link \u0027\u0027{0}\u0027\u0027 successfully.", applicationName)
        },
        "i18n-relocate": function(applicationName) {
            return AJS.format("applinks.link.relocate.success", applicationName)
        },
        "i18n-upgrade": function(applicationName) {
            return AJS.format("Upgraded Application Link \u0027\u0027{0}\u0027\u0027 successfully.", applicationName)
        },
        "i18n-delete": function(applicationName) {
            return AJS.format("Deleted Application Link \u0027\u0027{0}\u0027\u0027 successfully.", applicationName)
        },
        "i18n-primary": function(applicationName) {
            return AJS.format("New primary link \u0027\u0027{0}\u0027\u0027 success.", applicationName)
        }
    };

    //Bind success messages
    $.each(['update', 'relocate', 'upgrade', 'delete', 'primary'], function(i, current) {
        AppLinks.UI.bind(current, function(event, applicationName) {
            AppLinks.UI.showInfoBox($('<span>').text(eventSuccessI18n['i18n-' + current](applicationName)));
        });
    });

    $.extend(AppLinks.UI || {}, {
        listApplicationLinks: function(appLinkIdOrName, operation, status) {

            // if we are about to redirect don't bother refreshing the list
            if(AppLinks.Creation.aboutToRedirect()) {
                return;
            }

            //otherwise refresh the list
            var applicationList = $('#applicationsList');
            applicationList.removeClass("fully-loaded");
            $('.no-links').hide();
            $('.links-loading').show();
            $('.relocate-warning').closest('.aui-message.aui-message-warning').remove();
            $('.upgrade-warning').closest('.aui-message.aui-message-warning').remove();
            $('#application-links-table').hide();
            applicationList.empty();
            AppLinks.SPI.getAllLinksWithAuthInfo(function(applicationList) {
                var tableBody = $('#applicationsList'),
                    applicationLinksAndAuthInfo = applicationList.list,
                    createRow = function(application, isSystem) {
                        var extensions = {
                            typeLabel: AppLinks.I18n.getApplicationTypeName(application.typeId)
                        };
                        var row;
                        if (isSystem) {
                            row = $(AJS.template.load('al-system-row')
                                .fill($.extend(extensions, application))
                                .fillHtml({applicationId: application.id})
                                .fillHtml({iconTag: application.iconUrl ?
                                    AJS.template.load('al-row-application-icon').fill({iconUrl: application.iconUrl}).toString() :
                                    ""})
                                .toString());
                        } else {
                            row = $(AJS.template.load('al-row')
                                .fill($.extend(extensions, application))
                                .fillHtml({applicationId: application.id})
                                .fillHtml({iconTag: application.iconUrl ?
                                    AJS.template.load('al-row-application-icon').fill({iconUrl: application.iconUrl}).toString() :
                                    ""})
                                .toString());
                            row.find(".app-delete-link").click({application: application}, AppLinks.bindDeleteLink);
                            row.find(".app-edit-link").click({application: application}, AppLinks.bindEditAppLink);

                            if (!application.isPrimary) {
                                row.find(".app-toggleprimary-action").show();
                                row.find(".app-toggleprimary-link").on('click', function(e) {
                                    e.preventDefault();
                                    AppLinks.UI.hideInfoBox();
                                    AppLinks.SPI.makePrimary(application, function() {
                                        AppLinks.UI.listApplicationLinks(application.id, 'primary');
                                    });
                                });
                            } else {
                                row.find(".app-toggleprimary-action").hide();
                            }

                            if ( $('#ual.list-links').data("sysadminFlag")) {
                                AppLinks.SPI.getApplicationLinkState(application.id,  function(result) {
                                    if (result.appLinkState === 'OFFLINE') {
                                        AppLinks.Warnings.relocateApplinkWarning(application);
                                    }
                                    else if (result.appLinkState !== 'OK') {
                                        AppLinks.Warnings.upgradeApplinkWarning(application, result.appLinkState);
                                    }
                                }, function(data) {
                                    var message = AppLinks.parseError(data);
                                    AppLinks.UI.showErrorBox(message);
                                });
                            }
                        }

                        var toAttrib = function(key, value) {
                            return (typeof value === "undefined" || value === null || value === "") ?
                                "" : (key + "='" + value + "'");
                        };
                        var actions = row.find("ul.app-actions");
                        for (var i = 0; i < application.webItems.length; i++) {
                            var wi = application.webItems[i];
                            // render the icon html (if needed)
                            if (wi.iconUrl) {
                                wi.icon = AJS.template.load('al-row-op-webitem-icon').fill(wi).toString()
                            } else {
                                wi.icon = "";
                            }
                            wi.id = toAttrib("id", wi.id);
                            wi.tooltip = toAttrib("tooltip", wi.tooltip);
                            wi.styleClass = toAttrib("styleClass", wi.styleClass);
                            wi.accessKey = toAttrib("accessKey", wi.accessKey);
                            // add the rendered web-item to the row
                            actions.append(AJS.template.load('al-row-op-webitem').fill(wi).toString());
                        }
                        for (var x = 0; x < application.webPanels.length; x++) {
                            var wp = application.webPanels[x];
                            actions.append($("<li>| " + wp.html + "</li>"));
                        }

                        return row;
                    };

                var modifiedApplicationLinkAndAuthInfo;
                $('.links-loading').hide();
                if (applicationLinksAndAuthInfo.length == 0) {
                    $('#application-links-table').hide();
                    $('.no-links').show();
                    $('#add-first-application-link').on('click', function(e) {
                        e.preventDefault();
                        $('#add-application-link').click();
                    });
                } else {
                    $('#application-links-table').show();
                    $('.no-links').hide();
                }

                var multipleTypes = false,
                    tempTypeId;
                for (var x = 0, xx = applicationLinksAndAuthInfo.length; x < xx; x++) {
                    var appInfo = applicationLinksAndAuthInfo[x],
                        application = appInfo.application;
                    application.hasIncoming = appInfo.hasIncomingAuthenticationProviders;
                    application.hasOutgoing = appInfo.hasOutgoingAuthenticationProviders;
                    application.webItems = appInfo.webItems;
                    application.webPanels = appInfo.webPanels;
                    if (!multipleTypes && tempTypeId && tempTypeId == application.typeId) {
                        multipleTypes = true;
                    }
                    tempTypeId = application.typeId;
                    if (appLinkIdOrName && application.id == appLinkIdOrName) {
                        modifiedApplicationLinkAndAuthInfo = appInfo;
                    }

                    tableBody.append(createRow(application, appInfo.isSystem));
                }

                if (multipleTypes) {
                    $('.primary-column').show();
                } else {
                    $('.primary-column').hide();
                }

                if (appLinkIdOrName) {
                    AppLinks.UI.trigger(operation, appLinkIdOrName, operation, status);
                    if (operation == 'new') {
                        var message;
                        if (!modifiedApplicationLinkAndAuthInfo || !modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators || modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators.length == 0) {
                            message = AJS.format("Created a link to \u0027\u0027{0}\u0027\u0027 without outgoing authentication.", AppLinks.UI.sanitiseHTML(modifiedApplicationLinkAndAuthInfo.application.name));
                        } else if (modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators && modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators.length == 1) {
                            message = AJS.format("Created a two-way link to \u0027\u0027{0}\u0027\u0027 using {1}.", AppLinks.UI.sanitiseHTML(modifiedApplicationLinkAndAuthInfo.application.name), AppLinks.I18n.getAuthenticationTypeName(modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators[0]));
                        } else {
                            message = AJS.format("Created a link to \u0027\u0027{0}\u0027\u0027 with {1} configured authentication types.", AppLinks.UI.sanitiseHTML(modifiedApplicationLinkAndAuthInfo.application.name), modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators.length);
                        }

                        if (!status.autoConfigurationSuccessful) {
                            message += " " + "There was a problem with the auto configuration with one or more authentication providers. Please check the server log for more information.";
                        }
                        AppLinks.UI.showInfoBox(message);

                        if (modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators.length == 0) {
                            $(".page-info").append(" " + AJS.format("{0}Configure authentication{1}.", "<a href='#' id='edit-new-link'>", "</a>"));
                        }

                        if (AppLinks.SPI.showCreateEntityLinkSuggestion()) {
                            /**
                             * Now render the suggestion for the next step:
                             * "Next you should link a Charlie to a FishEye Repository or Crucible Project. You can do this from the
                             * Charlie admin page."
                             */
                            var localEntityTypeString = AppLinks.UI.prettyJoin(localEntityTypeIdStrings,
                                function(key) {
                                    return AppLinks.I18n.getEntityTypeName(key);
                                }, "or");
                            var remoteEntityTypeString = AppLinks.UI.prettyJoin(modifiedApplicationLinkAndAuthInfo.entityTypeIdStrings,
                                function(key) {
                                    return AppLinks.I18n.getEntityTypeName(key);
                                }, "or");
                            var suggestion = AJS.format("After that you should link a {0} to a {1}. You can do this from the {0} admin page.",
                                localEntityTypeString, remoteEntityTypeString);
                            $(".page-info").append("<br>" + suggestion);
                        }

                        $('#edit-new-link').on('click', function(e) {
                            e.preventDefault();
                            AppLinks.UI.hideInfoBox();
                            AppLinks.editAppLink(modifiedApplicationLinkAndAuthInfo.application, 'undefined', false, function(updated) {
                                AppLinks.UI.listApplicationLinks(updated.id, 'update');
                                return true;
                            }, function() {
                                AppLinks.UI.listApplicationLinks();
                                return true;
                            });
                        });
                    } else if (operation == 'upgrade') {
                        if (status && status.message && $.isArray(status.message) && status.message.length > 0) {
                            AppLinks.UI.showWarningBox(status.message);
                        }
                    }
                }
                tableBody.addClass("fully-loaded");
            }, function(data) {
                $('.links-loading').hide();
                var message = AppLinks.parseError(data);
                AppLinks.UI.showErrorBox(message);
            });

            AppLinks.UI.refreshOrphanedTrust();
        }
    });
});;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.component.inline-dialog2', location = 'aui.chunk.94423b920bb6fd8444bf--c2bcb142e280f8838ece.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.inline-dialog2"],[],[["Rvtc","runtime","aui.splitchunk.vendors--1df5b34e16","aui.splitchunk.vendors--084821f40b","aui.splitchunk.172ffb6da7","aui.splitchunk.b0831cc7d0","aui.splitchunk.572a8bf5cd","aui.splitchunk.a16cabd587","aui.splitchunk.fbd1a5ab27","aui.splitchunk.d49cf794d2","aui.splitchunk.54d3f16c20","aui.splitchunk.1659111a3c","aui.splitchunk.bc4873e5f9","aui.splitchunk.1df5b34e16","aui.splitchunk.fb15cffa72","aui.splitchunk.8659b532c1","aui.splitchunk.3e0cdb810a","aui.splitchunk.d0110a864f","aui.splitchunk.afa5039e04","aui.splitchunk.c750721820","aui.splitchunk.6d6f245ed3","aui.splitchunk.084821f40b","aui.splitchunk.5b8c290363","aui.splitchunk.baa83dbaf9","aui.splitchunk.36cd9d521c","aui.splitchunk.d925afe2c0","aui.splitchunk.5b7fdbd666","aui.splitchunk.8a641c03a4","aui.splitchunk.d727dd207f","aui.splitchunk.543254b237"]]]);
//# sourceMappingURL=aui.chunk.94423b920bb6fd8444bf--c2bcb142e280f8838ece.js.map;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.pattern.help', location = 'aui.chunk.97b0b8778b1dab612048--03b806a46f5014eb639d.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.pattern.help"],{EoRc:function(i,u,n){},H4sa:function(i,u,n){"use strict";n("FStl"),n("Q0fs"),n("nqD9"),n("0FWE"),n("VtiI"),n("EoRc")}},[["H4sa","runtime","aui.splitchunk.vendors--7da3927366","aui.splitchunk.b0831cc7d0","aui.splitchunk.572a8bf5cd","aui.splitchunk.d49cf794d2","aui.splitchunk.d925afe2c0","aui.splitchunk.d727dd207f","aui.splitchunk.7da3927366"]]]);
//# sourceMappingURL=aui.chunk.97b0b8778b1dab612048--03b806a46f5014eb639d.js.map;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--6372529f0d', location = 'aui.chunk.51d64ebdd5b608183531--6f8de0a702a601fa238b.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--6372529f0d"],{mJZu:function(n,t,i){(function(t){!function(t,i){n.exports=function(n){if(n.CSS&&n.CSS.escape)return n.CSS.escape;var t=function(n){for(var t,i=String(n),r=i.length,o=-1,e="",u=i.charCodeAt(0);++o<r;)0!=(t=i.charCodeAt(o))?e+=t>=1&&t<=31||127==t||0==o&&t>=48&&t<=57||1==o&&t>=48&&t<=57&&45==u?"\\"+t.toString(16)+" ":(0!=o||1!=r||45!=t)&&(t>=128||45==t||95==t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122)?i.charAt(o):"\\"+i.charAt(o):e+="�";return e};n.CSS||(n.CSS={});return n.CSS.escape=t,t}(t)}(void 0!==t?t:this)}).call(this,i("uKge"))}}]);
//# sourceMappingURL=aui.chunk.51d64ebdd5b608183531--6f8de0a702a601fa238b.js.map;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.deprecated.component.inline-dialog1', location = 'aui.chunk.11b5a1d3b8901f5c77a6--b00e1de37013bbd1820b.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.deprecated.component.inline-dialog1"],{"/L3Z":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InlineDialog=void 0;var o=i("zAx8");Object.defineProperty(e,"InlineDialog",{enumerable:!0,get:function(){return function(t){return t&&t.__esModule?t:{default:t}}(o).default}}),i("NjKm")},zAx8:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=d(i("+x/D")),n=i("cWqH"),a=u(i("bPPT")),l=u(i("JFi+")),r=d(i("KloK")),f=d(i("+ay7")),s=d(i("mJZu"));function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}function d(t){return t&&t.__esModule?t:{default:t}}function c(t,e,i,a){if((a=a||[]).hasOwnProperty("onTop")&&(v(),a.onTop&&void 0===a.gravity&&(a.gravity="s")),void 0===e&&(e=String(Math.random()).replace(".",""),(0,o.default)("#inline-dialog-"+e+", #arrow-"+e+", #inline-dialog-shim-"+e).length))throw"GENERATED_IDENTIFIER_NOT_UNIQUE";var r,u,d,h=(0,s.default)(e),p=o.default.extend(!1,c.opts,a);"w"===p.gravity&&(p.offsetX=void 0===a.offsetX?10:a.offsetX,p.offsetY=void 0===a.offsetY?0:a.offsetY);var g,m,y=!1,b=!1,C=!1,k=(0,o.default)('<div id="inline-dialog-'+e+'" class="aui-inline-dialog"><div class="aui-inline-dialog-contents contents"></div><div id="arrow-'+e+'" class="aui-inline-dialog-arrow arrow aui-css-arrow"></div></div>'),T=(0,o.default)("#arrow-"+h,k),O=k.find(".contents");p.displayShadow||O.addClass("aui-inline-dialog-no-shadow"),p.autoWidth?O.addClass("aui-inline-dialog-auto-width"):O.width(p.width),O.on({mouseenter:function(){clearTimeout(u),k.unbind("mouseenter")},mouseleave:function(){_()}});var M=function(){return r||(r={popup:k,hide:function(){_(0)},id:e,show:function(){X()},persistent:!!p.persistent,reset:function(){var t=(0,o.default)(window).height(),i=Math.round(.75*t);k.children(".aui-inline-dialog-contents").css("max-height",i);var a=p.calculatePositions(k,m,g,p);if(a.hasOwnProperty("displayAbove")&&(w(),a.gravity=a.displayAbove?"s":"n"),function(t,e){t.css(e.popupCss),T.removeClass("aui-bottom-arrow aui-left-arrow aui-right-arrow"),"s"!==e.gravity||T.hasClass("aui-bottom-arrow")?"w"===e.gravity?T.addClass("aui-left-arrow"):"e"===e.gravity&&T.addClass("aui-right-arrow"):T.addClass("aui-bottom-arrow"),T.css(e.arrowCss)}(k,a),k.fadeIn(p.fadeTime,function(){}),(0,n.needsLayeringShim)()){var l=(0,o.default)("#inline-dialog-shim-"+h);l.length||(0,o.default)(k).prepend((0,o.default)('<iframe class = "inline-dialog-shim" id="inline-dialog-shim-'+e+'" frameBorder="0" src="javascript:false;"></iframe>')),l.css({width:O.outerWidth(),height:O.outerHeight()})}}}),r},X=function(){k.is(":visible")||(d=setTimeout(function(){C&&b&&(p.addActiveClass&&(0,o.default)(t).addClass("active"),y=!0,p.persistent||I(),c.current=M(),(0,o.default)(document).trigger("showLayer",["inlineDialog",M()]),M().reset())},p.showDelay))},_=function(e){void 0===e&&p.persistent||void 0===k.get(0)._datePickerPopup&&(b=!1,y&&p.preHideCallback.call(k[0].popup)&&(e=null==e?p.hideDelay:e,clearTimeout(u),clearTimeout(d),null!=e&&(u=setTimeout(function(){D(),p.addActiveClass&&(0,o.default)(t).removeClass("active"),k.fadeOut(p.fadeTime,function(){p.hideCallback.call(k[0].popup)}),y=!1,b=!1,(0,o.default)(document).trigger("hideLayer",["inlineDialog",M()]),c.current=null,p.cacheContent||(C=!1,L=!1)},e))))},x=function(t,n){var a=(0,o.default)(n);p.upfrontCallback.call({popup:k,hide:function(){_(0)},id:e,show:function(){X()}}),k.each(function(){void 0!==this.popup&&this.popup.hide()}),p.closeOthers&&(0,o.default)(".aui-inline-dialog").each(function(){!this.popup.persistent&&this.popup.hide()}),m={target:a},g=t?{x:t.pageX,y:t.pageY}:{x:a.offset().left,y:a.offset().top},y||clearTimeout(d),b=!0;return L||(L=!0,o.default.isFunction(i)?i(O,n,function(){L=!1,C=!0,p.initCallback.call({popup:k,hide:function(){_(0)},id:e,show:function(){X()}}),X()}):o.default.get(i,function(t,i,o){O.html(p.responseHandler(t,i,o)),C=!0,p.initCallback.call({popup:k,hide:function(){_(0)},id:e,show:function(){X()}}),X()})),clearTimeout(u),y||X(),!1};k[0].popup=M();var L=!1,P=!1,Y=function(){P||((0,o.default)(p.container).append(k),P=!0)},E=(0,o.default)(t);p.onHover?p.useLiveEvents?E.selector?(0,o.default)(document).on("mouseenter",E.selector,function(t){Y(),x(t,this)}).on("mouseleave",E.selector,function(){_()}):l.log("Warning: inline dialog trigger elements must have a jQuery selector when the useLiveEvents option is enabled."):E.on({mouseenter:function(t){Y(),x(t,this)},mouseleave:function(){_()}}):p.noBind||(p.useLiveEvents?E.selector?(0,o.default)(document).on("click",E.selector,function(t){return Y(),A()?k.hide():x(t,this),!1}).on("mouseleave",E.selector,function(){_()}):l.log("Warning: inline dialog trigger elements must have a jQuery selector when the useLiveEvents option is enabled."):E.on("click",function(t){return Y(),A()?k.hide():x(t,this),!1}).on("mouseleave",function(){_()}));var A=function(){return y&&p.closeOnTriggerClick},I=function(){j(),W()},D=function(){B(),S()},H=!1,F=e+".inline-dialog-check",j=function(){H||((0,o.default)("body").bind("click."+F,function(t){0===(0,o.default)(t.target).closest("#inline-dialog-"+h+" .contents").length&&_(0)}),H=!0)},B=function(){H&&(0,o.default)("body").unbind("click."+F),H=!1},N=function(t){t.keyCode===f.default.ESCAPE&&_(0)},W=function(){(0,o.default)(document).on("keydown",N)},S=function(){(0,o.default)(document).off("keydown",N)};return k.show=function(e,i){e&&e.stopPropagation(),Y(),!p.noBind||t&&t.length?x(e,t):x(e,void 0===i?e.target:i)},k.hide=function(){_(0)},k.refresh=function(){y&&M().reset()},k.getOptions=function(){return p},k}function h(t){var e=(0,o.default)(t);if((t=e.get(0))&&t===t.window)return{left:0,top:0,width:e.width(),height:e.height()};var i=e.offset()||{};return{left:i.left||0,top:i.top||0,width:e.outerWidth()||0,height:e.outerHeight()||0}}function p(t,e,i,n){var a=function(t,e,i,n){var a=o.default.isFunction(n.offsetX)?n.offsetX(t,e,i,n):n.offsetX,l=o.default.isFunction(n.offsetY)?n.offsetY(t,e,i,n):n.offsetY,r=o.default.isFunction(n.arrowOffsetX)?n.arrowOffsetX(t,e,i,n):n.arrowOffsetX,f=o.default.isFunction(n.arrowOffsetY)?n.arrowOffsetY(t,e,i,n):n.arrowOffsetY,s="body"!==n.container.toLowerCase(),u=(0,o.default)(n.container),d=s?(0,o.default)(n.container).parent():(0,o.default)(window),c=s?u.offset():{left:0,top:0},h=s?d.offset():{left:0,top:0},p=e.target,g=p.offset(),w=p[0].getBBox&&p[0].getBBox();return{screenPadding:10,arrowMargin:5,window:{top:h.top,left:h.left,scrollTop:d.scrollTop(),scrollLeft:d.scrollLeft(),width:d.width(),height:d.height()},scrollContainer:{width:u.width(),height:u.height()},trigger:{top:g.top-c.top,left:g.left-c.left,width:w?w.width:p.outerWidth(),height:w?w.height:p.outerHeight()},dialog:{width:t.width(),height:t.height(),offset:{top:l,left:a}},arrow:{height:t.find(".arrow").outerHeight(),offset:{top:f,left:r}}}}(t,e,i,n),l=a.screenPadding,r=a.window,f=a.trigger,s=a.dialog,u=a.arrow,d=a.scrollContainer,c=f.top-r.scrollTop,h=f.left-r.scrollLeft,p=Math.floor(f.height/2),g=Math.floor(s.height/2),w=Math.floor(u.height/2),v=h-s.offset.left-l,m=d.width-h-f.width-s.offset.left-l,y=v>=s.width,b=!(m>=s.width)&&y?"e":"w",C=c+p-w,k=r.height-C-u.height;l=Math.min(l,C-a.arrowMargin),l=Math.min(l,k-a.arrowMargin);var T,O,M=c+p,X=Math.max(M-l,0),_=Math.max(r.height-M-l,0),x=g-s.offset.top>X,L=g+s.offset.top>_;return x?(T={top:r.scrollTop+l,left:"w"===b?f.left+f.width+s.offset.left:f.left-s.width-s.offset.left},O={top:f.top+p-(T.top+w)}):L?(T={top:r.scrollTop+r.height-s.height-l,left:"w"===b?f.left+f.width+s.offset.left:f.left-s.width-s.offset.left},O={top:f.top+p-(T.top+w)}):(T={top:f.top+p-g+s.offset.top,left:"w"===b?f.left+f.width+s.offset.left:f.left-s.width-s.offset.left},O={top:g-w+u.offset.top}),{gravity:b,popupCss:T,arrowCss:O}}function g(t,e,i,n){var a=o.default.isFunction(n.offsetX)?n.offsetX(t,e,i,n):n.offsetX,l=o.default.isFunction(n.offsetY)?n.offsetY(t,e,i,n):n.offsetY,r=o.default.isFunction(n.arrowOffsetX)?n.arrowOffsetX(t,e,i,n):n.arrowOffsetX,f=h(window),s=h(e.target),u=h(t),d=h(t.find(".aui-inline-dialog-arrow")),c=s.left+s.width/2,p=(window.pageYOffset||document.documentElement.scrollTop)+f.height;u.top=s.top+s.height+~~l,u.left=s.left+~~a;var g=f.width-(u.left+u.width+10);d.left=c-u.left+~~r,d.top=-d.height/2;var w=s.top>u.height,v=!(u.top+u.height<p)&&w||w&&"s"===n.gravity;if(v&&(u.top=s.top-u.height-d.height/2,d.top=u.height),n.isRelativeToMouse)g<0?(u.right=10,u.left="auto",d.left=i.x-(f.width-u.width)):(u.left=i.x-20,d.left=i.x-u.left);else if(g<0){u.right=10,u.left="auto";var m=f.width-u.right-u.width;d.right="auto",d.left=c-m-d.width/2}else u.width<=s.width/2&&(d.left=u.width/2,u.left=c-u.width/2);return{gravity:v?"s":"n",displayAbove:v,popupCss:{left:u.left,top:u.top,right:u.right},arrowCss:{left:d.left,top:d.top,right:d.right}}}c.opts={onTop:!1,responseHandler:function(t){return t},closeOthers:!0,isRelativeToMouse:!1,addActiveClass:!0,onHover:!1,useLiveEvents:!1,noBind:!1,fadeTime:100,persistent:!1,hideDelay:1e4,showDelay:0,width:300,offsetX:0,offsetY:10,arrowOffsetX:0,arrowOffsetY:0,container:"body",cacheContent:!0,displayShadow:!0,autoWidth:!1,gravity:"n",closeOnTriggerClick:!1,preHideCallback:function(){return!0},hideCallback:function(){},initCallback:function(){},upfrontCallback:function(){},calculatePositions:function(t,e,i,o){return("w"===(o=o||{}).gravity?p:g)(t,e,i,o)}},c=a.construct(c,"Inline dialog constructor",{alternativeName:"inline dialog 2"});var w=a.getMessageLogger("displayAbove","[remove version]",{alternativeName:"gravity",extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-2197."}),v=a.getMessageLogger("onTop","[remove version]",{alternativeName:"gravity",extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-2197."});(0,r.default)("InlineDialog",c),e.default=c,t.exports=e.default}},[["/L3Z","runtime","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--6372529f0d","aui.splitchunk.172ffb6da7","aui.splitchunk.a16cabd587","aui.splitchunk.fbd1a5ab27","aui.splitchunk.54d3f16c20","aui.splitchunk.1659111a3c","aui.splitchunk.bc4873e5f9","aui.splitchunk.def7f73e47","aui.splitchunk.d925afe2c0"]]]);
//# sourceMappingURL=aui.chunk.11b5a1d3b8901f5c77a6--b00e1de37013bbd1820b.js.map;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-components', location = 'applinks/internal/component/inline-dialog/inline-dialog.js' */
define('applinks/component/inline-dialog', [
    'applinks/lib/lodash',
    'applinks/lib/jquery',
    'applinks/lib/aui',
    'applinks/lib/skate',
    'applinks/common/dialog-focus'
], function(
    _,
    $,
    AJS,
    skate,
    DialogFocus
) {
    function isAuiBefore59() {
        return AJS.versionDetails.is58;
    }

    function InlineDialog(id, contents, options) {
        this.id = id;
        var popupHtml = applinks.inlineDialog.popup(_.extend({
            id: id,
            contents: contents,
            auiVersion: AJS.versionDetails
        }, options));

        this.$popup = $(popupHtml);
        this.popup = this.$popup[0];

        $('body').append(this.$popup);
        if (isAuiBefore59()) {
            // skate will be undefined from AUI 5.9 and later.
            // Note that "applinks/lib/skate" is a wrapper around window.skate and skate is not exposed as a global
            // from AUI 5.9.
            skate.init(this.popup);
        }
        this.onShow(_.partial(DialogFocus.defaultFocus, this.$popup));
    }

    InlineDialog.prototype.hide = function() {
        if (isAuiBefore59()) {
            this.popup.hide();
        } else {
            this.popup.removeAttribute('open');
        }
    };

    InlineDialog.prototype.show = function() {
        if (isAuiBefore59()) {
            this.popup.show();
        } else {
            this.popup.setAttribute('open', '');
        }
    };

    InlineDialog.prototype.isVisible = function() {
        if (isAuiBefore59()) {
            return this.popup.isVisible();
        } else {
            return this.popup.hasAttribute("open");
        }
    };

    InlineDialog.prototype.realign = function() {
        if (isAuiBefore59()) {
            this.popup.show();
        }
        return this;
    };

    InlineDialog.prototype.on = function() {
        this.$popup.on.apply(this.$popup, arguments);
        return this;
    };

    InlineDialog.prototype.onShow = function(callback) {
        if (isAuiBefore59()) {
            this.$popup.on('aui-layer-show', callback);
        } else {
            this.$popup.on('aui-show', callback)
        }
        return this;
    };

    InlineDialog.prototype.onHide = function(callback) {
        if (isAuiBefore59()) {
            this.$popup.on('aui-layer-hide', callback);
        } else {
            this.$popup.on('aui-hide', callback)
        }
        return this;
    };

    /**
     * @returns {HTMLElement} the DOM element representing this dialog's contents
     */
    InlineDialog.prototype.html = function() {
        return this.popup;
    };

    /**
     * @returns {jQuery} jQuery element representing this dialog's contents
     */
    InlineDialog.prototype.contents = function() {
        return this.$popup;
    };

    return InlineDialog;
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-components', location = 'applinks/internal/component/inline-dialog/inline-dialog.soy' */
// This file was automatically generated from inline-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace applinks.inlineDialog.
 */

if (typeof applinks == 'undefined') { var applinks = {}; }
if (typeof applinks.inlineDialog == 'undefined') { applinks.inlineDialog = {}; }


applinks.inlineDialog.popup58 = function(opt_data, opt_ignored) {
  return '<aui-inline-dialog2 id="' + soy.$$escapeHtml(opt_data.id) + '" alignment="' + soy.$$escapeHtml(opt_data.alignment) + '" responds-to="toggle" persistent="' + ((opt_data.persistent) ? 'true' : 'false') + '" ' + ((opt_data.open) ? 'open' : '') + '><div class="' + soy.$$escapeHtml(opt_data.classes) + '">' + soy.$$filterNoAutoescape(opt_data.contents) + '</div></aui-inline-dialog2>';
};
if (goog.DEBUG) {
  applinks.inlineDialog.popup58.soyTemplateName = 'applinks.inlineDialog.popup58';
}


applinks.inlineDialog.popup59 = function(opt_data, opt_ignored) {
  return '<aui-inline-dialog id="' + soy.$$escapeHtml(opt_data.id) + '" alignment="' + soy.$$escapeHtml(opt_data.alignment) + '" ' + ((opt_data.open) ? 'open' : '') + ' ' + ((opt_data.persistent) ? 'persistent' : '') + '><div class="' + soy.$$escapeHtml(opt_data.classes) + '">' + soy.$$filterNoAutoescape(opt_data.contents) + '</div></aui-inline-dialog>';
};
if (goog.DEBUG) {
  applinks.inlineDialog.popup59.soyTemplateName = 'applinks.inlineDialog.popup59';
}


applinks.inlineDialog.popup = function(opt_data, opt_ignored) {
  return '' + ((opt_data.auiVersion.is58) ? applinks.inlineDialog.popup58(opt_data) : applinks.inlineDialog.popup59(opt_data));
};
if (goog.DEBUG) {
  applinks.inlineDialog.popup.soyTemplateName = 'applinks.inlineDialog.popup';
}
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-components', location = 'applinks/internal/component/feature-discovery/feature-discovery.js' */
define('applinks/component/feature-discovery', [
    'applinks/lib/jquery',
    'applinks/lib/lodash',
    'applinks/common/features',
    'applinks/component/inline-dialog'
], function(
    $,
    _,
    ApplinksFeatures,
    InlineDialog
) {
    /**
     * Generic feature discovery component for Applinks.
     *
     * @param featureKey {string} ID of the feature
     * @param contents {string} contents of the feature discovery dialog
     * @param anchor {HTMLElement} DOM element to attach the feature discovery to
     */
    function FeatureDiscovery(featureKey, contents, anchor) {
        this.featureId = featureKey;
        this.contents = contents;
        this.anchor = anchor;
        this.popupId = 'feature-discovery-' + this.featureId;

        if (!ApplinksFeatures.isDiscovered(featureKey)) {
            this.init();
            ApplinksFeatures.discover(featureKey);
        }
    }

    FeatureDiscovery.prototype.init = function() {
        $(this.anchor).attr('aria-controls', this.popupId);

        this.dialog = new InlineDialog(this.popupId, this.contents, {
            alignment: 'bottom center',
            open: true,
            persistent: true
        });
        this.dialog.realign();
    };

    /**
     * Dismiss the feature discovery popup if it's being displayed to the user.
     */
    FeatureDiscovery.prototype.dismiss = function() {
        if (this._isDisplayed()) {
            this.dialog.hide();
        }
    };

    /**
     * Attach event hadlers to the feature discovery popup, if it has been displayed. Use the same arguments as for
     * `jQuery.on`
     * @see {@link http://api.jquery.com/on/}
     */
    FeatureDiscovery.prototype.on = function() {
        if (this._isDisplayed()) {
            var $popup = this.dialog.$popup;
            $popup.on.apply($popup, arguments);
        }
    };

    /**
     * Provide selector for an element inside the popup that should dismiss it.
     *
     * @param triggerSelector selector for an element that will dismiss this feature discovery popup
     * @return {Object} this feature discovery
     */
    FeatureDiscovery.prototype.dismissTrigger = function(triggerSelector) {
        this.on('click', triggerSelector, _.bind(this.dismiss, this));
        return this;
    };

    /**
     * Refresh the feature discovery popup (if already showing) and optionally attach to a new `anchor`. This is
     * required in some cases where DOM is modified after the popup has been displayed already, or the anchor is
     * re-rendered or changed.
     *
     * Note: if a new anchor is provided, the entire popup has to be re-rendered, so all event handlers attached to it
     * will have to be re-added to.
     *
     * @param anchor {HTMLElement} optional new anchor for the popup
     * @return {Object} this feature discovery
     */
    FeatureDiscovery.prototype.refresh = function(anchor) {
        if (this._isDisplayed()) {
            if (anchor) {
                // new anchor - need to re-render the entire dialog
                this.anchor = anchor;
                this.dialog.$popup.remove();
                this.init();
            } else {
                // re-align the inline dialog
                this.dialog.realign();
            }
        }

        return this;
    };

    FeatureDiscovery.prototype._isDisplayed = function() {
        return this.dialog && this.dialog.isVisible();
    };

    return FeatureDiscovery;
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-components', location = 'applinks/internal/component/feature-discovery/feature-discovery.soy' */
// This file was automatically generated from feature-discovery.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace applinks.component.feature.
 */

if (typeof applinks == 'undefined') { var applinks = {}; }
if (typeof applinks.component == 'undefined') { applinks.component = {}; }
if (typeof applinks.component.feature == 'undefined') { applinks.component.feature = {}; }


applinks.component.feature.featureDiscoveryPopup = function(opt_data, opt_ignored) {
  return '<aui-inline-dialog2 id="feature-discovery-' + soy.$$escapeHtml(opt_data.featureId) + '" data-feature-id="' + soy.$$escapeHtml(opt_data.featureId) + '" class="aui-help ' + ((opt_data.extraClasses) ? soy.$$escapeHtml(opt_data.extraClasses) : '') + '" alignment="bottom left" persistent="true"' + ((opt_data.extraAttributes) ? soy.$$filterNoAutoescape(opt_data.extraAttributes) : '') + ' open>' + soy.$$filterNoAutoescape(opt_data.contents) + '</aui-inline-dialog2>';
};
if (goog.DEBUG) {
  applinks.component.feature.featureDiscoveryPopup.soyTemplateName = 'applinks.component.feature.featureDiscoveryPopup';
}


applinks.component.feature.featureDiscoveryPopup57 = function(opt_data, opt_ignored) {
  return '' + applinks.component.feature.featureDiscoveryPopup({featureId: opt_data.featureId, contents: '<div class="aui-inline-dialog-contents">' + soy.$$filterNoAutoescape(opt_data.contents) + '</div>', extraAttributes: 'data-aui-alignment="bottom left" data-aui-persistent="true"', extraClasses: 'aui-layer aui-inline-dialog'});
};
if (goog.DEBUG) {
  applinks.component.feature.featureDiscoveryPopup57.soyTemplateName = 'applinks.component.feature.featureDiscoveryPopup57';
}
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-v2-shim', location = 'applinks/internal/feature/creation/applinks-creation-shim.js' */
// shim for the Applinks.Creation global, to be transformed into a good AMD law abiding citizen
define('applinks/feature/creation', function () {
    var creation = window.AppLinks.Creation;
    creation.isInProgress = function () {
        // if creation is in progress, the creation log array will be available
        var creationLog = creation.getSubmittedStatusLog();
        return creationLog && creationLog.length;
    };
    return creation;
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-v2-shim', location = 'applinks/internal/shim/applinks-shim.js' */
define('applinks/shim/applinks', [
    'applinks/lib/window',
    'applinks/common/preconditions'
], function (Window,
             Preconditions) {
    var applinks = Window.AppLinks;
    Preconditions.hasValue(applinks, 'applinks');
    return applinks;
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-v3', location = 'applinks/internal/feature/v3/v3-ui.js' */
define('applinks/feature/v3/ui', [
    'applinks/lib/aui',
    'applinks/lib/jquery'
], function(
    AJS,
    $
) {
    return {
        isOn: function() {
            return $('#ual.applinks-admin-v3').length > 0;
        },

        isFinishedOnboarding : function() {
            if ($("body").attr("data-v3-onboarding-dialog-finished")) {
                var featureDiscoveryDialog = $('#v3-ui-feature-discovery-dialog');
                if (featureDiscoveryDialog.length === 0 || featureDiscoveryDialog.is(':hidden')) {
                    return true;
                }
            }
        }
    }
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-bitbucket-rebrand', location = 'applinks/internal/feature/bitbucket-rebrand/bitbucket-rebrand.js' */
define('applinks/feature/bitbucket-rebrand', [
    'applinks/lib/jquery',
    'applinks/lib/lodash',
    'applinks/common/context',
    'applinks/common/events',
    'applinks/common/features',
    'applinks/common/products',
    'applinks/component/feature-discovery',
    'applinks/feature/creation',
    'applinks/feature/v3/ui'
], function(
    $,
    _,
    ApplinksContext,
    ApplinksEvents,
    ApplinksFeatures,
    ApplinksProducts,
    FeatureDiscovery,
    ApplinksCreation,
    V3Ui
) {

    var DISMISS_BUTTON_SELECTOR = '#bb-rebrand-dismiss';

    return {
        // use BB rebrand feature name as feature key for discovery
        FEATURE_KEY: ApplinksFeatures.BITBUCKET_REBRAND,

        _featureDiscovery: undefined,
        _featureDiscoveryApplinkId: undefined,

        initOldUi: function() {
            if (this._isInitialized()) {
                return;
            }

            // old UI
            var bbAppLegacyRows = $('#application-links-table').find('tr.ual-row').filter(function(index, elem) {
                return $(elem).find('td.application-type').text().indexOf('Bitbucket') > -1;
            });
            if (bbAppLegacyRows.length) {
                this._discoverBitbucketRebrand(bbAppLegacyRows.find('.application-icon').get(0),
                    bbAppLegacyRows.first().attr('application-id'));
            }
        },

        initNewUi: function() {
            if (this._isInitialized()) {
                return;
            }

            // new UI
            var bbAppNewRows = $('#agent-table').find('tr').filter(function(index, elem) {
                return $(elem).find('.applinks-type').text().indexOf('Bitbucket') > -1;
            });
            if (bbAppNewRows.length) {
                this._discoverBitbucketRebrand(bbAppNewRows.find('.applinks-type').get(0),
                    bbAppNewRows.first().attr('id'));
            }
        },

        init: function() {
            // only initiate discovery if: not in Bitbucket/Stash already, rebrand is enabled, but not discovered yet
            if (!this._isBitbucket() && this._isRebrandEnabled() && !this._isRebrandDiscovered()) {
                ApplinksEvents.on(ApplinksEvents.APPLINKS_LOADED, _.bind(function() {
                    if (this._isInitialized()) {
                        return;
                    }

                    if (V3Ui.isOn()) {
                        if(V3Ui.isFinishedOnboarding()) {
                            this.initNewUi();
                        } else {
                            ApplinksEvents.on(ApplinksEvents.V3_ONBOARDING_FINISHED, _.bind(function(){
                               this.initNewUi();
                            }, this));
                        }
                    } else {
                        this.initOldUi();
                    }
                }, this));
            }
        },

        _isBitbucket: function() {
            return ApplinksProducts.BITBUCKET === ApplinksContext.hostApplication().type;
        },

        _isRebrandEnabled: function() {
            return ApplinksFeatures.isEnabled(this.FEATURE_KEY);
        },

        _isRebrandDiscovered: function() {
            return ApplinksFeatures.isDiscovered(this.FEATURE_KEY);
        },

        _isInitialized: function() {
            return !!this._featureDiscovery;
        },

        _discoverBitbucketRebrand: function(anchor, applinkId) {
            if (this._isCreationInProgress()) {
                // don't show feature discovery if there's a link being created - if we got here, it means there were
                // no existing Stash links on the page before the creation started, so just discover the feature
                ApplinksFeatures.discover(this.FEATURE_KEY);
            } else {
                this._featureDiscoveryApplinkId = applinkId;
                this._featureDiscovery = new FeatureDiscovery(
                    this.FEATURE_KEY,
                    applinks.feature.bitbucket.rebrand.featureDiscovery(),
                    anchor
                );
                this._featureDiscovery.dismissTrigger(DISMISS_BUTTON_SELECTOR);
                this._bindEvents();
                this._fixFocus();
            }
        },

        _isCreationInProgress: function() {
            // if creation is in progress, the creation log array will be available
            var creationLog = ApplinksCreation.getSubmittedStatusLog();
            return creationLog && creationLog.length;
        },

        // listen to UI events to re-align the popup
        _bindEvents: function() {
            // only bind if we have a popup showing
            if (this._isInitialized()) {
                ApplinksEvents.on(ApplinksEvents.Legacy.MESSAGE_BOX_DISPLAYED, _.bind(function() {
                    if (this._featureDiscovery) {
                        this._featureDiscovery.refresh();
                    }
                }, this));
                ApplinksEvents.on(ApplinksEvents.APPLINKS_UPDATED, _.bind(function() {
                    var element;

                    if (this._featureDiscovery && this._featureDiscoveryApplinkId) {
                        // applinks table refreshed, need to find the new anchor
                        if (V3Ui.isOn()) {
                            element = $('#' + this._featureDiscoveryApplinkId + ' .applinks-type')[0];
                        } else {
                            element = $('[application-id=' + this._featureDiscoveryApplinkId + '] .application-icon')[0]
                        }

                        this._featureDiscovery.refresh(element);
                        this._featureDiscovery.dismissTrigger(DISMISS_BUTTON_SELECTOR);
                        this._fixFocus();
                    }
                }, this));
            }
        },

        _fixFocus: function() {
            if (this._featureDiscovery) {
                this._featureDiscovery.dialog.contents().find(DISMISS_BUTTON_SELECTOR).focus();
            }
        }
    };
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-bitbucket-rebrand', location = 'applinks/internal/feature/bitbucket-rebrand/bitbucket-rebrand.soy' */
// This file was automatically generated from bitbucket-rebrand.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace applinks.feature.bitbucket.rebrand.
 */

if (typeof applinks == 'undefined') { var applinks = {}; }
if (typeof applinks.feature == 'undefined') { applinks.feature = {}; }
if (typeof applinks.feature.bitbucket == 'undefined') { applinks.feature.bitbucket = {}; }
if (typeof applinks.feature.bitbucket.rebrand == 'undefined') { applinks.feature.bitbucket.rebrand = {}; }


applinks.feature.bitbucket.rebrand.featureDiscovery = function(opt_data, opt_ignored) {
  return '<h3>' + soy.$$escapeHtml('Stash is now called Bitbucket Server') + '</h3><p>' + soy.$$filterNoAutoescape('Same great product, with a new name.\x3cbr\x3eYou can read more about the change in our \x3ca id\x3d\x22bb-rebrand-link\x22 href\x3d\x22http://go.atlassian.com/bitbucket-server-4.0\x22 target\x3d\x22_blank\x22\x3eofficial announcement\x3c/a\x3e.') + '</p><p><button id="bb-rebrand-dismiss" class="aui-button aui-button-primary">' + soy.$$escapeHtml('OK, got it') + '</button></p>';
};
if (goog.DEBUG) {
  applinks.feature.bitbucket.rebrand.featureDiscovery.soyTemplateName = 'applinks.feature.bitbucket.rebrand.featureDiscovery';
}
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-help-link', location = 'applinks/internal/feature/help-link/help-link-analytics.js' */
define('applinks/feature/help-link/analytics', [
    'applinks/lib/aui',
    'applinks/lib/jquery'
], function(
    AJS,
    $
) {
    /**
     * Initializable component that raises Analytics events for all help links clicks.
     */
    return {
        init: function() {
            $('body').on('click', '.help-link', function () {
                AJS.trigger('analyticsEvent', {
                    name: 'applinks.view.documentation',
                    data: {linkKey: $(this).attr('data-help-link-key')}
                });
            });
        }
    };
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:list-application-links', location = 'js/relocate-application-link.js' */
AJS.$(document).bind(AppLinks.Event.READY, function() {
    (function($) {

        var dialogDiv = $('#relocate-link-dialog');

        var dialogSettings; // contains the applink-specific data
        var wizard;
        var newUrl;

        var wizardSettings = {
            nextLabel: "Relocate",
            submitLabel: "Relocate",
            api: true,
            width: 500,
            height: 250,
            onshow: function(popup) {
                var dialog = popup.popup.element;
                dialog.find('h2').text("Relocate").append(AppLinks.Docs.createDocLink(dialogSettings.helpKey, null, 'dialog-help-link'));
                $('#relocate-text').text(dialogSettings.description);
                $('#relocate-error').text('');
                $('#relocate-url').val(dialogSettings.application.rpcUrl);
                AppLinks.UI.hideLoadingIcon($('#relocate-url'));
                AppLinks.UI.hideLoadingIcon($('#confirm-relocate-text'));
                return true;
            },
            onnext: function(popup) {
                $('#relocate-error').text('');
                newUrl = AppLinks.UI.addProtocolToURL($('#relocate-url').val());
                AppLinks.UI.showLoadingIcon($('#relocate-url'));
                dialogSettings.doRelocate(newUrl, wizardSettings.closeWizard, function(xhr) {
                    AppLinks.UI.hideLoadingIcon($('#relocate-url'));
                    if (xhr.status == 409) {
                        $('#confirm-relocate-text').text(AJS.format("The application at URL \u0027\u0027{0}\u0027\u0027 is not responding. Please confirm that you want to use this URL.", newUrl));
                        popup.popup.element.find('h2').text("Confirm Relocation").append(AppLinks.Docs.createDocLink(dialogSettings.helpKey, null, 'dialog-help-link'));
                        wizard.dialog.gotoPage(1);
                    } else {
                        $('#relocate-error').text(AppLinks.parseError(xhr));
                    }
                });
                return false;
            },
            onprevious: function(popup) {
                var dialog = popup.popup.element;
                dialog.find('h2').text("Relocate").append(AppLinks.Docs.createDocLink(dialogSettings.helpKey, null, 'dialog-help-link'));
            },
            closeWizard: function() {
                wizard.cancel();
                dialogSettings.callback();  // refresh the application list
            },
            onsubmit: function() {
                AppLinks.UI.showLoadingIcon($('#confirm-relocate-text'));
                dialogSettings.doForceRelocate(newUrl, wizardSettings.closeWizard, function(xhr) {
                    AppLinks.UI.hideLoadingIcon($('#confirm-relocate-text'));
                    $('#confirm-relocate-error').text(AppLinks.parseError(xhr));
                });
                return false;
            }
        };

        wizard = dialogDiv.wizard(wizardSettings);

        AppLinks.showRelocateLinkDialog = function(settings) {
            dialogSettings = settings;
            wizard.show();
        }

    })(AJS.$)
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:list-application-links', location = 'js/upgrade-legacy-application-link.js' */
// This file contains the logic for the upgrade a non-ual-link wizard (serverid substitution)
AJS.$(document).bind(AppLinks.Event.READY, function() {
    (function($) {

        var dialogDiv = $('#upgrade-legacy-link-dialog');

        var dialogSettings; // contains the applink-specific data
        var wizard;

        var wizardSettings = {
            api: true,
            submitLabel: "Upgrade",
            onshow: function(popup) {
                var dialog = popup.popup.element;
                dialog.find('h2').text("Upgrade").append(AppLinks.Docs.createDocLink(dialogSettings.helpKey, null, 'dialog-help-link'));
                $('#legacy-upgrade-text').text(dialogSettings.description);
                $('.legacy-upgrade-error').text('');
                AppLinks.UI.hideLoadingIcon('#legacy-upgrade-text');
                $(popup.popup.element).find('.wizard-submit').attr('disabled', false);
                return true;
            },
            onsubmit: function(popup) {
                $('.legacy-upgrade-error').text('');
                $(popup.popup.element).find('.wizard-submit').attr('disabled', true);
                AppLinks.UI.showLoadingIcon('#legacy-upgrade-text');
                dialogSettings.submit(
                        function(upgradedApplicationLink) {
                            wizard.cancel();
                            // refresh the application list and apply the new id
                            dialogSettings.callback(upgradedApplicationLink.applicationLink.id);
                        },
                        function(xhr) {
                            AppLinks.UI.displayValidationError('legacy-upgrade-error', dialogRootEl)(xhr);
                            $(popup.popup.element).find('.wizard-submit').attr('disabled', false);
                        }
                );
                return false;
            }
        };

        wizard = dialogDiv.wizard(wizardSettings);
        var dialogRootEl     = $(wizard.dialog.popup.element);

        AppLinks.showUpgradeLinkDialog = function(settings) {
            dialogSettings = settings;
            wizard.show();
        }

    })(AJS.$)
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:list-application-links', location = 'js/upgrade-ual-application-link.js' */
// This file contains the logic for the upgrade a non-ual-link-to-ual wizard
AJS.$(document).bind(AppLinks.Event.READY, function() {
    (function($) {
        var dialogSettings; // contains the applink-specific data, incl manifest
        var appUrl;
        var wizardSettings = {
            width: 510,
            height: 660,
            id: "upgrade-application-link-dialog",
            onnext: function() {
                dialogRootEl.find('.applinks-error').remove();
                var page = upgradeApplicationLinkWizard.dialog.curpage;
                if (page == 0) {
                    AppLinks.Wizard.handleUALManifest(dialogSettings.manifest, dialogRootEl);
                    upgradeApplicationLinkWizard.dialog.gotoPage(1);
                    reciprocalLinkUsernameEl.focus();
                    return false;

                } else if (page == 1) {
                    var createOneWayLinkFn = function() {
                        //Create the link if user decided not to create a reciprocal link

                        // call the upgrade rest endpoint
                        var successFn = function(upgradedApplicationLink) {
                            upgradeApplicationLinkWizard.cancel();
                            dialogSettings.successCallback(upgradedApplicationLink);
                        };
                        var payload = {
                            createTwoWayLink: false,
                            reciprocateEntityLinks: false,
                            configFormValues: {
                                trustEachOther: false,
                                shareUserbase: false
                            }
                        };
                        AppLinks.SPI.ualUpgrade(dialogSettings.application, payload, successFn, AppLinks.UI.displayValidationError('create-validation-errors', dialogRootEl));
                    };
                    var gotoNextPageFn = function() {
                        upgradeApplicationLinkWizard.dialog.gotoPage(2);
                    };
                    AppLinks.Wizard.checkReciprocalLinkFormThreeStepMode(dialogRootEl, createOneWayLinkFn, gotoNextPageFn, appUrl);
                    return false;
                }
                return true;
            },
            onprevious: function() {
                return true;
            },
            onsubmit: function() {
                var successFn = function(upgradedApplicationLink) {
                    upgradeApplicationLinkWizard.cancel();
                    dialogSettings.successCallback(upgradedApplicationLink);
                };
                var payload = {
                    rpcUrl: rpcURLEl.val(),
                    username: reciprocalLinkUsernameEl.val(),
                    password: reciprocalLinkPasswordEl.val(),
                    createTwoWayLink: true,
                    reciprocateEntityLinks: reciprocateEntityLinks.is(':checked'),
                    configFormValues: {
                        trustEachOther: !!(dialogRootEl.find('.trust-each-other-description').find('input').is(':checked')),
                        shareUserbase: !!(dialogRootEl.find('.same-user-description').find('input').is(':checked'))
                    }
                };
                AppLinks.SPI.ualUpgrade(dialogSettings.application, payload, successFn, AppLinks.UI.displayValidationError('create-validation-errors', dialogRootEl));
                return false;
            },
            onshow: function() {
                dialogRootEl.find('.applinks-error').remove();
                AppLinks.UI.hideInfoBox();
                rpcURLEl.val($('#baseUrl').val());
                $(".ual-upgrade-text").text(dialogSettings.description);
                appUrl = dialogSettings.application.rpcUrl;

                var success = function(entities) {
                    if (AJS.$.isArray(entities.entity) && entities.entity.length > 0) {

                        // get all unique entity type keys:
                        var uniqueNames = new Array();
                        AJS.$.each(entities.entity, function(index, entity) {
                            if (AJS.$.inArray(entity.typeId, uniqueNames) == -1) {
                                uniqueNames.push(entity.typeId);
                            }
                        });

                        // string them all in a coherent "1, 2 and 3" string:
                        var prettyString = AppLinks.UI.prettyJoin(uniqueNames, function(typeId) {
                            return AppLinks.I18n.getEntityTypeName(typeId);
                        });

                        // display, make visible and tick the checkbox
                        reciprocateEntityLinksDescription.text(AJS.format("For each existing {0} link, create an incoming link from the remote application.", prettyString));
                        reciprocateEntityLinks
                                .attr('checked', true)
                                .closest('div')
                                .removeClass('hidden');
                    }
                };
                var failure = function(xhr) {
                    reciprocateEntityLinksDescription.text(AJS.format("For each existing {0} link, create an incoming link from the remote application.", 'project'));
                    reciprocateEntityLinks
                            .attr('checked', true)
                            .closest('div')
                            .removeClass('hidden');
                };
                reciprocateEntityLinks.closest('div').addClass('hidden');
                AppLinks.SPI.getLocalEntitiesWithLinksToApplication(dialogSettings.application.id, success, failure);
                return true;
            },
            aftershow: function() {
            }
        };
        var upgradeApplicationLinkWizard = $("#upgrade-application-link-container").wizard(wizardSettings);
        var dialogRootEl     = $(upgradeApplicationLinkWizard.dialog.popup.element);
        var localAppNameEl   = dialogRootEl.find('.local-app-name');
        var rpcURLEl = dialogRootEl.find('.reciprocal-rpc-url');
        var reciprocalLinkUsernameEl = dialogRootEl.find('.reciprocal-link-username');
        var reciprocalLinkPasswordEl = dialogRootEl.find('.reciprocal-link-password');
        var reciprocateEntityLinks = dialogRootEl.find('.reciprocate-entity-links');
        var reciprocateEntityLinksDescription = dialogRootEl.find('.reciprocate-entity-links-description');

        localAppNameEl.html(AppLinks.UI.shortenString(applicationName, 20));

        AppLinks.Wizard.initNonUALUI(dialogRootEl);
        AppLinks.Wizard.initAuthenticationUI(dialogRootEl);

        AppLinks.showUpgradeLinkToUALDialog = function(settings) {
            dialogSettings = settings;
            upgradeApplicationLinkWizard.show();
        };

        reciprocalLinkPasswordEl.on('keydown', function (event) {
             //KeyCode 13 is the enter key.
            if (event.keyCode == '13') {
               upgradeApplicationLinkWizard.nextPage();
            }
        });
    })(AJS.$);
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:list-application-links', location = 'js/list-application-links.js' */
/**
 * NOTE: this file implements Applinks V1/V2 UI, which is no longer in use. Unfortunately some parts of it are still
 * used in V3 UI and therefore it cannot be simply removed without making sure it doesn't break any important
 * functionality in V3.
 */

// NOTE: for legacy reasons this module is loaded onto the V3 page, so make sure any logic duplicated in the V3 page
// (such is initializing AMD modules common to both pages) is guarded with a !V3Ui.isOn() check

function _initRequiredAmdModules(V3Ui) {
    if (!V3Ui.isOn()) {
        // init required AMD-fied features
        var Initializer = require('applinks/common/initializer');
        Initializer.init(require('applinks/feature/bitbucket-rebrand'));
        Initializer.initOnDomReady(require('applinks/feature/help-link/analytics'));
    }
}

AJS.$(document).bind(AppLinks.Event.PREREADY, function() {
    (function ($, V3Ui, Events) {

        _initRequiredAmdModules(V3Ui);

        AJS.$.extend(AppLinks.UI || {}, {

            listApplicationLinks: function(appLinkIdOrName, operation, status, isFirstLoad) {
                // first load, only load if not in V3
                if (isFirstLoad && V3Ui.isOn()) {
                    return;
                }

                $('#applicationsList').removeClass("fully-loaded");
                $('.no-links').hide();
                $('.links-loading').show();
                $('.relocate-warning').closest('.aui-message.aui-message-warning').remove();
                $('.upgrade-warning').closest('.aui-message.aui-message-warning').remove();
                $('#application-links-table').hide();
                $('#applicationsList').empty();
                AppLinks.SPI.getAllLinksWithAuthInfo(function(applicationList) {
                    var tableBody = $('#applicationsList'),
                        applicationLinksAndAuthInfo = applicationList.list,
                        createRow = function(application, incomingAuth, auth, isSystem) {
                            var extensions = {
                                typeLabel: AppLinks.I18n.getApplicationTypeName(application.typeId)
                            };
                            var row;
                            if (isSystem) {
                                row = $(AJS.template.load('al-system-row')
                                    .fill($.extend(extensions, application))
                                    .fillHtml({configuredIncomingAuth: incomingAuth})
                                    .fillHtml({applicationId: application.id})
                                    .fillHtml({configuredAuth: auth})
                                    .fillHtml({iconTag: application.iconUrl ?
                                        AJS.template.load('al-row-application-icon').fill({iconUrl: application.iconUrl}).toString() :
                                        ""})
                                    .toString());
                            } else {
                                row = $(AJS.template.load('al-row')
                                    .fill($.extend(extensions, application))
                                    .fillHtml({configuredIncomingAuth: incomingAuth})
                                    .fillHtml({applicationId: application.id})
                                    .fillHtml({configuredAuth: auth})
                                    .fillHtml({iconTag: application.iconUrl ?
                                        AJS.template.load('al-row-application-icon').fill({iconUrl: application.iconUrl}).toString() :
                                        ""})
                                    .toString());
                                row.find(".app-delete-link").on('click', function(e) {
                                    e.preventDefault();
                                    AppLinks.UI.hideInfoBox();
                                    AppLinks.SPI.getApplicationLinkInfo(application.id, function(appLinkInfo) {
                                        var confirmMessage = $('<div>');
                                        confirmMessage.append($('<div>').text(AJS.format("Confirm that you want to delete the Application Link to \u0027\u0027{0}\u0027\u0027 ({1}).", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId))));
                                        if (appLinkInfo.configuredAuthProviders.length > 0){
                                            var authProviderMessage = AppLinks.UI.prettyJoin(appLinkInfo.configuredAuthProviders, function(value) {
                                                return AppLinks.I18n.getAuthenticationTypeName(value);
                                            });
                                            confirmMessage.append($('<div>').text(AJS.format("The authentication information stored for {0} will be deleted.", authProviderMessage)));

                                            if (appLinkInfo.numConfiguredEntities > 0) {
                                                var linkI18nKey;
                                                if (appLinkInfo.numConfiguredEntities > 1){
                                                    linkI18nKey = "applinks.dialog.delete.entity.links.plural";
                                                } else {
                                                    linkI18nKey = "applinks.dialog.delete.entity.links.singular";
                                                }

                                                var hostEntityTypeLabel = AppLinks.UI.prettyJoin(appLinkInfo.hostEntityTypes, function(value) {
                                                    if (appLinkInfo.numConfiguredEntities > 1) {
                                                        return AppLinks.I18n.getPluralizedEntityTypeName(value);
                                                    } else {
                                                        return AppLinks.I18n.getEntityTypeName(value);
                                                    }
                                                });
                                                var remoteEntityTypeLabel = AppLinks.UI.prettyJoin(appLinkInfo.remoteEntityTypes, function(value) {
                                                    return AppLinks.I18n.getPluralizedEntityTypeName(value);
                                                });
                                                var entityLinksMsg = AJS.I18n.getText(linkI18nKey, appLinkInfo.numConfiguredEntities, hostEntityTypeLabel, remoteEntityTypeLabel, application.name);
                                                confirmMessage.append($('<div>').text(entityLinksMsg));
                                            }
                                        }
                                        var deleteDialogSettings = {
                                            title: AJS.format("Delete Link to \u0027\u0027{0}\u0027\u0027", application.name),
                                            applicationId: application.id,
                                            confirmMessage: confirmMessage,
                                            reciprocalLinkMessage: AJS.format("{0} ({1}) has a link to this Application. Do you want to delete this link as well?", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                                            noReciprocalLinkMessage: AJS.format("{0} ({1}) doesn\u0027\u0027t have a link to this application. Click confirm to delete only the link from this application to {0} ({1}).", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                                            deleteYesMessage: AJS.format("Yes, delete the link from {0} ({1}) to this application.", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                                            deleteNoMessage: AJS.format("No, do not delete the link from {0} ({1}) to this application.", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                                            authenticationMessage: AJS.format("We can check if {0} ({1}) has a link to this application and delete this link as well. To do this you must authenticate. Click confirm to delete only the local link to {0} ({1}).", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                                            noConnectionMessage: "There was a problem when contacting the remote application.",
                                            authenticationFailedMessage: AJS.format("Unable to check if {0} ({1}) has a link to this application, because the authorization failed. Click confirm to delete only the local Application Link to {0} ({1})", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                                            failedToDetectReciprocalLinkMessage : AJS.format("A problem occurred when trying to check if a link from {0} ({1}) to this application exists.", application.name, AppLinks.I18n.getApplicationTypeName(application.typeId)),
                                            helpKey: 'applinks.docs.delete.application.link',
                                            doPermissionCheck: function(success, error) {
                                                AppLinks.SPI.canDeleteAppLink(application.id, success, error);
                                            },
                                            doDelete: function(reciprocate, success, error) {
                                                AppLinks.SPI.deleteLink(application, reciprocate, success, error);
                                            },
                                            callback: function() {
                                                AppLinks.UI.listApplicationLinks(application.name, 'delete');
                                                return true;
                                            }
                                        };
                                        AppLinks.showDeleteLinkDialog(deleteDialogSettings);
                                    });
                                });

                                $.each(row.find('.configure-auth-type'), function(i, v) {
                                    var authProvider = $(v).attr('data-auth-type');
                                    var authDirection = $(v).attr('data-auth-direction');
                                    var isInbound = authDirection == "incoming";
                                    $(v).on('click', function(e) {
                                        e.preventDefault();
                                        AppLinks.UI.hideInfoBox();
                                        AppLinks.editAppLink(application, authProvider, isInbound, function(updated) {
                                            AppLinks.UI.listApplicationLinks(updated.id, 'update');
                                            return true;
                                        }, function() {
                                            AppLinks.UI.listApplicationLinks();
                                            return true;
                                        });
                                    });
                                });

                                row.find(".app-edit-link").on('click', function(e) {
                                    e.preventDefault();
                                    AppLinks.UI.hideInfoBox();
                                    AppLinks.editAppLink(application, "undefined", false, function(updated) {
                                        AppLinks.UI.listApplicationLinks(updated.id, 'update');
                                        return true;
                                    }, function() {
                                        AppLinks.UI.listApplicationLinks();
                                        return true;
                                    });

                                });

                                if (!application.isPrimary) {
                                    row.find(".app-toggleprimary-action").show();
                                    row.find(".app-toggleprimary-link").on('click', function(e) {
                                        e.preventDefault();
                                        AppLinks.UI.hideInfoBox();
                                        AppLinks.SPI.makePrimary(application, function() {
                                            AppLinks.UI.listApplicationLinks(application.id, 'primary');
                                        });
                                    });
                                } else {
                                    row.find(".app-toggleprimary-action").hide();
                                }

                                if ( $('#ual.list-links').data("sysadminFlag")) {
                                    AppLinks.SPI.getApplicationLinkState(application.id,  function(result) {

                                        if (result.appLinkState == 'OFFLINE' && !V3Ui.isOn()) {
                                            var relocateLink = $("<div>");
                                            relocateLink.text(AJS.format("Application \u0027\u0027{0}\u0027\u0027 seems to be offline.", application.name) + " ");
                                            $(relocateLink).append("<a class='relocate-" + application.id  + " relocate-from-" + application.rpcUrl + " relocate-warning' href='#'>" + "Click here to Relocate." + "</a>");
                                            AppLinks.UI.showWarningBox(relocateLink);
                                            var relocateLink = $('.relocate-' + application.id);
                                            relocateLink.on('click', function(e) {
                                                e.preventDefault();
                                                AppLinks.UI.hideInfoBox();
                                                var relocateDialogSettings = {
                                                    description: AJS.format("Relocate Application Link \u0027\u0027{0}\u0027\u0027 to a different URL.", application.name),
                                                    application: application,
                                                    helpKey: 'applinks.docs.relocate.application.link',
                                                    doRelocate: function(newUrl, success, error) {
                                                        AppLinks.SPI.relocate(application, newUrl, false, success, error);
                                                    },
                                                    doForceRelocate: function(newUrl, success, error) {
                                                        AppLinks.SPI.relocate(application, newUrl, true, success, error);
                                                    },
                                                    callback: function() {
                                                        AppLinks.UI.listApplicationLinks(application.name, 'relocate');
                                                    }
                                                };
                                                AppLinks.showRelocateLinkDialog(relocateDialogSettings);
                                            });
                                        }
                                        else if (result.appLinkState !== 'OFFLINE' && result.appLinkState != 'OK') {
                                            var upgradeLink = $("<div>");
                                            var message = AJS.format("Application \u0027\u0027{0}\u0027\u0027 has been upgraded.", application.name);
                                            var action = "Click here to Upgrade the Application Link configuration";
                                            upgradeLink.text(message + " ");

                                            upgradeLink.append("<a class='upgrade-" + application.id +" upgrade-warning' href='#'>" + action + "</a>");
                                            AppLinks.UI.showWarningBox(upgradeLink);

                                            var upgradeFn = function(appInfo) {
                                                return function (e) {
                                                    e.preventDefault();
                                                    AppLinks.UI.hideInfoBox();
                                                    if (result.appLinkState == 'UPGRADED_TO_UAL') {
                                                        var upgradeDialogSettings = {
                                                            application: application,
                                                            description: AJS.format("The remote application \u0027\u0027{0}\u0027\u0027 appears to have been upgraded. This wizard lets you apply these changes to the application link to ensure your project links keep working properly.", application.name),
                                                            manifest: {
                                                                name: application.name,
                                                                typeId: application.typeId
                                                            },
                                                            successCallback: function(upgradedApplicationLink) {
                                                                // called when the upgrade completed successfully
                                                                AppLinks.UI.listApplicationLinks(upgradedApplicationLink.applicationLink.name, 'upgrade', upgradedApplicationLink);
                                                            }
                                                        };
                                                        AppLinks.showUpgradeLinkToUALDialog(upgradeDialogSettings);
                                                    } else {
                                                        var localEntityTypeString = AppLinks.UI.prettyJoin(localEntityTypeIdStrings,
                                                            function(key) {
                                                                return AppLinks.I18n.getEntityTypeName(key);
                                                            }, "and");
                                                        var upgradeDialogSettings = {
                                                            application: application,
                                                            description: AJS.format("The remote application \u0027\u0027{0}\u0027\u0027 may have been relocated. To ensure our {1} links remain working properly, we can update the Application Link.", application.name, localEntityTypeString),
                                                            helpKey: 'applinks.docs.upgrade.application.link',
                                                            submit: function(success, error) {
                                                                AppLinks.SPI.legacyUpgrade(application, success, error);
                                                            },
                                                            callback: function(newApplicationId) {
                                                                application.applicationId = newApplicationId;
                                                                AppLinks.UI.listApplicationLinks(application.name, 'upgrade');
                                                            }
                                                        };
                                                        AppLinks.showUpgradeLinkDialog(upgradeDialogSettings);
                                                    }
                                                }
                                            };

                                            $('.upgrade-' + application.id).click(upgradeFn(appInfo));
                                        }
                                    }, function(data) {
                                        var message = AppLinks.parseError(data);
                                        AppLinks.UI.showErrorBox(message);
                                    });

                                }
                            }

                            var toAttrib = function(key, value) {
                                return (typeof value == "undefined" || value == null || value == "") ?
                                    "" : (key + "='" + value + "'");
                            };
                            var actions = row.find("ul.app-actions");
                            for (var i = 0; i < application.webItems.length; i++) {
                                var wi = application.webItems[i];
                                // render the icon html (if needed)
                                if (wi.iconUrl) {
                                    wi.icon = AJS.template.load('al-row-op-webitem-icon').fill(wi).toString()
                                } else {
                                    wi.icon = "";
                                }
                                wi.id = toAttrib("id", wi.id);
                                wi.tooltip = toAttrib("tooltip", wi.tooltip);
                                wi.styleClass = toAttrib("styleClass", wi.styleClass);
                                wi.accessKey = toAttrib("accessKey", wi.accessKey);
                                // add the rendered web-item to the row
                                actions.append(AJS.template.load('al-row-op-webitem').fill(wi).toString());
                            }
                            for (i = 0; i < application.webPanels.length; i++) {
                                var wp = application.webPanels[i];
                                actions.append($("<li>| " + wp.html + "</li>"));
                            }

                            return row;
                        };

                    var modifiedApplicationLinkAndAuthInfo;
                    $('.links-loading').hide();
                    if (applicationLinksAndAuthInfo.length == 0) {
                        $('#application-links-table').hide();
                        $('.no-links').show();
                        $('#add-first-application-link').on('click', function(e) {
                            e.preventDefault();
                            $('#add-application-link').click();
                        });
                    } else {
                        $('#application-links-table').show();
                        $('.no-links').hide();
                    }

                    var multipleTypes = false,
                        tempTypeId;
                    for (var x = 0, xx = applicationLinksAndAuthInfo.length; x < xx; x++) {
                        var appInfo = applicationLinksAndAuthInfo[x],
                            application = appInfo.application;
                        application.hasIncoming = appInfo.hasIncomingAuthenticationProviders;
                        application.hasOutgoing = appInfo.hasOutgoingAuthenticationProviders;
                        application.webItems = appInfo.webItems;
                        application.webPanels = appInfo.webPanels;
                        if (!multipleTypes && tempTypeId && tempTypeId == application.typeId) {
                            multipleTypes = true;
                        }
                        tempTypeId = application.typeId;
                        if (appLinkIdOrName && application.id == appLinkIdOrName) {
                            modifiedApplicationLinkAndAuthInfo = appInfo;
                        }
                        var clickToConfigure = "Click to configure";

                        var incomingAuth = "";
                        var numConfiguredIncomingAuth = appInfo.configuredInboundAuthenticators.length;
                        $.each(appInfo.configuredInboundAuthenticators, function(i, value) {
                            var authType = value.substring(value.lastIndexOf('.') + 1);
                            var incomingTemplate;
                            if (appInfo.isSystem) {
                                incomingTemplate = AJS.template('<div>{name}');
                                incomingAuth += incomingTemplate.fill({
                                    name: AppLinks.I18n.getAuthenticationTypeName(value)
                                });
                            } else {
                                incomingTemplate = AJS.template('<div><a href="#" class="configure-auth-type" data-auth-type="{authType}" data-auth-direction="incoming" title="{linkTitle}">{name}</a>');
                                incomingAuth += incomingTemplate.fill({
                                    authType: authType,
                                    linkTitle: clickToConfigure + ' ' + AppLinks.I18n.getAuthenticationTypeName(value),
                                    name: AppLinks.I18n.getAuthenticationTypeName(value)
                                });
                            }
                        });
                        if (numConfiguredIncomingAuth == 0) {
                            incomingAuth = "<div>" + "none" + "</div>";
                        }

                        var configuredAuth = "";
                        var numConfiguredAuth = appInfo.configuredOutboundAuthenticators.length;
                        $.each(appInfo.configuredOutboundAuthenticators, function(i, value) {
                            if (i == 0 && (numConfiguredAuth > 1)){
                                configuredAuth = '<div class="primary-auth-type-wrapper"><span class="primary-auth-type" title="' + "applinks.primary.auth" + '">&nbsp;</span>';
                            } else if (numConfiguredAuth == 1) {
                                configuredAuth += '<div>';
                            } else {
                                configuredAuth += '<div class="configured-auth-type">';
                            }
                            var authType = value.substring(value.lastIndexOf('.') + 1);

                            if (appInfo.isSystem) {
                                var outboundTemplate = AJS.template('{name}')
                                configuredAuth += outboundTemplate.fill({
                                    name: AppLinks.I18n.getAuthenticationTypeName(value)
                                });
                            } else {
                                var outboundTemplate = AJS.template('<a href="#" class="configure-auth-type" data-auth-type="{authType}" data-auth-direction="outgoing" title="{linkTitle}">{name}</a>')
                                configuredAuth += outboundTemplate.fill({
                                    authType: authType,
                                    linkTitle: clickToConfigure + ' ' + AppLinks.I18n.getAuthenticationTypeName(value),
                                    name: AppLinks.I18n.getAuthenticationTypeName(value)
                                });
                            }

                            configuredAuth += "</div>";
                        });
                        if (numConfiguredAuth == 0) {
                            configuredAuth = "<div>" + "none" + "</div>";
                        }
                        tableBody.append(createRow(application, incomingAuth, configuredAuth, appInfo.isSystem));
                    }

                    if (multipleTypes) {
                        $('.primary-column').show();
                    } else {
                        $('.primary-column').hide();
                    }

                    if (appLinkIdOrName) {

                        if (operation == 'new') {
                            var message;
                            if (!modifiedApplicationLinkAndAuthInfo || !modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators || modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators.length == 0) {
                                message = AJS.format("Created a link to \u0027\u0027{0}\u0027\u0027 without outgoing authentication.", AppLinks.UI.sanitiseHTML(modifiedApplicationLinkAndAuthInfo.application.name));
                            } else if (modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators && modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators.length == 1) {
                                message = AJS.format("Created a two-way link to \u0027\u0027{0}\u0027\u0027 using {1}.", AppLinks.UI.sanitiseHTML(modifiedApplicationLinkAndAuthInfo.application.name), AppLinks.I18n.getAuthenticationTypeName(modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators[0]));
                            } else {
                                message = AJS.format("Created a link to \u0027\u0027{0}\u0027\u0027 with {1} configured authentication types.", AppLinks.UI.sanitiseHTML(modifiedApplicationLinkAndAuthInfo.application.name), modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators.length);
                            }

                            if (!status.autoConfigurationSuccessful) {
                                message += " " + "There was a problem with the auto configuration with one or more authentication providers. Please check the server log for more information.";
                            }
                            AppLinks.UI.showInfoBox(message);

                            if (modifiedApplicationLinkAndAuthInfo.configuredOutboundAuthenticators.length == 0) {
                                $(".page-info").append(" " + AJS.format("{0}Configure authentication{1}.", "<a href='#' id='edit-new-link'>", "</a>"));
                            }

                            if (AppLinks.SPI.showCreateEntityLinkSuggestion()) {
                                /**
                                 * Now render the suggestion for the next step:
                                 * "Next you should link a Charlie to a FishEye Repository or Crucible Project. You can do this from the
                                 * Charlie admin page."
                                 */
                                var localEntityTypeString = AppLinks.UI.prettyJoin(localEntityTypeIdStrings,
                                    function(key) {
                                        return AppLinks.I18n.getEntityTypeName(key);
                                    }, "or");
                                var remoteEntityTypeString = AppLinks.UI.prettyJoin(modifiedApplicationLinkAndAuthInfo.entityTypeIdStrings,
                                    function(key) {
                                        return AppLinks.I18n.getEntityTypeName(key);
                                    }, "or");
                                var suggestion = AJS.format("After that you should link a {0} to a {1}. You can do this from the {0} admin page.",
                                    localEntityTypeString, remoteEntityTypeString);
                                $(".page-info").append("<br>" + suggestion);
                            }

                            $('#edit-new-link').on('click', function(e) {
                                e.preventDefault();
                                AppLinks.UI.hideInfoBox();
                                AppLinks.editAppLink(modifiedApplicationLinkAndAuthInfo.application, 'undefined', false, function(updated) {
                                    AppLinks.UI.listApplicationLinks(updated.id, 'update');
                                    return true;
                                }, function() {
                                    AppLinks.UI.listApplicationLinks();
                                    return true;
                                });
                            });
                        } else if (operation == 'update') {
                            AppLinks.UI.showInfoBox($('<span>').text(AJS.format("Updated Application Link \u0027\u0027{0}\u0027\u0027 successfully.", modifiedApplicationLinkAndAuthInfo.application.name)));
                        } else if (operation == 'upgrade') {
                            AppLinks.UI.showInfoBox($('<span>').text(AJS.format("Upgraded Application Link \u0027\u0027{0}\u0027\u0027 successfully.", appLinkIdOrName)));
                            if (status && status.message && AJS.$.isArray(status.message) && status.message.length > 0) {
                                AppLinks.UI.showWarningBox(status.message);
                            }
                        } else if (operation == 'delete') {
                            AppLinks.UI.showInfoBox(AJS.format("Deleted Application Link \u0027\u0027{0}\u0027\u0027 successfully.", AppLinks.UI.sanitiseHTML(appLinkIdOrName)));
                        } else if (operation == 'primary') {
                            var applicationTypeLabel = AppLinks.I18n.getApplicationTypeName(modifiedApplicationLinkAndAuthInfo.application.typeId);
                            AppLinks.UI.showInfoBox(AJS.format("New primary link for application type {0} is \u0027\u0027{1}\u0027\u0027", applicationTypeLabel, AppLinks.UI.sanitiseHTML(modifiedApplicationLinkAndAuthInfo.application.name)));
                        }
                    }
                    tableBody.addClass("fully-loaded");
                    if (isFirstLoad) {
                        $(document).trigger(AppLinks.Event.APPLINKS_LOADED);
                    } else {
                        $(document).trigger(AppLinks.Event.APPLINKS_UPDATED);
                    }
                }, function(data) {
                    $('.links-loading').hide();
                    var message = AppLinks.parseError(data);
                    AppLinks.UI.showErrorBox(message);
                });

                AppLinks.UI.refreshOrphanedTrust();
            }
        });

        // refresh applinks on orphaned upgrade, in V2 only
        if (!V3Ui.isOn()) {
            Events.on(Events.ORPHANED_UPGRADE, function(event, data) {
                AppLinks.UI.listApplicationLinks(data.applicationLink.id, 'new', data);
            });
        }
    })(AJS.$, require('applinks/feature/v3/ui'), require('applinks/common/events'))
});

AJS.$(document).bind(AppLinks.Event.READY, function() {
    AppLinks.UI.listApplicationLinks(undefined, undefined, undefined, true);
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:list-application-links', location = 'js/add-application-link.js' */
AJS.$(document).bind(AppLinks.Event.READY, function() {
    (function($) {
        var manifest = {};
        var appUrl;
        var createOneWayLinkFn = function() {
            createApplicationLinkWizard.enableNextBtn();
            createApplicationLinkWizard.enablePreviousBtn();
            //Create the link if user decided not to create a reciprocal link
            var applicationLink = {
                id: manifest.id,
                typeId: manifest.typeId,
                name: manifest.name,
                rpcUrl: appUrl,
                displayUrl: manifest.url,
                isPrimary: false
            },
                configFormValues = {
                    trustEachOther: false,
                    shareUserbase: false
                },
                successFn = function(data) {
                    createApplicationLinkWizard.enableSubmitBtn();
                    createApplicationLinkWizard.cancel();
                    AppLinks.UI.listApplicationLinks(data.applicationLink.id, 'new', data);
                };
            createApplicationLinkWizard.disableSubmitBtn();
            AppLinks.SPI.createLink(applicationLink, "", "", false, false, "", configFormValues, successFn, AppLinks.UI.displayValidationError('create-validation-errors', dialogRootEl, function() {
                createApplicationLinkWizard.enableSubmitBtn();
            }));
        };
        var performLinkCreationSubmit = function() {
            var successFn = function(data) {
                createApplicationLinkWizard.enableSubmitBtn();
                createApplicationLinkWizard.enablePreviousBtn();
                createApplicationLinkWizard.cancel();
                AppLinks.UI.listApplicationLinks(data.applicationLink.id, 'new', data);
            };
            if (typeof manifest.typeId == "undefined") {
                var applicationLink = {
                    id: manifest.id,
                    typeId: dialogRootEl.find(".application-types").val(),
                    name: dialogRootEl.find(".application-name").val(),
                    rpcUrl: appUrl,
                    displayUrl: appUrl,
                    isPrimary: false
                },
                    configFormValues = {
                        trustEachOther: false,
                        shareUserbase: false
                    };
                //NON-UAL
                createApplicationLinkWizard.disableSubmitBtn();
                createApplicationLinkWizard.disablePreviousBtn();
                AppLinks.SPI.createLink(applicationLink, '', '', false, false, "", configFormValues, successFn, AppLinks.UI.displayValidationError('create-non-ual-errors', dialogRootEl, function() {
                    createApplicationLinkWizard.enableSubmitBtn();
                    createApplicationLinkWizard.enablePreviousBtn();
                }));
            } else {
                var configFormValues;
                if (!!dialogRootEl.find("#step3-allowed").length) {
                    configFormValues = {
                        trustEachOther: !!(dialogRootEl.find('.trust-each-other-description').find('input').is(':checked')),
                        shareUserbase: !!(dialogRootEl.find('.same-user-description').find('input').is(':checked'))
                    };
                }
                else {
                    configFormValues = {
                        trustEachOther: true,
                        shareUserbase: false
                    };
                }

                applicationLink = {
                    id: manifest.id,
                    typeId: manifest.typeId,
                    name: manifest.name,
                    rpcUrl: appUrl,
                    displayUrl: manifest.url,
                    isPrimary: false
                };

                rpcUrl = rpcURLEl.val();
                createApplicationLinkWizard.disableSubmitBtn();
                createApplicationLinkWizard.disablePreviousBtn();

                //APL-548: Is the URL is not the same as the base URL then tell UAL that we are sending along a
                // custom URL.
                var isCustomUrl = rpcUrl && rpcUrl !== baseUrl;
                AppLinks.SPI.createLink(applicationLink, reciprocalLinkUsernameEl.val(), reciprocalLinkPasswordEl.val(), /*create two way link*/ true, isCustomUrl, rpcUrl, configFormValues, successFn, AppLinks.UI.displayValidationError('create-validation-errors', dialogRootEl, function() {
                    createApplicationLinkWizard.enableSubmitBtn();
                    createApplicationLinkWizard.enablePreviousBtn();
                }));
            }
        };
        var wizardSettings = {
            showButtonId: "add-application-link",
            width: 510,
            height: 660,
            id: "add-application-link-dialog",
            onnext: function() {
                dialogRootEl.find('.applinks-error').remove();
                var page = createApplicationLinkWizard.dialog.curpage;
                if (page == 0) {
                    var handleManifest = function (man) {
                       manifest = man;
                    };
                    appUrl = AppLinks.Wizard.fetchManifest(createApplicationLinkWizard, dialogRootEl, handleManifest, handleManifest);
                    return false;
                } else if (page == 2) {
                    var gotoNextPageFn = function() {
                        createApplicationLinkWizard.enableNextBtn();
                        createApplicationLinkWizard.enablePreviousBtn();
                        createApplicationLinkWizard.dialog.gotoPage(3);
                        if (manifest.publicSignup) {
                            dialogRootEl.find("#warning-without-public-signup").hide();
                            dialogRootEl.find("#warning-with-public-signup").show();
                        } else {
                            dialogRootEl.find("#warning-without-public-signup").show();
                            dialogRootEl.find("#warning-with-public-signup").hide();
                        }
                    }
                    createApplicationLinkWizard.disableNextBtn();
                    createApplicationLinkWizard.disablePreviousBtn();
                    var errorFn = function() {
                        createApplicationLinkWizard.enableNextBtn();
                        createApplicationLinkWizard.enablePreviousBtn();
                    }
                    AppLinks.Wizard.checkReciprocalLinkFormThreeStepMode(dialogRootEl, createOneWayLinkFn, gotoNextPageFn, appUrl, errorFn);
                    return false;
                } else if (page == 3) {
                    performLinkCreationSubmit();
                    return false;
                }
                return true;
            },
            onprevious: function() {
                if (createApplicationLinkWizard.dialog.curpage == 2) {
                    createApplicationLinkWizard.dialog.gotoPage(0);
                    return false;
                }
                return true;
            },
            onsubmit: function() {
                // if it's 2-step or it's for a 3rd-party.
                if (!!dialogRootEl.find("#step3-allowed").length || typeof manifest.typeId == "undefined") {
                    performLinkCreationSubmit();
                // if the it's only oneway link, just go to create
                } else if (!dialogRootEl.find('.create-reciprocal-link').is(':checked')) {
                    createOneWayLinkFn();
                } else {
                    var successFn = function() {
                        performLinkCreationSubmit();
                    };
                    AppLinks.Wizard.checkReciprocalLinkFormTwoStepMode(dialogRootEl, appUrl, successFn, function(){});
                }
                return false;
            },
            onshow: function() {
                dialogRootEl.find('.applinks-error').remove();
                AppLinks.UI.hideInfoBox();
                applicationURLEl.val('');
                rpcURLEl.val(baseUrl);
                return true;
            },
            aftershow: function() {
                applicationURLEl.focus();
            }
        },
            wizardContainer = $("#create-application-link-container"),
            createApplicationLinkWizard = wizardContainer.wizard(wizardSettings),
            dialogRootEl     = $(createApplicationLinkWizard.dialog.popup.element),
            localAppNameEl   = dialogRootEl.find('.local-app-name'),
            applicationURLEl = dialogRootEl.find('#application-url'),
            rpcURLEl = dialogRootEl.find('.reciprocal-rpc-url'),
            reciprocalLinkUsernameEl = dialogRootEl.find('.reciprocal-link-username'),
            reciprocalLinkPasswordEl = dialogRootEl.find('.reciprocal-link-password'),
            baseUrl = $('#baseUrl').val();
            localAppNameEl.html(AppLinks.UI.shortenString(applicationName, 20));

        wizardContainer.data('wizard', createApplicationLinkWizard);

        AppLinks.Wizard.initNonUALUI(dialogRootEl);
        AppLinks.Wizard.initAuthenticationUI(dialogRootEl);

        AppLinks.showAddApplicationLinkWizard = function(url) {
                createApplicationLinkWizard.show();
                if (url) {
                    applicationURLEl.val(url);
                }
            };

        applicationURLEl.on('keydown', function(event) {
                //KeyCode 13 is the enter key.
                if (event.keyCode == '13') {
                    createApplicationLinkWizard.nextPage();
                }
            });

        reciprocalLinkPasswordEl.on('keydown', function(event) {
                //KeyCode 13 is the enter key.
                if (event.keyCode == '13') {
                    handleEnterKeyInWizardStep2();
                }
            });

        rpcURLEl.on('keydown', function(event) {
                //KeyCode 13 is the enter key.
                if (event.keyCode == '13') {
                    handleEnterKeyInWizardStep2();
                }
            });

        function handleEnterKeyInWizardStep2() {
            if (!!dialogRootEl.find("#step3-allowed").length) {
                createApplicationLinkWizard.nextPage();
            } else {
                createApplicationLinkWizard.submit();
            }
        }
    })(AJS.$);
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:list-application-links', location = 'js/edit-application-link.js' */
AJS.$(document).bind(AppLinks.Event.READY, function() {
    var $ = AJS.$,
        dialogDiv = $("#editAppLinkDialog"),
        currentApplication,
        editableDisplayUrl = $('#display-url'),
        editableApplicationName = $('#applicationName'),
        update = function() {
            $('.applinks-error', "#editAppLinkDialog").remove();
            var rawURL = editableDisplayUrl.val().trim();
            if (rawURL == '') {
                $('<div class="error applinks-error">'+ "The URL should not be empty." +'</div>').insertAfter(editableDisplayUrl);
                return false;
            }
            if (editableApplicationName.val() == '') {
                $('<div class="error applinks-error">'+ "The application name should not be empty." +'</div>').insertAfter(editableApplicationName);
                return false;
            }
            // screen for the most common URL syntax errors
            // this needs to be upgraded to fully implement RFC1738 and refactored to a utility class for reuse
            var badIndex = rawURL.search(/[ \t\n\f\r\v]/);
            if (badIndex > -1) {
                $('<div class="error applinks-error">'+ AJS.format("Invalid URL: Illegal whitespace at index {0}", badIndex) +'</div>').insertAfter(editableDisplayUrl);
                return false;
            }
            if(rawURL.match(/^http/) && !rawURL.match(/^https?:\/\//)) {
                $('<div class="error applinks-error">'+ "Invalid URL: Missing double slash" +'</div>').insertAfter(editableDisplayUrl);
                return false;
            }

            var updated = $.extend(true, {}, currentApplication); //deep copy in case this object changes
            updated.name = $("#applicationName").val();
            var displayURL = AppLinks.UI.addProtocolToURL($("#display-url").val());
            updated.displayUrl = displayURL;
            delete updated.hasOutgoing;
            delete updated.hasIncoming;
            delete updated.webPanels;
            delete updated.webItems;
            wizard.disableSubmitBtn();
            AppLinks.update(updated, function() {
                currentApplication = updated;
                wizard.enableSubmitBtn();
                wizard.dialog.popup.element.find("h2").text(updated.name);
                wizard.dialog.popup.hide();
                currentUpdateCallback(currentApplication);
            }, AppLinks.UI.displayValidationError('update-validation-errors', dialogRootEl, function() {
                wizard.enableSubmitBtn();
            }));
        },
        show = function() {
            $('.applinks-error').remove();
            var dialog = wizard.dialog.popup;
            dialog.element.find("h2").text("Configure" + " " + currentApplication.name);

            $('#applicationTypeValue').text(AppLinks.I18n.getApplicationTypeName(currentApplication.typeId));

            $("#rpc-url").text(currentApplication.rpcUrl);

            $("#applicationName").val(currentApplication.name);
            $('#display-url').val(currentApplication.displayUrl);

            if (currentApplication.isTwoWay) {
                $("#hasApplinks").html("Yes");
            }
            else {
                $("#hasApplinks").html("No");
            }
        },
        currentCancelCallback,
        currentUpdateCallback,
        settings = {
            showButtonId: 'edit-application-link',
            cancelLabel: "Close",
            width: 800,
            height: 520,
            id: 'edit-application-link-dialog',
            submitLabel: "Update",
            onshow: function(popup) {
                show();
                var contextPath = AJS.contextPath();
                if (currentApplication.hasOutgoing === true) {
                    $("#outgoing-auth").attr("src", contextPath + "/plugins/servlet/applinks/auth/conf/config-tabs?direction=OUTBOUND&applicationId=" + currentApplication.id);
                    $($("#edit-application-link-dialog .item-button")[1]).show();
                } else {
                    $($("#edit-application-link-dialog .item-button")[1]).hide();
                }
                if (currentApplication.hasIncoming === true){
                    $("#incoming-auth").attr("src", contextPath + "/plugins/servlet/applinks/auth/conf/config-tabs?direction=INBOUND&applicationId=" + currentApplication.id);
                    $($("#edit-application-link-dialog .item-button")[2]).show();
                } else {
                    $($("#edit-application-link-dialog .item-button")[2]).hide();
                }
                return true;
            },
            onsubmit: function(popup) {
                dialogRootEl.find('.applinks-error').remove();
                update();
                return false;
            },
            oncancel: function() {
                currentCancelCallback();
                return true;
            }
        },
        wizard = dialogDiv.wizard(settings);
        var dialogRootEl = $(wizard.dialog.popup.element);

    $('#edit-application-link-dialog .item-button').each(function(index) {
        var locationStr = "" + parent.location;
        var $wizardSubmit = $('#edit-application-link-dialog .wizard-submit');
        var handler;
        if (locationStr.indexOf('#') !== -1) {
            locationStr = locationStr.substring(0, locationStr.indexOf('#'));
        }
        if (index === 1 || index === 2) {
            handler = function() {
                $wizardSubmit.hide();
                var $activePane = $(".active-pane", document.getElementById((index === 1 ? "outgoing-auth" : "incoming-auth")).contentWindow.document),
                    $iframe = $activePane.children("iframe"),
                    $loadIcon = $activePane.children(".loading.loading-tabs");
                $loadIcon.show();
                $iframe.attr('src', $iframe.attr('src'));
            }
        } else {
            handler = function() {
                $wizardSubmit.show();
            }
        }
        $(this).on('click', handler);
    });

    AppLinks.editAppLink = function(application, authType, showIncoming, onupdate, oncancel) {
        currentApplication = application;
        currentUpdateCallback = onupdate || function() {
            AppLinks.UI.refreshOrphanedTrust();
            return true;
        };
        currentCancelCallback = oncancel || function() {
            AppLinks.UI.refreshOrphanedTrust();
            return true;
        };
        wizard.show();
        var itemButtonNumber;
        var authIframeId;

        if (showIncoming) {
            itemButtonNumber = 2;
            authIframeId = "incoming-auth";
        } else {
            itemButtonNumber = 1;
            authIframeId = "outgoing-auth";
        }

        if (authType != "undefined") {
            $('#edit-application-link-dialog .item-button')[itemButtonNumber].click();
            $('#outgoing-auth').load( function() {
                var iframeDocument = document.getElementById(authIframeId).contentWindow.document;
                var $configTab = $("." + authType, iframeDocument);
                $configTab.parent().addClass('active-tab').siblings().removeClass('active-tab');
                var $configPane = $($configTab.attr('href'), iframeDocument);
                $configPane.addClass('active-pane').siblings().removeClass('active-pane');
            });
        } else {
            $('#' + authIframeId).unbind('load');
        }
    };
    AppLinks.bindEditAppLink = function(e) {
        var application = e.data.application;
        e.preventDefault();
        AppLinks.UI.hideInfoBox();
        AppLinks.editAppLink(application, "undefined", false, function(updated) {
            AppLinks.UI.listApplicationLinks(updated.id, 'update');
            return true;
        }, function() {
            AppLinks.UI.listApplicationLinks();
            return true;
        });

    }
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:list-application-links', location = 'js/orphaned-trust.js' */
AJS.$(document).bind(AppLinks.Event.READY, function() {
    (function($) {

        var trustDialog;
        var confirmDeleteDialog;
        var orphanTrustRow;

        var trustDialogDiv = $("#orphaned-trust-certificates");

        var trustDialogSettings = {
            showButtonId: 'show-orphaned-trust',
            cancelLabel: "Close",
            width: 800,
            height: 300,
            id: 'orphaned-trust-certificates-dialog',
            onshow: function(popup) {
                var dialog = popup.popup.element;
            }
        };

        trustDialog = trustDialogDiv.wizard(trustDialogSettings);

        AppLinks.showOrphanedTrustCertificates = function() {
            trustDialog.show();
        };

        var deleteDialogDiv = $("#orphaned-trust-certificates-delete");

        var deleteDialogSettings = {
            submitLabel: "Delete",
            cancelLabel: "Cancel",
            width: 350,
            height: 175,
            id: "#orphaned-trust-certificates-delete-dialog",
            onshow: function(popup) {
                var dialog = popup.popup.element;
                $(dialog).find(".confirm-delete-text")
                        .text($.trim(AJS.format("Are you sure you want to delete the trust relationship with \u0027\u0027{0}\u0027\u0027?",
                                orphanTrustRow.find("td.description").text())));
            },
            onsubmit: function() {
                var success = function() {
                    orphanTrustRow.remove();

                    confirmDeleteDialog.dialog.hide();

                    if ($('tr.orphaned-trust-row').size() == 0) {
                        // all trust certs dealt with
                        $('.orphaned-trust-warning').hide();
                    } else {
                        // still some certs left - reshow the wizard
                        trustDialog.show();
                    }
                };

                var error = function(xhr, ajaxOptions, thrownError) {
                    confirmDeleteDialog.dialog.hide();
                    var msg = $.parseJSON(xhr.responseText).message;
                    AppLinks.UI.showErrorBox("Failed to delete orphaned trust certificate" + ": " + msg);
                };

                var orphanedTrustId = orphanTrustRow.attr("data-id");
                var orphanedTrustType = orphanTrustRow.attr("data-type");

                AppLinks.SPI.deleteOrphanedTrust(orphanedTrustId, orphanedTrustType, success, error);
                return false;
            },
            oncancel: function() {
                trustDialog.show();
            }
        };

        confirmDeleteDialog = deleteDialogDiv.wizard(deleteDialogSettings);

        $(".orphaned-trust-create-link").on('click', function() {
            var row = $(this).parents("tr.orphaned-trust-row");
            var description = row.find("td.description").text();
            var id          = row.attr("data-id");
            var authType   = row.attr("data-type");
            trustDialog.dialog.hide();
            AppLinks.showUpgradeToApplicationLinkWizard(id, authType, AppLinks.UI.findApplicationType(id), AppLinks.UI.findUrl(description));
        });

        $(".orphaned-trust-delete").on('click', function() {
            orphanTrustRow = AJS.$(this).parents("tr.orphaned-trust-row");

            trustDialog.dialog.hide();
            confirmDeleteDialog.show();
        });

    })(AJS.$);
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:list-application-links', location = 'js/upgrade-orphaned-trust.js' */
/**
 This dialog is used to upgrade an existing oauth or trusted apps configuration to an Application Link.
 **/
(function($, ApplinksEvents) {
    $(document).bind(AppLinks.Event.READY, function() {
        var authenticationType,
            authLabel,
            authId,
            appType,
            appTypeLabel,
            manifest,
            appUrl,
            upgradeDialogSettings = {
                cancelLabel:   "Cancel",
                width:         510,
                height:        660,
                id:            'upgrade-orphaned-trust-dialog',
                onshow: function(popup) {
                    dialogRootEl.find('.applinks-error').remove();
                    return true;
                },
                onnext: function() {
                    dialogRootEl.find('.applinks-error').remove();
                    var page = upgradeTrustWizard.dialog.curpage;
                    if (page == 0) {
                        var ualAppFn = function(man) {
                            manifest = man;
                            dialogRootEl.find('.reciprocal-link-description').text(AJS.format("To enable {0} in both directions between these applications, we require administrator credentials for the remote application. Uncheck the tickbox, if you only want {0} enabled for incoming requests.", authLabel));
                            dialogRootEl.find('.no-reciprocal-link-description').text(AJS.format("Tick this box to enable {0} in both directions between these applications, otherwise clicking on create will create the Application Link with allowing incoming {0} requests only.", authLabel));
                        };
                        var nonUALAppFn = function(man) {
                            dialogRootEl.find('.application-name').val(dialogRootEl.find(".non-ual-application-url").text());
                            if (authenticationType == "OAUTH_SERVICE_PROVIDER") {
                                dialogRootEl.find('.non-ual-description').text("This will enable outgoing authentication for this application using OAuth.");
                            } else {
                                dialogRootEl.find('.non-ual-description').text(AJS.format("This will allow incoming requests from this application using {0}.", authLabel));
                            }
                            manifest = man;
                            if (appType) {
                                dialogRootEl.find('.application-types').val(appType);
                            }

                        };
                        appUrl= AppLinks.Wizard.fetchManifest(upgradeTrustWizard, dialogRootEl, ualAppFn, nonUALAppFn);
                    }
                    return false;
                },
                onprevious: function() {
                    upgradeTrustWizard.dialog.gotoPage(1);
                },
                onsubmit: function() {
                    var page = upgradeTrustWizard.dialog.curpage;
                    var successFn = function(data) {
                        upgradeTrustWizard.enableSubmitBtn();
                        upgradeTrustWizard.enablePreviousBtn();
                        upgradeTrustWizard.cancel();
                        // re-load applinks list, depending on the UI
                        ApplinksEvents.trigger(ApplinksEvents.ORPHANED_UPGRADE, data);
                        AppLinks.UI.refreshOrphanedTrust();
                    };
                    if (page == 1) {
                        //NON-UAL
                        var orphanedConfig = {
                                id:   authId,
                                type: authenticationType
                            },
                            applicationLink = {
                                id: manifest.id,
                                typeId: dialogRootEl.find(".application-types").val(),
                                name: dialogRootEl.find(".application-name").val(),
                                rpcUrl: dialogRootEl.find(".non-ual-application-url").text(),
                                displayUrl: dialogRootEl.find(".non-ual-application-url").text(),
                                isPrimary: false
                            },
                            configFormValues = {
                                trustEachOther: false,
                                shareUserbase: false
                            };
                        upgradeTrustWizard.disableSubmitBtn();
                        upgradeTrustWizard.disablePreviousBtn();
                        AppLinks.SPI.createLinkWithOrphanedTrust(applicationLink, '', '', false, false, "",
                            configFormValues, orphanedConfig, successFn,
                            AppLinks.UI.displayValidationError('create-non-ual-errors', dialogRootEl, function() {
                                upgradeTrustWizard.enableSubmitBtn();
                                upgradeTrustWizard.enablePreviousBtn();
                            }));
                    } else if (page == 2) {
                        var orphanedConfig = {
                            id:   authId,
                            type: authenticationType
                        };
                        var configFormValues = {
                                trustEachOther: false,
                                shareUserbase:  false
                            },
                            applicationLink = {
                                id: manifest.id,
                                typeId: manifest.typeId,
                                name: manifest.name,
                                rpcUrl: appUrl,
                                displayUrl: manifest.url,
                                isPrimary: false
                            },
                            rpcUrl = rpcURLEl.val();
                        upgradeTrustWizard.disableSubmitBtn();
                        upgradeTrustWizard.disablePreviousBtn();
                        var createTwoWayLink = dialogRootEl.find('.create-reciprocal-link').is(':checked');
                        var createLinkFn = function() {
                            AppLinks.SPI.createLinkWithOrphanedTrust(applicationLink, reciprocalLinkUsernameEl.val(),
                                reciprocalLinkPasswordEl.val(), createTwoWayLink/*create two way link*/ , true, rpcUrl,
                                configFormValues, orphanedConfig, successFn,
                                AppLinks.UI.displayValidationError('two-way-link-errors', dialogRootEl, function() {
                                    upgradeTrustWizard.enableSubmitBtn();
                                    upgradeTrustWizard.enablePreviousBtn();
                                }));
                        };
                        var errorFn = function() {
                            upgradeTrustWizard.enableSubmitBtn();
                            upgradeTrustWizard.enablePreviousBtn();
                        };
                        AppLinks.Wizard.checkReciprocalLinkFormThreeStepMode(dialogRootEl, createLinkFn, createLinkFn, appUrl, errorFn);
                    }
                    return false;
                },
                aftershow: function() {
                    applicationURLEl.focus();
                }
            };
        var upgradeTrustWizard = $("#upgrade-orphaned-trust-container").wizard(upgradeDialogSettings),
            dialogRootEl =  $(upgradeTrustWizard.dialog.popup.element),
            localAppNameEl   = dialogRootEl.find('.local-app-name'),
            applicationURLEl = dialogRootEl.find('#application-url'),
            rpcURLEl = dialogRootEl.find('.reciprocal-rpc-url'),
            reciprocalLinkUsernameEl = dialogRootEl.find('.reciprocal-link-username'),
            reciprocalLinkPasswordEl = dialogRootEl.find('.reciprocal-link-password');
        localAppNameEl.html(AppLinks.UI.shortenString(applicationName, 20));

        AppLinks.showUpgradeToApplicationLinkWizard = function(id, authType, applicationType, url) {
            authId = id;
            authenticationType = authType;
            appType = applicationType;
            appTypeLabel = AppLinks.I18n.getApplicationTypeName(applicationType);
            authLabel;
            if (authType === "TRUSTED_APPS") {
                authLabel = "Trusted Application";
            } else if (authType == "OAUTH") {
                authLabel = "OAuth";
            }

            AppLinks.UI.removeCssClass(dialogRootEl.find('#remoteApp'), 'application-type-image');
            if (applicationType) {
                dialogRootEl.find('#remoteApp').removeClass('app-image unknown-app-image');
                dialogRootEl.find('#remoteApp').addClass('app-image remote-app-image application-type-image-' + applicationType);
            } else {
                dialogRootEl.find('#remoteApp').removeClass('app-image remote-app-image');
                dialogRootEl.find('#remoteApp').addClass('app-image unknown-app-image');
            }

            if (url && applicationType) {
                dialogRootEl.find('.upgrade-info').text(AJS.format("Check that this URL for {0} is correct.", appTypeLabel));
                applicationURLEl.val(url);
            } else if (url && !applicationType) {
                dialogRootEl.find('.upgrade-info').text("Check that this URL is correct.");
                applicationURLEl.val(url);
            } else if (!url && applicationType) {
                dialogRootEl.find('.upgrade-info').text(AJS.format("Enter the URL for {0}.", appTypeLabel));
            }
            else {
                dialogRootEl.find('.upgrade-info').text(AJS.format("Enter the URL of the Application.", authLabel));
            }
            upgradeTrustWizard.show();
        };

        AppLinks.Wizard.initNonUALUI(dialogRootEl);
        AppLinks.Wizard.initAuthenticationUI(dialogRootEl);

        applicationURLEl.on('keydown', function(event) {
            //KeyCode 13 is the enter key.
            if (event.keyCode == '13') {
                upgradeTrustWizard.nextPage();
            }
        });
        reciprocalLinkPasswordEl.on('keydown', function(event) {
            //KeyCode 13 is the enter key.
            if (event.keyCode == '13') {
                upgradeTrustWizard.submit();
            }
        });
        rpcURLEl.on('keydown', function(event) {
            //KeyCode 13 is the enter key.
            if (event.keyCode == '13') {
                upgradeTrustWizard.submit();
            }
        });

    });
})(require('applinks/lib/jquery'), require('applinks/common/events'));
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:list-application-links', location = 'com/atlassian/applinks/ui/admin/list-applinks-table.soy' */
// This file was automatically generated from list-applinks-table.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace applinks.templates.list.
 */

if (typeof applinks == 'undefined') { var applinks = {}; }
if (typeof applinks.templates == 'undefined') { applinks.templates = {}; }
if (typeof applinks.templates.list == 'undefined') { applinks.templates.list = {}; }


applinks.templates.list.getUpgradeWarning = function(opt_data, opt_ignored) {
  return '<div>' + soy.$$escapeHtml(AJS.format('Application \x27\x27{0}\x27\x27 has been upgraded.',opt_data.name)) + ' <a class=\'upgrade-' + soy.$$escapeHtml(opt_data.id) + ' upgrade-warning\' href=\'#\'>' + soy.$$escapeHtml('Click here to Upgrade the Application Link configuration') + '</a></div>';
};
if (goog.DEBUG) {
  applinks.templates.list.getUpgradeWarning.soyTemplateName = 'applinks.templates.list.getUpgradeWarning';
}
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:list-application-links', location = 'com/atlassian/applinks/ui/admin/applinks-dialog.soy' */
// This file was automatically generated from applinks-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace applinks.templates.
 */

if (typeof applinks == 'undefined') { var applinks = {}; }
if (typeof applinks.templates == 'undefined') { applinks.templates = {}; }


applinks.templates.helpLink = function(opt_data, opt_ignored) {
  return '<a title="' + soy.$$escapeHtml('Help') + '" href="' + soy.$$escapeHtml(require('applinks/common/help-paths').getFullPath(opt_data.helpLinkKey,undefined)) + '" target="_blank" class="ual-help-link help-link" data-help-link-key="' + soy.$$escapeHtml(opt_data.helpLinkKey) + '"><span class="aui-icon aui-icon-small aui-iconfont-help">' + soy.$$escapeHtml('Help') + '</span></a>';
};
if (goog.DEBUG) {
  applinks.templates.helpLink.soyTemplateName = 'applinks.templates.helpLink';
}


applinks.templates.getConfirmUrlsDialog = function(opt_data, opt_ignored) {
  return '<div id="applinks-dialog"><p>' + soy.$$escapeHtml('The Application URL is different to the Display URL.') + '</p><p>' + soy.$$escapeHtml('Confirm that this is correct or change the Application URL below.') + '</p><p>' + soy.$$escapeHtml('The Application URL should only be different to the Display URL if your application cannot access the internet directly (e.g. behind a firewall or proxy).') + '</p>' + aui.form.form({action: '', id: 'applinks-confirm-urls-form', content: '' + aui.form.textField({id: 'application-url-rpc', labelContent: 'Application URL', isRequired: true, value: opt_data.rpcUrl, descriptionText: 'This is the URL used to connect to the remote application from this server.'}) + aui.form.textField({id: 'application-url-display', labelContent: 'Display URL', isRequired: true, isDisabled: true, value: opt_data.displayUrl, descriptionText: 'The display URL is used when rendering links to the application in the user\x27s browser.'})}) + '</div>';
};
if (goog.DEBUG) {
  applinks.templates.getConfirmUrlsDialog.soyTemplateName = 'applinks.templates.getConfirmUrlsDialog';
}


applinks.templates.getCreateUalLinkDialog = function(opt_data, opt_ignored) {
  return '<div id="applinks-dialog"><p>' + soy.$$escapeHtml('You are creating a link from:') + '</p>' + applinks.templates.appDetails({displayUrl: opt_data.fromApp.url, rpcUrl: opt_data.fromApp.rpcUrl, name: opt_data.fromApp.name, product: opt_data.fromApp.product, logoUrl: opt_data.fromApp.logoUrl}) + '<p>' + soy.$$escapeHtml('To this application:') + '</p>' + applinks.templates.appDetails({displayUrl: opt_data.toApp.url, rpcUrl: opt_data.toApp.rpcUrl, name: opt_data.toApp.name, product: opt_data.toApp.product, logoUrl: opt_data.toApp.logoUrl}) + ((opt_data.reciprocal) ? aui.message.info({extraClasses: 'redirect', isCloseable: false, content: soy.$$escapeHtml('Click continue to create the link and be redirected back to') + ' <strong>' + soy.$$escapeHtml(opt_data.fromApp.name) + '</strong>'}) + ((! opt_data.isSysAdmin && opt_data.sharedUserbase) ? aui.message.error({extraClasses: 'sharedUserBaseWarning', isCloseable: false, content: '' + soy.$$escapeHtml('The reciprocal Application Link cannot be configured for a shared userbase. This can be configured later by a system administrator.')}) : '') + ((opt_data.isUsingCors) ? aui.message.warning({isCloseable: false, content: '' + soy.$$escapeHtml('There is a problem communicating directly between these two applications. This may affect the behaviour of some integration features.')}) : '') : aui.form.form({action: '', extraClasses: 'long-label', content: ((opt_data.isSysAdmin && opt_data.impersonationIsSupported) ? '<div class="checkbox"><input name="userbase" id="userbase" type="checkbox"><label for="userbase">' + soy.$$escapeHtml('The servers have the same set of users and usernames.') + '</label>' + applinks.templates.helpLink({helpLinkKey: 'applinks.docs.administration.guide'}) + '<div class="description">If unsure leave unchecked.</div></div>' : '') + '<div class="checkbox"><input name="isAdmin" id="isAdmin" checked type="checkbox"><label for="isAdmin">' + soy.$$escapeHtml('I am an administrator on both instances.') + '</label></div><div class="isAdmin"><!-- place holder --><br/><br/><br/><br/><br/></div>' + aui.message.info({extraClasses: 'isAdmin hidden notAdmin ', isCloseable: false, content: soy.$$escapeHtml('Indicating you are not an admin on both instances means only the local end of the link will be created now. An Admin on') + ' <strong>' + soy.$$escapeHtml(opt_data.fromApp.name) + '</strong> ' + soy.$$escapeHtml('can complete the link.')})}) + ((opt_data.isUsingCors) ? aui.message.warning({isCloseable: false, content: '' + soy.$$escapeHtml('There is a problem communicating directly between these two applications. This may affect the behaviour of some integration features.')}) : '')) + '</div>';
};
if (goog.DEBUG) {
  applinks.templates.getCreateUalLinkDialog.soyTemplateName = 'applinks.templates.getCreateUalLinkDialog';
}


applinks.templates.getCreateNonUalLinkDialog = function(opt_data, opt_ignored) {
  return '<div id="applinks-dialog"><p>' + soy.$$escapeHtml('You are creating a link from:') + '</p>' + applinks.templates.appDetails({rpcUrl: opt_data.toApp.url, name: opt_data.toApp.name, product: opt_data.toApp.product, logoUrl: opt_data.toApp.logoUrl}) + '<p>' + soy.$$escapeHtml('To this application:') + '</p>' + aui.form.form({action: '', id: 'applinks-create-nonual-form', content: '' + applinks.templates.nonUalAppDetails({url: opt_data.fromApp.url}) + aui.message.error({extraClasses: 'createNonUalLinkDialogError', isCloseable: false}) + aui.form.textField({id: 'application-name-new', labelContent: 'Application Name', isRequired: true, errorTexts: ['The application name should not be empty.']}) + aui.form.selectField({id: 'application-types-new', labelContent: 'Application Type', options: opt_data.typeOptions, isRequired: true}) + '<div id="applinks-nonual-oath-configuration">' + aui.form.textField({id: 'serviceProvider', labelContent: 'Service Provider Name', isRequired: false, errorTexts: ['Service provider name is required.']}) + aui.form.textField({id: 'consumerKey', labelContent: 'Consumer key', isRequired: false, errorTexts: ['auth.oauth.config.serviceprovider.missing.consumer.key']}) + aui.form.textField({id: 'sharedSecret', labelContent: 'Shared secret', isRequired: false, errorTexts: ['Shared secret is required.']}) + aui.form.textField({id: 'requestTokenUrl', labelContent: 'Request Token URL', isRequired: false, errorTexts: ['Request Token URL is required.']}) + aui.form.textField({id: 'accessTokenUrl', labelContent: 'Access token URL', isRequired: false, errorTexts: ['Access Token URL is required.']}) + aui.form.textField({id: 'authorizeUrl', labelContent: 'Authorize URL', isRequired: false, errorTexts: ['Authorize URL is required.']}) + '</div><div class="field-group"><input name="createIncoming" id="createIncoming" type="checkbox"><label for="createIncoming">' + soy.$$escapeHtml('Create incoming link') + '</label><input name="oauth-outgoing-enabled" id="oauth-outgoing-enabled" type="hidden" value="true"/></div>'}) + '</div>';
};
if (goog.DEBUG) {
  applinks.templates.getCreateNonUalLinkDialog.soyTemplateName = 'applinks.templates.getCreateNonUalLinkDialog';
}


applinks.templates.getConfigureIncomingNonUalLinkDialog = function(opt_data, opt_ignored) {
  return '<div id="applinks-dialog"><p>' + soy.$$escapeHtml('You are creating a link from:') + '</p>' + applinks.templates.appDetails({rpcUrl: opt_data.toApp.url, name: opt_data.toApp.name, product: opt_data.toApp.product, logoUrl: opt_data.toApp.logoUrl}) + '<p>' + soy.$$escapeHtml('To this application:') + '</p>' + aui.form.form({action: '', id: 'applinks-configure-incoming-nonual-form', content: '' + applinks.templates.nonUalAppDetails({url: opt_data.fromApp.url, isRequired: true}) + aui.message.error({extraClasses: 'configureIncomingNonUalLinkDialogError', isCloseable: false}) + aui.form.textField({id: 'consumerKey', labelContent: 'Consumer Key', isRequired: true, errorTexts: ['auth.oauth.config.serviceprovider.missing.consumer.key']}) + aui.form.textField({id: 'consumerName', labelContent: 'Consumer Name', isRequired: true, errorTexts: ['Consumer name is required.']}) + aui.form.textareaField({id: 'publicKey', labelContent: 'Public Key', isRequired: true, errorTexts: ['A Public Key is required.']})}) + '</div>';
};
if (goog.DEBUG) {
  applinks.templates.getConfigureIncomingNonUalLinkDialog.soyTemplateName = 'applinks.templates.getConfigureIncomingNonUalLinkDialog';
}


applinks.templates.getConfigureUrlDialog = function(opt_data, opt_ignored) {
  return '<div id="url-dialog">' + aui.message.warning({extraClasses: 'urlError', isCloseable: false, content: opt_data.urlErrorMessage}) + aui.form.form({action: '', id: 'applinks-configure-url-form', content: '' + aui.form.textField({id: 'application-url-userdefined', labelContent: 'Entered URL', isRequired: false, isDisabled: true, value: opt_data.originalUrl}) + ((opt_data.showSelectOptions) ? aui.form.checkboxField({id: 'use-application-url', legendContent: '', fields: [{id: 'use-application-url-userdefined', labelText: 'Use this URL', 'isChecked?': false}], descriptionText: 'Checking this will skip any further validation and use this URL for the link.'}) : '') + aui.form.textField({id: 'application-url-corrected', labelContent: 'New URL', isRequired: true, value: opt_data.correctedUrl})}) + '</div>';
};
if (goog.DEBUG) {
  applinks.templates.getConfigureUrlDialog.soyTemplateName = 'applinks.templates.getConfigureUrlDialog';
}


applinks.templates.getPauseDialog = function(opt_data, opt_ignored) {
  return '<div id="create-applink">' + aui.message.info({extraClasses: 'applinksPauseDialog', isCloseable: false, content: opt_data.message}) + '</div>';
};
if (goog.DEBUG) {
  applinks.templates.getPauseDialog.soyTemplateName = 'applinks.templates.getPauseDialog';
}


applinks.templates.getManualRedirectDialog = function(opt_data, opt_ignored) {
  return '<div id="create-applink">' + aui.form.form({action: '', id: 'applinks-manual-redirect-form', content: aui.message.info({extraClasses: 'manualRedirectUrl', isCloseable: false, content: '<p>' + soy.$$escapeHtml('To create a reciprocal link please copy the following URL and pass to an Administrator on') + ' <strong>' + soy.$$escapeHtml(opt_data.redirectApp) + '</strong></p>'}) + '<p><input type="text" size="100%" class="text long-field" value="' + soy.$$escapeHtml(opt_data.redirectUrl) + '" readonly/></p>'}) + '</div>';
};
if (goog.DEBUG) {
  applinks.templates.getManualRedirectDialog.soyTemplateName = 'applinks.templates.getManualRedirectDialog';
}


applinks.templates.appDetails = function(opt_data, opt_ignored) {
  return '<div class="appDetail"><div class="appDetailRow"><div class="avatar">' + ((opt_data.logoUrl) ? '<img src="' + soy.$$escapeHtml(opt_data.logoUrl) + '" class="aui-icon-small" width=16px height=16px/>' : '') + '</div><div class="detail">' + ((opt_data.displayUrl) ? '<p><strong>' + soy.$$escapeHtml('Display URL') + ':</strong> ' + soy.$$escapeHtml(opt_data.displayUrl) + '</p>' : '') + ((opt_data.rpcUrl) ? '<p><strong>' + soy.$$escapeHtml('Application URL') + ':</strong> ' + soy.$$escapeHtml(opt_data.rpcUrl) + '</p>' : '') + '<p><strong>' + soy.$$escapeHtml('Name') + ':</strong> ' + soy.$$escapeHtml(opt_data.name) + '</p><p><strong>' + soy.$$escapeHtml('Application') + ':</strong> ' + soy.$$escapeHtml(opt_data.product) + '</p></div></div></div>';
};
if (goog.DEBUG) {
  applinks.templates.appDetails.soyTemplateName = 'applinks.templates.appDetails';
}


applinks.templates.nonUalAppDetails = function(opt_data, opt_ignored) {
  return '<div class="appDetail"><div class="appDetailRow"><div class="avatar"><span class="avatarSpace"></span></div><div class="detail"><p><strong>' + soy.$$escapeHtml('Application URL') + ':</strong> ' + soy.$$escapeHtml(opt_data.url) + '</p><input type="hidden" id="non-ual-application-url" value="' + soy.$$escapeHtml(opt_data.url) + '"/></div></div></div>';
};
if (goog.DEBUG) {
  applinks.templates.nonUalAppDetails.soyTemplateName = 'applinks.templates.nonUalAppDetails';
}


applinks.templates.getInformationDialog = function(opt_data, opt_ignored) {
  return '<div id="create-applink">' + aui.form.form({action: '', id: 'applinks-information-form', content: '' + ((opt_data.warningHtml != null) ? aui.message.warning({id: 'applinks-warning-message', isCloseable: false, content: '<p>' + soy.$$filterNoAutoescape(opt_data.warningHtml) + '</p>'}) : '') + ((opt_data.informationHtml != null) ? aui.message.info({id: 'applinks-information-message', isCloseable: false, content: '<p>' + soy.$$filterNoAutoescape(opt_data.informationHtml) + '</p>'}) : '')}) + '</div>';
};
if (goog.DEBUG) {
  applinks.templates.getInformationDialog.soyTemplateName = 'applinks.templates.getInformationDialog';
}
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-applink-migration', location = 'applinks/internal/feature/migration/applinks-feature-migration.js' */
define('applinks/feature/migration', [
    'applinks/lib/jquery',
    'applinks/lib/lodash',
    'applinks/lib/aui',
    'applinks/common/dialog-helper',
    'applinks/common/preconditions',
    'applinks/common/rest'
], function(
    $,
    _,
    AJS,
    DialogHelper,
    Preconditions,
    ApplinksRest
) {

    function disableLocalTrustedAuth(applink) {
        $.ajax({
            url: AJS.contextPath() + '/plugins/servlet/applinks/auth/conf/trusted/autoconfig/' + applink.id,
            type: 'DELETE'
        }).always(function() {
            applink.fetchStatus();
        });
    }

    function createLocalRemovalDialog(applink) {
        var dialogId = 'removal-dialog-' + applink.id;
        var dialogContents = applinks.migration.localRemovalDialogContent({
            id: dialogId,
            displayUrl: applink.getAdminUrl(),
            displayName: applink.get("name")
        });

        $(DialogHelper.getContainer()).append(dialogContents);
        var dialog = AJS.dialog2('#' + dialogId);

        $('#' + dialogId + ' button').on('click', function() {
            dialog.hide();
            dialog.remove();
        });

        dialog.id = dialogId;
        dialog.closeButtonId = dialogId + '-close-button';
        dialog.okButtonId = dialogId + '-ok-button';
        return dialog;
    }

    function hasMigrationApi(config) {
        return _.some(config.capabilities, function(capability) {
            return capability === 'MIGRATION_API';
        });
    }

    function migrate(applink, disableLocalTrustedPredicate) {
        ApplinksRest.V3.migration(applink.id).post().done(function(config) {
            if (disableLocalTrustedPredicate(config)) {
                disableLocalTrustedAuth(applink);
            } else {
                applink.fetchStatus();
            }
        }).fail(function () {
            applink.fetchStatus();
        });
    }

    function showLoadingSpinner(applink) {
        // switch status lozenge to a loading spinner
        applink.set({statusLoaded: false});
    }

    return {
        migrate: function(applink) {
            // this should only run for applink with automatic migration status, i.e LEGACY_UPDATE and LEGACY_REMOVAL
            Preconditions.hasValue(applink, 'applink');
            showLoadingSpinner(applink);
            migrate(applink, function(config) {
                return config.incoming.oauth && config.incoming.trusted;
            });
        },
        removeLocal: function(applink) {
            Preconditions.hasValue(applink, 'applink');
            var dialog = createLocalRemovalDialog(applink);
            $('#' + dialog.okButtonId).on('click', function() {
                showLoadingSpinner(applink);
                migrate(applink, hasMigrationApi);
            });
            dialog.show();
        }
    }
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-applink-migration', location = 'applinks/internal/feature/migration/applinks-feature-migration-dialog.soy' */
// This file was automatically generated from applinks-feature-migration-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace applinks.migration.
 */

if (typeof applinks == 'undefined') { var applinks = {}; }
if (typeof applinks.migration == 'undefined') { applinks.migration = {}; }


applinks.migration.localRemovalDialogContent = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="' + soy.$$escapeHtml(opt_data.id) + '" class="aui-layer aui-dialog2 aui-dialog2-medium aui-dialog2-warning" aria-hidden="true" data-aui-modal="true" data-aui-remove-on-hide="true" data-aui-focus-selector="' + soy.$$escapeHtml(opt_data.id) + '-close-button"><!-- Dialog header --><header class="aui-dialog2-header"><!-- The dialog\'s title --><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Remove deprecated authentication locally') + '</h2></header><!-- Main dialog content --><div class="aui-dialog2-content"><p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml('You are about to remove Trusted Applications authentication from the local end of this application link.')) + '</p><p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('Doing this will temporarily break the connection for all users until you also remove Trusted Applications authentication from the link in \x3ca href\x3d{0} target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.displayName) === 'number' ? opt_data.displayName : soy.$$escapeHtml(opt_data.displayName)))) + '</p><p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml('Are you sure you want to continue?')) + '</p></div><!-- Dialog footer --><footer class="aui-dialog2-footer"><!-- Actions to render on the right of the footer --><div class="aui-dialog2-footer-actions"><button type="button" id="' + soy.$$escapeHtml(opt_data.id) + '-ok-button" class="aui-button">' + soy.$$escapeHtml('Confirm') + '</button><button type="button" id="' + soy.$$escapeHtml(opt_data.id) + '-close-button" class="aui-button aui-button-link applinks-default-focus">' + soy.$$escapeHtml('Close') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  applinks.migration.localRemovalDialogContent.soyTemplateName = 'applinks.migration.localRemovalDialogContent';
}
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-applink-status', location = 'applinks/internal/feature/applink-status/details/applink-status-details-deprecated.js' */
define('applinks/feature/status/details/deprecated', [
    'applinks/feature/migration',
    'applinks/feature/status/errors'
], function(
    Migration,
    ApplinkStatusErrors
) {
   return {
       onLoad: function(statusDialog, applink) {
           statusDialog._dialog.$popup.find('.applinks-status-update').on('click', function() {
               statusDialog._dialog.hide();
                if (ApplinkStatusErrors.MANUAL_LEGACY_REMOVAL.matches(applink.get('status'))) {
                    Migration.removeLocal(applink);
                } else {
                    Migration.migrate(applink);
                }
           })
       }
   };
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-applink-status', location = 'applinks/internal/feature/applink-status/applink-status.js' */
define('applinks/feature/status', [
    'applinks/lib/jquery',
    'applinks/common/preconditions'
], function(
    $,
    Preconditions
) {
    function processStatus(status) {
        // this is the place to adjust status client side if needed
        return status;
    }

    /**
     * Renders Applink Status lozenge.
     *
     * Supported options:
     *
     * `applink` {Object} (required) - the applink to render the status for, with a `status` property indicating applink status
     * `container` {HTMLElement} (required) - container to attach the status to
     * `clickable` {boolean} (optional, defaults to `true`) - render the lozenge as clickable
     * `extraClasses` {string} (optional, defaults to `undefined`) - extra classes to render on the status element
     *
     * @param {Object} options object to render the status with
     * @constructor
     */
    function ApplinkStatus(options) {
        Preconditions.hasValue(options, 'options');
        Preconditions.hasValue(options.applink, 'options.applink');
        Preconditions.hasValue(options.container, 'options.container');

        var $container = $(options.container),
            applink = options.applink;
       
        if (!applink.statusLoaded || !applink.status) {
            $container.append(applinks.status.loading(createTemplateData(options)));
        } else if (applink.status.working) {
            $container.append(applinks.status.working(createTemplateData(options)));
        } else {
            $container.append(applinks.status.error(createTemplateData(options)));
        }
        $container.attr('data-status-loaded', applink.statusLoaded);
    }

    function createTemplateData(options) {
        var clickable = options.clickable !== false; // true by default, false only if explicitly false
        var status = options.applink.status && processStatus(options.applink.status);
        var extraClasses = options.extraClasses || '';

        return {
            status: status,
            clickable: clickable,
            extraClasses: extraClasses
        };
    }

    return {
        View: ApplinkStatus,
        processStatus: processStatus,
        /**
         * CSS selector for the authenticate link generated by the View component for statuses requiring remote 
         * authentication 
         */
        AUTHENTICATE_LINK_SELECTOR: '.status-remote-auth-required'
    };
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-applink-status', location = 'applinks/internal/feature/applink-status/applink-status-errors.js' */
define('applinks/feature/status/errors', [
    'applinks/lib/lodash',
    'applinks/common/preconditions'
], function(
    _,
    Preconditions
) {

    function ApplinkError(type, category, linkKey, sectionKey) {
        this.type = type;
        this.category = category;
        this.linkKey = linkKey;
        this.sectionKey = sectionKey;
    }

    ApplinkError.prototype.equals = function(error) {
        return isErrorObject(error) && 
            this.type === error.type && 
            this.category === error.category;
    };

    /**
     * @param statusOrError status or error object
     * @returns {boolean} `true`, if this error is equal to the error represented by the `status` object
     */
    ApplinkError.prototype.matches = function(statusOrError) {
        if (isStatusObject(statusOrError)) {
            return this.equals(statusOrError.error);
        } else if (isErrorObject(statusOrError)) {
            return this.equals(statusOrError);
        } else {
            return false;
        }
    };

    function isStatusObject(object) {
        return object && object.error && isErrorObject(object.error);
    }

    function isErrorObject(object) {
        return object && object.type && object.category;
    }

    function isApplinkError(object) {
        return object instanceof ApplinkError;
    }

    /**
     * NOTE: the keys and errors below must match `ApplinkErrorType`. Make sure to run ApplinkErrorTypeContractTest
     * after updating this file.
     */
    var Errors =  {
        "CONNECTION_REFUSED": new ApplinkError('CONNECTION_REFUSED', 'NETWORK_ERROR', 'applinks.docs.diagnostics.troubleshoot.connectionrefused', 'connectionrefused'),
        "UNKNOWN_HOST": new ApplinkError('UNKNOWN_HOST', 'NETWORK_ERROR', 'applinks.docs.diagnostics.troubleshoot.unknownhost', 'unknownhost'),
        "SSL_UNTRUSTED": new ApplinkError('SSL_UNTRUSTED', 'NETWORK_ERROR', 'applinks.docs.diagnostics.troubleshoot.ssluntrusted', 'SSLnottrusted'),
        "SSL_HOSTNAME_UNMATCHED": new ApplinkError('SSL_HOSTNAME_UNMATCHED', 'NETWORK_ERROR', 'applinks.docs.diagnostics.troubleshoot.sslunmatched', 'SSLnotmatching'),
        "SSL_UNMATCHED": new ApplinkError('SSL_UNMATCHED', 'NETWORK_ERROR', 'applinks.docs.diagnostics.troubleshoot.sslunmatched', 'SSLnotmatching'),
        "OAUTH_PROBLEM": new ApplinkError('OAUTH_PROBLEM', 'NETWORK_ERROR', 'applinks.docs.diagnostics.troubleshoot.oauthproblem', 'commonerrors'),
        "OAUTH_TIMESTAMP_REFUSED": new ApplinkError('OAUTH_TIMESTAMP_REFUSED', 'NETWORK_ERROR', 'applinks.docs.diagnostics.troubleshoot.oauthtimestamprefused', 'OAuthtimestamp'),
        "OAUTH_SIGNATURE_INVALID": new ApplinkError('OAUTH_SIGNATURE_INVALID', 'NETWORK_ERROR', 'applinks.docs.diagnostics.troubleshoot.oauthsignatureinvalid', 'OAuthinvalidsig'),
        "UNEXPECTED_RESPONSE": new ApplinkError('UNEXPECTED_RESPONSE', 'NETWORK_ERROR', 'applinks.docs.diagnostics.troubleshoot.unexpectedresponse', 'unexpectedresponse'),
        "UNEXPECTED_RESPONSE_STATUS": new ApplinkError('UNEXPECTED_RESPONSE_STATUS', 'NETWORK_ERROR', 'applinks.docs.diagnostics.troubleshoot.unexpectedresponse', 'unexpectedresponse'),

        "AUTH_LEVEL_MISMATCH": new ApplinkError('AUTH_LEVEL_MISMATCH', 'CONFIG_ERROR', 'applinks.docs.diagnostics.troubleshoot.authlevelmismatch', 'OAuthmatch'),
        "NO_REMOTE_APPLINK" : new ApplinkError('NO_REMOTE_APPLINK', 'CONFIG_ERROR'),

        "LOCAL_AUTH_TOKEN_REQUIRED": new ApplinkError('LOCAL_AUTH_TOKEN_REQUIRED', 'ACCESS_ERROR'),
        "REMOTE_AUTH_TOKEN_REQUIRED": new ApplinkError('REMOTE_AUTH_TOKEN_REQUIRED', 'ACCESS_ERROR'),
        "INSUFFICIENT_REMOTE_PERMISSION" : new ApplinkError('INSUFFICIENT_REMOTE_PERMISSION', 'ACCESS_ERROR', 'applinks.docs.configuring.auth.oauth', 'accessdenied_oauth'),

        "REMOTE_VERSION_INCOMPATIBLE" : new ApplinkError('REMOTE_VERSION_INCOMPATIBLE', 'INCOMPATIBLE'),
        "NO_OUTGOING_AUTH" : new ApplinkError('NO_OUTGOING_AUTH', 'INCOMPATIBLE', 'applinks.docs.configuring.auth.oauth'),

        "GENERIC_LINK" : new ApplinkError('GENERIC_LINK', 'NON_ATLASSIAN'),
        "NON_ATLASSIAN" : new ApplinkError('NON_ATLASSIAN', 'NON_ATLASSIAN'),

        "SYSTEM_LINK" : new ApplinkError('SYSTEM_LINK', 'SYSTEM'),

        "AUTH_LEVEL_UNSUPPORTED" : new ApplinkError('AUTH_LEVEL_UNSUPPORTED', 'DEPRECATED', 'applinks.docs.diagnostics.troubleshoot.authlevelunsupported', 'OAuthunsupported'),
        "LEGACY_UPDATE" : new ApplinkError('LEGACY_UPDATE', 'DEPRECATED', 'applinks.docs.diagnostics.troubleshoot.migration', 'autoUpdate'),
        "LEGACY_REMOVAL" : new ApplinkError('LEGACY_REMOVAL', 'DEPRECATED', 'applinks.docs.diagnostics.troubleshoot.migration', 'autoRemove'),
        "MANUAL_LEGACY_UPDATE" : new ApplinkError('MANUAL_LEGACY_UPDATE', 'DEPRECATED', 'applinks.docs.diagnostics.troubleshoot.migration', 'manualUpdate'),
        "MANUAL_LEGACY_REMOVAL" : new ApplinkError('MANUAL_LEGACY_REMOVAL', 'DEPRECATED', 'applinks.docs.diagnostics.troubleshoot.migration', 'manualRemove'),
        "MANUAL_LEGACY_REMOVAL_WITH_OLD_EDIT" : new ApplinkError('MANUAL_LEGACY_REMOVAL_WITH_OLD_EDIT', 'DEPRECATED', 'applinks.docs.diagnostics.troubleshoot.migration', 'manualOldEditRemove'),

        "UNKNOWN" : new ApplinkError('UNKNOWN', 'UNKNOWN', 'applinks.docs.diagnostics.troubleshoot.unknownerror'),

        eachError: function(callback) {
            _.chain(Errors).values().filter(isApplinkError).each(callback);
        },

        /**
         * @param statusOrError status or status error to match by
         * @returns {object} matching status error, or undefined if not found
         */
        find: function(statusOrError) {
            if (isErrorObject(statusOrError)) {
                return Errors[statusOrError.type]
            } else if (isStatusObject(statusOrError)) {
                return Errors[statusOrError.error.type];
            } else {
                return undefined;
            }
        },

        /**
         * @param statusOrError status or status error to match
         * @returns {boolean} `true` if `status` represents an "access token missing" error, `false` otherwise
         */
        isAccessTokenError: function(statusOrError) {
            return Errors.REMOTE_AUTH_TOKEN_REQUIRED.matches(statusOrError) ||
                Errors.LOCAL_AUTH_TOKEN_REQUIRED.matches(statusOrError);
        },

        hasErrorCategory: function(statusOrError, targetCategory) {
            Preconditions.hasValue(targetCategory, 'targetCategory');

            var category = isErrorObject(statusOrError) ? statusOrError.category :
                            (isStatusObject(statusOrError) ? statusOrError.error.category : undefined);
            return category === targetCategory;
        }
    };

    return Errors;
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-applink-status', location = 'applinks/internal/feature/applink-status/details/applink-status-oauth-matcher.js' */
define('applinks/feature/status/oauth-matcher', [
    'applinks/common/preconditions'
], function(
    Preconditions
) {
    function getAuthLevel(config) {
        Preconditions.hasValue(config);
        if (config.enabled && config.twoLoEnabled && config.twoLoImpersonationEnabled) {
            return 'oauthWithImpersonation';
        }
        if (config.enabled && !config.twoLoImpersonationEnabled) {
            return 'oauth';
        }
        if (!config.enabled && !config.twoLoEnabled && !config.twoLoImpersonationEnabled) {
            return 'disabled';
        }
        return undefined;
    }

    function matchLocalAndRemote(status) {
        var local = status.localAuthentication;
        var remote = status.remoteAuthentication;
        Preconditions.hasValue(local);
        Preconditions.hasValue(remote);
        var config = {
            'incoming' : {
                'local': getAuthLevel(local.incoming),
                'remote': getAuthLevel(remote.outgoing)
            },
            'outgoing' : {
                'local': getAuthLevel(local.outgoing),
                'remote': getAuthLevel(remote.incoming)
            }
        };
        if (config.incoming.local === config.incoming.remote && config.outgoing.local === config.outgoing.remote) {
            return undefined;
        }
        return config;
    }

    return matchLocalAndRemote;
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-applink-status', location = 'applinks/internal/feature/applink-status/details/applink-status-details.js' */
define('applinks/feature/status/details', [
    'applinks/lib/aui',
    'applinks/lib/console',
    'applinks/lib/jquery',
    'applinks/lib/lodash',
    'applinks/common/events',
    'applinks/component/inline-dialog',
    'applinks/common/preconditions',
    'applinks/common/rest',
    'applinks/feature/status',
    'applinks/feature/status/errors',
    'applinks/feature/status/oauth-matcher',
    'applinks/feature/oauth-dance',
    'applinks/common/urls',
    'applinks/feature/status/details/deprecated'
], function(
    AJS,
    console,
    $,
    _,
    ApplinksEvents,
    InlineDialog,
    Preconditions,
    ApplinksRest,
    ApplinkStatus,
    ApplinkStatusErrors,
    matchOAuthConfigs,
    OAuthDance,
    Urls,
    DeprecatedStatus
) {
    var MODE_DIALOG = 'dialog';
    var MODE_NOTIFICATION = 'notification';

    function generateStatusDetailsContents(applink, mode) {
        mode = mode || MODE_DIALOG;

        var status = applink.get('status');
        var data = {
            status: status,
            displayUrl: applink.getAdminUrl(),
            editUrl: Urls.Local.edit(applink.id)
        };
        var injectedData = {
            mode: mode,
            isDialog: mode === MODE_DIALOG
        };

        function renderTemplate(template, extraData) {
            // render with injected data
            return template(_.extend({}, data, extraData || {}), null, injectedData)
        }

        var contents = null;

        if (ApplinkStatusErrors.CONNECTION_REFUSED.matches(status)) {
            contents = renderTemplate(applinks.status.details.connection_refused);
        } else if (ApplinkStatusErrors.UNKNOWN_HOST.matches(status)) {
            contents = renderTemplate(applinks.status.details.unknown_host);
        } else if (ApplinkStatusErrors.AUTH_LEVEL_MISMATCH.matches(status)) {
            var mismatches = matchOAuthConfigs(status);
            Preconditions.hasValue(mismatches, 'mismatches', 'Unable to find mismatch description');
            contents = renderTemplate(applinks.status.details.auth_level_mismatch, {mismatches: mismatches});
        } else if (ApplinkStatusErrors.UNKNOWN.matches(status)) {
            contents = renderTemplate(applinks.status.details.unknown_error);
        } else if (ApplinkStatusErrors.AUTH_LEVEL_UNSUPPORTED.matches(status)) {
            contents = renderTemplate(applinks.status.details.auth_level_unsupported);
            contents = renderTemplate(applinks.status.details.auth_level_unsupported);
        } else if (ApplinkStatusErrors.SSL_UNTRUSTED.matches(status)) {
            contents = renderTemplate(applinks.status.details.ssl_untrusted);
        } else if (ApplinkStatusErrors.SSL_HOSTNAME_UNMATCHED.matches(status)) {
            contents = renderTemplate(applinks.status.details.ssl_hostname_unmatched);
        } else if (ApplinkStatusErrors.SSL_UNMATCHED.matches(status)) {
            contents = renderTemplate(applinks.status.details.ssl_unmatched);
        } else if (ApplinkStatusErrors.OAUTH_PROBLEM.matches(status)) {
            contents = renderTemplate(applinks.status.details.oauth_problem);
        } else if (ApplinkStatusErrors.OAUTH_TIMESTAMP_REFUSED.matches(status)) {
            contents = renderTemplate(applinks.status.details.oauth_timestamp_refused);
        } else if (ApplinkStatusErrors.OAUTH_SIGNATURE_INVALID.matches(status)) {
            contents = renderTemplate(applinks.status.details.oauth_signature_invalid);
        } else if (ApplinkStatusErrors.UNEXPECTED_RESPONSE.matches(status) ||
            ApplinkStatusErrors.UNEXPECTED_RESPONSE_STATUS.matches(status)) {
            contents = renderTemplate(applinks.status.details.unexpected_response, {
                renderDetails: ApplinkStatusErrors.UNEXPECTED_RESPONSE_STATUS.matches(status)
            });
        } else if (ApplinkStatusErrors.SYSTEM_LINK.matches(status)) {
            contents = renderTemplate(applinks.status.details.system_link);
        } else if (ApplinkStatusErrors.GENERIC_LINK.matches(status)) {
            contents = renderTemplate(applinks.status.details.generic_link);
        } else if (ApplinkStatusErrors.REMOTE_VERSION_INCOMPATIBLE.matches(status)) {
            contents = renderTemplate(applinks.status.details.remote_version_incompatible,
                {applinkType: applink.getTypeName()});
        } else if (ApplinkStatusErrors.NON_ATLASSIAN.matches(status)) {
            contents = renderTemplate(applinks.status.details.non_atlassian);
        } else if (ApplinkStatusErrors.NO_REMOTE_APPLINK.matches(status)) {
            contents = renderTemplate(applinks.status.details.no_remote_applink);
        } else if (ApplinkStatusErrors.NO_OUTGOING_AUTH.matches(status)) {
            contents = renderTemplate(applinks.status.details.no_outgoing_auth);
        } else if (ApplinkStatusErrors.INSUFFICIENT_REMOTE_PERMISSION.matches(status)) {
            contents = renderTemplate(applinks.status.details.insufficient_remote_permission);
        } else if (ApplinkStatusErrors.LEGACY_REMOVAL.matches(status)) {
            contents = renderTemplate(applinks.status.details.legacy_removal);
        } else if (ApplinkStatusErrors.LEGACY_UPDATE.matches(status)) {
            contents = renderTemplate(applinks.status.details.legacy_update);
        } else if (ApplinkStatusErrors.MANUAL_LEGACY_UPDATE.matches(status)) {
            contents = renderTemplate(applinks.status.details.manual_legacy_update);
        } else if (ApplinkStatusErrors.MANUAL_LEGACY_REMOVAL.matches(status)) {
            contents = renderTemplate(applinks.status.details.manual_legacy_removal);
        } else if (ApplinkStatusErrors.MANUAL_LEGACY_REMOVAL_WITH_OLD_EDIT.matches(status)) {
            contents = renderTemplate(applinks.status.details.manual_legacy_removal_with_old_edit);
        }
        // add more status popups here

        return contents && modeContainer(status, mode, contents);
    }

    function modeContainer(status, mode, contents) {
        if (mode == MODE_NOTIFICATION) {
            return applinks.status.details.notificationContainer({status: status, contents: contents});
        } else {
            // dialog does not need a container
            return contents;
        }
    }

    function inlineDialogId(linkId) {
        return 'applinks-status-dialog-' + linkId;
    }

    function inlineDialog(linkId) {
        return $('#' + inlineDialogId(linkId));
    }

    function initialiseOAuthDanceForInsufficientPermission($container, applink) {
        var selector = '.status-insufficient-remote-permission';
        var $oauthLink = $container.find(selector);

        // remove consumer token before redirecting user to the OAuth dance
        $oauthLink.on('click', function() {
            ApplinksRest.OAuth.V1.consumerToken(applink.id).del()
                .fail(function(req) {
                    console.warn(AJS.format('Could not remove consumer token for appLinkId {0}, {1}: {2}',
                        applink.id, req.status, req.responseText));
                    triggerOAuthDance($oauthLink);
                })
                .done(function() {
                    triggerOAuthDance($oauthLink);
                });

            return false;
        });
    }

    function onLoad(statusDialog, applink) {
        var status = statusDialog._status;
        if (status && status.error && "DEPRECATED" === status.error.category) {
            return DeprecatedStatus.onLoad(statusDialog, applink);
        }
    }

    function triggerOAuthDance($oauthLink) {
        new OAuthDance($oauthLink).start();
    }

    function fireAnalyticsForDialog(status) {
        AJS.trigger('analyticsEvent', {
            name: 'applinks.status.dialog.opened',
            data: {
                applicationId: status.link.id,
                status: status.error.type.toLowerCase(),
                category: status.error.category.toLowerCase()
            }
        });
    }

    /**
     * Remove any existing status details dialog
     *
     * @param id applink ID to remove the dialog for
     */
    function removeDialog(id) {
        inlineDialog(id).remove();
    }

    /**
     * Constructs status details in form of an inline dialog.
     *
     * @param applink applink V3 model
     * @constructor
     */
    function Dialog(applink) {
        var self = this;
        this._status = applink.get('status');

        if (this._status) {
            this._status = ApplinkStatus.processStatus(this._status);
            removeDialog(this._status.link.id);
            var contents = generateStatusDetailsContents(applink);
            if (contents) {
                var dialog = this._dialog = new InlineDialog(inlineDialogId(this._status.link.id), contents, {
                    classes: 'applinks-status-dialog',
                    alignment: 'bottom center'
                });

                onLoad(this, applink);

                var realign = _.bind(function() {
                    if (this.isVisible()) {
                        this.realign();
                    }
                }, dialog);

                dialog.onShow(function() {
                    $(document).on(ApplinksEvents.Legacy.MESSAGE_BOX_DISPLAYED, realign);
                    self.onDialogShow();
                }).onHide(function() {
                    $(document).off(ApplinksEvents.Legacy.MESSAGE_BOX_DISPLAYED, realign);
                });

                dialog.on('click', '.applinks-status-close, .applinks-v3-switchback', function() {
                    dialog.hide();
                });

                initialiseOAuthDanceForInsufficientPermission(dialog.contents(), applink);
            }
        }
    }

    // visible for testing
    Dialog.prototype.onDialogShow = function () {
        fireAnalyticsForDialog(this._status);
    };

    /**
     * Constructs status details in form of a static inline notification.
     *
     * @param {Object} options object to render the status with:
     *        `applink` {Object} (required) - applink model to render the status details for, with a `status` property 
     *                                        indicating applink status
     *        `container` {HTMLElement} (required) - container to attach the status notification to
     *        `refresh` {HTMLElement} (optional, true by default) - if true, remove the previous notification if the
     *                                                              container already has one
     * @constructor
     */
    function Notification(options) {
        Preconditions.hasValue(options, 'options');
        Preconditions.hasValue(options.applink, 'options.applink');
        Preconditions.hasValue(options.container, 'options.container');

        var self = this;
        this._status = options.applink.get('status');

        if (this._status) {
            this._status = ApplinkStatus.processStatus(this._status);
            var contents = generateStatusDetailsContents(options.applink, MODE_NOTIFICATION);
            if (contents) {
                if (options.refresh !== false) {
                    self.findNotification(options.container).remove();
                }
                $(options.container).append(contents);

                initialiseOAuthDanceForInsufficientPermission(self.findNotification(options.container), options.applink);
            }
        }
    }

    Notification.prototype.findNotification = function(container) {
        return findNotification(container, this._status.link.id);
    };

    function findNotification(container, applinkId) {
        return $(container).find('.applink-status-notification').filter('[data-applink-id="' + applinkId + '"]');
    }

    /**
     * Render the status details in form of a mere Troubleshooting link relevant to the provided status.
     * @param {Object} options object to render the status with:
     *        `applink` {Object} (required) - applink model to render the status details for, with a `status` property
     *                                        indicating applink status
     *        `container` {HTMLElement} (required) - container to attach the status notification to
     *        `refresh` {HTMLElement} (optional, true by default) - if true, remove the any previous help link if the
     *                                                              container already has one
     *        `style` {string} (optional, `link` by default) - controls whether the help link is rendered as a `link` 
     *                                                         or `button`
     *        `textMode` {string} (optional, `short` by default) - controls the link text, `short` or `full`
     *        `extraClasses` {string} (optional, defaults to `undefined`) - extra classes to render on the link element  
     * @constructor
     */
    function HelpLink(options) {
        Preconditions.hasValue(options, 'options');
        Preconditions.hasValue(options.applink, 'options.applink');
        Preconditions.hasValue(options.container, 'options.container');

        var status = options.applink.get('status');

        // only render for error statuses
        if (status && status.error) {
            var error = ApplinkStatusErrors.find(ApplinkStatus.processStatus(status));
            if (error) {
                var contents = applinks.status.details.helpLink({
                    linkKey: error.linkKey,
                    sectionKey: error.sectionKey,
                    style: options.style || 'link',
                    textMode: options.textMode || 'short',
                    extraClasses: options.extraClasses
                });
                // remove previous contents if refresh not explicitly == false
                if (options.refresh !== false) {
                    options.container.find('.troubleshoot-link').remove();
                }
                $(options.container).append(contents);
            }
        }
    }

    return {
        Dialog: Dialog,
        Notification: Notification,
        HelpLink: HelpLink,
        removeDialog: removeDialog
    };
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-applink-status', location = 'applinks/internal/feature/applink-status/applink-status.soy' */
// This file was automatically generated from applink-status.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace applinks.status.
 */

if (typeof applinks == 'undefined') { var applinks = {}; }
if (typeof applinks.status == 'undefined') { applinks.status = {}; }


applinks.status.loading = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<span class="aui-icon aui-icon-wait status-lozenge ' + soy.$$escapeHtml(opt_data.extraClasses) + '">Loading...</span>';
};
if (goog.DEBUG) {
  applinks.status.loading.soyTemplateName = 'applinks.status.loading';
}


applinks.status.working = function(opt_data, opt_ignored) {
  return '' + applinks.status.statusLozengeNonClickable(soy.$$augmentMap(opt_data, {class: 'aui-lozenge-success aui-lozenge-subtle', text: 'Connected'}));
};
if (goog.DEBUG) {
  applinks.status.working.soyTemplateName = 'applinks.status.working';
}


applinks.status.error = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.status.error.category) {
    case 'ACCESS_ERROR':
      switch (opt_data.status.error.type) {
        case 'INSUFFICIENT_REMOTE_PERMISSION':
          output += applinks.status.statusLozenge(soy.$$augmentMap(opt_data, {class: 'aui-lozenge-subtle aui-lozenge-moved', text: 'Access denied', id: opt_data.status.link.id}));
          break;
        default:
          output += (opt_data.clickable) ? '<button type="button" class="aui-button aui-button-link status-remote-auth-required ' + soy.$$escapeHtml(opt_data.extraClasses) + '" data-authorisation-uri="' + soy.$$escapeHtml(opt_data.status.error.authorisationUri) + '">' + aui.icons.icon({useIconFont: true, size: 'small', icon: 'locked'}) + soy.$$escapeHtml('Authenticate to see status') + '</button>' : '';
      }
      break;
    case 'INCOMPATIBLE':
      output += applinks.status.statusLozenge(soy.$$augmentMap(opt_data, {class: 'aui-lozenge-subtle', text: 'Status unavailable', id: opt_data.status.link.id, clickable: opt_data.clickable}));
      break;
    case 'NON_ATLASSIAN':
      output += applinks.status.statusLozenge(soy.$$augmentMap(opt_data, {class: 'aui-lozenge-subtle', text: 'Non-Atlassian', id: opt_data.status.link.id, clickable: opt_data.clickable}));
      break;
    case 'SYSTEM':
      output += applinks.status.statusLozenge(soy.$$augmentMap(opt_data, {class: 'aui-lozenge-subtle', text: 'System', id: opt_data.status.link.id, clickable: opt_data.clickable}));
      break;
    case 'NETWORK_ERROR':
    case 'UNKNOWN':
      output += applinks.status.statusLozenge(soy.$$augmentMap(opt_data, {class: 'aui-lozenge-error', text: 'Network error', id: opt_data.status.link.id, clickable: opt_data.clickable}));
      break;
    case 'CONFIG_ERROR':
      output += applinks.status.statusLozenge(soy.$$augmentMap(opt_data, {class: 'aui-lozenge-error', text: 'Config error', id: opt_data.status.link.id, clickable: opt_data.clickable}));
      break;
    case 'DEPRECATED':
      output += applinks.status.statusLozenge(soy.$$augmentMap(opt_data, {class: 'aui-lozenge-subtle aui-lozenge-current', text: 'Deprecated', id: opt_data.status.link.id, clickable: opt_data.clickable}));
      break;
    case 'DISABLED':
      output += applinks.status.statusLozengeNonClickable(soy.$$augmentMap(opt_data, {class: 'aui-lozenge-subtle', text: 'Disabled'}));
      break;
  }
  return output;
};
if (goog.DEBUG) {
  applinks.status.error.soyTemplateName = 'applinks.status.error';
}


applinks.status.statusLozenge = function(opt_data, opt_ignored) {
  return '' + ((! opt_data.clickable) ? applinks.status.statusLozengeNonClickable(opt_data) : '<button type="button" data-aui-trigger class="aui-lozenge status-lozenge ' + soy.$$escapeHtml(opt_data['class']) + ' ' + soy.$$escapeHtml(opt_data.extraClasses) + '" aria-controls="applinks-status-dialog-' + soy.$$escapeHtml(opt_data.id) + '">' + soy.$$escapeHtml(opt_data.text) + '</button>');
};
if (goog.DEBUG) {
  applinks.status.statusLozenge.soyTemplateName = 'applinks.status.statusLozenge';
}


applinks.status.statusLozengeNonClickable = function(opt_data, opt_ignored) {
  return '<span class="aui-lozenge status-lozenge ' + soy.$$escapeHtml(opt_data['class']) + ' ' + soy.$$escapeHtml(opt_data.extraClasses) + '">' + soy.$$escapeHtml(opt_data.text) + '</spans>';
};
if (goog.DEBUG) {
  applinks.status.statusLozengeNonClickable.soyTemplateName = 'applinks.status.statusLozengeNonClickable';
}
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-applink-status', location = 'applinks/internal/feature/applink-status/details/applink-status-details.soy' */
// This file was automatically generated from applink-status-details.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace applinks.status.details.
 */

if (typeof applinks == 'undefined') { var applinks = {}; }
if (typeof applinks.status == 'undefined') { applinks.status = {}; }
if (typeof applinks.status.details == 'undefined') { applinks.status.details = {}; }


applinks.status.details.actions = function(opt_data, opt_ignored, opt_ijData) {
  return '<div class="' + ((opt_ijData.isDialog) ? 'applink-status-dialog-actions' : 'applink-status-notification-actions') + '">' + ((opt_ijData.isDialog) ? soy.$$filterNoAutoescape(opt_data.primaryActionButton) : '') + applinks.status.details.helpLink({linkKey: opt_data.helpLinkKey, sectionKey: opt_data.sectionKey, style: opt_ijData.isDialog ? 'link' : 'button', textMode: opt_ijData.isDialog ? 'full' : 'short', extraClasses: opt_ijData.isDialog ? 'applinks-status-close' : ''}, null, opt_ijData) + '</div>';
};
if (goog.DEBUG) {
  applinks.status.details.actions.soyTemplateName = 'applinks.status.details.actions';
}


applinks.status.details.closeAction = function(opt_data, opt_ignored, opt_ijData) {
  return '<button type="button" class="aui-button applinks-status-close applinks-default-focus">' + soy.$$escapeHtml('Close') + '</button>';
};
if (goog.DEBUG) {
  applinks.status.details.closeAction.soyTemplateName = 'applinks.status.details.closeAction';
}


applinks.status.details.updateAction = function(opt_data, opt_ignored, opt_ijData) {
  opt_data = opt_data || {};
  var output = '';
  var buttonText__soy26 = opt_data.updateActionText ? opt_data.updateActionText : 'Update';
  output += '<button type="button" class="aui-button applinks-status-update applinks-default-focus">' + soy.$$escapeHtml(buttonText__soy26) + '</button>';
  return output;
};
if (goog.DEBUG) {
  applinks.status.details.updateAction.soyTemplateName = 'applinks.status.details.updateAction';
}


applinks.status.details.editAction = function(opt_data, opt_ignored, opt_ijData) {
  var output = '';
  var buttonText__soy31 = opt_data.editActionText ? opt_data.editActionText : 'Edit';
  output += '<a class="edit-url-button aui-button applinks-default-focus" href="' + soy.$$escapeHtml(opt_data.editUrl) + '">' + soy.$$escapeHtml(buttonText__soy31) + '</a>';
  return output;
};
if (goog.DEBUG) {
  applinks.status.details.editAction.soyTemplateName = 'applinks.status.details.editAction';
}


applinks.status.details.actionsWithCloseButton = function(opt_data, opt_ignored, opt_ijData) {
  opt_data = opt_data || {};
  return '' + applinks.status.details.actions({helpLinkKey: opt_data.helpLinkKey, sectionKey: opt_data.sectionKey, primaryActionButton: '' + applinks.status.details.closeAction(null, null, opt_ijData)}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.actionsWithCloseButton.soyTemplateName = 'applinks.status.details.actionsWithCloseButton';
}


applinks.status.details.actionsWithUpdateButton = function(opt_data, opt_ignored, opt_ijData) {
  opt_data = opt_data || {};
  return '' + applinks.status.details.actions({helpLinkKey: opt_data.helpLinkKey, sectionKey: opt_data.sectionKey, primaryActionButton: '' + applinks.status.details.updateAction(opt_data, null, opt_ijData)}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.actionsWithUpdateButton.soyTemplateName = 'applinks.status.details.actionsWithUpdateButton';
}


applinks.status.details.actionsWithEditButton = function(opt_data, opt_ignored, opt_ijData) {
  return '' + applinks.status.details.actions({helpLinkKey: opt_data.helpLinkKey, sectionKey: opt_data.sectionKey, primaryActionButton: '' + applinks.status.details.editAction(opt_data, null, opt_ijData)}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.actionsWithEditButton.soyTemplateName = 'applinks.status.details.actionsWithEditButton';
}


applinks.status.details.inlineHelpLinkStart = function(opt_data, opt_ignored, opt_ijData) {
  return '' + ((opt_data.sectionKey) ? '<a target="_blank" class="help-link" href="' + soy.$$escapeHtml(require('applinks/common/help-paths').getFullPath(opt_data.helpLinkKey,opt_data.sectionKey)) + '" data-help-link-key="' + soy.$$escapeHtml(opt_data.helpLinkKey) + '">' : '<a target="_blank" class="help-link" href="' + soy.$$escapeHtml(require('applinks/common/help-paths').getFullPath(opt_data.helpLinkKey,undefined)) + '" data-help-link-key="' + soy.$$escapeHtml(opt_data.helpLinkKey) + '">');
};
if (goog.DEBUG) {
  applinks.status.details.inlineHelpLinkStart.soyTemplateName = 'applinks.status.details.inlineHelpLinkStart';
}


applinks.status.details.errorDetails = function(opt_data, opt_ignored, opt_ijData) {
  return '' + ((opt_data.status.error.details) ? '<pre><code>' + soy.$$escapeHtml(opt_data.status.error.details) + '</code></pre>' : '');
};
if (goog.DEBUG) {
  applinks.status.details.errorDetails.soyTemplateName = 'applinks.status.details.errorDetails';
}


applinks.status.details.notificationContainer = function(opt_data, opt_ignored, opt_ijData) {
  return '<div class="applink-status-notification aui-message aui-message-error" data-applink-id="' + soy.$$escapeHtml(opt_data.status.link.id) + '">' + soy.$$filterNoAutoescape(opt_data.contents) + '</div>';
};
if (goog.DEBUG) {
  applinks.status.details.notificationContainer.soyTemplateName = 'applinks.status.details.notificationContainer';
}


applinks.status.details.detailsHeader = function(opt_data, opt_ignored, opt_ijData) {
  return '' + ((opt_ijData.isDialog) ? '<h2 class="applinks-status-dialog-title">' + soy.$$escapeHtml(opt_data.headerText) + '</h2>' : '<p class="title applink-status-notification-title"><strong>' + soy.$$escapeHtml(opt_data.headerText) + '</strong></p>');
};
if (goog.DEBUG) {
  applinks.status.details.detailsHeader.soyTemplateName = 'applinks.status.details.detailsHeader';
}


applinks.status.details.helpLink = function(opt_data, opt_ignored, opt_ijData) {
  var output = '';
  if (opt_data.linkKey) {
    var helpUrl__soy98 = '' + ((opt_data.sectionKey) ? soy.$$escapeHtml(require('applinks/common/help-paths').getFullPath(opt_data.linkKey,opt_data.sectionKey)) : soy.$$escapeHtml(require('applinks/common/help-paths').getFullPath(opt_data.linkKey,undefined)));
    var troubleshootText__soy104 = '' + ((opt_data.textMode == 'full') ? soy.$$escapeHtml('Troubleshoot this problem') : soy.$$escapeHtml('Troubleshoot'));
    output += '<a title="' + soy.$$escapeHtml(troubleshootText__soy104) + '" href="' + soy.$$escapeHtml(helpUrl__soy98) + '" data-help-link-key="' + soy.$$escapeHtml(opt_data.linkKey) + '" target="_blank" class="aui-button ual-help-link help-link troubleshoot-link ' + soy.$$escapeHtml(opt_data.extraClasses) + ((! opt_data.style || opt_data.style == 'link') ? ' aui-button-link' : '') + '">' + soy.$$escapeHtml(troubleshootText__soy104) + '</a>';
  }
  return output;
};
if (goog.DEBUG) {
  applinks.status.details.helpLink.soyTemplateName = 'applinks.status.details.helpLink';
}


applinks.status.details.connection_refused = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('The remote application is not responding')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('The connection to {0} was refused. \x3ca href\x3d\x22{1}\x22 target\x3d\x22_blank\x22\x3e{2}\x3c/a\x3e may be down or blocked by a firewall. Alternatively, the Application URL for the remote application may be incorrect or may have changed recently.',typeof (opt_data.status.link.rpcUrl) === 'number' ? opt_data.status.link.rpcUrl : soy.$$escapeHtml(opt_data.status.link.rpcUrl),typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p>' + applinks.status.details.actionsWithEditButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.connectionrefused', sectionKey: 'connectionrefused', editUrl: opt_data.editUrl}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.connection_refused.soyTemplateName = 'applinks.status.details.connection_refused';
}


applinks.status.details.unknown_host = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Unable to reach the remote application')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('We couldn\x27\x27t resolve the hostname at {0}. There may be a DNS configuration problem, or the Application URL for the remote application may be incorrect or may have changed recently.',typeof (opt_data.status.link.rpcUrl) === 'number' ? opt_data.status.link.rpcUrl : soy.$$escapeHtml(opt_data.status.link.rpcUrl)))) + '</p>' + applinks.status.details.actionsWithEditButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.unknownhost', sectionKey: 'unknownhost', editUrl: opt_data.editUrl}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.unknown_host.soyTemplateName = 'applinks.status.details.unknown_host';
}


applinks.status.details.oauth_problem = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('OAuth problem')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('There is an issue with the OAuth configuration of the connection to \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p>' + applinks.status.details.errorDetails(opt_data, null, opt_ijData) + applinks.status.details.actionsWithCloseButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.oauthproblem', sectionKey: 'commonerrors'}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.oauth_problem.soyTemplateName = 'applinks.status.details.oauth_problem';
}


applinks.status.details.oauth_timestamp_refused = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('The system clocks are not synchronized')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('This server has a different system time from \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e, which prevents the applications from authenticating.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p>' + applinks.status.details.actionsWithCloseButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.oauthtimestamprefused', sectionKey: 'OAuthtimestamp'}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.oauth_timestamp_refused.soyTemplateName = 'applinks.status.details.oauth_timestamp_refused';
}


applinks.status.details.oauth_signature_invalid = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Invalid OAuth signature')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('We couldn\x27\x27t connect to \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e, possibly because that instance is behind a misconfigured proxy.',typeof (opt_data.status.link.displayUrl) === 'number' ? opt_data.status.link.displayUrl : soy.$$escapeHtml(opt_data.status.link.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p>' + applinks.status.details.actionsWithCloseButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.oauthsignatureinvalid', sectionKey: 'OAuthinvalidsig'}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.oauth_signature_invalid.soyTemplateName = 'applinks.status.details.oauth_signature_invalid';
}


applinks.status.details.unexpected_response = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Unexpected response')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('We received an unexpected response from \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e. If the remote application is behind a proxy, check that the application is operational. Troubleshoot this for other possible causes.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p>' + ((opt_data.renderDetails) ? applinks.status.details.errorDetails(opt_data, null, opt_ijData) : '') + '<p>' + soy.$$escapeHtml('To see the full response content look at your application logs.') + '</p>' + applinks.status.details.actionsWithCloseButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.unexpectedresponse', sectionKey: 'unexpectedresponse'}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.unexpected_response.soyTemplateName = 'applinks.status.details.unexpected_response';
}


applinks.status.details.authLevelMismatchMessage = function(opt_data, opt_ignored, opt_ijData) {
  var output = '';
  if (opt_data.direction.local != opt_data.direction.remote) {
    var impersonation__soy196 = 'OAuth with impersonation';
    switch (opt_data.direction.local) {
      case 'disabled':
        output += (opt_data.direction.remote == 'oauth') ? '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('The local {0} connection is disabled, however \x3ca href\x3d\x22{1}\x22 target\x3d\x22_blank\x22\x3e{2}\x3c/a\x3e uses {3}.',typeof (opt_data.directionText) === 'number' ? opt_data.directionText : soy.$$escapeHtml(opt_data.directionText),typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.link.name) === 'number' ? opt_data.link.name : soy.$$escapeHtml(opt_data.link.name),typeof ('OAuth') === 'number' ? 'OAuth' : soy.$$escapeHtml('OAuth')))) + '</p>' : (opt_data.direction.remote == 'oauthWithImpersonation') ? '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('The local {0} connection is disabled, however \x3ca href\x3d\x22{1}\x22 target\x3d\x22_blank\x22\x3e{2}\x3c/a\x3e uses {3}.',typeof (opt_data.directionText) === 'number' ? opt_data.directionText : soy.$$escapeHtml(opt_data.directionText),typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.link.name) === 'number' ? opt_data.link.name : soy.$$escapeHtml(opt_data.link.name),typeof (impersonation__soy196) === 'number' ? impersonation__soy196 : soy.$$escapeHtml(impersonation__soy196)))) + '</p>' : '';
        break;
      case 'oauth':
        output += (opt_data.direction.remote == 'disabled') ? '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('The local {0} connection uses {1}, however it\x27\x27s disabled on \x3ca href\x3d\x22{2}\x22 target\x3d\x22_blank\x22\x3e{3}\x3c/a\x3e.',typeof (opt_data.directionText) === 'number' ? opt_data.directionText : soy.$$escapeHtml(opt_data.directionText),typeof ('OAuth') === 'number' ? 'OAuth' : soy.$$escapeHtml('OAuth'),typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.link.name) === 'number' ? opt_data.link.name : soy.$$escapeHtml(opt_data.link.name)))) + '</p>' : (opt_data.direction.remote == 'oauthWithImpersonation') ? '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('The local {0} connection uses {1}, however \x3ca href\x3d\x22{2}\x22 target\x3d\x22_blank\x22\x3e{3}\x3c/a\x3e uses {4}.',typeof (opt_data.directionText) === 'number' ? opt_data.directionText : soy.$$escapeHtml(opt_data.directionText),typeof ('OAuth') === 'number' ? 'OAuth' : soy.$$escapeHtml('OAuth'),typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.link.name) === 'number' ? opt_data.link.name : soy.$$escapeHtml(opt_data.link.name),typeof (impersonation__soy196) === 'number' ? impersonation__soy196 : soy.$$escapeHtml(impersonation__soy196)))) + '</p>' : '';
        break;
      case 'oauthWithImpersonation':
        output += (opt_data.direction.remote == 'disabled') ? '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('The local {0} connection uses {1}, however it\x27\x27s disabled on \x3ca href\x3d\x22{2}\x22 target\x3d\x22_blank\x22\x3e{3}\x3c/a\x3e.',typeof (opt_data.directionText) === 'number' ? opt_data.directionText : soy.$$escapeHtml(opt_data.directionText),typeof (impersonation__soy196) === 'number' ? impersonation__soy196 : soy.$$escapeHtml(impersonation__soy196),typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.link.name) === 'number' ? opt_data.link.name : soy.$$escapeHtml(opt_data.link.name)))) + '</p>' : (opt_data.direction.remote == 'oauth') ? '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('The local {0} connection uses {1}, however \x3ca href\x3d\x22{2}\x22 target\x3d\x22_blank\x22\x3e{3}\x3c/a\x3e uses {4}.',typeof (opt_data.directionText) === 'number' ? opt_data.directionText : soy.$$escapeHtml(opt_data.directionText),typeof (impersonation__soy196) === 'number' ? impersonation__soy196 : soy.$$escapeHtml(impersonation__soy196),typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.link.name) === 'number' ? opt_data.link.name : soy.$$escapeHtml(opt_data.link.name),typeof ('OAuth') === 'number' ? 'OAuth' : soy.$$escapeHtml('OAuth')))) + '</p>' : '';
        break;
    }
  }
  return output;
};
if (goog.DEBUG) {
  applinks.status.details.authLevelMismatchMessage.soyTemplateName = 'applinks.status.details.authLevelMismatchMessage';
}


applinks.status.details.auth_level_mismatch = function(opt_data, opt_ignored, opt_ijData) {
  return '' + applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('OAuth mismatch')}, null, opt_ijData) + applinks.status.details.authLevelMismatchMessage({link: opt_data.status.link, direction: opt_data.mismatches.incoming, directionText: 'incoming', displayUrl: opt_data.displayUrl}, null, opt_ijData) + applinks.status.details.authLevelMismatchMessage({link: opt_data.status.link, direction: opt_data.mismatches.outgoing, directionText: 'outgoing', displayUrl: opt_data.displayUrl}, null, opt_ijData) + '<p>' + soy.$$escapeHtml('You\x27ll need to edit each connection to make sure the authentication methods are the same.') + '</p>' + applinks.status.details.actionsWithEditButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.authlevelmismatch', sectionKey: 'OAuthmatch', editUrl: opt_data.editUrl}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.auth_level_mismatch.soyTemplateName = 'applinks.status.details.auth_level_mismatch';
}


applinks.status.details.unknown_error = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Network error')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('We couldn\x27\x27t connect to {0} at {1}. This might have been caused by a network error or another configuration error.',typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name),typeof (opt_data.status.link.rpcUrl) === 'number' ? opt_data.status.link.rpcUrl : soy.$$escapeHtml(opt_data.status.link.rpcUrl)))) + '</p>' + applinks.status.details.errorDetails(opt_data, null, opt_ijData) + applinks.status.details.actionsWithEditButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.unknownerror', editUrl: opt_data.editUrl}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.unknown_error.soyTemplateName = 'applinks.status.details.unknown_error';
}


applinks.status.details.auth_level_unsupported = function(opt_data, opt_ignored, opt_ijData) {
  var output = '';
  var oAuthHelpLinkStart__soy261 = '' + applinks.status.details.inlineHelpLinkStart({helpLinkKey: 'applinks.docs.configuring.auth.oauth', sectionKey: 'oauth'}, null, opt_ijData);
  var oAuthImpersonationHelpLinkStart__soy265 = '' + applinks.status.details.inlineHelpLinkStart({helpLinkKey: 'applinks.docs.configuring.auth.oauth', sectionKey: 'impersonation'}, null, opt_ijData);
  var helpLinkEnd__soy269 = '</a>';
  output += applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Unsupported OAuth level')}, null, opt_ijData) + '<p>' + soy.$$filterNoAutoescape(AJS.format('The current OAuth configuration prevents integrations from working. You need to update your configuration to {0}OAuth{1} or {2}OAuth with impersonation{3}.',oAuthHelpLinkStart__soy261,helpLinkEnd__soy269,oAuthImpersonationHelpLinkStart__soy265,helpLinkEnd__soy269)) + '</p>' + applinks.status.details.actionsWithEditButton({editActionText: 'Update', editUrl: opt_data.editUrl, helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.authlevelunsupported', sectionKey: 'OAuthunsupported'}, null, opt_ijData);
  return output;
};
if (goog.DEBUG) {
  applinks.status.details.auth_level_unsupported.soyTemplateName = 'applinks.status.details.auth_level_unsupported';
}


applinks.status.details.ssl_untrusted = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('The remote certificate can\x27t be trusted')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('\x3ca href\x3d{0} target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e may be using a self-signed SSL certificate or a certificate that was issued by a certificate authority that isn\x27\x27t known locally.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p>' + applinks.status.details.actionsWithCloseButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.ssluntrusted', sectionKey: 'SSLnottrusted'}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.ssl_untrusted.soyTemplateName = 'applinks.status.details.ssl_untrusted';
}


applinks.status.details.ssl_hostname_unmatched = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('The remote certificate doesn\x27t match the remote host name')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('The SSL certificate used by \x3ca href\x3d{0} target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e can\x27\x27t be trusted because the certificate\x27\x27s host name doesn\x27\x27t match the URL {2}.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name),typeof (opt_data.status.link.rpcUrl) === 'number' ? opt_data.status.link.rpcUrl : soy.$$escapeHtml(opt_data.status.link.rpcUrl)))) + '</p>' + applinks.status.details.actionsWithCloseButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.sslunmatched', sectionKey: 'SSLnotmatching'}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.ssl_hostname_unmatched.soyTemplateName = 'applinks.status.details.ssl_hostname_unmatched';
}


applinks.status.details.ssl_unmatched = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Unable to verify remote certificate details')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('The SSL certificate used by \x3ca href\x3d{0} target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e can\x27\x27t be trusted because details inside the certificate can\x27\x27t be verified. Check that the remote certificate has the correct details.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p>' + applinks.status.details.errorDetails(opt_data, null, opt_ijData) + applinks.status.details.actionsWithCloseButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.sslunmatched', sectionKey: 'SSLnotmatching'}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.ssl_unmatched.soyTemplateName = 'applinks.status.details.ssl_unmatched';
}


applinks.status.details.system_link = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Internal System Link')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml('This is an internal link to a Cloud server, created automatically by the system. System internal links are read-only and cannot be edited.')) + '</p>' + applinks.status.details.actionsWithCloseButton(null, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.system_link.soyTemplateName = 'applinks.status.details.system_link';
}


applinks.status.details.generic_link = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Link to external third party')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml('This is an application link to an external third party. We are unable to retrieve the status to third parties. If you are experiencing any problems with your connection ensure that your OAuth configuration is correct.')) + '</p>' + applinks.status.details.actionsWithCloseButton(null, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.generic_link.soyTemplateName = 'applinks.status.details.generic_link';
}


applinks.status.details.remote_version_incompatible = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Unable to retrieve status')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('We\x27\x27re unable to determine the status of this link, because the version of {0} is a little too old. The link may actually be good. You can upgrade \x3ca href\x3d\x22{1}\x22 target\x3d\x22_blank\x22\x3e{0}\x3c/a\x3e to the latest version of {2} to get status and diagnostic capabilities.',typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name),typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.applinkType) === 'number' ? opt_data.applinkType : soy.$$escapeHtml(opt_data.applinkType)))) + '</p>' + applinks.status.details.actionsWithCloseButton(null, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.remote_version_incompatible.soyTemplateName = 'applinks.status.details.remote_version_incompatible';
}


applinks.status.details.non_atlassian = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Link to external third party')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml('This is an application link to an external third party. We are unable to retrieve the status to third parties, so if you are experiencing any problems with your connection reach out to the third party directly.')) + '</p>' + applinks.status.details.actionsWithCloseButton(null, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.non_atlassian.soyTemplateName = 'applinks.status.details.non_atlassian';
}


applinks.status.details.no_remote_applink = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('No remote application link')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('We can\x27\x27t connect with \x3ca href\x3d{0} target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e  because a reciprocal application link is missing on that server. You\x27\x27ll need to delete and then re-create this application link.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p>' + applinks.status.details.actionsWithCloseButton(null, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.no_remote_applink.soyTemplateName = 'applinks.status.details.no_remote_applink';
}


applinks.status.details.no_outgoing_auth = function(opt_data, opt_ignored, opt_ijData) {
  var output = '';
  var helpLinkStart__soy355 = '' + applinks.status.details.inlineHelpLinkStart({helpLinkKey: 'applinks.docs.configuring.auth.oauth'}, null, opt_ijData);
  var helpLinkEnd__soy358 = '</a>';
  output += applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('No outgoing authentication')}, null, opt_ijData) + '<p>' + soy.$$filterNoAutoescape(AJS.format('We can\x27\x27t display the status for this application link, because outgoing authentication is disabled. You can {0}enable outgoing authentication{1} to see the status.',helpLinkStart__soy355,helpLinkEnd__soy358)) + '</p>' + applinks.status.details.actionsWithCloseButton({helpLinkKey: 'applinks.docs.configuring.auth.oauth'}, null, opt_ijData);
  return output;
};
if (goog.DEBUG) {
  applinks.status.details.no_outgoing_auth.soyTemplateName = 'applinks.status.details.no_outgoing_auth';
}


applinks.status.details.insufficient_remote_permission = function(opt_data, opt_ignored, opt_ijData) {
  var output = '' + applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Access denied')}, null, opt_ijData);
  if (opt_data.status.localAuthentication.outgoing.twoLoImpersonationEnabled) {
    output += '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('We couldn\x27\x27t retrieve the status from the remote application because your user account doesn\x27\x27t have admin privileges on {0}.',typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p><p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('To see the status, ask for admin access for your account on \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p>' + applinks.status.details.actionsWithCloseButton({helpLinkKey: 'applinks.docs.configuring.auth.oauth', sectionKey: 'accessdenied_oauthimpersonation'}, null, opt_ijData);
  } else {
    var startButton__soy384 = '<button type="button" class="aui-button aui-button-link inline-button status-insufficient-remote-permission" data-authorisation-uri="' + soy.$$escapeHtml(opt_data.status.error.authorisationUri) + '">';
    var endButton__soy388 = '</button>';
    output += '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('We couldn\x27\x27t retrieve the status from the remote application because you don\x27\x27t have admin privileges on {0}.',typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p><p>';
    var displayUrlEscaped__soy393 = '' + soy.$$escapeHtml(opt_data.displayUrl);
    var linkNameEscaped__soy395 = '' + soy.$$escapeHtml(opt_data.status.link.name);
    output += soy.$$filterNoAutoescape(AJS.format('To see the status, log out of \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e and then {2}authenticate{3} as an admin on {1}.',displayUrlEscaped__soy393,linkNameEscaped__soy395,startButton__soy384,endButton__soy388)) + '</p>' + applinks.status.details.actionsWithCloseButton({helpLinkKey: 'applinks.docs.configuring.auth.oauth', sectionKey: 'accessdenied_oauth'}, null, opt_ijData);
  }
  return output;
};
if (goog.DEBUG) {
  applinks.status.details.insufficient_remote_permission.soyTemplateName = 'applinks.status.details.insufficient_remote_permission';
}


applinks.status.details.legacy_update = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Deprecated authentication type')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml('This application link uses either the Trusted Applications or Basic Access authentication type, both of which are deprecated.') + '</p><p>' + soy.$$escapeHtml('You should update this link to use OAuth authentication, the industry standard.') + '</p>' + applinks.status.details.actionsWithUpdateButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.migration', sectionKey: 'autoUpdate'}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.legacy_update.soyTemplateName = 'applinks.status.details.legacy_update';
}


applinks.status.details.legacy_removal = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Deprecated authentication type')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml('As well as OAuth, this application link still uses either the Trusted Applications or Basic Access authentication type, both of which are deprecated.') + '</p><p>' + soy.$$escapeHtml('You should update this link to use OAuth authentication, the industry standard.') + '</p>' + applinks.status.details.actionsWithUpdateButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.migration', sectionKey: 'autoRemove'}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.legacy_removal.soyTemplateName = 'applinks.status.details.legacy_removal';
}


applinks.status.details.manual_legacy_update = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Deprecated authentication type')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml('This application link uses either the Trusted Applications or Basic Access authentication type, both of which are deprecated.') + '</p><p>' + soy.$$escapeHtml('You should manually update this link to use OAuth authentication, the industry standard.') + '</p><p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('You might be able to automatically update this link, if you obtain temporary sysadmin permissions on \x3ca href\x3d{0} target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e and then refresh this page.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p>' + applinks.status.details.actionsWithCloseButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.migration', sectionKey: 'manualUpdate'}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.manual_legacy_update.soyTemplateName = 'applinks.status.details.manual_legacy_update';
}


applinks.status.details.manual_legacy_removal = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Deprecated authentication type')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml('This application link uses a deprecated authentication type.')) + '</p><p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml('You should click \x3cb\x3eUpdate locally\x3c/b\x3e to move to OAuth authentication. Doing this will remove Trusted Applications authentication from this end of the link.')) + '</p><p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('You\x27\x27ll then need to manually remove Trusted Applications authentication from the \x3ca href\x3d{0} target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e end of the link.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p><p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('You might be able to automatically update this link, if you obtain temporary sysadmin permissions on \x3ca href\x3d{0} target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e and then refresh this page.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p>' + applinks.status.details.actionsWithUpdateButton({updateActionText: 'Update locally', helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.migration', sectionKey: 'manualRemove'}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.manual_legacy_removal.soyTemplateName = 'applinks.status.details.manual_legacy_removal';
}


applinks.status.details.manual_legacy_removal_with_old_edit = function(opt_data, opt_ignored, opt_ijData) {
  return applinks.status.details.detailsHeader({headerText: '' + soy.$$escapeHtml('Deprecated authentication type')}, null, opt_ijData) + '<p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml('This application link uses a deprecated authentication type.')) + '</p><p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('You\x27\x27ll need to manually remove Trusted Applications authentication from the \x3ca href\x3d{0} target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e end of the link.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p><p>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('You might be able to automatically update this link, if you obtain temporary sysadmin permissions on \x3ca href\x3d{0} target\x3d\x22_blank\x22\x3e{1}\x3c/a\x3e and then refresh this page.',typeof (opt_data.displayUrl) === 'number' ? opt_data.displayUrl : soy.$$escapeHtml(opt_data.displayUrl),typeof (opt_data.status.link.name) === 'number' ? opt_data.status.link.name : soy.$$escapeHtml(opt_data.status.link.name)))) + '</p>' + applinks.status.details.actionsWithCloseButton({helpLinkKey: 'applinks.docs.diagnostics.troubleshoot.migration', sectionKey: 'manualOldEditRemove'}, null, opt_ijData);
};
if (goog.DEBUG) {
  applinks.status.details.manual_legacy_removal_with_old_edit.soyTemplateName = 'applinks.status.details.manual_legacy_removal_with_old_edit';
}
;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.deprecated.behaviour.jquery-spin', location = 'aui.chunk.0dde33018a05c4d75d7b--1439a98959daf27f272a.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.deprecated.behaviour.jquery-spin"],{My1v:function(u,i,a){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),a("oSOL"),i.default="jquery",u.exports=i.default}},[["My1v","runtime","aui.splitchunk.vendors--1df5b34e16","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.172ffb6da7","aui.splitchunk.a16cabd587","aui.splitchunk.fbd1a5ab27","aui.splitchunk.54d3f16c20","aui.splitchunk.1df5b34e16","aui.splitchunk.9c48cc20a9","aui.splitchunk.ed86a19e01","aui.splitchunk.86ad04cc86"]]]);
//# sourceMappingURL=aui.chunk.0dde33018a05c4d75d7b--1439a98959daf27f272a.js.map;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib-backbone', location = 'applinks/internal/lib/backbone-amd.js' */
define('applinks/lib/backbone', function() {
    var backbone = window.Backbone;
    if (!backbone) {
        throw "window.Backbone not defined, cannot load Backbone";
    }
    return backbone;
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:model-applink', location = 'applinks/internal/model/applink.js' */
define('applinks/model/applink', [
    'applinks/lib/lodash',
    'applinks/lib/backbone',
    'applinks/common/products',
    'applinks/common/response-handlers',
    'applinks/common/response-status',
    'applinks/common/rest'
], function(
    _,
    Backbone,
    ApplinksProducts,
    ResponseHandlers,
    ResponseStatus,
    ApplinksRest
){
    function getExpectedStatuses(options) {
        return options && options.expectedStatuses || [ResponseStatus.Family.SUCCESSFUL];
    }

    var DataKeys = ApplinksRest.V3.ApplinkData;

    var ApplinkModel = Backbone.Model.extend({

        defaults: {
            statusLoaded: false
        },

        /**
         * @param attributes initial model attributes
         * @param options Backbone options containing extra Applink-specific attributes:
         *                `dataKeys`: data keys to fetch extra data while fetching the applink
         */
        initialize: function(attributes, options) {
            this.dataKeys = options && options.dataKeys;
        },

        url: function() {
            return ApplinksRest.V3.applink(this.id, this.dataKeys).getUrl();
        },

        // overridden Backbone methods

        destroy: function(options) {
            var expectedStatuses = getExpectedStatuses(options);
            return Backbone.Model.prototype.destroy.call(this, options)
                .done(ResponseHandlers.done(expectedStatuses))
                .fail(ResponseHandlers.fail(expectedStatuses));
        },

        fetch: function(options) {
            var expectedStatuses = getExpectedStatuses(options);
            return Backbone.Model.prototype.fetch.call(this, options)
                .done(ResponseHandlers.done(expectedStatuses))
                .fail(ResponseHandlers.fail(expectedStatuses));
        },

        save: function(attributes, options) {
            var expectedStatuses = getExpectedStatuses(options);
            return Backbone.Model.prototype.save.call(this, attributes, options)
                .done(ResponseHandlers.done(expectedStatuses))
                .fail(ResponseHandlers.fail(expectedStatuses));
        },

        // Applink-specific API

        /**
         * For compatibility with the legacy "applinks-model-status" model. This simply uses the injected applink data
         * "configUrl"
         *
         * @returns {string}
         */
        getAdminUrl: function() {
            return this.getData(DataKeys.CONFIG_URL);
        },

        /**
         * I18n application type name 
         *
         * @returns {string}
         */
        getTypeName: function() {
            return ApplinksProducts.getTypeName(this.get('type'));
        },
        
        /**
         * @param dataKey optional param to get value of a specific data key. Use ApplinkModel.DataKeys for that
         * @returns {object} `data` object for this applink containing extra injected data from the server. To control
         * contents of this use `dataKeys` option when instantiating this model.
         */
        getData: function(dataKey) {
            var data = this.get('data') || {};
            return dataKey ? data[dataKey] : data;
        },

        /**
         * Fetch status for this applink, once fetched this will be reflected in the `statusLoaded` and
         * `status` attributes of this model.
         */
        fetchStatus: function() {
            var self = this;
            // reset previous status
            self.set('statusLoaded', false);
            self.set('status', null);
            return ApplinksRest.V3.status(this.id).get()
                .done(function(data) {
                    self.set('statusLoaded', true);
                    self.set('status', data);
                });
        },

        /**
         * Mark application link as primary, including a blocking request with a corresponding server-side update.
         *
         * @param options Backbone options for the request
         */
        makePrimary: function (options) {
            var model = this.toServerJSON();
            model.primary = true;
            return this.save(model, _.extend({}, options, {
                wait: true
            }));
        },

        /**
         * @return JSON object suitable for server update, removing all client-side attributes redundant for data
         * update; use it for any server-side operation (e.g. `save`)
         */
        toServerJSON: function () {
            var model = this.toJSON();

            delete model.status;
            delete model.statusLoaded;
            delete model.data;

            return model;
        }
    });

    /**
     * Applink Model collection.
     */
    var CollectionModel = Backbone.Collection.extend({
        model: ApplinkModel,

        /**
         * @param models initial model array
         * @param options Backbone options containing extra Applink-specific attributes:
         *                `dataKeys`: data keys to fetch extra data while fetching the applink
         */
        initialize: function(models, options) {
            this.dataKeys = options && options.dataKeys;
        },

        url: function() {
            return ApplinksRest.V3.applinks(this.dataKeys).getUrl();
        },

        fetch: function(options) {
            var expectedStatuses = getExpectedStatuses(options);
            return Backbone.Collection.prototype.fetch.call(this, options)
                .done(ResponseHandlers.done(expectedStatuses))
                .fail(ResponseHandlers.fail(expectedStatuses));
        }
    });

    return {
        Applink: ApplinkModel,
        Collection: CollectionModel,
        DataKeys: DataKeys
    }
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-v3-list', location = 'applinks/internal/feature/v3/list/feature-v3-list-views.js' */
define('applinks/feature/v3/list-views', [
    'applinks/lib/lodash',
    'applinks/lib/backbone',
    'applinks/lib/aui',
    'applinks/lib/jquery',
    'applinks/lib/window',
    'applinks/common/products',
    'applinks/common/urls'
], function(
    _,
    Backbone,
    AJS,
    $,
    window,
    Products,
    Urls
) {

    // include legacy edit action if "magic" query parameter is present; lazy-load to facilitate unit testing
    function checkLegacyEdit() {
        return window.location.search.indexOf('legacyEdit=true') > 0;  
    }
    var includeLegacyEdit = _.memoize(checkLegacyEdit);
    
    /**
     * Backbone view for table Row.
     */
     var Row = Backbone.View.extend({
        template: applinks.feature.v3.list.templates,

        initialize: function (options) {
            var applink = options.model.toJSON();
            this.$el.html(this.template.row({
                applink: applink,
                typeName: Products.getTypeName(applink.type),
                editUrl: Urls.Local.edit(applink.id),
                includeLegacyEdit: includeLegacyEdit()
            }));
            this.setFirstLinkInDropdownAsActive();
        },

        render: function () {
            return this.$el.find('tr');
        },

        setFirstLinkInDropdownAsActive: function() {
            this.$el.find(".actions-dropdown-content").on({
                "aui-dropdown2-show": function() {
                    $(this).find('a:first').addClass('active');
                },
                "aui-dropdown2-hide": function() {
                    $(this).find('a').removeClass('active');
                }
            });
        }
    });

    /*
     * Dialog confirmation on delete.
     */
    var ConfirmationDialog = Backbone.View.extend({

        template: applinks.feature.v3.list.templates,

        initialize: function (options) {
            // extend with options
            _.extend(this, options);

            this.$dialog = new AJS.Dialog({
                closeOnOutsideClick: true,
                height: 'auto',
                width: 620
            });

            // dialog content
            this.$dialog.addHeader("Delete an application link");
            this.$dialog.addPanel(null, this.template.confirmationDialog());

            // confirm button
            this.$dialog.addButton(
                "Confirm",
                _.bind(this.onConfirm, this),
                    "delete-confirm-button"
            );

            // cancel link
            this.$dialog.addLink(
                "Cancel",
                _.bind(this.onCancel, this), '#'
            );
        },

        /**
         * Trigger confirm event and also call cancel logic.
         */
        onConfirm: function (dialog) {
            this.trigger('confirm', this.id);
            this.onCancel(dialog);
        },

        /**
         * On cancel hide dialog and remove element from DOM.
         */
        onCancel: function (dialog) {
            dialog.hide().remove();
        },

        /**
         * Show dialog.
         */
        show: function () {
            this.$dialog.show();
        }
    });

    return {
        Row: Row,
        ConfirmDialog : ConfirmationDialog
    }
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-v3-list', location = 'applinks/internal/feature/v3/list/feature-v3-list.js' */
define('applinks/feature/v3/list', [
    'applinks/lib/lodash',
    'applinks/lib/backbone',
    'applinks/lib/jquery',
    'applinks/lib/window',
    'applinks/lib/aui',
    'applinks/shim/applinks',
    'applinks/common/events',
    'applinks/common/rest',
    'applinks/common/response-status',
    'applinks/feature/status',
    'applinks/feature/status/details',
    'applinks/feature/oauth-dance',
    'applinks/feature/v3/list-views',
    'applinks/model/applink'
], function(
    _,
    Backbone,
    $,
    window,
    AJS,
    LegacyApplinks,
    Events,
    ApplinksRest,
    ResponseStatus,
    ApplinkStatus,
    ApplinkStatusDetails,
    OAuthDance,
    ListViews,
    ApplinkModel
){
    var hasLoaded = false;

    var ACTION_DELETE = 'delete';
    var ACTION_LEGACY_EDIT = 'legacy-edit';
    var ACTION_PRIMARY = 'primary';
    var ACTION_REMOTE = 'remote';
    var BUILT_IN_ACTIONS = [ACTION_DELETE, ACTION_LEGACY_EDIT, ACTION_PRIMARY, ACTION_REMOTE];

    // extra data keys required to render the applinks config screen
    var DATA_KEYS = [
        ApplinkModel.DataKeys.APPLICATION_VERSION,
        ApplinkModel.DataKeys.ATLASSIAN,
        ApplinkModel.DataKeys.CONFIG_URL,
        ApplinkModel.DataKeys.ICON_URI,
        ApplinkModel.DataKeys.EDITABLE,
        ApplinkModel.DataKeys.V3_EDITABLE,
        ApplinkModel.DataKeys.WEB_ITEMS
    ];

    /**
     * Convert to legacy applink format for legacy editing
     *
     * @param applink applink to convert
     * @private
     */
    function toLegacyApplink(applink) {
        // self link to legacy REST URL
        applink.link = [{
            rel: 'self',
            href: ApplinksRest.V1.applink(applink.id).getUrl()
        }];

        // typeId has changed to type
        applink.typeId = applink.type;
        // mark incoming & outgoing as available
        applink.hasIncoming = true;
        applink.hasOutgoing = true;

        return applink;
    }

    function findApplinkRowId(element) {
        return $(element).parents('tr:first').attr('id');
    }

    /**
     * Main table backbone view, handles data
     * loading, remove and updating.
     */
    return Backbone.View.extend({
        template: applinks.feature.v3.list.templates,

        events: {
            'click .legacy-edit-button': 'onLegacyEditClick'
        },

        initialize: function (options) {
            // extend with options
            _.extend(this, options);

            this.applinks = options.model || new ApplinkModel.Collection(null, {dataKeys: DATA_KEYS});
            this.$el.html(this.template.table());
            this.registerEvents();

            // initial data load
            this.fetchAllApplinks();
        },

        remove: function() {
            Backbone.View.prototype.remove.call(this);
            this.unregisterEvents();
        },

        /**
         * "Manually" registered events for model and view.
         */
        registerEvents: function () {
            // model events
            // currently only status changes asynchronously, so no need to refresh the view for any other event
            this.listenTo(this.applinks, 'remove destroy', this.onModelRemove)
                .listenTo(this.applinks, 'change:status', this.onStatusChange);

            // view events
            // actions dropdown callbacks
            $(document).on('click', '.v3-applink-actions-dropdown li', _.bind(this.onActionsDropdownClick, this));
            // global OAuth dance callback for all authorise links (see applink-status)
            new OAuthDance(this.$el, ApplinkStatus.AUTHENTICATE_LINK_SELECTOR)
                .onSuccess(_.bind(this.onOAuthDanceSuccess, this))
                .initialize();
            // re-fetch all applinks on orphaned upgrade, as it likely results in a new applink
            Events.on(Events.ORPHANED_UPGRADE, this.fetchAllApplinks, this);
        },

        /**
         * Unregister "manually" registered events outside of `this.$el`.
         */
        unregisterEvents: function() {
            $(document).off('click', '.v3-applink-actions-dropdown li');
            Events.off(Events.ORPHANED_UPGRADE);
        },

        /**
         * Fetch and re-render all applinks.
         */
        fetchAllApplinks: function() {
            this.getTable().removeClass('applinks-loaded');
            this.applinks.fetch({reset: true}).always(
                _.bind(this.filterAndSort, this),
                _.bind(this.onCollectionUpdate, this, true));
        },

        /**
         * Filter the applinks collection, skipping non-Atlassian system links and moving the built-in (Atlassian)
         * system links to the bottom. System links are generally not important for the user as there's not much that
         * can be done with them.
         */
        filterAndSort: function() {
            // Backbone uses Underscore's stable sortBy so the order of applinks should otherwise be preserved
            var sorted = this.applinks.chain().filter(function(applink) {
                return !applink.get('system') || applink.getData(ApplinkModel.DataKeys.ATLASSIAN)
            }).sortBy(function(applink) {
                return applink.get('system') ? 1 : 0;
            }).value();
            this.applinks.reset(sorted);
        },


        onStatusChange: function (model) {
            var statusContainer = this.$el.find('#' + model.id + ' td.status');
            statusContainer.empty();

            // render status
            new ApplinkStatus.View({
                applink: model.toJSON(),
                container: statusContainer
            });
            // render status details dialog
            new ApplinkStatusDetails.Dialog(model);

            $(document).trigger(Events.APPLINKS_UPDATED);
        },

        onModelRemove: function (model) {
            ApplinkStatusDetails.removeDialog(model.id);
            if (this.applinks.isEmpty()) {
                this.onCollectionUpdate();
            } else {
                var $container = this.$el.find('tbody');
                this.removeTooltips($container);
                this.$el.find('#' + model.id).remove();
                $(document).trigger(Events.APPLINKS_UPDATED);
                this.renderTooltips($container);
            }
        },

        /**
         * Executed when the Applinks collection is updated.
         *
         * @param isFetched if the update is resulting from a remote fetch of the applinks list
         */
        onCollectionUpdate: function (isFetched) {
            this.populateTable();
            if (isFetched) {
                // init status fetch for all applinks
                this.fetchStatus();
            }
            this.getTable().find('.in-progress .progress-spinner').spin();
            this.getTable().addClass('applinks-loaded');

            if (hasLoaded) {
                $(document).trigger(Events.APPLINKS_UPDATED);
            } else {
                // Trigger this event once only
                hasLoaded = true;
                $(document).trigger(Events.APPLINKS_LOADED);
            }
        },

        populateTable: function () {
            var rows = document.createDocumentFragment(),
                table = this.getTable(),
                container = table.find('tbody'),
                noApplinksNotice = this.getNoApplinksNotice();

            this.removeTooltips(container);

            this.applinks.each(function (applink) {
                rows.appendChild(new ListViews.Row({model: applink}).render().get(0))
            });

            // clear container
            container.empty();

            // Update table content (in one go)
            if (rows.childNodes.length > 0) {
                // Show the table and hide the No Applinks notice
                container.append(rows);
                table.removeAttr('data-empty');
                table.removeAttr('hidden');
                noApplinksNotice.attr('hidden', '');
            } else {
                // Hide the table and show the No Applinks notice
                table.attr('data-empty','empty');
                table.attr('hidden','');
                noApplinksNotice.removeAttr('hidden');
            }

            this.renderTooltips(container);
        },

        /**
         * OAuth dance success callback: refresh status of the link corresponding to the event source.
         */
        onOAuthDanceSuccess: function(source) {
            var applink = this.applinks.get(findApplinkRowId(source));
            applink && applink.fetchStatus();
        },

        /**
         * Actions drop-down menu click handler.
         */
        onActionsDropdownClick: function (event) {
            var $element = $(event.target);
            var action = $element.data('action');

            if (action && (_.includes ? _.includes : _.contains)(BUILT_IN_ACTIONS, action)) {
                event.preventDefault();
                var id = $element.parents('.aui-dropdown2:first').data('id');
                // trigger selected action
                switch (action) {
                    case ACTION_DELETE:
                        this.confirmDelete(id);
                        break;
                    case ACTION_LEGACY_EDIT:
                        this.legacyEdit(id);
                        break;
                    case ACTION_PRIMARY:
                        this.makePrimary(id);
                        break;
                    case ACTION_REMOTE:
                        this.goToRemote(id);
                        break;
                }
            }
        },

        /**
         * @param event the event to respond to
         */
        onLegacyEditClick: function (event) {
            var id = findApplinkRowId(event.target);
            this.legacyEdit(id);
        },

        /**
         * Show delete confirmation dialog.
         */
        confirmDelete: function (id) {
            var dialog = new ListViews.ConfirmDialog({
                id: id
            });
            dialog.on('confirm', this.deleteApplink, this);

            dialog.show();
        },

        deleteApplink: function(id) {
            // REST Delete call must be synchronous otherwise the applink in the UI (model) will be deleted even if the
            // REST call fails.
            this.applinks.get(id).destroy({
                wait: true,
                expectedStatuses: [ResponseStatus.Family.SUCCESSFUL, ResponseStatus.NOT_FOUND]
            });
        },

        /**
         * Mark selected application link as primary.
         */
        makePrimary: function(id) {
            var self = this;
            this.applinks.get(id).makePrimary({
                success: _.bind(self.fetchAllApplinks, self)
            });
        },

        /**
         * Open the legacy edit dialog for a given applink `id`.
         *
         * @param id Applink ID
         */
        legacyEdit: function (id) {
            LegacyApplinks.UI.hideInfoBox();

            var applink = toLegacyApplink(this.applinks.get(id).toJSON());
            var refreshApplinks = _.bind(this.fetchAllApplinks, this);

            LegacyApplinks.editAppLink(applink, 'undefined', false, refreshApplinks, refreshApplinks);
        },

        /**
         * Open remote in new window.
         */
        goToRemote: function (id) {
            window.open(this.applinks.get(id).getAdminUrl());
        },

        /**
         * Init fetch Applink status for all applinks.
         */
        fetchStatus: function () {
            // init fetch status on all applinks,
            this.applinks.each(function(applink) {
                applink.fetchStatus();
            });
        },

        /**
         * Initialize tipsy handler.
         */
        renderTooltips: function ($element) {
            // first remove any existing tipsy element
            $('body > .tipsy').remove();

            // re-initialize tipsy, search only for data-title
            ($element || this.$el).find('[data-title]')
                .tooltip({
                    className: 'tipsy-left',
                    title: 'data-title',
                    html: true
                });

            ($element || this.$el).find('span.applinks-name')
                .tooltip({
                    className: 'url-tipsy',
                    gravity: 's',
                    html: true,
                    title: function () {
                        return this.getAttribute('data-displayUrl') + '<br/>' + this.getAttribute('data-rpcUrl')
                    }
                });
        },

        removeTooltips: function ($element) {
            // re-initialize tipsy, search only for data-title
            ($element || this.$el).find('[data-title]').attr('data-title', '');
        },

        getTable: function() {
            return this.$el.find('#agent-table');
        },

        getNoApplinksNotice: function() {
            return this.$el.find('#v3-no-applinks-notice');
        }
    });
});;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-v3-list', location = 'applinks/internal/feature/v3/list/feature-v3-list.soy' */
// This file was automatically generated from feature-v3-list.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace applinks.feature.v3.list.templates.
 */

if (typeof applinks == 'undefined') { var applinks = {}; }
if (typeof applinks.feature == 'undefined') { applinks.feature = {}; }
if (typeof applinks.feature.v3 == 'undefined') { applinks.feature.v3 = {}; }
if (typeof applinks.feature.v3.list == 'undefined') { applinks.feature.v3.list = {}; }
if (typeof applinks.feature.v3.list.templates == 'undefined') { applinks.feature.v3.list.templates = {}; }


applinks.feature.v3.list.templates.table = function(opt_data, opt_ignored) {
  return '<div id="agent-table-dialog"></div><table id="agent-table" class="aui aui-table-interactive v3-applinks-list"  hidden=""><thead><tr><th class="application">' + soy.$$escapeHtml('Application') + '</th><th class="application-name"></th><th class="version">' + soy.$$escapeHtml('Version') + '</th><th class="status">' + soy.$$escapeHtml('Status') + '</th><th class="actions">' + soy.$$escapeHtml('Actions') + '</th></tr></thead><tbody>' + applinks.feature.v3.list.templates.rowStatic({content: 'Loading application links...', showSpinner: true}) + '</tbody></table>' + applinks.feature.v3.list.templates.noApplinksNotice(null);
};
if (goog.DEBUG) {
  applinks.feature.v3.list.templates.table.soyTemplateName = 'applinks.feature.v3.list.templates.table';
}


applinks.feature.v3.list.templates.row = function(opt_data, opt_ignored) {
  return '<tr id="' + soy.$$escapeHtml(opt_data.applink.id) + '"><td class="application-icon">' + ((opt_data.applink.data.iconUri) ? '<img class="applinks-icon" src="' + soy.$$escapeHtml(opt_data.applink.data.iconUri) + '" alt="' + soy.$$escapeHtml(opt_data.applink.name) + '" width="20" height="20">' : '') + '</td><td class="id-badge trim"><div class="applinks-name-primary"><span data-rpcUrl="' + soy.$$escapeHtml('Application URL:') + ' ' + soy.$$escapeHtml(opt_data.applink.rpcUrl) + '" data-displayUrl="' + soy.$$escapeHtml('Display URL:') + ' ' + soy.$$escapeHtml(opt_data.applink.displayUrl) + '" class="applinks-name">' + ((opt_data.applink.name) ? soy.$$escapeHtml(opt_data.applink.name) : '') + '</span>' + ((opt_data.applink.primary) ? '<span class="aui-lozenge aui-lozenge-subtle primary-lozenge" data-title="' + soy.$$escapeHtml('Primary application link') + '">' + soy.$$escapeHtml('PRIMARY') + '</span>' : '') + '</div></td><td class="version"><div class="applinks-type-version"><span class="applinks-type">' + soy.$$escapeHtml(opt_data.typeName) + '</span>&nbsp;' + ((opt_data.applink.data.applicationVersion) ? '<span class="applinks-version">' + soy.$$escapeHtml(opt_data.applink.data.applicationVersion) + '</span>' : '') + '</div></td><td class="status"></td><td class="actions aui-compact-button-column">' + ((opt_data.applink.data.editable) ? (opt_data.applink.data.v3Editable) ? '<a class="edit aui-button icon-button aui-button-link" href=' + soy.$$escapeHtml(opt_data.editUrl) + '><span class="aui-icon aui-icon-small aui-iconfont-edit">' + soy.$$escapeHtml('Edit') + '</span></a>' : '<button class="edit legacy-edit-button aui-button icon-button aui-button-link"><span class="aui-icon aui-icon-small aui-iconfont-edit">' + soy.$$escapeHtml('Edit') + '</span></a>' : '') + applinks.feature.v3.list.templates.rowDropdown(opt_data) + '</td></tr>';
};
if (goog.DEBUG) {
  applinks.feature.v3.list.templates.row.soyTemplateName = 'applinks.feature.v3.list.templates.row';
}


applinks.feature.v3.list.templates.rowDropdown = function(opt_data, opt_ignored) {
  return '<button aria-owns="dropdown-button-' + soy.$$escapeHtml(opt_data.applink.id) + '" aria-haspopup="true" class="applinks-dropdown-button aui-button aui-button-compact aui-button-subtle aui-dropdown2-trigger aui-dropdown2-trigger-arrowless actions-menu"><span class="aui-icon aui-icon-small aui-iconfont-more"></span></button><div id="dropdown-button-' + soy.$$escapeHtml(opt_data.applink.id) + '" class="aui-dropdown2 aui-style-default actions-dropdown-content v3-applink-actions-dropdown" aria-hidden="true" data-dropdown2-alignment="right" data-id="' + soy.$$escapeHtml(opt_data.applink.id) + '">' + applinks.feature.v3.list.templates.pluggableLinks(opt_data) + '<div class="aui-dropdown2-section"><ul class="aui-list-truncate">' + ((opt_data.applink.displayUrl) ? '<li><a href="#" data-action="remote">' + soy.$$escapeHtml('Go to remote') + '</a></li>' : '') + ((! opt_data.applink.primary) ? '<li><a href="#" data-action="primary">' + soy.$$escapeHtml('Make primary') + '</a></li>' : '') + '</ul></div>' + ((opt_data.applink.data.editable) ? '<div class="aui-dropdown2-section"><ul class="aui-list-truncate">' + ((opt_data.includeLegacyEdit && opt_data.applink.data.v3Editable) ? '<li><a href="#" data-action="legacy-edit">' + soy.$$escapeHtml('Legacy Edit') + '</a></li>' : '') + '<li><a href="#" data-action="delete">' + soy.$$escapeHtml('Delete') + '</a></li></ul></div>' : '') + '</div>';
};
if (goog.DEBUG) {
  applinks.feature.v3.list.templates.rowDropdown.soyTemplateName = 'applinks.feature.v3.list.templates.rowDropdown';
}


applinks.feature.v3.list.templates.rowStatic = function(opt_data, opt_ignored) {
  return '<tr class="static"><td class="actions" colspan="7">' + ((opt_data.showSpinner) ? '<span class="aui-icon aui-icon-wait"></span>' : '') + ' ' + soy.$$escapeHtml(opt_data.content) + '</td></tr>';
};
if (goog.DEBUG) {
  applinks.feature.v3.list.templates.rowStatic.soyTemplateName = 'applinks.feature.v3.list.templates.rowStatic';
}


applinks.feature.v3.list.templates.noApplinksNotice = function(opt_data, opt_ignored) {
  var output = '';
  var imgBaseUrl__soy115 = "" + '/download/resources/com.atlassian.applinks.applinks-plugin:feature-v3-list/images';
  output += '<div id="v3-no-applinks-notice" hidden=""><img class="applinks-icon" src="' + soy.$$escapeHtml(imgBaseUrl__soy115) + '/appslinks.svg" alt="" height="97" width="262"><h3>' + soy.$$escapeHtml('You haven\x27t linked any applications yet') + '</h3><p>' + soy.$$escapeHtml('To create an application link, enter the URL of the application you\x27re linking to and click Create new link. Once linked you\x27ll see the status of the connection.') + '</p></div>';
  return output;
};
if (goog.DEBUG) {
  applinks.feature.v3.list.templates.noApplinksNotice.soyTemplateName = 'applinks.feature.v3.list.templates.noApplinksNotice';
}


applinks.feature.v3.list.templates.confirmationDialog = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({titleContent: 'Warning', content: '<p>' + soy.$$escapeHtml('You are about to delete the selected application link. Deleting an application link will remove all per-user authentication tokens. If you re-add the application link to this server in the future, each of your users will be forced to authorize again. Are you sure you want to continue?') + '</p>'});
};
if (goog.DEBUG) {
  applinks.feature.v3.list.templates.confirmationDialog.soyTemplateName = 'applinks.feature.v3.list.templates.confirmationDialog';
}


applinks.feature.v3.list.templates.pluggableLinks = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.applink.data.webItems && opt_data.applink.data.webItems.length > 0) {
    output += '<div class="aui-dropdown2-section"><ul class="aui-list-truncate">';
    var webItemList134 = opt_data.applink.data.webItems;
    var webItemListLen134 = webItemList134.length;
    for (var webItemIndex134 = 0; webItemIndex134 < webItemListLen134; webItemIndex134++) {
      var webItemData134 = webItemList134[webItemIndex134];
      output += '<li><a href="' + soy.$$escapeHtml(webItemData134.url) + '" data-action="custom" ' + ((webItemData134.styleClass) ? 'class="' + soy.$$escapeHtml(webItemData134.styleClass) + '"' : '') + '>' + soy.$$escapeHtml(webItemData134.label) + '</a></li>';
    }
    output += '</ul></div>';
  }
  return output;
};
if (goog.DEBUG) {
  applinks.feature.v3.list.templates.pluggableLinks.soyTemplateName = 'applinks.feature.v3.list.templates.pluggableLinks';
}
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-v3-onboarding', location = 'applinks/internal/feature/v3/v3-onboarding.soy' */
// This file was automatically generated from v3-onboarding.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace applinks.feature.onboarding.v3.
 */

if (typeof applinks == 'undefined') { var applinks = {}; }
if (typeof applinks.feature == 'undefined') { applinks.feature = {}; }
if (typeof applinks.feature.onboarding == 'undefined') { applinks.feature.onboarding = {}; }
if (typeof applinks.feature.onboarding.v3 == 'undefined') { applinks.feature.onboarding.v3 = {}; }


applinks.feature.onboarding.v3.learnMoreLink = function(opt_data, opt_ignored) {
  return '<a title="' + soy.$$escapeHtml('Learn more') + '" href="' + soy.$$escapeHtml(require('applinks/common/help-paths').getFullPath(opt_data.key,opt_data.anchor)) + '" target="_blank" class="help-link" data-help-link-key="' + soy.$$escapeHtml(opt_data.key) + '">' + soy.$$escapeHtml('Learn more') + '</a>';
};
if (goog.DEBUG) {
  applinks.feature.onboarding.v3.learnMoreLink.soyTemplateName = 'applinks.feature.onboarding.v3.learnMoreLink';
}


applinks.feature.onboarding.v3.onboardingDialog = function(opt_data, opt_ignored) {
  var output = '';
  var imgBaseUrl__soy13 = "" + '/download/resources/com.atlassian.applinks.applinks-plugin:feature-v3-onboarding/images';
  output += '<section role="dialog" id="v3-ui-feature-discovery-dialog" class="aui-layer aui-dialog2 aui-dialog2-xlarge" data-aui-focus-selector="#v3-onboarding-dialog-close-button" ><header class="aui-dialog2-header"><!-- The dialog\'s title --><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('What\x27s new for application links') + '</h2></header><div class="aui-dialog2-content feature-discovery-dialog"><div class="aui-group feature-discovery-dialog" id="main-v3-ui-onboarding-panel"><div id="v3-onboarding-dialog-panel-1" class="aui-item v3-feature-discovery-panel" ><img class="v3-onboarding-image" class="simplified-diagnostics-image" src="' + soy.$$escapeHtml(imgBaseUrl__soy13) + '/error_illustration.svg" height="112"><h1>' + soy.$$escapeHtml('Built-in diagnostics') + '</h2><p/><div class="simplified-diagnostics-text">' + soy.$$escapeHtml('Get real-time integration status and focused diagnostics for when things stop working.') + '</div><br/>' + applinks.feature.onboarding.v3.learnMoreLink({key: 'applinks.docs.diagnostics', anchor: 'app_diagnostics'}) + '</div><div id="v3-onboarding-dialog-panel-2" class="aui-item v3-feature-discovery-panel"><img class="v3-onboarding-image" src="' + soy.$$escapeHtml(imgBaseUrl__soy13) + '/documentation_illustration.svg"  height="120"><h1>' + soy.$$escapeHtml('Better troubleshooting') + '</h2><p/><div>' + soy.$$escapeHtml('Find the information you need to quickly get your integrations working again.') + '</div><br/>' + applinks.feature.onboarding.v3.learnMoreLink({key: 'applinks.docs.troubleshoot.application.links'}) + '</div><div id="v3-onboarding-dialog-panel-3" class="aui-item v3-feature-discovery-panel"><img class="v3-onboarding-image" src="' + soy.$$escapeHtml(imgBaseUrl__soy13) + '/lock.svg" height="120"><h1>' + soy.$$escapeHtml('Simplified security') + '</h2><p/><div>' + soy.$$escapeHtml('New application links use industry-standard OAuth security, and old links are easily updated.') + '</div><br/>' + applinks.feature.onboarding.v3.learnMoreLink({key: 'applinks.docs.oauth.security'}) + '</div></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button id="v3-onboarding-dialog-close-button" class="aui-button aui-button-primary" autofocus>' + soy.$$escapeHtml('OK, got it') + '</button></div></footer></section>';
  return output;
};
if (goog.DEBUG) {
  applinks.feature.onboarding.v3.onboardingDialog.soyTemplateName = 'applinks.feature.onboarding.v3.onboardingDialog';
}
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-v3-onboarding', location = 'applinks/internal/feature/v3/v3-onboarding.js' */
define('applinks/feature/v3/onboarding', [
    'applinks/lib/aui',
    'applinks/lib/jquery',
    'applinks/lib/lodash',
    'applinks/common/features',
    'applinks/feature/creation',
    'applinks/common/events',
    'applinks/feature/v3/ui'

], function(
    AJS,
    $,
    _,
    ApplinksFeatures,
    ApplinksCreation,
    ApplinksEvents,
    V3Ui

) {
    return {
        init: function () {

            $(document).bind(ApplinksEvents.READY, function () {
                if (!ApplinksFeatures.isDiscovered(ApplinksFeatures.V3_UI) && !ApplinksCreation.isInProgress() && V3Ui.isOn() ) {
                    $('body').append(applinks.feature.onboarding.v3.onboardingDialog());
                    var v3OnboardingDialog  =  AJS.dialog2('#v3-ui-feature-discovery-dialog');
                    v3OnboardingDialog.show();
                    ApplinksFeatures.discover(ApplinksFeatures.V3_UI);
                    $('#v3-onboarding-dialog-close-button').on('click', function () {
                        v3OnboardingDialog.hide();
                        $(document).trigger(ApplinksEvents.V3_ONBOARDING_FINISHED);
                        $('body').attr('data-v3-onboarding-dialog-finished', 'finished' );
                    });
                } else {
                    $(document).trigger(ApplinksEvents.V3_ONBOARDING_FINISHED);
                    $('body').attr('data-v3-onboarding-dialog-finished', 'finished');
                }
                $('body').attr('data-v3-onboarding-dialog-code-loaded', ''); //used for testing
            });
        }
    }
});
;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-v3-feedback-collector', location = 'applinks/internal/feature/v3/v3-feedback-collector.js' */
define('applinks/feature/v3/feedback-collector', [
    'applinks/lib/jquery',
    'applinks/lib/window'
], function(
    $,
    window
) {
    return {
        init : function() {
            /**
             * Handles the displaying of feedback dialogs
             */
            var applinksFeedbackButton = $("#applinks-feedback-button");

            // fetch the collector scripts
            // Feedback button feedback collector
            $.ajax({
                url: "https://jira.atlassian.com/s/e0149ca37bab64d8016b53497b961ef3-T/en_UKdzil1d/65000/131/1.4.25/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?locale=en-UK&collectorId=35047165",
                type: "get",
                cache: true,
                dataType: "script",
                success: enableFeedbackButton
            });

            // callback functions
            function enableFeedbackButton() {
                window.ATL_JQ_PAGE_PROPS = $.extend(window.ATL_JQ_PAGE_PROPS, {
                    '35047165': {
                        triggerFunction: function (showCollectorDialog) {
                            applinksFeedbackButton.on('click', function (e) {
                                e.preventDefault();
                                showCollectorDialog();
                            });
                        }
                    }
                });
                $("#applinks-feedback-button").show();
            }
        }
    }
});

;
;
/* module-key = 'com.atlassian.applinks.applinks-plugin:page-v3', location = 'applinks/internal/page/v3/page-v3.js' */
define('applinks/page/v3', [
    'applinks/lib/jquery',
    'applinks/lib/backbone',
    'applinks/common/events',
    'applinks/common/i18n',
    'applinks/common/initializer',
    'applinks/feature/bitbucket-rebrand',
    'applinks/feature/help-link/analytics',
    'applinks/feature/v3/list',
    'applinks/feature/v3/onboarding',
    'applinks/feature/v3/feedback-collector'
], function(
    $,
    Backbone,
    Events,
    I18n,
    Initializer,
    BitbucketRebrand,
    HelpLinkAnalytics,
    V3List,
    Onboarding,
    FeedbackCollector
){
    var V3PageView = Backbone.View.extend({
       initialize: function () {
           this.applinksList = new V3List({
               el: this.$el.find('.content')
           });
       }
    });

    return {
        init: function() {
            new V3PageView({ el: $('#ual') });
            Initializer.init(BitbucketRebrand, HelpLinkAnalytics, FeedbackCollector, Onboarding);
        }
    }
});

;
;
/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/store-1.3.1.js' */
(function(){var l={},h=window,k=h.document,c="localStorage",n="globalStorage",d="__storejs__",g;l.disabled=false;l.set=function(e,o){};l.get=function(e){};l.remove=function(e){};l.clear=function(){};l.transact=function(e,o){var p=l.get(e);if(typeof p=="undefined"){p={}}o(p);l.set(e,p)};l.serialize=function(e){return JSON.stringify(e)};l.deserialize=function(e){if(typeof e!="string"){return undefined}return JSON.parse(e)};function b(){try{return(c in h&&h[c])}catch(e){return false}}function m(){try{return(n in h&&h[n]&&h[n][h.location.hostname])}catch(e){return false}}if(b()){g=h[c];l.set=function(e,o){if(o===undefined){return l.remove(e)}g.setItem(e,l.serialize(o))};l.get=function(e){return l.deserialize(g.getItem(e))};l.remove=function(e){g.removeItem(e)};l.clear=function(){g.clear()}}else{if(m()){g=h[n][h.location.hostname];l.set=function(e,o){if(o===undefined){return l.remove(e)}g[e]=l.serialize(o)};l.get=function(e){return l.deserialize(g[e]&&g[e].value)};l.remove=function(e){delete g[e]};l.clear=function(){for(var e in g){delete g[e]}}}else{if(k.documentElement.addBehavior){var j,f;try{f=new ActiveXObject("htmlfile");f.open();f.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></frame>');f.close();j=f.w.frames[0].document;g=j.createElement("div")}catch(i){g=k.createElement("div");j=k.body}function a(e){return function(){var p=Array.prototype.slice.call(arguments,0);p.unshift(g);j.appendChild(g);g.addBehavior("#default#userData");g.load(c);var o=e.apply(l,p);j.removeChild(g);return o}}l.set=a(function(p,e,o){if(o===undefined){return l.remove(e)}p.setAttribute(e,l.serialize(o));p.save(c)});l.get=a(function(o,e){return l.deserialize(o.getAttribute(e))});l.remove=a(function(o,e){o.removeAttribute(e);o.save(c)});l.clear=a(function(q){var o=q.XMLDocument.documentElement.attributes;q.load(c);for(var p=0,e;e=o[p];p++){q.removeAttribute(e.name)}q.save(c)})}}}try{l.set(d,d);if(l.get(d)!=d){l.disabled=true}l.remove(d)}catch(i){l.disabled=true}if(typeof module!="undefined"){module.exports=l}else{if(typeof define==="function"&&define.amd){define(l)}else{this.store=l}}})();;
;
/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/page-visibility.js' */
define("atlassian/analytics/page-visibility",function(){var a=(document.hidden!==undefined);var b={supported:a,isHidden:function(){return a?document.hidden:false}};return b});;
;
/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/user-activity-xhr-header.js' */
define("atlassian/analytics/user-activity-xhr-header",["atlassian/analytics/page-visibility"],function(c){var e="x-atlassian-mau-ignore";var d=XMLHttpRequest.prototype.send;var a=window.fetch;var b=false;return{install:function(){if(!b&&c.supported){XMLHttpRequest.prototype.send=function(){if(c.isHidden()){this.setRequestHeader(e,c.isHidden())}d.apply(this,arguments)};if(a){window.fetch=function(f,i){var g=i||{};var h=g.headers;if(c.isHidden()){g.headers=(h)?new Headers(h):new Headers();g.headers.append(e,c.isHidden())}return a.call(this,f,g)}}b=true}},uninstall:function(){if(b){XMLHttpRequest.prototype.send=d;if(a){window.fetch=a}}b=false}}});require("atlassian/analytics/user-activity-xhr-header").install();;
;
/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/atlassian-analytics.js' */
(function(d){var q=AJS.$.ajax;var l="atlassian-analytics";var j=typeof AJS.contextPath==="function"?AJS.contextPath():"";var p=null;var m=null;var g=null;var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(z){var y=Math.random()*16|0,x=z=="x"?y:(y&3|8);return x.toString(16)});var t=function(){var x="unknown";if(document.body.id=="jira"){x="jira"}else{if(document.body.id=="com-atlassian-confluence"){x="confluence"}}m=l+"."+x;g=m+".lock"};var f=function(){if(store.get(g)){return false}store.set(g,r);return(store.get(g)===r)};var u=function(){store.set(g,null)};var i=function(){var y=[],A,B,x,z;if(AJS.EventQueue.length==0){return}y=store.get(m)||y;for(x=0,z=AJS.EventQueue.length;x<z;++x){B=AJS.EventQueue[x];if(B.name){A={name:B.name,properties:B.properties,time:B.time||0};y.push(A)}}AJS.EventQueue.length=0;store.set(m,y)};var v=0;var a=function(x){return Math.min(5000*Math.pow(2,x),5*60*1000)};var e=0;var h=function(){var A;function y(){setTimeout(h,a(v=0))}function x(){setTimeout(h,a(++v))}if(!f()){++e;if(e<20){return y()}}else{e=0}try{i();A=store.get(m);if(!A||!A.length){return y()}store.remove(m);if(!o(A)){return y()}var B=new Date().getTime();for(var z=0;z<A.length;z++){if(A[z].time>0){A[z].timeDelta=A[z].time-B}else{A[z].timeDelta=z-A.length}delete A[z].time}p=q({type:"POST",url:j+"/rest/analytics/1.0/publish/bulk",data:JSON.stringify(A),contentType:"application/json",dataType:"json"});p.fail(function(){AJS.EventQueue.concat(A);i();x()});p.done(function(){y()})}finally{u()}};var o=function(z){for(var y=z.length-1;y>=0;y--){var B="";var A=z[y];var x=A.properties;if(typeof A.name==="undefined"){B="you must provide a name for the event."}else{if(typeof x!=="undefined"&&x!==null){if(x.constructor!==Object){B="properties must be an object with key value pairs."}else{b(x)}}}if(B!==""){AJS.log("WARN: Invalid analytics event detected and ignored, "+B+"\nEvent: "+JSON.stringify(A));z.splice(y,1)}}return z.length};var b=function(z){for(var y in z){if(z.hasOwnProperty(y)){var x=z[y];if(c(x)&&k(x)){}else{if(c(x)&&x.toString){z[y]=x.toString()}else{z[y]=""}}}}};function c(x){return typeof x!=="undefined"&&x!==null}function k(x){return typeof x==="number"||typeof x==="string"||typeof x==="boolean"}var n=function(){if(p&&!(p.state()==="resolved"||p.state()==="rejected")){p.abort()}};AJS.EventQueue=AJS.EventQueue||[];var s=Array.prototype.push;AJS.EventQueue.push=function(x){x.time=new Date().getTime();s.call(AJS.EventQueue,x)};AJS.toInit(function(){t();setTimeout(h,500);w()});d(window).unload(function(){n();i()});AJS.Analytics={triggerPrivacyPolicySafeEvent:function(x,y){AJS.log("WARN: 'triggerPrivacyPolicySafeEvent' has been deprecated");AJS.EventQueue.push({name:x,properties:y})}};AJS.bind("analytics",function(x,y){AJS.EventQueue.push({name:y.name,properties:y.data})});AJS.bind("analyticsEvent",function(x,y){AJS.EventQueue.push({name:y.name,properties:y.data})});var w=function(){if(window.location.pathname.indexOf("/secure/admin/ViewApplicationProperties")>-1){AJS.$("[data-property-id='analytics-enabled']").remove()}else{if(window.location.pathname.indexOf("/secure/admin/EditApplicationProperties")>-1){var y=AJS.$(":contains(Enable Atlassian analytics)");if(y.size()>0){var x=y[y.size()-2];if(x){x.remove()}}}}}}(AJS.$));;
;
/* module-key = 'com.atlassian.analytics.analytics-client:policy-update-init', location = 'js/policy-update-init.js' */
AJS.toInit(function(){var a=WRM.data.claim("com.atlassian.analytics.analytics-client:policy-update-init.policy-update-data-provider");if(a){WRM.require("wrc!com.atlassian.analytics.analytics-client:policy-update")}});;
;
/* module-key = 'com.atlassian.analytics.analytics-client:programmatic-analytics-init', location = 'js/programmatic-analytics-init.js' */
(function(){var a=WRM.data.claim("com.atlassian.analytics.analytics-client:programmatic-analytics-init.programmatic-analytics-data-provider");if(a){WRM.require("wrc!com.atlassian.analytics.analytics-client:programmatic-analytics")}}());;
;
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:application-header-administration-cog-resource', location = 'header/cog.js' */
var NavLinks=(function(a){a.ApplicationHeader=function(b){b.Cog=(function(){var c=function(){var d=AJS.$("#system-admin-menu-content");if(d.length>0){return d}var e=AJS.$("#admin-menu-link-content");if(e.length>0){return e}return AJS.$("#bamboo\\.global\\.header-admin\\.menu")};return{getDropdown:c}}());return b}(a.ApplicationHeader||{});return a}(NavLinks||{}));;
;
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts-resources', location = 'adminshortcuts/adminshortcuts.soy' */
// This file was automatically generated from adminshortcuts.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace navlinks.templates.adminshortcuts.
 */

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.adminshortcuts == 'undefined') { navlinks.templates.adminshortcuts = {}; }


navlinks.templates.adminshortcuts.section = function(opt_data, opt_ignored) {
  var param5 = '<ul class="aui-list-truncate">';
  var linkList7 = opt_data.links;
  var linkListLen7 = linkList7.length;
  for (var linkIndex7 = 0; linkIndex7 < linkListLen7; linkIndex7++) {
    var linkData7 = linkList7[linkIndex7];
    param5 += '<li><a href="' + soy.$$escapeHtml(linkData7.link) + '">' + soy.$$escapeHtml(linkData7.label) + '</a></li>';
  }
  param5 += '</ul>';
  var output = '' + aui.dropdown2.section({id: 'nl-remote-admin-section', label: 'Other applications', content: param5});
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.adminshortcuts.section.soyTemplateName = 'navlinks.templates.adminshortcuts.section';
}
;
;
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts-resources', location = 'adminshortcuts/adminnavlinks.js' */
var NavLinks=(function(a){a.AdminShortcuts=(function(){var c=function(){return AJS.$.ajax({url:AJS.contextPath()+"/rest/menu/latest/admin",cache:false,dataType:"json"})};var b=function(){AJS.$("#nl-remote-admin-section").on("click","a",function(){NL.trackEvent("remoteAdminItemSelected",NL.getCurrentApplication(),$(this).attr("href"))})};return{render:function(){c().done(function(e){e=_.reject(e,function(f){return f.local===true});if(e.length){var d=navlinks.templates.adminshortcuts.section({links:e});a.ApplicationHeader.Cog.getDropdown().append(d);b()}})}}}());return a}(NavLinks||{}));;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--20a97d6a33', location = 'aui.chunk.06b24c52978659ad2544--58a9b276da5b20b52fb4.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--20a97d6a33"],{"O+lX":function(i,n,o){var u,p,a;p=[o("oDIA")],void 0===(a="function"==typeof(u=function(i){return i.ui=i.ui||{},i.ui.version="1.12.1"})?u.apply(n,p):u)||(i.exports=a)}}]);
//# sourceMappingURL=aui.chunk.06b24c52978659ad2544--58a9b276da5b20b52fb4.js.map;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.splitchunk.vendors--02a4084a95', location = 'aui.chunk.44a84b38d918ac48f23e--0bb7ce9e7417a425cdd3.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.splitchunk.vendors--02a4084a95"],{M4tZ:function(E,n,o){var i,u,A;u=[o("oDIA"),o("O+lX")],void 0===(A="function"==typeof(i=function(E){return E.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}})?i.apply(n,u):i)||(E.exports=A)}}]);
//# sourceMappingURL=aui.chunk.44a84b38d918ac48f23e--0bb7ce9e7417a425cdd3.js.map;
;
/* module-key = 'com.atlassian.auiplugin:split_jquery.ui.keycode', location = 'aui.chunk.d175379a9b4e384fcbc6--5bd6af766d5f5cd45e54.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["jquery.ui.keycode"],{wrJm:function(u,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i("M4tZ"),e.default="jquery",u.exports=e.default}},[["wrJm","runtime","aui.splitchunk.vendors--20a97d6a33","aui.splitchunk.vendors--02a4084a95","aui.splitchunk.172ffb6da7"]]]);
//# sourceMappingURL=aui.chunk.d175379a9b4e384fcbc6--5bd6af766d5f5cd45e54.js.map;
;
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.soy' */
// This file was automatically generated from projectshortcuts.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace navlinks.templates.projectshortcuts.
 */

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.projectshortcuts == 'undefined') { navlinks.templates.projectshortcuts = {}; }


navlinks.templates.projectshortcuts.dialogContent = function(opt_data, opt_ignored) {
  return '' + ((opt_data.localShortcuts && opt_data.localShortcuts.length > 0) ? navlinks.templates.projectshortcuts.dialogContentShortcuts({shortcuts: opt_data.localShortcuts, listClass: 'projectshortcut-links'}) : '') + ((opt_data.remoteShortcuts != null) ? (opt_data.remoteShortcuts.length > 0) ? '<h2 class="projectshortcuts-heading">Related Links</h2>' + navlinks.templates.projectshortcuts.dialogContentShortcuts(soy.$$augmentMap(opt_data.remoteShortcuts, {shortcuts: opt_data.remoteShortcuts, listClass: 'projectshortcut-links'})) : '' : navlinks.templates.projectshortcuts.dialogLoading(null));
};
if (goog.DEBUG) {
  navlinks.templates.projectshortcuts.dialogContent.soyTemplateName = 'navlinks.templates.projectshortcuts.dialogContent';
}


navlinks.templates.projectshortcuts.headingWrapper = function(opt_data, opt_ignored) {
  return '<div class="project-dialog-header-wrapper"><div class="project-header"><img class="project-img" src="' + soy.$$escapeHtml(opt_data.logoUrl) + '"><h2 class="dialog-title">' + soy.$$escapeHtml(opt_data.title) + '</h2></div><div class="project-content-wrapper">' + soy.$$filterNoAutoescape(opt_data.contentHtml) + '</div></div>';
};
if (goog.DEBUG) {
  navlinks.templates.projectshortcuts.headingWrapper.soyTemplateName = 'navlinks.templates.projectshortcuts.headingWrapper';
}


navlinks.templates.projectshortcuts.dialogContentShortcuts = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '<ul' + ((opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '') + '>';
  var shortcutList35 = opt_data.shortcuts;
  var shortcutListLen35 = shortcutList35.length;
  for (var shortcutIndex35 = 0; shortcutIndex35 < shortcutListLen35; shortcutIndex35++) {
    var shortcutData35 = shortcutList35[shortcutIndex35];
    output += '<li' + ((shortcutIndex35 == shortcutListLen35 - 1) ? ' class="last"' : '') + '>' + navlinks.templates.projectshortcuts.dialogContentShortcut(shortcutData35) + '</li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.projectshortcuts.dialogContentShortcuts.soyTemplateName = 'navlinks.templates.projectshortcuts.dialogContentShortcuts';
}


navlinks.templates.projectshortcuts.dialogContentShortcut = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml(opt_data.link) + '"' + ((opt_data.tooltip) ? ' title="' + soy.$$escapeHtml(opt_data.tooltip) + '"' : '') + '>' + soy.$$escapeHtml(opt_data.label) + '</a>';
};
if (goog.DEBUG) {
  navlinks.templates.projectshortcuts.dialogContentShortcut.soyTemplateName = 'navlinks.templates.projectshortcuts.dialogContentShortcut';
}


navlinks.templates.projectshortcuts.dialogLoading = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="projectshortcuts-loading">' + ((opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '') + '</div>';
};
if (goog.DEBUG) {
  navlinks.templates.projectshortcuts.dialogLoading.soyTemplateName = 'navlinks.templates.projectshortcuts.dialogLoading';
}
;
;
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.js' */
(function(e,g){var i,k={},m="key",b="name",j="entity-type";function f(s){var n=e(this),o=n.data(m),q=n.data(b),p=n.data(j);if(typeof o==="undefined"){return}s.preventDefault();i=new AJS.Dialog({width:600,keypressListener:function(u){if(u.which==jQuery.ui.keyCode.ESCAPE){i.remove()}},id:"project-shortcuts-dialog"}).addCancel("Close",function(){i.remove()}).addPanel("",navlinks.templates.projectshortcuts.headingWrapper({title:q,logoUrl:h(),contentHtml:navlinks.templates.projectshortcuts.dialogLoading({text:"Retrieving links…"})})).show();c(i);if(!k[o]){k[o]={entity:{title:q},localShortcuts:null,remoteShortcuts:null};d(AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+o,{entityType:p}).done(t);d(AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+o,{entityType:p}).done(r).fail(function(){var u=i.getCurrentPanel().body.find(".project-content-wrapper");u.find(".projectshortcuts-loading").remove();AJS.messages.error(u,{body:"Could not retrieve remote project shortcuts",closeable:false});c(i)})}else{l(k[o])}function t(u){k[o].localShortcuts=u.shortcuts;l(k[o])}function r(u){k[o].remoteShortcuts=u.shortcuts;l(k[o])}}function h(){return e(".project-shortcut-dialog-trigger img").attr("src")}function l(n){if(n.localShortcuts){i.getCurrentPanel().html(navlinks.templates.projectshortcuts.headingWrapper({title:n.entity.title,logoUrl:h(),contentHtml:navlinks.templates.projectshortcuts.dialogContent(n)}));c(i)}}function a(p){var o=210;if(!p||p.length<=o){return p}var n=o;while(n>0&&p.charAt(n)!=" "){n--}if(n==0){n=o}p=p.substring(0,n);if(p.length>=n){p=p+"..."}return p}function c(n){var q=n.popup.element,p=q.find(".dialog-panel-body"),o=q.find(".dialog-components");p.height("auto");q.height(o.outerHeight()-1);e(".aui-shadow").remove()}function d(n,o){return e.ajax({url:n,cache:false,data:o,dataType:"json"})}e(document).on("click",".project-shortcut-dialog-trigger",f)}(jQuery,window.NL=(window.NL||{})));;
;
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:atlassian-ui-popup-display-controller', location = 'popups/DisplayController.js' */
AJS.Popups=AJS.Popups||{};AJS.Popups.DisplayController=function(){var c=[];var a=false;var b=false;AJS.toInit(function(){setTimeout(function(){AJS.Popups.DisplayController.render()},0)});return{request:function(d){c.push(d);if(a&&b===false){this.render()}},render:function(){c.sort(function(e,d){return e.weight-d.weight});a=true;if(c.length!==0){b=true;c[0].show()}}}}();;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.vendor.underscore', location = 'aui.chunk.a0bef1370d92fa153f15--e3f0dea7215bed5d5c6b.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.vendor.underscore"],{snLL:function(e,n,u){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=function(e){return e&&e.__esModule?e:{default:e}}(u("QFBp"));n.default=o.default,console.warn&&console.warn("Use of `window._` through AUI is deprecated and will be removed in AUI 9.0");var d=o.default;window._=d,e.exports=n.default}},[["snLL","runtime","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.9c48cc20a9"]]]);
//# sourceMappingURL=aui.chunk.a0bef1370d92fa153f15--e3f0dea7215bed5d5c6b.js.map;
;
/* module-key = 'com.atlassian.auiplugin:split_aui.component.dropdown2', location = 'aui.chunk.e22f6beba3f9ccca4bf5--91dfebccd6e92a314957.js' */
(window.__auiJsonp=window.__auiJsonp||[]).push([["aui.component.dropdown2"],[],[["XHZH","runtime","aui.splitchunk.vendors--1df5b34e16","aui.splitchunk.vendors--95c789edf5","aui.splitchunk.vendors--9c48cc20a9","aui.splitchunk.vendors--084821f40b","aui.splitchunk.vendors--d2297af84a","aui.splitchunk.172ffb6da7","aui.splitchunk.b0831cc7d0","aui.splitchunk.a16cabd587","aui.splitchunk.fbd1a5ab27","aui.splitchunk.54d3f16c20","aui.splitchunk.1659111a3c","aui.splitchunk.bc4873e5f9","aui.splitchunk.1df5b34e16","aui.splitchunk.fb15cffa72","aui.splitchunk.56dfb54d0c","aui.splitchunk.8659b532c1","aui.splitchunk.9c48cc20a9","aui.splitchunk.792781e698","aui.splitchunk.3e0cdb810a","aui.splitchunk.d0110a864f","aui.splitchunk.afa5039e04","aui.splitchunk.c750721820","aui.splitchunk.6d6f245ed3","aui.splitchunk.382c9b559f","aui.splitchunk.ed86a19e01","aui.splitchunk.084821f40b","aui.splitchunk.5b8c290363","aui.splitchunk.baa83dbaf9","aui.splitchunk.36cd9d521c","aui.splitchunk.def7f73e47","aui.splitchunk.4248e12b20","aui.splitchunk.b548966f06"]]]);
//# sourceMappingURL=aui.chunk.e22f6beba3f9ccca4bf5--91dfebccd6e92a314957.js.map;
;
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher.soy' */
// This file was automatically generated from appswitcher.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace navlinks.templates.appswitcher.
 */

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.appswitcher == 'undefined') { navlinks.templates.appswitcher = {}; }


navlinks.templates.appswitcher.linkSection = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.list.length > 0) {
    output += '<div class="aui-nav-heading sidebar-section-header">' + soy.$$escapeHtml(opt_data.title) + '</div><ul class="aui-nav nav-links">';
    var linkList8 = opt_data.list;
    var linkListLen8 = linkList8.length;
    for (var linkIndex8 = 0; linkIndex8 < linkListLen8; linkIndex8++) {
      var linkData8 = linkList8[linkIndex8];
      output += navlinks.templates.appswitcher.applicationsItem(linkData8);
    }
    output += '</ul>';
  }
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.linkSection.soyTemplateName = 'navlinks.templates.appswitcher.linkSection';
}


navlinks.templates.appswitcher.applicationsItem = function(opt_data, opt_ignored) {
  return '<li class="nav-link"><a href="' + soy.$$escapeHtml(opt_data.link) + '" ' + ((opt_data.self) ? 'class="checked"' : '') + ' title="' + soy.$$escapeHtml(opt_data.link) + '"><span class="nav-link-label">' + soy.$$escapeHtml(opt_data.label) + '</span></a></li>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.applicationsItem.soyTemplateName = 'navlinks.templates.appswitcher.applicationsItem';
}


navlinks.templates.appswitcher.shortcutsItem = function(opt_data, opt_ignored) {
  return '<li class="nav-link"><a href="' + soy.$$escapeHtml(opt_data.link) + '" ' + ((opt_data.self) ? 'class="checked"' : '') + ' title="' + soy.$$escapeHtml(opt_data.link) + '"><span class="nav-link-label">' + soy.$$escapeHtml(opt_data.label) + '</span>' + ((opt_data.showDescription && opt_data.description) ? '<span class="nav-link-description">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '') + '</a></li>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.shortcutsItem.soyTemplateName = 'navlinks.templates.appswitcher.shortcutsItem';
}


navlinks.templates.appswitcher.error = function(opt_data, opt_ignored) {
  return '<div class="app-switcher-error">' + soy.$$filterNoAutoescape('Something went wrong, please \x3cspan class\x3d\x22app-switcher-retry\x22\x3etry again\x3c/span\x3e.') + '</div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.error.soyTemplateName = 'navlinks.templates.appswitcher.error';
}


navlinks.templates.appswitcher.sidebarContents = function(opt_data, opt_ignored) {
  return '<div class="aui-page-panel-nav"><nav class="aui-navgroup aui-navgroup-vertical"><div class="app-switcher-section app-switcher-applications"><div class="aui-nav-heading">' + soy.$$escapeHtml('Application Links') + '</div><div class="app-switcher-loading">' + soy.$$filterNoAutoescape('Loading\x26hellip;') + '</div></div><div class="app-switcher-section app-switcher-shortcuts"><div class="aui-nav-heading">' + soy.$$escapeHtml('Shortcuts') + '</div><div class="app-switcher-loading">' + soy.$$filterNoAutoescape('Loading\x26hellip;') + '</div></div></nav></div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.sidebarContents.soyTemplateName = 'navlinks.templates.appswitcher.sidebarContents';
}


navlinks.templates.appswitcher.trigger = function(opt_data, opt_ignored) {
  return '<span class="aui-icon aui-icon-small aui-iconfont-appswitcher">' + soy.$$escapeHtml('Linked Applications') + '</span>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.trigger.soyTemplateName = 'navlinks.templates.appswitcher.trigger';
}


navlinks.templates.appswitcher.projectHeaderSection = function(opt_data, opt_ignored) {
  return '<div class="app-switcher-title">' + aui.avatar.avatar({size: 'large', avatarImageUrl: opt_data.avatarUrl, isProject: true, title: opt_data.name}) + '<div class="sidebar-project-name">' + soy.$$escapeHtml(opt_data.name) + '</div></div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.projectHeaderSection.soyTemplateName = 'navlinks.templates.appswitcher.projectHeaderSection';
}


navlinks.templates.appswitcher.cogDropdown = function(opt_data, opt_ignored) {
  var output = '';
  var dropdownList__soy74 = '' + navlinks.templates.appswitcher.dropdownList({list: opt_data.links});
  output += aui.dropdown2.dropdown2({menu: {id: opt_data.id, content: dropdownList__soy74, extraClasses: 'aui-style-default sidebar-customize-section'}, trigger: {showIcon: false, content: '<span class="aui-icon aui-icon-small aui-iconfont-configure"></span>', container: '#app-switcher'}});
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.cogDropdown.soyTemplateName = 'navlinks.templates.appswitcher.cogDropdown';
}


navlinks.templates.appswitcher.dropdownList = function(opt_data, opt_ignored) {
  var output = '<ul class="sidebar-admin-links">';
  var linkList82 = opt_data.list;
  var linkListLen82 = linkList82.length;
  for (var linkIndex82 = 0; linkIndex82 < linkListLen82; linkIndex82++) {
    var linkData82 = linkList82[linkIndex82];
    output += '<li class="nav-link"><a href="' + soy.$$escapeHtml(linkData82.href) + '" title="' + soy.$$escapeHtml(linkData82.title) + '"><span class="nav-link-label">' + soy.$$escapeHtml(linkData82.label) + '</span></a></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.dropdownList.soyTemplateName = 'navlinks.templates.appswitcher.dropdownList';
}


navlinks.templates.appswitcher.switcher = function(opt_data, opt_ignored) {
  var output = '';
  if (true) {
    if (AJS.DarkFeatures.isEnabled('rotp.sidebar')) {
      var sidebarContents__soy97 = '' + navlinks.templates.appswitcher.sidebarContents(null);
      var triggerContent__soy99 = '' + navlinks.templates.appswitcher.trigger(null);
      output += navlinks.templates.appswitcher.sidebar({sidebar: {id: 'app-switcher', content: sidebarContents__soy97}, trigger: {showIcon: false, content: triggerContent__soy99}});
    } else {
      output += navlinks.templates.appswitcher_old.switcher(null);
    }
  }
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.switcher.soyTemplateName = 'navlinks.templates.appswitcher.switcher';
}


navlinks.templates.appswitcher.sidebar = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml(opt_data.sidebar.id) + '" class="sidebar-trigger app-switcher-trigger" aria-owns="' + soy.$$escapeHtml(opt_data.sidebar.id) + '" aria-haspopup="true" data-is-user-admin="' + soy.$$escapeHtml(false) + '" data-is-sidebar="true" >' + soy.$$filterNoAutoescape(opt_data.trigger.content) + '</a><div id=' + soy.$$escapeHtml(opt_data.sidebar.id) + ' class="app-switcher-sidebar aui-style-default sidebar-offscreen">' + soy.$$filterNoAutoescape(opt_data.sidebar.content) + '</div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher.sidebar.soyTemplateName = 'navlinks.templates.appswitcher.sidebar';
}
;
;
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher.js' */
(function(e,a){var d="is-user-admin";var c="#app-switcher";a.SideBar=function(f){var g=this;this.$sidebar=null;f=e.extend({sidebarContents:null},f);this.getLinks=function(){return e.ajax({url:AJS.contextPath()+"/rest/menu/latest/appswitcher",cache:false,dataType:"json"}).done(this.updateAppLinks).fail(this.showAppSwitcherError)};this.populateProjectHeader=function(i,h){g.getSidebar().find(".app-switcher-shortcuts .aui-nav-heading").after(navlinks.templates.appswitcher.projectHeaderSection({avatarUrl:h,name:i}))};this.getProjectData=function(){var h=e(".project-shortcut-dialog-trigger"),i=h.data("key"),j=h.data("entity-type");if(h.size()==0||!i||!j){e(".app-switcher-shortcuts").remove();return}var l,k;k=e.ajax({url:AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+i,cache:false,data:{entityType:j},dataType:"json"});l=e.ajax({url:AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+i,cache:false,data:{entityType:j},dataType:"json"});e.when(k,l).then(function(n,m){g.updateProjectShortcuts(n,m,{key:i,entityType:j,name:h.data("name"),avatarUrl:h.find("img").prop("src")})},g.showProjectShortcutsError)};this.getSidebar=function(){if(!this.$sidebar){this.$sidebar=e(f.sidebarContents)}return this.$sidebar};this.addApplicationsCog=function(){e(".app-switcher-applications .aui-nav-heading").before(navlinks.templates.appswitcher.cogDropdown({id:"sidebar-applications-admin-dropdown",links:[{href:AJS.contextPath()+"/plugins/servlet/customize-application-navigator",label:"Customize navigator",title:"Add new entries, hide existing or restrict who sees what"},{href:AJS.contextPath()+"/plugins/servlet/applinks/listApplicationLinks",label:"Manage application links",title:"Link to more Atlassian applications"}]}))};this.addProjectShortcutsCog=function(h,j){var i=[{href:AJS.contextPath()+"/plugins/servlet/custom-content-links-admin?entityKey="+h,label:"Customize shortcuts",title:""}];if(g.entityMappings[j]){i.push({href:g.generateEntityLinksUrl(h,g.entityMappings[j]),label:"Manage product links",title:""})}g.getSidebar().find(".app-switcher-shortcuts .aui-nav-heading").before(navlinks.templates.appswitcher.cogDropdown({id:"sidebar-project-shortcuts-admin-dropdown",links:i}))};this.updateAppLinks=function(h){e(function(){g.getSidebar().find(".app-switcher-applications").html(navlinks.templates.appswitcher.linkSection({title:"Application Links",list:h}));if(g.getSidebar().data(d)){g.addApplicationsCog()}g.bindAnalyticsHandlers(g.getSidebar(),h)})};this.updateProjectShortcuts=function(k,i,j){var l=k[0].shortcuts,h=i[0].shortcuts;g.getSidebar().find(".app-switcher-shortcuts").html(navlinks.templates.appswitcher.linkSection({title:"Shortcuts",list:l.concat(h)}));if(g.getSidebar().data(d)){g.addProjectShortcutsCog(j.key,j.entityType)}g.populateProjectHeader(j.name,j.avatarUrl);g.bindAnalyticsHandlers(g.getSidebar(),data)};this.entityMappings={"confluence.space":"com.atlassian.applinks.api.application.confluence.ConfluenceSpaceEntityType","jira.project":"com.atlassian.applinks.api.application.jira.JiraProjectEntityType","bamboo.project":"com.atlassian.applinks.api.application.bamboo.BambooProjectEntityType","stash.project":"com.atlassian.applinks.api.application.stash.StashProjectEntityType"};this.generateEntityLinksUrl=function(h,i){if(i===g.entityMappings["confluence.space"]){return AJS.contextPath()+"/spaces/listentitylinks.action?typeId="+i+"&key="+h}else{return AJS.contextPath()+"/plugins/servlet/applinks/listEntityLinks/"+i+"/"+h}};this.showAppSwitcherError=function(){e(function(){var h=g.getSidebar();h.find(".app-switcher-applications .app-switcher-loading").replaceWith(navlinks.templates.appswitcher.error());h.off(".appswitcher").on("click.appswitcher",".app-switcher-retry",e.proxy(g.retryLoading,g))})};this.showProjectShortcutsError=function(){e(function(){var h=g.getSidebar();h.find(".app-switcher-shortcuts .app-switcher-loading").replaceWith(navlinks.templates.appswitcher.error());h.off(".appswitcher").on("click.appswitcher",".app-switcher-retry",e.proxy(g.retryLoading,g))})};this.retryLoading=function(h){this.getSidebar().html(navlinks.templates.appswitcher.sidebarContents());this.getLinks();this.getProjectData();h&&h.stopPropagation()};this.bindAnalyticsHandlers=function(h,i){};this.getLinks();e(this.getProjectData);this.toggleSidebar=function(j){var k=g.getSidebar(),i=e("body"),h=e(window.document);if(!i.hasClass("app-switcher-open")){var m=e("#header");k.css("left",-k.width());k.parent("body").length||k.appendTo("body");b({data:k});k.animate({left:0},300);function l(n){var p=n.target&&e(n.target),o=n.keyCode;if(n.originalEvent===j.originalEvent){return}if(p&&!o&&!(p.closest(k).length||p.closest(m).length)&&j.which==1&&!(n.shiftKey||n.ctrlKey||n.metaKey)){g.toggleSidebar()}else{if(o===27){g.toggleSidebar()}}}h.on("click.appSwitcher",l);h.on("keydown.appSwitcher",l);h.on("scroll.appSwitcher",k,b)}else{h.off(".appSwitcher")}i.toggleClass("app-switcher-open")};e("#header").on("click",".app-switcher-trigger",this.toggleSidebar)};function b(h){var f=e(document).scrollTop(),i=e("#header"),g=(i.height()+i.offset().top)-f;if(g>=0){h.data.css({top:g,position:"fixed"})}else{h.data.css({top:0,left:0,position:"fixed"})}}e(function(){if(e(c).data("is-sidebar")===true){new a.SideBar({sidebarContents:c})}})}(jQuery,window.NL=(window.NL||{})));;
;
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher_old.js' */
var APPSWITCHER_TRIGGER_CLICK="appswitcher.trigger.click";var APPSWITCHER_DROPDOWN_SHOW="appswitcher.dropdown.show";var APPSWITCHER_DROPDOWN_DISPLAY_ERROR="appswitcher.dropdown.display.error";var APPSWITCHER_APP_LINK_CLICK="appswitcher.app.link.click";var APPSWITCHER_CONFIGURE_LINK_CLICK="appswitcher.configure.link.click";(function(c,f){var b="isAppSuggestionAvailable";var d="isSiteAdminUser";var e="isUserAdmin";var a="#app-switcher";f.AppSwitcher=function(j){var l=AJS.contextPath()+"/plugins/servlet/customize-application-navigator";var k="unified.usermanagement";var m=this;this.$dropdown=null;j=c.extend({dropdownContents:null},j);this.getLinks=function(){return c.ajax({url:AJS.contextPath()+"/rest/menu/latest/appswitcher",cache:false,dataType:"json"}).done(this.updateDropdown).fail(this.showError)};this.getDropdown=function(){if(!this.$dropdown){this.$dropdown=c(j.dropdownContents);this.envData=this.$dropdown.data("environment")}return this.$dropdown};this.updateDropdown=function(n){c(function(){m.getDropdown().html(navlinks.templates.appswitcher_old.applications({apps:n,showAdminLink:m.envData[e],adminLink:l}));m.bindAnalyticsHandlers();if(m.envData[b]===true){m.handleSuggestionApps(n)}})};this.bindAnalyticsHandlers=function(){c(".app-switcher-trigger").on("click",function(){AJS.trigger("analyticsEvent",{name:APPSWITCHER_TRIGGER_CLICK})});c("#app-switcher").on("aui-dropdown2-show",function(){AJS.trigger("analyticsEvent",{name:APPSWITCHER_DROPDOWN_SHOW})});c("#app-switcher .nav-link").on("click",function(){var p="custom";var q=c(this).find("a");var o=q.attr("href");var n=window.location.hostname;if(o&&o.indexOf("bitbucket.org")>-1){p="bitbucket-cloud"}else{if(o.indexOf(n+"/wiki")>-1){p="confluence"}else{if(o.indexOf(n+"/build")>-1){p="bamboo"}else{if(o.indexOf(n)>-1){p="jira"}}}}AJS.trigger("analyticsEvent",{name:APPSWITCHER_APP_LINK_CLICK,data:{product:p}})});c(".nav-link-edit-wrapper").on("click",function(){AJS.trigger("analyticsEvent",{name:APPSWITCHER_CONFIGURE_LINK_CLICK})})};this.isBillingSystemEnabled=function(){return(this.envData[d]===true)&&AJS.DarkFeatures.isEnabled(k)};this.handleSuggestionApps=function(q){var r=_.map(q,function(s){return s.applicationType.toLowerCase()});var o=c("<div id='app-switcher-suggestion-apps' class='aui-dropdown2-section'/>");o.html(navlinks.templates.appswitcher_old.suggestionApps);var p=o.find(".suggestion-apps");var n=false;_.each(g,function(s){if(!_.contains(r,s.appName)){n=true;p.append(navlinks.templates.appswitcher_old.suggestionApp({suggestionApp:s,isBillingSystemEnabled:m.isBillingSystemEnabled()}))}});if(!n){return}c("#app-switcher").append(o);c(".app-discovery-suggestion-app").click(function(){var t=c(this).find("a");var s;if(m.envData[d]===true){s="appswitcher.discovery.siteadmin.select.inproduct."}else{s="appswitcher.discovery.user.select."}s=s+t.attr("id").toLowerCase();AJS.trigger("analytics",{name:s})});c(".app-discovery-suggestion-app").hover(function(){c(this).find("a").removeClass("active").removeClass("aui-dropdown2-active")});c(".app-discovery-cancel-button").click(function(){AJS.trigger("analytics",{name:"appswitcher.discovery.nothanks.button.click"});i(h,"true");o.remove()})};this.showError=function(){c(function(){AJS.trigger("analyticsEvent",{name:APPSWITCHER_DROPDOWN_DISPLAY_ERROR});m.getDropdown().html(navlinks.templates.appswitcher_old.error()).off(".appswitcher").on("click.appswitcher",".app-switcher-retry",c.proxy(m.retryLoading,m))})};this.retryLoading=function(n){this.getDropdown().html(navlinks.templates.appswitcher_old.loading());this.getLinks();n&&n.stopPropagation()};this.getLinks()};var h="key-no-thanks";var g=[{appName:"jira",appDesc:"Issue & Project Tracking Software",discoveryUrl:"https://www.atlassian.com/software/jira",billingSystemDiscoveryUrl:"/admin/billing/addapplication"},{appName:"confluence",appDesc:"Collaboration and content sharing",discoveryUrl:"https://www.atlassian.com/software/confluence",billingSystemDiscoveryUrl:"/admin/billing/addapplication?product=confluence.ondemand"},{appName:"bamboo",appDesc:"Continuous integration",discoveryUrl:"https://www.atlassian.com/software/bamboo",billingSystemDiscoveryUrl:"/admin/billing/addapplication?product=bamboo.ondemand"}];var i=function(j,k){c.ajax({url:AJS.contextPath()+"/rest/menu/latest/userdata/",type:"PUT",contentType:"application/json",data:JSON.stringify({key:j,value:k})})};c(function(){if(c(a).data("is-switcher")===true){new f.AppSwitcher({dropdownContents:a})}})}(jQuery,window.NL=(window.NL||{})));;
;
/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher_old.soy' */
// This file was automatically generated from appswitcher_old.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace navlinks.templates.appswitcher_old.
 */

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.appswitcher_old == 'undefined') { navlinks.templates.appswitcher_old = {}; }


navlinks.templates.appswitcher_old.applications = function(opt_data, opt_ignored) {
  return '' + navlinks.templates.appswitcher_old.applicationsSection({list: opt_data.apps, listClass: 'nav-links', showDescription: opt_data.showDescription}) + ((opt_data.custom) ? navlinks.templates.appswitcher_old.applicationsSection({list: opt_data.custom, showDescription: opt_data.showDescription}) : '') + ((opt_data.showAdminLink) ? navlinks.templates.appswitcher_old.adminSection(opt_data) : '');
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.applications.soyTemplateName = 'navlinks.templates.appswitcher_old.applications';
}


navlinks.templates.appswitcher_old.applicationsSection = function(opt_data, opt_ignored) {
  var output = '';
  if (opt_data.list.length > 0) {
    var param19 = '<ul' + ((opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '') + '>';
    var linkList27 = opt_data.list;
    var linkListLen27 = linkList27.length;
    for (var linkIndex27 = 0; linkIndex27 < linkListLen27; linkIndex27++) {
      var linkData27 = linkList27[linkIndex27];
      param19 += navlinks.templates.appswitcher_old.applicationsItem(soy.$$augmentMap(linkData27, {showDescription: opt_data.showDescription}));
    }
    param19 += '</ul>';
    output += aui.dropdown2.section({content: param19});
  }
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.applicationsSection.soyTemplateName = 'navlinks.templates.appswitcher_old.applicationsSection';
}


navlinks.templates.appswitcher_old.applicationsItem = function(opt_data, opt_ignored) {
  return '<li class="nav-link' + ((opt_data.self) ? ' nav-link-local' : '') + '"><a href="' + soy.$$escapeHtml(opt_data.link) + '" class="aui-dropdown2-radio ' + ((opt_data.self) ? 'aui-dropdown2-checked' : '') + '" title="' + soy.$$escapeHtml(opt_data.link) + '"><span class="nav-link-label">' + soy.$$escapeHtml(opt_data.label) + '</span>' + ((opt_data.showDescription && opt_data.description) ? '<span class="nav-link-description">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '') + '</a></li>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.applicationsItem.soyTemplateName = 'navlinks.templates.appswitcher_old.applicationsItem';
}


navlinks.templates.appswitcher_old.adminSection = function(opt_data, opt_ignored) {
  return '' + aui.dropdown2.section({content: '<ul class="nav-links"><li><a class="nav-link-edit-wrapper" href="' + soy.$$escapeHtml(opt_data.adminLink) + '"><span class="nav-link-edit">' + soy.$$filterNoAutoescape('Configure\x26hellip;') + '</span></a></li></ul>'});
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.adminSection.soyTemplateName = 'navlinks.templates.appswitcher_old.adminSection';
}


navlinks.templates.appswitcher_old.error = function(opt_data, opt_ignored) {
  return '<div class="app-switcher-error">' + soy.$$filterNoAutoescape('Something went wrong, please \x3cspan class\x3d\x22app-switcher-retry\x22\x3etry again\x3c/span\x3e.') + '</div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.error.soyTemplateName = 'navlinks.templates.appswitcher_old.error';
}


navlinks.templates.appswitcher_old.loading = function(opt_data, opt_ignored) {
  return '<div class="app-switcher-loading">' + soy.$$filterNoAutoescape('Loading\x26hellip;') + '</div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.loading.soyTemplateName = 'navlinks.templates.appswitcher_old.loading';
}


navlinks.templates.appswitcher_old.trigger = function(opt_data, opt_ignored) {
  return '<span class="aui-icon aui-icon-small aui-iconfont-appswitcher">' + soy.$$escapeHtml('Linked Applications') + '</span>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.trigger.soyTemplateName = 'navlinks.templates.appswitcher_old.trigger';
}


navlinks.templates.appswitcher_old.switcher = function(opt_data, opt_ignored) {
  var output = '';
  if (true) {
    var loadingContent__soy81 = '' + navlinks.templates.appswitcher_old.loading(null);
    var triggerContent__soy83 = '' + navlinks.templates.appswitcher_old.trigger(null);
    output += aui.dropdown2.dropdown2({menu: {id: 'app-switcher', content: loadingContent__soy81, extraClasses: 'aui-style-default', extraAttributes: {'data-environment': {}, 'data-is-switcher': 'true'}}, trigger: {showIcon: false, content: triggerContent__soy83, extraClasses: 'app-switcher-trigger', extraAttributes: {href: '#app-switcher'}}});
  }
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.switcher.soyTemplateName = 'navlinks.templates.appswitcher_old.switcher';
}


navlinks.templates.appswitcher_old.suggestionApp = function(opt_data, opt_ignored) {
  var output = '';
  var href__soy89 = opt_data.isBillingSystemEnabled == true ? opt_data.suggestionApp.billingSystemDiscoveryUrl : opt_data.suggestionApp.discoveryUrl;
  output += '<li class="app-discovery-suggestion-app"><a id="' + soy.$$escapeHtml(opt_data.suggestionApp.appName) + '" href="' + soy.$$escapeHtml(href__soy89) + '" class="app-discovery-link aui-icon-container app-discovery-' + soy.$$escapeHtml(opt_data.suggestionApp.appName) + '-product-icon" title="' + soy.$$escapeHtml(href__soy89) + '" target="_blank"/><div class="app-discovery-small">' + soy.$$escapeHtml(opt_data.suggestionApp.appDesc) + '</div></li>';
  return output;
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.suggestionApp.soyTemplateName = 'navlinks.templates.appswitcher_old.suggestionApp';
}


navlinks.templates.appswitcher_old.suggestionApps = function(opt_data, opt_ignored) {
  return '<ul class=\'nav-links suggestion-apps\'><li><span class=\'app-discovery-suggest-title nav-link-label\'><h6>' + soy.$$escapeHtml('Try other Atlassian apps') + '</h6></span></li></ul><div class=\'buttons-container app-discovery-suggest-apps-buttons\'><div class=\'buttons\'><button class=\'aui-button aui-button-link app-discovery-cancel-button\' name=\'cancel\' accesskey=\'c\' href=\'#\'>' + soy.$$escapeHtml('Don\x27t show this again') + '</button></div></div>';
};
if (goog.DEBUG) {
  navlinks.templates.appswitcher_old.suggestionApps.soyTemplateName = 'navlinks.templates.appswitcher_old.suggestionApps';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:classnames', location = '/static/lib/react/classnames.js' */
/*
 Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
(function(){function b(){for(var c=[],d=0;d<arguments.length;d++){var a=arguments[d];if(a){var e=typeof a;if("string"===e||"number"===e)c.push(a);else if(Array.isArray(a)&&a.length)(a=b.apply(null,a))&&c.push(a);else if("object"===e)for(var f in a)g.call(a,f)&&a[f]&&c.push(f)}}return c.join(" ")}var g={}.hasOwnProperty;"undefined"!==typeof module&&module.exports?(b.default=b,module.exports=b):"function"===typeof define&&"object"===typeof define.amd&&define.amd?define("classnames",[],function(){return b}):
window.classNames=b})();;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:classnames', location = '/static/lib/react/classnames-AMD.js' */
define("classnames",function(){return window.classNames});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:redux', location = '/static/lib/redux/redux.js' */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Redux={})}(this,function(e){"use strict";var t=function(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),r=function(){return Math.random().toString(36).substring(7).split("").join(".")},n={INIT:"@@redux/INIT"+r(),REPLACE:"@@redux/REPLACE"+r(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+r()}};function o(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+r+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function i(e,t){return function(){return t(e.apply(this,arguments))}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r}function a(e){for(var t=1;arguments.length>t;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(r,!0).forEach(function(t){u(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function f(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}e.__DO_NOT_USE__ActionTypes=n,e.applyMiddleware=function(){for(var e=arguments.length,t=Array(e),r=0;e>r;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},i=t.map(function(e){return e(o)});return a({},r,{dispatch:n=f.apply(void 0,i)(r.dispatch)})}}},e.bindActionCreators=function(e,t){if("function"==typeof e)return i(e,t);if("object"!=typeof e||null===e)throw Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var r={};for(var n in e){var o=e[n];"function"==typeof o&&(r[n]=i(o,t))}return r},e.combineReducers=function(e){for(var t=Object.keys(e),r={},i=0;t.length>i;i++){var u=t[i];"function"==typeof e[u]&&(r[u]=e[u])}var c,a=Object.keys(r);try{!function(e){Object.keys(e).forEach(function(t){var r=e[t];if(void 0===r(void 0,{type:n.INIT}))throw Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:n.PROBE_UNKNOWN_ACTION()}))throw Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+n.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(r)}catch(e){c=e}return function(e,t){if(void 0===e&&(e={}),c)throw c;for(var n=!1,i={},u=0;a.length>u;u++){var f=a[u],s=e[f],d=(0,r[f])(s,t);if(void 0===d){var l=o(f,t);throw Error(l)}i[f]=d,n=n||d!==s}return n?i:e}},e.compose=f,e.createStore=function e(r,o,i){var u;if("function"==typeof o&&"function"==typeof i||"function"==typeof i&&"function"==typeof arguments[3])throw Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof o&&void 0===i&&(i=o,o=void 0),void 0!==i){if("function"!=typeof i)throw Error("Expected the enhancer to be a function.");return i(e)(r,o)}if("function"!=typeof r)throw Error("Expected the reducer to be a function.");var c=r,a=o,f=[],s=f,d=!1;function l(){s===f&&(s=f.slice())}function p(){if(d)throw Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return a}function h(e){if("function"!=typeof e)throw Error("Expected the listener to be a function.");if(d)throw Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return l(),s.push(e),function(){if(t){if(d)throw Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,l();var r=s.indexOf(e);s.splice(r,1)}}}function y(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(d)throw Error("Reducers may not dispatch actions.");try{d=!0,a=c(a,e)}finally{d=!1}for(var t=f=s,r=0;t.length>r;r++)(0,t[r])();return e}return y({type:n.INIT}),(u={dispatch:y,subscribe:h,getState:p,replaceReducer:function(e){if("function"!=typeof e)throw Error("Expected the nextReducer to be a function.");c=e,y({type:n.REPLACE})}})[t]=function(){var e,r=h;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function t(){e.next&&e.next(p())}return t(),{unsubscribe:r(t)}}})[t]=function(){return this},e},u},Object.defineProperty(e,"__esModule",{value:!0})});
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:redux', location = '/static/lib/redux/redux-AMD.js' */
define("redux",function(){return window.Redux});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:enums', location = '/static/bitbucket/internal/enums.js' */
define("bitbucket/internal/enums",["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});var d=a.Entity=Object.freeze({COMMIT:"COMMIT",PROJECT:"PROJECT",PULL_REQUEST:"PULL_REQUEST",REPOSITORY:"REPOSITORY",USER:"USER",MIRROR:"MIRROR"}),e=a.UserType=Object.freeze({NORMAL:"NORMAL",SERVICE:"SERVICE"}),f=a.ProjectType=Object.freeze({NORMAL:"NORMAL",PERSONAL:"PERSONAL"}),g=a.ScmType=Object.freeze({GIT:"git",HG:"hg"}),h=a.RefType=Object.freeze({TAG:"TAG",BRANCH:"BRANCH"}),b=a.ParticipantRole=
Object.freeze({AUTHOR:"AUTHOR",REVIEWER:"REVIEWER",PARTICIPANT:"PARTICIPANT"}),k=a.ApprovalStatus=Object.freeze({APPROVED:"APPROVED",NEEDS_WORK:"NEEDS_WORK",UNAPPROVED:"UNAPPROVED"}),l=a.SelfAction=Object.freeze({ADD_SELF:"ADD_SELF",REMOVE_SELF:"REMOVE_SELF"}),m=a.PullRequestState=Object.freeze({OPEN:"OPEN",MERGED:"MERGED",DECLINED:"DECLINED"}),n=a.BranchStability=Object.freeze({STABLE:"stable",UNSTABLE:"unstable"}),p=a.MergeOutcome=Object.freeze({CLEAN:"CLEAN",CONFLICTED:"CONFLICTED",UNKNOWN:"UNKNOWN"});
a.RepositoryState=Object.freeze({AVAILABLE:"AVAILABLE",INITIALISATION_FAILED:"INITIALISATION_FAILED",INITIALISING:"INITIALISING"});var q=a.ChangeTypes=Object.freeze({ADD:"ADD",COPY:"COPY",DELETE:"DELETE",MODIFY:"MODIFY",MOVE:"MOVE",RENAME:"RENAME",UNKNOWN:"UNKNOWN"}),r=a.DiffSegmentTypes=Object.freeze({ADDED:"ADDED",REMOVED:"REMOVED",CONTEXT:"CONTEXT",MODIFIED:"MODIFIED",CONFLICT:"CONFLICT"}),t=a.DiffFileTypes=Object.freeze({FROM:"FROM",TO:"TO"}),u=a.ConflictSegmentTypes=Object.freeze({MARKER:"MARKER",
OURS:"OURS",THEIRS:"THEIRS"}),c=a.AvatarSize={XSMALL:32,SMALL:48,MEDIUM:64,LARGE:96,XLARGE:128,XXLARGE:192,XXXLARGE:256},v=a.AvatarTShirtSize=Object.keys(c).reduce(function(a,b){a[b]=b.toLowerCase();return a},{});a.default={ApprovalStatus:k,AvatarSize:c,AvatarTShirtSize:v,BranchStability:n,ChangeTypes:q,ConflictSegmentTypes:u,DiffFileTypes:t,DiffSegmentTypes:r,Entity:d,MergeOutcome:p,ProjectType:f,PullRequestState:m,RefType:h,ParticipantRole:b,SelfAction:l,ScmType:g,UserRole:b,UserType:e}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:entity-util', location = '/static/bitbucket/internal/util/entity.js' */
define("bitbucket/internal/util/entity",["exports"],function(b){Object.defineProperty(b,"__esModule",{value:!0});b.getCommitId=function(a){return a.id};b.getProjectId=function(a){return a.key};b.getPullRequestId=function(a){var b=a.toRef.repository;return[b.project.key,b.slug,a.id].join("/")};b.getRepositoryId=function(a){return[a.project.key,a.slug].join("/")};b.getUserId=function(a){return a.slug};b.buildMinimalCommit=function(a){return{id:a}};var c=b.buildMinimalProject=function(a){return{key:a}};
b.buildMinimalPullRequest=function(a,b,c){return{toRef:{repository:d(a,b)},id:c}};var d=b.buildMinimalRepository=function(a,b){return{project:c(a),slug:b}};b.buildMinimalUser=function(a){return{slug:a}}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:get-id', location = '/static/bitbucket/internal/util/get-id.js' */
define("bitbucket/internal/util/get-id",["exports","lodash"],function(a,c){Object.defineProperty(a,"__esModule",{value:!0});a.getIdString=a.getId=a.defaultIdField=void 0;var d=a.defaultIdField="id";a.getId=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d;return function(b){return(0,c.isFunction)(a)?a(b):(0,c.get)(b,a)}};a.getIdString=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d;return function(b){return(b=(0,c.isFunction)(a)?a(b):(0,c.get)(b,a))&&
String(b)}}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:icepick', location = '/static/lib/icepick/icepick.js' */
!function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).icepick=n()}}(function(){return function n(r,e,t){function o(u,i){if(!e[u]){if(!r[u]){var s="function"==typeof require&&require;if(!i&&s)return s(u,!0);if(c)return c(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var a=e[u]={exports:{}};r[u][0].call(a.exports,function(n){var e=r[u][1][n];return o(e||n)},a,a.exports,n,r,e,t)}return e[u].exports}for(var c="function"==typeof require&&require,u=0;u<t.length;u++)o(t[u]);return o}({1:[function(n,r,e){"use strict";function t(n,r){return(r||[]).reduce(function(n,r){if(n)return n[r]},n)}function o(n,r){return Object.keys(r).reduce(function(n,e){return i.assoc(n,e,r[e])},n)}function c(n,r,e){return null==n||null==r?n:Object.keys(r).reduce(function(n,t){var o=r[t],s=n[t],a=e?e(s,o,t):o;return f(o)&&f(s)?a===s?n:Array.isArray(o)?i.assoc(n,t,a):u(n,t,c(s,a,e)):u(n,t,a)},n)}function u(n,r,e){return n[r]===e?n:i.assoc(n,r,e)}var i=e,s=function(n){return n},f=function(n){return null!==n&&(Array.isArray(n)||a(n))},a=function(n){return!("object"!=typeof n||n.constructor!==Object&&null!=n.constructor||Object.getPrototypeOf(n)!==Object.prototype&&null!==Object.getPrototypeOf(n))},l=function(n,r){var e,t;if(Array.isArray(n))for(e=n.length;e--;)r(e);else for(e=(t=Object.keys(n)).length;e--;)r(t[e])},p=function(n){for(var r,e=null==n.constructor?Object.create(null):{},t=Object.keys(n),o=t.length;o--;)e[r=t[o]]=n[r];return e},v=function(n){return Array.isArray(n)?n.slice():p(n)},d=s,h=s;e.freeze=s,e.thaw=function n(r){if(!f(r)||!Object.isFrozen(r))return r;var e=Array.isArray(r)?new Array(r.length):{};return l(r,function(t){e[t]=n(r[t])}),e},e.assoc=function(n,r,e){if(n[r]===e)return h(n);var t=v(n);return t[r]=d(e),h(t)},e.set=e.assoc,e.dissoc=function(n,r){var e=v(n);return delete e[r],h(e)},e.unset=e.dissoc,e.assocIn=function n(r,e,t){var o=e[0];return 1===e.length?i.assoc(r,o,t):i.assoc(r,o,n(r[o]||{},e.slice(1),t))},e.setIn=e.assocIn,e.dissocIn=function n(r,e){var t=e[0];return r.hasOwnProperty(t)?1===e.length?i.dissoc(r,t):i.assoc(r,t,n(r[t],e.slice(1))):r},e.unsetIn=e.dissocIn,e.getIn=t,e.updateIn=function(n,r,e){var o=t(n,r);return i.assocIn(n,r,e(o))},["push","unshift","pop","shift","reverse","sort"].forEach(function(n){e[n]=function(r,e){var t=[].concat(r);return t[n](d(e)),h(t)},e[n].displayName="icepick."+n}),e.splice=function(n){for(var r=[],e=arguments.length-1;e-- >0;)r[e]=arguments[e+1];var t=[].concat(n),o=r.map(d);return t.splice.apply(t,o),h(t)},e.slice=function(n,r,e){var t=n.slice(r,e);return h(t)},["map","filter"].forEach(function(n){e[n]=function(r,e){var t=e[n](r);return h(t)},e[n].displayName="icepick."+n}),e.extend=e.assign=function(n){for(var r=[],e=arguments.length-1;e-- >0;)r[e]=arguments[e+1];var t=r.reduce(o,n);return h(t)},e.merge=c;var y={value:function(){return this.val},thru:function(n){return this.val=d(n(this.val)),this}};Object.keys(e).forEach(function(n){n.match(/^(map|filter)$/)?y[n]=function(r){return this.val=e[n](r,this.val),this}:y[n]=function(){for(var r=[],t=arguments.length;t--;)r[t]=arguments[t];return this.val=e[n].apply(e,[this.val].concat(r)),this}}),e.chain=function(n){var r=Object.create(y);return r.val=n,r}},{}]},{},[1])(1)});
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:icepick', location = '/static/lib/icepick/icepick-AMD.js' */
define("icepick",function(){return window.icepick});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:object-util', location = '/static/bitbucket/internal/util/object.js' */
define("bitbucket/internal/util/object",["exports","lodash"],function(a,d){function k(b){return b}function n(b){return"object"===("undefined"===typeof b?"undefined":f(b))?JSON.stringify(b):String(b)}function l(b,g,c){var a,e,h=g.length,d=c?n:k;return p.default.uniqBy(b,function(b){a=0;for(e="";a<h;a++)e+=d(b[g[a]]);return e})}function m(b,a){b.prototype=Object.create(a.prototype);Object.defineProperty(b.prototype,"constructor",{value:b,configurable:!0,writable:!0,enumerable:!1})}Object.defineProperty(a,
"__esModule",{value:!0});a.shallowEqual=a.deepFreeze=a.freeze=void 0;a.uniqueFromArray=l;a.inherits=m;var p=d&&d.__esModule?d:{default:d},f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"===typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},q=Object.prototype.hasOwnProperty;d=a.freeze=Object.freeze||k;var r=a.deepFreeze=Object.freeze?function g(c,a){if(null!==c&&"object"===("undefined"===typeof c?
"undefined":f(c))){var d=Object.isFrozen(c);d||Object.freeze(c);if(!d||a)for(var h in c)q.call(c,h)&&g(c[h])}return c}:k,t=a.shallowEqual=function(a,c){if(a===c)return!0;if("object"!==("undefined"===typeof a?"undefined":f(a))||"object"!==("undefined"===typeof c?"undefined":f(c))||null===a||null===c)return!1;var d=Object.keys(a),e=Object.keys(c);return d.length!==e.length?!1:d.every(function(d){return a[d]===c[d]})};a.default={uniqueFromArray:l,freeze:d,deepFreeze:r,inherits:m,shallowEqual:t}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:react', location = '/static/lib/react/react.js' */
/** @license React v16.9.0
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
'use strict';(function(t,q){"object"===typeof exports&&"undefined"!==typeof module?module.exports=q():"function"===typeof define&&define.amd?define(q):t.React=q()})(this,function(){function t(a){for(var b=a.message,c="https://reactjs.org/docs/error-decoder.html?invariant="+b,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);a.message="Minified React error #"+b+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ";
return a}function q(a,b,c){this.props=a;this.context=b;this.refs=fa;this.updater=c||ha}function ia(){}function O(a,b,c){this.props=a;this.context=b;this.refs=fa;this.updater=c||ha}function ja(a,b,c){var d=void 0,g={},k=null,e=null;if(null!=b)for(d in void 0!==b.ref&&(e=b.ref),void 0!==b.key&&(k=""+b.key),b)ka.call(b,d)&&!la.hasOwnProperty(d)&&(g[d]=b[d]);var l=arguments.length-2;if(1===l)g.children=c;else if(1<l){for(var h=Array(l),f=0;f<l;f++)h[f]=arguments[f+2];g.children=h}if(a&&a.defaultProps)for(d in l=
a.defaultProps,l)void 0===g[d]&&(g[d]=l[d]);return{$$typeof:y,type:a,key:k,ref:e,props:g,_owner:P.current}}function Ba(a,b){return{$$typeof:y,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function Q(a){return"object"===typeof a&&null!==a&&a.$$typeof===y}function Ca(a){var b={"=":"=0",":":"=2"};return"$"+(""+a).replace(/[=:]/g,function(a){return b[a]})}function ma(a,b,c,d){if(H.length){var g=H.pop();g.result=a;g.keyPrefix=b;g.func=c;g.context=d;g.count=0;return g}return{result:a,keyPrefix:b,
func:c,context:d,count:0}}function na(a){a.result=null;a.keyPrefix=null;a.func=null;a.context=null;a.count=0;10>H.length&&H.push(a)}function R(a,b,c,d){var g=typeof a;if("undefined"===g||"boolean"===g)a=null;var k=!1;if(null===a)k=!0;else switch(g){case "string":case "number":k=!0;break;case "object":switch(a.$$typeof){case y:case Da:k=!0}}if(k)return c(d,a,""===b?"."+S(a,0):b),1;k=0;b=""===b?".":b+":";if(Array.isArray(a))for(var e=0;e<a.length;e++){g=a[e];var l=b+S(g,e);k+=R(g,l,c,d)}else if(null===
a||"object"!==typeof a?l=null:(l=oa&&a[oa]||a["@@iterator"],l="function"===typeof l?l:null),"function"===typeof l)for(a=l.call(a),e=0;!(g=a.next()).done;)g=g.value,l=b+S(g,e++),k+=R(g,l,c,d);else if("object"===g)throw c=""+a,t(Error(31),"[object Object]"===c?"object with keys {"+Object.keys(a).join(", ")+"}":c,"");return k}function T(a,b,c){return null==a?0:R(a,"",b,c)}function S(a,b){return"object"===typeof a&&null!==a&&null!=a.key?Ca(a.key):b.toString(36)}function Ea(a,b,c){a.func.call(a.context,
b,a.count++)}function Fa(a,b,c){var d=a.result,g=a.keyPrefix;a=a.func.call(a.context,b,a.count++);Array.isArray(a)?U(a,d,c,function(a){return a}):null!=a&&(Q(a)&&(a=Ba(a,g+(!a.key||b&&b.key===a.key?"":(""+a.key).replace(pa,"$&/")+"/")+c)),d.push(a))}function U(a,b,c,d,g){var e="";null!=c&&(e=(""+c).replace(pa,"$&/")+"/");b=ma(b,e,d,g);T(a,Fa,b);na(b)}function r(){var a=qa.current;if(null===a)throw t(Error(321));return a}function ra(a,b){var c=a.next;if(c===a)e=null;else{a===e&&(e=c);var d=a.previous;
d.next=c;c.previous=d}a.next=a.previous=null;c=a.callback;d=m;var g=z;m=a.priorityLevel;z=a;try{var k=a.expirationTime<=b;switch(m){case 1:var f=c(k);break;case 2:f=c(k);break;case 3:f=c(k);break;case 4:f=c(k);break;case 5:f=c(k)}}catch(l){throw l;}finally{m=d,z=g}if("function"===typeof f)if(b=a.expirationTime,a.callback=f,null===e)e=a.next=a.previous=a;else{f=null;k=e;do{if(b<=k.expirationTime){f=k;break}k=k.next}while(k!==e);null===f?f=e:f===e&&(e=a);b=f.previous;b.next=f.previous=a;a.next=f;a.previous=
b}}function A(a){if(null!==f&&f.startTime<=a){do{var b=f,c=b.next;if(b===c)f=null;else{f=c;var d=b.previous;d.next=c;c.previous=d}b.next=b.previous=null;sa(b,b.expirationTime)}while(null!==f&&f.startTime<=a)}}function V(a){B=!1;A(a);u||(null!==e?(u=!0,w(W)):null!==f&&C(V,f.startTime-a))}function W(a,b){u=!1;B&&(B=!1,I());A(b);J=!0;try{if(!a)for(;null!==e&&e.expirationTime<=b;)ra(e,b),b=n(),A(b);else if(null!==e){do ra(e,b),b=n(),A(b);while(null!==e&&!K())}if(null!==e)return!0;null!==f&&C(V,f.startTime-
b);return!1}finally{J=!1}}function ta(a){switch(a){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1E4;default:return 5E3}}function sa(a,b){if(null===e)e=a.next=a.previous=a;else{var c=null,d=e;do{if(b<d.expirationTime){c=d;break}d=d.next}while(d!==e);null===c?c=e:c===e&&(e=a);b=c.previous;b.next=c.previous=a;a.next=c;a.previous=b}}var h="function"===typeof Symbol&&Symbol.for,y=h?Symbol.for("react.element"):60103,Da=h?Symbol.for("react.portal"):60106,v=h?Symbol.for("react.fragment"):
60107,X=h?Symbol.for("react.strict_mode"):60108,Ga=h?Symbol.for("react.profiler"):60114,Ha=h?Symbol.for("react.provider"):60109,Ia=h?Symbol.for("react.context"):60110,Ja=h?Symbol.for("react.forward_ref"):60112,Ka=h?Symbol.for("react.suspense"):60113,La=h?Symbol.for("react.suspense_list"):60120,Ma=h?Symbol.for("react.memo"):60115,Na=h?Symbol.for("react.lazy"):60116;h&&Symbol.for("react.fundamental");h&&Symbol.for("react.responder");var oa="function"===typeof Symbol&&Symbol.iterator,ua=Object.getOwnPropertySymbols,
Oa=Object.prototype.hasOwnProperty,Pa=Object.prototype.propertyIsEnumerable,L=function(){try{if(!Object.assign)return!1;var a=new String("abc");a[5]="de";if("5"===Object.getOwnPropertyNames(a)[0])return!1;var b={};for(a=0;10>a;a++)b["_"+String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(b).map(function(a){return b[a]}).join(""))return!1;var c={};"abcdefghijklmnopqrst".split("").forEach(function(a){c[a]=a});return"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},c)).join("")?
!1:!0}catch(d){return!1}}()?Object.assign:function(a,b){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");var c=Object(a);for(var d,g=1;g<arguments.length;g++){var e=Object(arguments[g]);for(var f in e)Oa.call(e,f)&&(c[f]=e[f]);if(ua){d=ua(e);for(var l=0;l<d.length;l++)Pa.call(e,d[l])&&(c[d[l]]=e[d[l]])}}return c},ha={isMounted:function(a){return!1},enqueueForceUpdate:function(a,b,c){},enqueueReplaceState:function(a,b,c,d){},enqueueSetState:function(a,
b,c,d){}},fa={};q.prototype.isReactComponent={};q.prototype.setState=function(a,b){if("object"!==typeof a&&"function"!==typeof a&&null!=a)throw t(Error(85));this.updater.enqueueSetState(this,a,b,"setState")};q.prototype.forceUpdate=function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};ia.prototype=q.prototype;h=O.prototype=new ia;h.constructor=O;L(h,q.prototype);h.isPureReactComponent=!0;var qa={current:null},P={current:null},ka=Object.prototype.hasOwnProperty,la={key:!0,ref:!0,__self:!0,
__source:!0},pa=/\/+/g,H=[],w=void 0,C=void 0,I=void 0,K=void 0,n=h=void 0,Y=void 0;if("undefined"===typeof window||"function"!==typeof MessageChannel){var D=null,va=null,wa=function(){if(null!==D)try{var a=n();D(!0,a);D=null}catch(b){throw setTimeout(wa,0),b;}};n=function(){return Date.now()};w=function(a){null!==D?setTimeout(w,0,a):(D=a,setTimeout(wa,0))};C=function(a,b){va=setTimeout(a,b)};I=function(){clearTimeout(va)};K=function(){return!1};h=Y=function(){}}else{var Z=window.performance,Qa=window.Date,
aa=window.setTimeout,xa=window.clearTimeout,ba=window.requestAnimationFrame;h=window.cancelAnimationFrame;"undefined"!==typeof console&&("function"!==typeof ba&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!==typeof h&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));n="object"===
typeof Z&&"function"===typeof Z.now?function(){return Z.now()}:function(){return Qa.now()};var M=!1,E=null,ca=-1,da=-1,p=33.33,F=-1,x=-1,N=0,ea=!1;K=function(){return n()>=N};h=function(){};Y=function(a){0>a||125<a?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):0<a?(p=Math.floor(1E3/a),ea=!0):(p=33.33,ea=!1)};var za=function(){if(null!==E){var a=n(),b=0<N-a;try{E(b,a)||(E=null)}catch(c){throw ya.postMessage(null),c;
}}},G=new MessageChannel,ya=G.port2;G.port1.onmessage=za;var Aa=function(a){if(null===E)x=F=-1,M=!1;else{M=!0;ba(function(a){xa(ca);Aa(a)});var b=function(){N=n()+p/2;za();ca=aa(b,3*p)};ca=aa(b,3*p);if(-1!==F&&.1<a-F){var c=a-F;!ea&&-1!==x&&c<p&&x<p&&(p=c<x?x:c,8.33>p&&(p=8.33));x=c}F=a;N=a+p;ya.postMessage(null)}};w=function(a){E=a;M||(M=!0,ba(function(a){Aa(a)}))};C=function(a,b){da=aa(function(){a(n())},b)};I=function(){xa(da);da=-1}}var e=null,f=null,z=null,m=3,J=!1,u=!1,B=!1,Ra=0;G={ReactCurrentDispatcher:qa,
ReactCurrentOwner:P,IsSomeRendererActing:{current:!1},assign:L};L(G,{Scheduler:{unstable_ImmediatePriority:1,unstable_UserBlockingPriority:2,unstable_NormalPriority:3,unstable_IdlePriority:5,unstable_LowPriority:4,unstable_runWithPriority:function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=m;m=a;try{return b()}finally{m=c}},unstable_next:function(a){switch(m){case 1:case 2:case 3:var b=3;break;default:b=m}var c=m;m=b;try{return a()}finally{m=c}},unstable_scheduleCallback:function(a,
b,c){var d=n();if("object"===typeof c&&null!==c){var g=c.delay;g="number"===typeof g&&0<g?d+g:d;c="number"===typeof c.timeout?c.timeout:ta(a)}else c=ta(a),g=d;c=g+c;a={callback:b,priorityLevel:a,startTime:g,expirationTime:c,next:null,previous:null};if(g>d){c=g;if(null===f)f=a.next=a.previous=a;else{b=null;var k=f;do{if(c<k.startTime){b=k;break}k=k.next}while(k!==f);null===b?b=f:b===f&&(f=a);c=b.previous;c.next=b.previous=a;a.next=b;a.previous=c}null===e&&f===a&&(B?I():B=!0,C(V,g-d))}else sa(a,c),
u||J||(u=!0,w(W));return a},unstable_cancelCallback:function(a){var b=a.next;if(null!==b){if(a===b)a===e?e=null:a===f&&(f=null);else{a===e?e=b:a===f&&(f=b);var c=a.previous;c.next=b;b.previous=c}a.next=a.previous=null}},unstable_wrapCallback:function(a){var b=m;return function(){var c=m;m=b;try{return a.apply(this,arguments)}finally{m=c}}},unstable_getCurrentPriorityLevel:function(){return m},unstable_shouldYield:function(){var a=n();A(a);return null!==z&&null!==e&&e.startTime<=a&&e.expirationTime<
z.expirationTime||K()},unstable_requestPaint:h,unstable_continueExecution:function(){u||J||(u=!0,w(W))},unstable_pauseExecution:function(){},unstable_getFirstCallbackNode:function(){return e},get unstable_now(){return n},get unstable_forceFrameRate(){return Y}},SchedulerTracing:{get __interactionsRef(){return null},get __subscriberRef(){return null},unstable_clear:function(a){return a()},unstable_getCurrent:function(){return null},unstable_getThreadID:function(){return++Ra},unstable_trace:function(a,
b,c){return c()},unstable_wrap:function(a){return a},unstable_subscribe:function(a){},unstable_unsubscribe:function(a){}}});v={Children:{map:function(a,b,c){if(null==a)return a;var d=[];U(a,d,null,b,c);return d},forEach:function(a,b,c){if(null==a)return a;b=ma(null,null,b,c);T(a,Ea,b);na(b)},count:function(a){return T(a,function(){return null},null)},toArray:function(a){var b=[];U(a,b,null,function(a){return a});return b},only:function(a){if(!Q(a))throw t(Error(143));return a}},createRef:function(){return{current:null}},
Component:q,PureComponent:O,createContext:function(a,b){void 0===b&&(b=null);a={$$typeof:Ia,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:Ha,_context:a};return a.Consumer=a},forwardRef:function(a){return{$$typeof:Ja,render:a}},lazy:function(a){return{$$typeof:Na,_ctor:a,_status:-1,_result:null}},memo:function(a,b){return{$$typeof:Ma,type:a,compare:void 0===b?null:b}},useCallback:function(a,b){return r().useCallback(a,b)},
useContext:function(a,b){return r().useContext(a,b)},useEffect:function(a,b){return r().useEffect(a,b)},useImperativeHandle:function(a,b,c){return r().useImperativeHandle(a,b,c)},useDebugValue:function(a,b){},useLayoutEffect:function(a,b){return r().useLayoutEffect(a,b)},useMemo:function(a,b){return r().useMemo(a,b)},useReducer:function(a,b,c){return r().useReducer(a,b,c)},useRef:function(a){return r().useRef(a)},useState:function(a){return r().useState(a)},Fragment:v,Profiler:Ga,StrictMode:X,Suspense:Ka,
unstable_SuspenseList:La,createElement:ja,cloneElement:function(a,b,c){if(null===a||void 0===a)throw t(Error(267),a);var d=void 0,e=L({},a.props),f=a.key,h=a.ref,l=a._owner;if(null!=b){void 0!==b.ref&&(h=b.ref,l=P.current);void 0!==b.key&&(f=""+b.key);var m=void 0;a.type&&a.type.defaultProps&&(m=a.type.defaultProps);for(d in b)ka.call(b,d)&&!la.hasOwnProperty(d)&&(e[d]=void 0===b[d]&&void 0!==m?m[d]:b[d])}d=arguments.length-2;if(1===d)e.children=c;else if(1<d){m=Array(d);for(var n=0;n<d;n++)m[n]=
arguments[n+2];e.children=m}return{$$typeof:y,type:a.type,key:f,ref:h,props:e,_owner:l}},createFactory:function(a){var b=ja.bind(null,a);b.type=a;return b},isValidElement:Q,version:"16.9.0",unstable_withSuspenseConfig:function(a,b){a()},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:G};v=(X={default:v},v)||X;return v.default||v});
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:react', location = '/static/lib/react/react-AMD.js' */
define("react",function(){return window.React});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:react', location = '/static/lib/react/react-dom.js' */
/** @license React v16.9.0
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
/*
 Modernizr 3.0.0pre (Custom Build) | MIT
*/
'use strict';(function(ka,m){"object"===typeof exports&&"undefined"!==typeof module?module.exports=m(require("react")):"function"===typeof define&&define.amd?define(["react"],m):ka.ReactDOM=m(ka.React)})(this,function(ka){function m(a){for(var b=a.message,c="https://reactjs.org/docs/error-decoder.html?invariant="+b,d=1;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d]);a.message="Minified React error #"+b+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ";
return a}function Ze(){if(jc)for(var a in Xa){var b=Xa[a],c=jc.indexOf(a);if(!(-1<c))throw m(Error(96),a);if(!kc[c]){if(!b.extractEvents)throw m(Error(97),a);kc[c]=b;c=b.eventTypes;for(var d in c){var e=void 0;var f=c[d],g=b,h=d;if(kd.hasOwnProperty(h))throw m(Error(99),h);kd[h]=f;var k=f.phasedRegistrationNames;if(k){for(e in k)k.hasOwnProperty(e)&&$e(k[e],g,h);e=!0}else f.registrationName?($e(f.registrationName,g,h),e=!0):e=!1;if(!e)throw m(Error(98),d,a);}}}}function $e(a,b,c){if(Ya[a])throw m(Error(100),
a);Ya[a]=b;ld[a]=b.eventTypes[c].dependencies}function Uh(a,b,c,d,e,f,g,h,k){ub=!1;lc=null;Vh.apply(Wh,arguments)}function Xh(a,b,c,d,e,f,g,h,k){Uh.apply(this,arguments);if(ub){if(ub){var l=lc;ub=!1;lc=null}else throw m(Error(198));mc||(mc=!0,md=l)}}function af(a,b,c){var d=a.type||"unknown-event";a.currentTarget=bf(c);Xh(d,b,void 0,a);a.currentTarget=null}function Za(a,b){if(null==b)throw m(Error(30));if(null==a)return b;if(Array.isArray(a)){if(Array.isArray(b))return a.push.apply(a,b),a;a.push(b);
return a}return Array.isArray(b)?[a].concat(b):[a,b]}function nd(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)}function nc(a){null!==a&&(vb=Za(vb,a));a=vb;vb=null;if(a){nd(a,Yh);if(vb)throw m(Error(95));if(mc)throw a=md,mc=!1,md=null,a;}}function cf(a,b){var c=a.stateNode;if(!c)return null;var d=od(c);if(!d)return null;c=d[b];a:switch(b){case "onClick":case "onClickCapture":case "onDoubleClick":case "onDoubleClickCapture":case "onMouseDown":case "onMouseDownCapture":case "onMouseMove":case "onMouseMoveCapture":case "onMouseUp":case "onMouseUpCapture":(d=
!d.disabled)||(a=a.type,d=!("button"===a||"input"===a||"select"===a||"textarea"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&"function"!==typeof c)throw m(Error(231),b,typeof c);return c}function oc(a){if(a[la])return a[la];for(;!a[la];)if(a.parentNode)a=a.parentNode;else return null;a=a[la];return 5===a.tag||6===a.tag?a:null}function df(a){a=a[la];return!a||5!==a.tag&&6!==a.tag?null:a}function Ja(a){if(5===a.tag||6===a.tag)return a.stateNode;throw m(Error(33));}function pd(a){return a[pc]||
null}function ma(a){do a=a.return;while(a&&5!==a.tag);return a?a:null}function ef(a,b,c){if(b=cf(a,c.dispatchConfig.phasedRegistrationNames[b]))c._dispatchListeners=Za(c._dispatchListeners,b),c._dispatchInstances=Za(c._dispatchInstances,a)}function Zh(a){if(a&&a.dispatchConfig.phasedRegistrationNames){for(var b=a._targetInst,c=[];b;)c.push(b),b=ma(b);for(b=c.length;0<b--;)ef(c[b],"captured",a);for(b=0;b<c.length;b++)ef(c[b],"bubbled",a)}}function qd(a,b,c){a&&c&&c.dispatchConfig.registrationName&&
(b=cf(a,c.dispatchConfig.registrationName))&&(c._dispatchListeners=Za(c._dispatchListeners,b),c._dispatchInstances=Za(c._dispatchInstances,a))}function $h(a){a&&a.dispatchConfig.registrationName&&qd(a._targetInst,null,a)}function $a(a){nd(a,Zh)}function qc(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c["Webkit"+a]="webkit"+b;c["Moz"+a]="moz"+b;return c}function rc(a){if(rd[a])return rd[a];if(!ab[a])return a;var b=ab[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in ff)return rd[a]=b[c];return a}function gf(){if(sc)return sc;
var a,b=sd,c=b.length,d,e="value"in va?va.value:va.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return sc=e.slice(a,1<d?1-d:void 0)}function tc(){return!0}function uc(){return!1}function Q(a,b,c,d){this.dispatchConfig=a;this._targetInst=b;this.nativeEvent=c;a=this.constructor.Interface;for(var e in a)a.hasOwnProperty(e)&&((b=a[e])?this[e]=b(c):"target"===e?this.target=d:this[e]=c[e]);this.isDefaultPrevented=(null!=c.defaultPrevented?c.defaultPrevented:
!1===c.returnValue)?tc:uc;this.isPropagationStopped=uc;return this}function ai(a,b,c,d){if(this.eventPool.length){var e=this.eventPool.pop();this.call(e,a,b,c,d);return e}return new this(a,b,c,d)}function bi(a){if(!(a instanceof this))throw m(Error(279));a.destructor();10>this.eventPool.length&&this.eventPool.push(a)}function hf(a){a.eventPool=[];a.getPooled=ai;a.release=bi}function jf(a,b){switch(a){case "keyup":return-1!==ci.indexOf(b.keyCode);case "keydown":return 229!==b.keyCode;case "keypress":case "mousedown":case "blur":return!0;
default:return!1}}function kf(a){a=a.detail;return"object"===typeof a&&"data"in a?a.data:null}function di(a,b){switch(a){case "compositionend":return kf(b);case "keypress":if(32!==b.which)return null;lf=!0;return mf;case "textInput":return a=b.data,a===mf&&lf?null:a;default:return null}}function ei(a,b){if(bb)return"compositionend"===a||!td&&jf(a,b)?(a=gf(),sc=sd=va=null,bb=!1,a):null;switch(a){case "paste":return null;case "keypress":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&
1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case "compositionend":return nf&&"ko"!==b.locale?null:b.data;default:return null}}function of(a){if(a=pf(a)){if("function"!==typeof ud)throw m(Error(280));var b=od(a.stateNode);ud(a.stateNode,a.type,b)}}function qf(a){cb?db?db.push(a):db=[a]:cb=a}function rf(){if(cb){var a=cb,b=db;db=cb=null;of(a);if(b)for(a=0;a<b.length;a++)of(b[a])}}function vd(){if(null!==cb||null!==db)wd(),rf()}function sf(a){var b=a&&a.nodeName&&
a.nodeName.toLowerCase();return"input"===b?!!fi[a.type]:"textarea"===b?!0:!1}function xd(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:a}function tf(a){if(!wa)return!1;a="on"+a;var b=a in document;b||(b=document.createElement("div"),b.setAttribute(a,"return;"),b="function"===typeof b[a]);return b}function uf(a){var b=a.type;return(a=a.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===b||"radio"===b)}function gi(a){var b=
uf(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=""+a[b];if(!a.hasOwnProperty(b)&&"undefined"!==typeof c&&"function"===typeof c.get&&"function"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=""+a;f.call(this,a)}});Object.defineProperty(a,b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=""+a},stopTracking:function(){a._valueTracker=null;
delete a[b]}}}}function vc(a){a._valueTracker||(a._valueTracker=gi(a))}function vf(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d="";a&&(d=uf(a)?a.checked?"true":"false":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function wb(a){if(null===a||"object"!==typeof a)return null;a=wf&&a[wf]||a["@@iterator"];return"function"===typeof a?a:null}function xa(a){if(null==a)return null;if("function"===typeof a)return a.displayName||a.name||null;if("string"===typeof a)return a;
switch(a){case ya:return"Fragment";case eb:return"Portal";case wc:return"Profiler";case xf:return"StrictMode";case xc:return"Suspense";case yd:return"SuspenseList"}if("object"===typeof a)switch(a.$$typeof){case yf:return"Context.Consumer";case zf:return"Context.Provider";case zd:var b=a.render;b=b.displayName||b.name||"";return a.displayName||(""!==b?"ForwardRef("+b+")":"ForwardRef");case Ad:return xa(a.type);case Af:if(a=1===a._status?a._result:null)return xa(a)}return null}function Bd(a){var b=
"";do{a:switch(a.tag){case 3:case 4:case 6:case 7:case 10:case 9:var c="";break a;default:var d=a._debugOwner,e=a._debugSource,f=xa(a.type);c=null;d&&(c=xa(d.type));d=f;f="";e?f=" (at "+e.fileName.replace(hi,"")+":"+e.lineNumber+")":c&&(f=" (created by "+c+")");c="\n    in "+(d||"Unknown")+f}b+=c;a=a.return}while(a);return b}function ii(a){if(Bf.call(Cf,a))return!0;if(Bf.call(Df,a))return!1;if(ji.test(a))return Cf[a]=!0;Df[a]=!0;return!1}function ki(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case "function":case "symbol":return!0;
case "boolean":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return"data-"!==a&&"aria-"!==a;default:return!1}}function li(a,b,c,d){if(null===b||"undefined"===typeof b||ki(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function B(a,b,c,d,e,f){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=
a;this.type=b;this.sanitizeURL=f}function Cd(a,b,c,d){var e=H.hasOwnProperty(b)?H[b]:null;var f=null!==e?0===e.type:d?!1:!(2<b.length)||"o"!==b[0]&&"O"!==b[0]||"n"!==b[1]&&"N"!==b[1]?!1:!0;f||(li(b,c,e,d)&&(c=null),d||null===e?ii(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,""+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:"":c:(b=e.attributeName,d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?"":""+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,
c))))}function za(a){switch(typeof a){case "boolean":case "number":case "object":case "string":case "undefined":return a;default:return""}}function Dd(a,b){var c=b.checked;return K({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=c?c:a._wrapperState.initialChecked})}function Ef(a,b){var c=null==b.defaultValue?"":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=za(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:"checkbox"===
b.type||"radio"===b.type?null!=b.checked:null!=b.value}}function Ff(a,b){b=b.checked;null!=b&&Cd(a,"checked",b,!1)}function Ed(a,b){Ff(a,b);var c=za(b.value),d=b.type;if(null!=c)if("number"===d){if(0===c&&""===a.value||a.value!=c)a.value=""+c}else a.value!==""+c&&(a.value=""+c);else if("submit"===d||"reset"===d){a.removeAttribute("value");return}b.hasOwnProperty("value")?Fd(a,b.type,c):b.hasOwnProperty("defaultValue")&&Fd(a,b.type,za(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=
!!b.defaultChecked)}function Gf(a,b,c){if(b.hasOwnProperty("value")||b.hasOwnProperty("defaultValue")){var d=b.type;if(!("submit"!==d&&"reset"!==d||void 0!==b.value&&null!==b.value))return;b=""+a._wrapperState.initialValue;c||b===a.value||(a.value=b);a.defaultValue=b}c=a.name;""!==c&&(a.name="");a.defaultChecked=!a.defaultChecked;a.defaultChecked=!!a._wrapperState.initialChecked;""!==c&&(a.name=c)}function Fd(a,b,c){if("number"!==b||a.ownerDocument.activeElement!==a)null==c?a.defaultValue=""+a._wrapperState.initialValue:
a.defaultValue!==""+c&&(a.defaultValue=""+c)}function Hf(a,b,c){a=Q.getPooled(If.change,a,b,c);a.type="change";qf(c);$a(a);return a}function mi(a){nc(a)}function yc(a){var b=Ja(a);if(vf(b))return a}function ni(a,b){if("change"===a)return b}function Jf(){xb&&(xb.detachEvent("onpropertychange",Kf),yb=xb=null)}function Kf(a){if("value"===a.propertyName&&yc(yb))if(a=Hf(yb,a,xd(a)),Z)nc(a);else{Z=!0;try{Gd(mi,a)}finally{Z=!1,vd()}}}function oi(a,b,c){"focus"===a?(Jf(),xb=b,yb=c,xb.attachEvent("onpropertychange",
Kf)):"blur"===a&&Jf()}function pi(a,b){if("selectionchange"===a||"keyup"===a||"keydown"===a)return yc(yb)}function qi(a,b){if("click"===a)return yc(b)}function ri(a,b){if("input"===a||"change"===a)return yc(b)}function si(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=ti[a])?!!b[a]:!1}function Hd(a){return si}function Ka(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}function zb(a,b){if(Ka(a,b))return!0;if("object"!==typeof a||null===a||"object"!==typeof b||null===
b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++)if(!ui.call(b,c[d])||!Ka(a[c[d]],b[c[d]]))return!1;return!0}function Lf(a,b){return{responder:a,props:b}}function Ab(a){var b=a;if(a.alternate)for(;b.return;)b=b.return;else{if(0!==(b.effectTag&2))return 1;for(;b.return;)if(b=b.return,0!==(b.effectTag&2))return 1}return 3===b.tag?2:3}function Mf(a){if(2!==Ab(a))throw m(Error(188));}function vi(a){var b=a.alternate;if(!b){b=Ab(a);if(3===b)throw m(Error(188));
return 1===b?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return Mf(e),a;if(f===d)return Mf(e),b;f=f.sibling}throw m(Error(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=f.child;h;){if(h===c){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw m(Error(189));
}}if(c.alternate!==d)throw m(Error(190));}if(3!==c.tag)throw m(Error(188));return c.stateNode.current===c?a:b}function Nf(a){a=vi(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}}return null}function zc(a){var b=a.keyCode;"charCode"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:
0}function Of(a){var b=a.targetInst,c=b;do{if(!c){a.ancestors.push(c);break}var d;for(d=c;d.return;)d=d.return;d=3!==d.tag?null:d.stateNode.containerInfo;if(!d)break;a.ancestors.push(c);c=oc(d)}while(c);for(c=0;c<a.ancestors.length;c++){b=a.ancestors[c];var e=xd(a.nativeEvent);d=a.topLevelType;for(var f=a.nativeEvent,g=null,h=0;h<kc.length;h++){var k=kc[h];k&&(k=k.extractEvents(d,b,f,e))&&(g=Za(g,k))}nc(g)}}function v(a,b){Bb(b,a,!1)}function Bb(a,b,c){switch(wi(b)){case 0:var d=xi.bind(null,b,1);
break;case 1:d=yi.bind(null,b,1);break;default:d=Ac.bind(null,b,1)}c?a.addEventListener(b,d,!0):a.addEventListener(b,d,!1)}function xi(a,b,c){Z||wd();var d=Ac,e=Z;Z=!0;try{Pf(d,a,b,c)}finally{(Z=e)||vd()}}function yi(a,b,c){Ac(a,b,c)}function Ac(a,b,c){if(Bc){b=xd(c);b=oc(b);null===b||"number"!==typeof b.tag||2===Ab(b)||(b=null);if(Cc.length){var d=Cc.pop();d.topLevelType=a;d.nativeEvent=c;d.targetInst=b;a=d}else a={topLevelType:a,nativeEvent:c,targetInst:b,ancestors:[]};try{if(c=a,Z)Of(c,void 0);
else{Z=!0;try{Qf(Of,c,void 0)}finally{Z=!1,vd()}}}finally{a.topLevelType=null,a.nativeEvent=null,a.targetInst=null,a.ancestors.length=0,10>Cc.length&&Cc.push(a)}}}function Rf(a){var b=Sf.get(a);void 0===b&&(b=new Set,Sf.set(a,b));return b}function Id(a){a=a||("undefined"!==typeof document?document:void 0);if("undefined"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}function Tf(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Uf(a,b){var c=Tf(a);a=0;for(var d;c;){if(3===
c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=Tf(c)}}function Vf(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?Vf(a,b.parentNode):"contains"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}function Wf(){for(var a=window,b=Id();b instanceof a.HTMLIFrameElement;){try{var c="string"===typeof b.contentWindow.location.href}catch(d){c=
!1}if(c)a=b.contentWindow;else break;b=Id(a.document)}return b}function Jd(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&("input"===b&&("text"===a.type||"search"===a.type||"tel"===a.type||"url"===a.type||"password"===a.type)||"textarea"===b||"true"===a.contentEditable)}function Xf(a,b){var c=b.window===b?b.document:9===b.nodeType?b:b.ownerDocument;if(Kd||null==fb||fb!==Id(c))return null;c=fb;"selectionStart"in c&&Jd(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&
c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset});return Cb&&zb(Cb,c)?null:(Cb=c,a=Q.getPooled(Yf.select,Ld,a,b),a.type="select",a.target=fb,$a(a),a)}function zi(a){var b="";ka.Children.forEach(a,function(a){null!=a&&(b+=a)});return b}function Md(a,b){a=K({children:void 0},b);if(b=zi(b.children))a.children=b;return a}function gb(a,b,c,d){a=a.options;if(b){b={};for(var e=0;e<c.length;e++)b["$"+
c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty("$"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=""+za(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}function Nd(a,b){if(null!=b.dangerouslySetInnerHTML)throw m(Error(91));return K({},b,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function Zf(a,b){var c=
b.value;if(null==c){c=b.defaultValue;b=b.children;if(null!=b){if(null!=c)throw m(Error(92));if(Array.isArray(b)){if(!(1>=b.length))throw m(Error(93));b=b[0]}c=b}null==c&&(c="")}a._wrapperState={initialValue:za(c)}}function $f(a,b){var c=za(b.value),d=za(b.defaultValue);null!=c&&(c=""+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=""+d)}function ag(a){switch(a){case "svg":return"http://www.w3.org/2000/svg";case "math":return"http://www.w3.org/1998/Math/MathML";
default:return"http://www.w3.org/1999/xhtml"}}function Od(a,b){return null==a||"http://www.w3.org/1999/xhtml"===a?ag(b):"http://www.w3.org/2000/svg"===a&&"foreignObject"===b?"http://www.w3.org/1999/xhtml":a}function bg(a,b,c){return null==b||"boolean"===typeof b||""===b?"":c||"number"!==typeof b||0===b||Db.hasOwnProperty(a)&&Db[a]?(""+b).trim():b+"px"}function cg(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf("--"),e=bg(c,b[c],d);"float"===c&&(c="cssFloat");d?a.setProperty(c,
e):a[c]=e}}function Pd(a,b){if(b){if(Ai[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw m(Error(137),a,"");if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw m(Error(60));if(!("object"===typeof b.dangerouslySetInnerHTML&&"__html"in b.dangerouslySetInnerHTML))throw m(Error(61));}if(null!=b.style&&"object"!==typeof b.style)throw m(Error(62),"");}}function Qd(a,b){if(-1===a.indexOf("-"))return"string"===typeof b.is;switch(a){case "annotation-xml":case "color-profile":case "font-face":case "font-face-src":case "font-face-uri":case "font-face-format":case "font-face-name":case "missing-glyph":return!1;
default:return!0}}function na(a,b){a=9===a.nodeType||11===a.nodeType?a:a.ownerDocument;var c=Rf(a);b=ld[b];for(var d=0;d<b.length;d++){var e=b[d];if(!c.has(e)){switch(e){case "scroll":Bb(a,"scroll",!0);break;case "focus":case "blur":Bb(a,"focus",!0);Bb(a,"blur",!0);c.add("blur");c.add("focus");break;case "cancel":case "close":tf(e)&&Bb(a,e,!0);break;case "invalid":case "submit":case "reset":break;default:-1===Eb.indexOf(e)&&v(e,a)}c.add(e)}}}function Dc(){}function dg(a,b){switch(a){case "button":case "input":case "select":case "textarea":return!!b.autoFocus}return!1}
function Rd(a,b){return"textarea"===a||"option"===a||"noscript"===a||"string"===typeof b.children||"number"===typeof b.children||"object"===typeof b.dangerouslySetInnerHTML&&null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}function Fb(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break}return a}function w(a,b){0>hb||(a.current=Sd[hb],Sd[hb]=null,hb--)}function D(a,b,c){hb++;Sd[hb]=a.current;a.current=b}function ib(a,b){var c=a.type.contextTypes;if(!c)return Aa;
var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}function G(a){a=a.childContextTypes;return null!==a&&void 0!==a}function Ec(a){w(M,a);w(I,a)}function Td(a){w(M,a);w(I,a)}function eg(a,b,c){if(I.current!==Aa)throw m(Error(168));D(I,b,a);D(M,c,a)}function fg(a,b,c){var d=
a.stateNode;a=b.childContextTypes;if("function"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in a))throw m(Error(108),xa(b)||"Unknown",e);return K({},c,d)}function Fc(a){var b=a.stateNode;b=b&&b.__reactInternalMemoizedMergedChildContext||Aa;La=I.current;D(I,b,a);D(M,M.current,a);return!0}function gg(a,b,c){var d=a.stateNode;if(!d)throw m(Error(169));c?(b=fg(a,b,La),d.__reactInternalMemoizedMergedChildContext=b,w(M,a),w(I,a),D(I,b,a)):w(M,a);D(M,c,a)}function Ud(){switch(Bi()){case Gc:return 99;
case hg:return 98;case ig:return 97;case jg:return 96;case kg:return 95;default:throw m(Error(332));}}function lg(a){switch(a){case 99:return Gc;case 98:return hg;case 97:return ig;case 96:return jg;case 95:return kg;default:throw m(Error(332));}}function Ma(a,b){a=lg(a);return Ci(a,b)}function Vd(a,b,c){a=lg(a);return Wd(a,b,c)}function Hc(a){null===oa?(oa=[a],Xd=Wd(Gc,mg)):oa.push(a);return ng}function V(){null!==Xd&&og(Xd);mg()}function mg(){if(!Yd&&null!==oa){Yd=!0;var a=0;try{var b=oa;Ma(99,
function(){for(;a<b.length;a++){var c=b[a];do c=c(!0);while(null!==c)}});oa=null}catch(c){throw null!==oa&&(oa=oa.slice(a+1)),Wd(Gc,V),c;}finally{Yd=!1}}}function Zd(a,b){if(1073741823===b)return 99;if(1===b)return 95;a=10*(1073741821-b)-10*(1073741821-a);return 0>=a?99:250>=a?98:5250>=a?97:95}function X(a,b){if(a&&a.defaultProps){b=K({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c])}return b}function Di(a){var b=a._result;switch(a._status){case 1:return b;case 2:throw b;case 0:throw b;
default:a._status=0;b=a._ctor;b=b();b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)});switch(a._status){case 1:return a._result;case 2:throw a._result;}a._result=b;throw b;}}function $d(){Ic=jb=Jc=null}function pg(a,b){var c=a.type._context;D(ae,c._currentValue,a);c._currentValue=b}function be(a){var b=ae.current;w(ae,a);a.type._context._currentValue=b}function qg(a,b){for(;null!==a;){var c=a.alternate;if(a.childExpirationTime<
b)a.childExpirationTime=b,null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);else if(null!==c&&c.childExpirationTime<b)c.childExpirationTime=b;else break;a=a.return}}function kb(a,b){Jc=a;Ic=jb=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(a.expirationTime>=b&&(pa=!0),a.firstContext=null)}function aa(a,b){if(Ic!==a&&!1!==b&&0!==b){if("number"!==typeof b||1073741823===b)Ic=a,b=1073741823;b={context:a,observedBits:b,next:null};if(null===jb){if(null===Jc)throw m(Error(308));jb=b;
Jc.dependencies={expirationTime:0,firstContext:b,responders:null}}else jb=jb.next=b}return a._currentValue}function Kc(a){return{baseState:a,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function ce(a){return{baseState:a.baseState,firstUpdate:a.firstUpdate,lastUpdate:a.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,
lastCapturedEffect:null}}function Ba(a,b){return{expirationTime:a,suspenseConfig:b,tag:rg,payload:null,callback:null,next:null,nextEffect:null}}function Lc(a,b){null===a.lastUpdate?a.firstUpdate=a.lastUpdate=b:(a.lastUpdate.next=b,a.lastUpdate=b)}function Ca(a,b){var c=a.alternate;if(null===c){var d=a.updateQueue;var e=null;null===d&&(d=a.updateQueue=Kc(a.memoizedState))}else d=a.updateQueue,e=c.updateQueue,null===d?null===e?(d=a.updateQueue=Kc(a.memoizedState),e=c.updateQueue=Kc(c.memoizedState)):
d=a.updateQueue=ce(e):null===e&&(e=c.updateQueue=ce(d));null===e||d===e?Lc(d,b):null===d.lastUpdate||null===e.lastUpdate?(Lc(d,b),Lc(e,b)):(Lc(d,b),e.lastUpdate=b)}function sg(a,b){var c=a.updateQueue;c=null===c?a.updateQueue=Kc(a.memoizedState):tg(a,c);null===c.lastCapturedUpdate?c.firstCapturedUpdate=c.lastCapturedUpdate=b:(c.lastCapturedUpdate.next=b,c.lastCapturedUpdate=b)}function tg(a,b){var c=a.alternate;null!==c&&b===c.updateQueue&&(b=a.updateQueue=ce(b));return b}function ug(a,b,c,d,e,f){switch(c.tag){case 1:return a=
c.payload,"function"===typeof a?a.call(f,d,e):a;case 3:a.effectTag=a.effectTag&-2049|64;case rg:a=c.payload;e="function"===typeof a?a.call(f,d,e):a;if(null===e||void 0===e)break;return K({},d,e);case Mc:Da=!0}return d}function Gb(a,b,c,d,e){Da=!1;b=tg(a,b);for(var f=b.baseState,g=null,h=0,k=b.firstUpdate,l=f;null!==k;){var m=k.expirationTime;m<e?(null===g&&(g=k,f=l),h<m&&(h=m)):(wg(m,k.suspenseConfig),l=ug(a,b,k,l,c,d),null!==k.callback&&(a.effectTag|=32,k.nextEffect=null,null===b.lastEffect?b.firstEffect=
b.lastEffect=k:(b.lastEffect.nextEffect=k,b.lastEffect=k)));k=k.next}m=null;for(k=b.firstCapturedUpdate;null!==k;){var n=k.expirationTime;n<e?(null===m&&(m=k,null===g&&(f=l)),h<n&&(h=n)):(l=ug(a,b,k,l,c,d),null!==k.callback&&(a.effectTag|=32,k.nextEffect=null,null===b.lastCapturedEffect?b.firstCapturedEffect=b.lastCapturedEffect=k:(b.lastCapturedEffect.nextEffect=k,b.lastCapturedEffect=k)));k=k.next}null===g&&(b.lastUpdate=null);null===m?b.lastCapturedUpdate=null:a.effectTag|=32;null===g&&null===
m&&(f=l);b.baseState=f;b.firstUpdate=g;b.firstCapturedUpdate=m;a.expirationTime=h;a.memoizedState=l}function xg(a,b,c,d){null!==b.firstCapturedUpdate&&(null!==b.lastUpdate&&(b.lastUpdate.next=b.firstCapturedUpdate,b.lastUpdate=b.lastCapturedUpdate),b.firstCapturedUpdate=b.lastCapturedUpdate=null);yg(b.firstEffect,c);b.firstEffect=b.lastEffect=null;yg(b.firstCapturedEffect,c);b.firstCapturedEffect=b.lastCapturedEffect=null}function yg(a,b){for(;null!==a;){var c=a.callback;if(null!==c){a.callback=null;
var d=b;if("function"!==typeof c)throw m(Error(191),c);c.call(d)}a=a.nextEffect}}function Nc(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:K({},b,c);a.memoizedState=c;d=a.updateQueue;null!==d&&0===a.expirationTime&&(d.baseState=c)}function zg(a,b,c,d,e,f,g){a=a.stateNode;return"function"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,f,g):b.prototype&&b.prototype.isPureReactComponent?!zb(c,d)||!zb(e,f):!0}function Ag(a,b,c,d){var e=!1;d=Aa;var f=b.contextType;"object"===
typeof f&&null!==f?f=aa(f):(d=G(b)?La:I.current,e=b.contextTypes,f=(e=null!==e&&void 0!==e)?ib(a,d):Aa);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Oc;a.stateNode=b;b._reactInternalFiber=a;e&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=d,a.__reactInternalMemoizedMaskedChildContext=f);return b}function Bg(a,b,c,d){a=b.state;"function"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);"function"===typeof b.UNSAFE_componentWillReceiveProps&&
b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Oc.enqueueReplaceState(b,b.state,null)}function de(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs=Cg;var f=b.contextType;"object"===typeof f&&null!==f?e.context=aa(f):(f=G(b)?La:I.current,e.context=ib(a,f));f=a.updateQueue;null!==f&&(Gb(a,f,c,e,d),e.state=a.memoizedState);f=b.getDerivedStateFromProps;"function"===typeof f&&(Nc(a,b,f,c),e.state=a.memoizedState);"function"===typeof b.getDerivedStateFromProps||"function"===typeof e.getSnapshotBeforeUpdate||
"function"!==typeof e.UNSAFE_componentWillMount&&"function"!==typeof e.componentWillMount||(b=e.state,"function"===typeof e.componentWillMount&&e.componentWillMount(),"function"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Oc.enqueueReplaceState(e,e.state,null),f=a.updateQueue,null!==f&&(Gb(a,f,c,e,d),e.state=a.memoizedState));"function"===typeof e.componentDidMount&&(a.effectTag|=4)}function Hb(a,b,c){a=c.ref;if(null!==a&&"function"!==typeof a&&"object"!==typeof a){if(c._owner){c=
c._owner;var d=void 0;if(c){if(1!==c.tag)throw m(Error(309));d=c.stateNode}if(!d)throw m(Error(147),a);var e=""+a;if(null!==b&&null!==b.ref&&"function"===typeof b.ref&&b.ref._stringRef===e)return b.ref;b=function(a){var b=d.refs;b===Cg&&(b=d.refs={});null===a?delete b[e]:b[e]=a};b._stringRef=e;return b}if("string"!==typeof a)throw m(Error(284));if(!c._owner)throw m(Error(290),a);}return a}function Pc(a,b){if("textarea"!==a.type)throw m(Error(31),"[object Object]"===Object.prototype.toString.call(b)?
"object with keys {"+Object.keys(b).join(", ")+"}":b,"");}function Dg(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c;c.nextEffect=null;c.effectTag=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,b),b=b.sibling;return a}function e(a,b,c){a=Na(a,b,c);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return c;
d=b.alternate;if(null!==d)return d=d.index,d<c?(b.effectTag=2,c):d;b.effectTag=2;return c}function g(b){a&&null===b.alternate&&(b.effectTag=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=ee(c,a.mode,d),b.return=a,b;b=e(b,c,d);b.return=a;return b}function k(a,b,c,d){if(null!==b&&b.elementType===c.type)return d=e(b,c.props,d),d.ref=Hb(a,b,c),d.return=a,d;d=Rc(c.type,c.key,c.props,null,a.mode,d);d.ref=Hb(a,b,c);d.return=a;return d}function l(a,b,c,d){if(null===b||4!==b.tag||b.stateNode.containerInfo!==
c.containerInfo||b.stateNode.implementation!==c.implementation)return b=fe(c,a.mode,d),b.return=a,b;b=e(b,c.children||[],d);b.return=a;return b}function n(a,b,c,d,f){if(null===b||7!==b.tag)return b=Ea(c,a.mode,d,f),b.return=a,b;b=e(b,c,d);b.return=a;return b}function q(a,b,c){if("string"===typeof b||"number"===typeof b)return b=ee(""+b,a.mode,c),b.return=a,b;if("object"===typeof b&&null!==b){switch(b.$$typeof){case Sc:return c=Rc(b.type,b.key,b.props,null,a.mode,c),c.ref=Hb(a,null,b),c.return=a,c;
case eb:return b=fe(b,a.mode,c),b.return=a,b}if(Tc(b)||wb(b))return b=Ea(b,a.mode,c,null),b.return=a,b;Pc(a,b)}return null}function x(a,b,c,d){var e=null!==b?b.key:null;if("string"===typeof c||"number"===typeof c)return null!==e?null:h(a,b,""+c,d);if("object"===typeof c&&null!==c){switch(c.$$typeof){case Sc:return c.key===e?c.type===ya?n(a,b,c.props.children,d,e):k(a,b,c,d):null;case eb:return c.key===e?l(a,b,c,d):null}if(Tc(c)||wb(c))return null!==e?null:n(a,b,c,d,null);Pc(a,c)}return null}function u(a,
b,c,d,e){if("string"===typeof d||"number"===typeof d)return a=a.get(c)||null,h(b,a,""+d,e);if("object"===typeof d&&null!==d){switch(d.$$typeof){case Sc:return a=a.get(null===d.key?c:d.key)||null,d.type===ya?n(b,a,d.props.children,e,d.key):k(b,a,d,e);case eb:return a=a.get(null===d.key?c:d.key)||null,l(b,a,d,e)}if(Tc(d)||wb(d))return a=a.get(c)||null,n(b,a,d,e,null);Pc(b,d)}return null}function v(e,g,h,k){for(var l=null,m=null,n=g,r=g=0,y=null;null!==n&&r<h.length;r++){n.index>r?(y=n,n=null):y=n.sibling;
var p=x(e,n,h[r],k);if(null===p){null===n&&(n=y);break}a&&n&&null===p.alternate&&b(e,n);g=f(p,g,r);null===m?l=p:m.sibling=p;m=p;n=y}if(r===h.length)return c(e,n),l;if(null===n){for(;r<h.length;r++)n=q(e,h[r],k),null!==n&&(g=f(n,g,r),null===m?l=n:m.sibling=n,m=n);return l}for(n=d(e,n);r<h.length;r++)y=u(n,e,r,h[r],k),null!==y&&(a&&null!==y.alternate&&n.delete(null===y.key?r:y.key),g=f(y,g,r),null===m?l=y:m.sibling=y,m=y);a&&n.forEach(function(a){return b(e,a)});return l}function z(e,g,h,k){var l=wb(h);
if("function"!==typeof l)throw m(Error(150));h=l.call(h);if(null==h)throw m(Error(151));for(var n=l=null,r=g,y=g=0,Qc=null,p=h.next();null!==r&&!p.done;y++,p=h.next()){r.index>y?(Qc=r,r=null):Qc=r.sibling;var t=x(e,r,p.value,k);if(null===t){null===r&&(r=Qc);break}a&&r&&null===t.alternate&&b(e,r);g=f(t,g,y);null===n?l=t:n.sibling=t;n=t;r=Qc}if(p.done)return c(e,r),l;if(null===r){for(;!p.done;y++,p=h.next())p=q(e,p.value,k),null!==p&&(g=f(p,g,y),null===n?l=p:n.sibling=p,n=p);return l}for(r=d(e,r);!p.done;y++,
p=h.next())p=u(r,e,y,p.value,k),null!==p&&(a&&null!==p.alternate&&r.delete(null===p.key?y:p.key),g=f(p,g,y),null===n?l=p:n.sibling=p,n=p);a&&r.forEach(function(a){return b(e,a)});return l}return function(a,d,f,h){var k="object"===typeof f&&null!==f&&f.type===ya&&null===f.key;k&&(f=f.props.children);var l="object"===typeof f&&null!==f;if(l)switch(f.$$typeof){case Sc:a:{l=f.key;for(k=d;null!==k;){if(k.key===l){if(7===k.tag?f.type===ya:k.elementType===f.type){c(a,k.sibling);d=e(k,f.type===ya?f.props.children:
f.props,h);d.ref=Hb(a,k,f);d.return=a;a=d;break a}c(a,k);break}else b(a,k);k=k.sibling}f.type===ya?(d=Ea(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Rc(f.type,f.key,f.props,null,a.mode,h),h.ref=Hb(a,d,f),h.return=a,a=h)}return g(a);case eb:a:{for(k=f.key;null!==d;){if(d.key===k){if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[],h);d.return=a;a=d;break a}c(a,d);break}else b(a,d);d=d.sibling}d=fe(f,a.mode,
h);d.return=a;a=d}return g(a)}if("string"===typeof f||"number"===typeof f)return f=""+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f,h),d.return=a,a=d):(c(a,d),d=ee(f,a.mode,h),d.return=a,a=d),g(a);if(Tc(f))return v(a,d,f,h);if(wb(f))return z(a,d,f,h);l&&Pc(a,f);if("undefined"===typeof f&&!k)switch(a.tag){case 1:case 0:throw a=a.type,m(Error(152),a.displayName||a.name||"Component");}return c(a,d)}}function Oa(a){if(a===Ib)throw m(Error(174));return a}function ge(a,b){D(Jb,b,a);D(Kb,a,a);D(ba,Ib,a);
var c=b.nodeType;switch(c){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:Od(null,"");break;default:c=8===c?b.parentNode:b,b=c.namespaceURI||null,c=c.tagName,b=Od(b,c)}w(ba,a);D(ba,b,a)}function lb(a){w(ba,a);w(Kb,a);w(Jb,a)}function Fg(a){Oa(Jb.current);var b=Oa(ba.current);var c=Od(b,a.type);b!==c&&(D(Kb,a,a),D(ba,c,a))}function he(a){Kb.current===a&&(w(ba,a),w(Kb,a))}function Uc(a){for(var b=a;null!==b;){if(13===b.tag){if(null!==b.memoizedState)return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==
(b.effectTag&64))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}function S(){throw m(Error(321));}function ie(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!Ka(a[c],b[c]))return!1;return!0}function je(a,b,c,d,e,f){Lb=f;Fa=b;ca=null!==a?a.memoizedState:null;Vc.current=null===ca?Ei:Gg;b=c(d,e);if(Mb){do Mb=!1,Nb+=
1,ca=null!==a?a.memoizedState:null,mb=nb,da=R=F=null,Vc.current=Gg,b=c(d,e);while(Mb);qa=null;Nb=0}Vc.current=Wc;a=Fa;a.memoizedState=nb;a.expirationTime=Ob;a.updateQueue=da;a.effectTag|=Pb;a=null!==F&&null!==F.next;Lb=0;mb=R=nb=ca=F=Fa=null;Ob=0;da=null;Pb=0;if(a)throw m(Error(300));return b}function Hg(){Vc.current=Wc;Lb=0;mb=R=nb=ca=F=Fa=null;Ob=0;da=null;Pb=0;Mb=!1;qa=null;Nb=0}function ob(){var a={memoizedState:null,baseState:null,queue:null,baseUpdate:null,next:null};null===R?nb=R=a:R=R.next=
a;return R}function Qb(){if(null!==mb)R=mb,mb=R.next,F=ca,ca=null!==F?F.next:null;else{if(null===ca)throw m(Error(310));F=ca;var a={memoizedState:F.memoizedState,baseState:F.baseState,queue:F.queue,baseUpdate:F.baseUpdate,next:null};R=null===R?nb=a:R.next=a;ca=F.next}return R}function Ig(a,b){return"function"===typeof b?b(a):b}function Jg(a,b,c){b=Qb();c=b.queue;if(null===c)throw m(Error(311));c.lastRenderedReducer=a;if(0<Nb){var d=c.dispatch;if(null!==qa){var e=qa.get(c);if(void 0!==e){qa.delete(c);
var f=b.memoizedState;do f=a(f,e.action),e=e.next;while(null!==e);Ka(f,b.memoizedState)||(pa=!0);b.memoizedState=f;b.baseUpdate===c.last&&(b.baseState=f);c.lastRenderedState=f;return[f,d]}}return[b.memoizedState,d]}d=c.last;var g=b.baseUpdate;f=b.baseState;null!==g?(null!==d&&(d.next=null),d=g.next):d=null!==d?d.next:null;if(null!==d){var h=e=null,k=d,l=!1;do{var n=k.expirationTime;n<Lb?(l||(l=!0,h=g,e=f),n>Ob&&(Ob=n)):(wg(n,k.suspenseConfig),f=k.eagerReducer===a?k.eagerState:a(f,k.action));g=k;k=
k.next}while(null!==k&&k!==d);l||(h=g,e=f);Ka(f,b.memoizedState)||(pa=!0);b.memoizedState=f;b.baseUpdate=h;b.baseState=e;c.lastRenderedState=f}return[b.memoizedState,c.dispatch]}function ke(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};null===da?(da={lastEffect:null},da.lastEffect=a.next=a):(b=da.lastEffect,null===b?da.lastEffect=a.next=a:(c=b.next,b.next=a,a.next=c,da.lastEffect=a));return a}function le(a,b,c,d){var e=ob();Pb|=a;e.memoizedState=ke(b,c,void 0,void 0===d?null:d)}function me(a,
b,c,d){var e=Qb();d=void 0===d?null:d;var f=void 0;if(null!==F){var g=F.memoizedState;f=g.destroy;if(null!==d&&ie(d,g.deps)){ke(pb,c,f,d);return}}Pb|=a;e.memoizedState=ke(b,c,f,d)}function Kg(a,b){if("function"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function Lg(a,b){}function Mg(a,b,c){if(!(25>Nb))throw m(Error(301));var d=a.alternate;if(a===Fa||null!==d&&d===Fa)if(Mb=!0,a={expirationTime:Lb,suspenseConfig:null,
action:c,eagerReducer:null,eagerState:null,next:null},null===qa&&(qa=new Map),c=qa.get(b),void 0===c)qa.set(b,a);else{for(b=c;null!==b.next;)b=b.next;b.next=a}else{var e=ea(),f=Rb.suspense;e=qb(e,a,f);f={expirationTime:e,suspenseConfig:f,action:c,eagerReducer:null,eagerState:null,next:null};var g=b.last;if(null===g)f.next=f;else{var h=g.next;null!==h&&(f.next=h);g.next=f}b.last=f;if(0===a.expirationTime&&(null===d||0===d.expirationTime)&&(d=b.lastRenderedReducer,null!==d))try{var k=b.lastRenderedState,
l=d(k,c);f.eagerReducer=d;f.eagerState=l;if(Ka(l,k))return}catch(vg){}finally{}Sb(a,e)}}function Ng(a,b){var c=fa(5,null,null,0);c.elementType="DELETED";c.type="DELETED";c.stateNode=b;c.return=a;c.effectTag=8;null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}function Og(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,!0):!1;case 6:return b=""===a.pendingProps||3!==b.nodeType?
null:b,null!==b?(a.stateNode=b,!0):!1;case 13:return!1;default:return!1}}function Pg(a){if(Pa){var b=rb;if(b){var c=b;if(!Og(a,b)){b=Fb(c.nextSibling);if(!b||!Og(a,b)){a.effectTag|=2;Pa=!1;ra=a;return}Ng(ra,c)}ra=a;rb=Fb(b.firstChild)}else a.effectTag|=2,Pa=!1,ra=a}}function Qg(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&18!==a.tag;)a=a.return;ra=a}function Xc(a){if(a!==ra)return!1;if(!Pa)return Qg(a),Pa=!0,!1;var b=a.type;if(5!==a.tag||"head"!==b&&"body"!==b&&!Rd(b,a.memoizedProps))for(b=rb;b;)Ng(a,
b),b=Fb(b.nextSibling);Qg(a);rb=ra?Fb(a.stateNode.nextSibling):null;return!0}function ne(){rb=ra=null;Pa=!1}function T(a,b,c,d){b.child=null===a?oe(b,null,c,d):sb(b,a.child,c,d)}function Rg(a,b,c,d,e){c=c.render;var f=b.ref;kb(b,e);d=je(a,b,c,d,f,e);if(null!==a&&!pa)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,d,e);return b.child}function Sg(a,b,c,d,e,f){if(null===a){var g=c.type;if("function"===typeof g&&!pe(g)&&void 0===
g.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=g,Tg(a,b,g,d,e,f);a=Rc(c.type,null,d,null,b.mode,f);a.ref=b.ref;a.return=b;return b.child=a}g=a.child;if(e<f&&(e=g.memoizedProps,c=c.compare,c=null!==c?c:zb,c(e,d)&&a.ref===b.ref))return sa(a,b,f);b.effectTag|=1;a=Na(g,d,f);a.ref=b.ref;a.return=b;return b.child=a}function Tg(a,b,c,d,e,f){return null!==a&&zb(a.memoizedProps,d)&&a.ref===b.ref&&(pa=!1,e<f)?sa(a,b,f):qe(a,b,c,d,f)}function Ug(a,b){var c=b.ref;if(null===a&&
null!==c||null!==a&&a.ref!==c)b.effectTag|=128}function qe(a,b,c,d,e){var f=G(c)?La:I.current;f=ib(b,f);kb(b,e);c=je(a,b,c,d,f,e);if(null!==a&&!pa)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,c,e);return b.child}function Vg(a,b,c,d,e){if(G(c)){var f=!0;Fc(b)}else f=!1;kb(b,e);if(null===b.stateNode)null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),Ag(b,c,d,e),de(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,
h=b.memoizedProps;g.props=h;var k=g.context,l=c.contextType;"object"===typeof l&&null!==l?l=aa(l):(l=G(c)?La:I.current,l=ib(b,l));var m=c.getDerivedStateFromProps,n="function"===typeof m||"function"===typeof g.getSnapshotBeforeUpdate;n||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||k!==l)&&Bg(b,g,d,l);Da=!1;var q=b.memoizedState;k=g.state=q;var u=b.updateQueue;null!==u&&(Gb(b,u,d,g,e),k=b.memoizedState);h!==d||q!==k||M.current||Da?
("function"===typeof m&&(Nc(b,c,m,d),k=b.memoizedState),(h=Da||zg(b,c,h,d,q,k,l))?(n||"function"!==typeof g.UNSAFE_componentWillMount&&"function"!==typeof g.componentWillMount||("function"===typeof g.componentWillMount&&g.componentWillMount(),"function"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),"function"===typeof g.componentDidMount&&(b.effectTag|=4)):("function"===typeof g.componentDidMount&&(b.effectTag|=4),b.memoizedProps=d,b.memoizedState=k),g.props=d,g.state=k,g.context=
l,d=h):("function"===typeof g.componentDidMount&&(b.effectTag|=4),d=!1)}else g=b.stateNode,h=b.memoizedProps,g.props=b.type===b.elementType?h:X(b.type,h),k=g.context,l=c.contextType,"object"===typeof l&&null!==l?l=aa(l):(l=G(c)?La:I.current,l=ib(b,l)),m=c.getDerivedStateFromProps,(n="function"===typeof m||"function"===typeof g.getSnapshotBeforeUpdate)||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||k!==l)&&Bg(b,g,d,l),Da=!1,k=b.memoizedState,
q=g.state=k,u=b.updateQueue,null!==u&&(Gb(b,u,d,g,e),q=b.memoizedState),h!==d||k!==q||M.current||Da?("function"===typeof m&&(Nc(b,c,m,d),q=b.memoizedState),(m=Da||zg(b,c,h,d,k,q,l))?(n||"function"!==typeof g.UNSAFE_componentWillUpdate&&"function"!==typeof g.componentWillUpdate||("function"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,q,l),"function"===typeof g.UNSAFE_componentWillUpdate&&g.UNSAFE_componentWillUpdate(d,q,l)),"function"===typeof g.componentDidUpdate&&(b.effectTag|=4),"function"===
typeof g.getSnapshotBeforeUpdate&&(b.effectTag|=256)):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=256),b.memoizedProps=d,b.memoizedState=q),g.props=d,g.state=q,g.context=l,d=m):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&k===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&
k===a.memoizedState||(b.effectTag|=256),d=!1);return re(a,b,c,d,f,e)}function re(a,b,c,d,e,f){Ug(a,b);var g=0!==(b.effectTag&64);if(!d&&!g)return e&&gg(b,c,!1),sa(a,b,f);d=b.stateNode;Fi.current=b;var h=g&&"function"!==typeof c.getDerivedStateFromError?null:d.render();b.effectTag|=1;null!==a&&g?(b.child=sb(b,a.child,null,f),b.child=sb(b,null,h,f)):T(a,b,h,f);b.memoizedState=d.state;e&&gg(b,c,!0);return b.child}function Wg(a){var b=a.stateNode;b.pendingContext?eg(a,b.pendingContext,b.pendingContext!==
b.context):b.context&&eg(a,b.context,!1);ge(a,b.containerInfo)}function Xg(a,b,c){var d=b.mode,e=b.pendingProps,f=z.current,g=null,h=!1,k;(k=0!==(b.effectTag&64))||(k=0!==(f&Tb)&&(null===a||null!==a.memoizedState));k?(g=Gi,h=!0,b.effectTag&=-65):null!==a&&null===a.memoizedState||void 0===e.fallback||!0===e.unstable_avoidThisFallback||(f|=se);f&=Ga;D(z,f,b);if(null===a)if(h){e=e.fallback;a=Ea(null,d,0,null);a.return=b;if(0===(b.mode&2))for(h=null!==b.memoizedState?b.child.child:b.child,a.child=h;null!==
h;)h.return=a,h=h.sibling;c=Ea(e,d,c,null);c.return=b;a.sibling=c;d=a}else d=c=oe(b,null,e.children,c);else{if(null!==a.memoizedState)if(f=a.child,d=f.sibling,h){e=e.fallback;c=Na(f,f.pendingProps,0);c.return=b;if(0===(b.mode&2)&&(h=null!==b.memoizedState?b.child.child:b.child,h!==f.child))for(c.child=h;null!==h;)h.return=c,h=h.sibling;e=Na(d,e,d.expirationTime);e.return=b;c.sibling=e;d=c;c.childExpirationTime=0;c=e}else d=c=sb(b,f.child,e.children,c);else if(f=a.child,h){h=e.fallback;e=Ea(null,d,
0,null);e.return=b;e.child=f;null!==f&&(f.return=e);if(0===(b.mode&2))for(f=null!==b.memoizedState?b.child.child:b.child,e.child=f;null!==f;)f.return=e,f=f.sibling;c=Ea(h,d,c,null);c.return=b;e.sibling=c;c.effectTag|=2;d=e;e.childExpirationTime=0}else c=d=sb(b,f,e.children,c);b.stateNode=a.stateNode}b.memoizedState=g;b.child=d;return c}function te(a,b,c,d,e){var f=a.memoizedState;null===f?a.memoizedState={isBackwards:b,rendering:null,last:d,tail:c,tailExpiration:0,tailMode:e}:(f.isBackwards=b,f.rendering=
null,f.last=d,f.tail=c,f.tailExpiration=0,f.tailMode=e)}function Yg(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;T(a,b,d.children,c);d=z.current;if(0!==(d&Tb))d=d&Ga|Tb,b.effectTag|=64;else{if(null!==a&&0!==(a.effectTag&64))a:for(a=b.child;null!==a;){if(13===a.tag){if(null!==a.memoizedState){a.expirationTime<c&&(a.expirationTime=c);var g=a.alternate;null!==g&&g.expirationTime<c&&(g.expirationTime=c);qg(a.return,c)}}else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;
for(;null===a.sibling;){if(null===a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=Ga}D(z,d,b);if(0===(b.mode&2))b.memoizedState=null;else switch(e){case "forwards":c=b.child;for(e=null;null!==c;)d=c.alternate,null!==d&&null===Uc(d)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);te(b,!1,e,c,f);break;case "backwards":c=null;e=b.child;for(b.child=null;null!==e;){d=e.alternate;if(null!==d&&null===Uc(d)){b.child=e;break}d=e.sibling;
e.sibling=c;c=e;e=d}te(b,!0,c,null,f);break;case "together":te(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}function sa(a,b,c){null!==a&&(b.dependencies=a.dependencies);if(b.childExpirationTime<c)return null;if(null!==a&&b.child!==a.child)throw m(Error(153));if(null!==b.child){a=b.child;c=Na(a,a.pendingProps,a.expirationTime);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Na(a,a.pendingProps,a.expirationTime),c.return=b;c.sibling=null}return b.child}
function Ub(a){a.effectTag|=4}function Yc(a,b){switch(a.tailMode){case "hidden":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case "collapsed":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}function Hi(a,b){switch(a.tag){case 1:return G(a.type)&&Ec(a),b=a.effectTag,b&2048?(a.effectTag=b&-2049|64,a):null;case 3:lb(a);Td(a);b=a.effectTag;
if(0!==(b&64))throw m(Error(285));a.effectTag=b&-2049|64;return a;case 5:return he(a),null;case 13:return w(z,a),b=a.effectTag,b&2048?(a.effectTag=b&-2049|64,a):null;case 18:return null;case 19:return w(z,a),null;case 4:return lb(a),null;case 10:return be(a),null;default:return null}}function ue(a,b){return{value:a,source:b,stack:Bd(b)}}function ve(a,b){var c=b.source,d=b.stack;null===d&&null!==c&&(d=Bd(c));null!==c&&xa(c.type);b=b.value;null!==a&&1===a.tag&&xa(a.type);try{console.error(b)}catch(e){setTimeout(function(){throw e;
})}}function Ii(a,b){try{b.props=a.memoizedProps,b.state=a.memoizedState,b.componentWillUnmount()}catch(c){Qa(a,c)}}function Zg(a){var b=a.ref;if(null!==b)if("function"===typeof b)try{b(null)}catch(c){Qa(a,c)}else b.current=null}function Vb(a,b,c){c=c.updateQueue;c=null!==c?c.lastEffect:null;if(null!==c){var d=c=c.next;do{if((d.tag&a)!==pb){var e=d.destroy;d.destroy=void 0;void 0!==e&&e()}(d.tag&b)!==pb&&(e=d.create,d.destroy=e());d=d.next}while(d!==c)}}function $g(a,b){"function"===typeof we&&we(a);
switch(a.tag){case 0:case 11:case 14:case 15:var c=a.updateQueue;if(null!==c&&(c=c.lastEffect,null!==c)){var d=c.next;Ma(97<b?97:b,function(){var b=d;do{var c=b.destroy;if(void 0!==c){var g=a;try{c()}catch(h){Qa(g,h)}}b=b.next}while(b!==d)})}break;case 1:Zg(a);b=a.stateNode;"function"===typeof b.componentWillUnmount&&Ii(a,b);break;case 5:Zg(a);break;case 4:ah(a,b)}}function bh(a,b){for(var c=a;;)if($g(c,b),null!==c.child&&4!==c.tag)c.child.return=c,c=c.child;else{if(c===a)break;for(;null===c.sibling;){if(null===
c.return||c.return===a)return;c=c.return}c.sibling.return=c.return;c=c.sibling}}function ch(a){return 5===a.tag||3===a.tag||4===a.tag}function dh(a){a:{for(var b=a.return;null!==b;){if(ch(b)){var c=b;break a}b=b.return}throw m(Error(160));}b=c.stateNode;switch(c.tag){case 5:var d=!1;break;case 3:b=b.containerInfo;d=!0;break;case 4:b=b.containerInfo;d=!0;break;default:throw m(Error(161));}c.effectTag&16&&(Wb(b,""),c.effectTag&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c.return||ch(c.return)){c=
null;break a}c=c.return}c.sibling.return=c.return;for(c=c.sibling;5!==c.tag&&6!==c.tag&&18!==c.tag;){if(c.effectTag&2)continue b;if(null===c.child||4===c.tag)continue b;else c.child.return=c,c=c.child}if(!(c.effectTag&2)){c=c.stateNode;break a}}for(var e=a;;){var f=5===e.tag||6===e.tag;if(f||20===e.tag){var g=f?e.stateNode:e.stateNode.instance;if(c)if(d){f=b;var h=g;g=c;8===f.nodeType?f.parentNode.insertBefore(h,g):f.insertBefore(h,g)}else b.insertBefore(g,c);else d?(h=b,8===h.nodeType?(f=h.parentNode,
f.insertBefore(g,h)):(f=h,f.appendChild(g)),h=h._reactRootContainer,null!==h&&void 0!==h||null!==f.onclick||(f.onclick=Dc)):b.appendChild(g)}else if(4!==e.tag&&null!==e.child){e.child.return=e;e=e.child;continue}if(e===a)break;for(;null===e.sibling;){if(null===e.return||e.return===a)return;e=e.return}e.sibling.return=e.return;e=e.sibling}}function ah(a,b){for(var c=a,d=!1,e=void 0,f=void 0;;){if(!d){d=c.return;a:for(;;){if(null===d)throw m(Error(160));e=d.stateNode;switch(d.tag){case 5:f=!1;break a;
case 3:e=e.containerInfo;f=!0;break a;case 4:e=e.containerInfo;f=!0;break a}d=d.return}d=!0}if(5===c.tag||6===c.tag)if(bh(c,b),f){var g=e,h=c.stateNode;8===g.nodeType?g.parentNode.removeChild(h):g.removeChild(h)}else e.removeChild(c.stateNode);else if(20===c.tag)h=c.stateNode.instance,bh(c,b),f?(g=e,8===g.nodeType?g.parentNode.removeChild(h):g.removeChild(h)):e.removeChild(h);else if(4===c.tag){if(null!==c.child){e=c.stateNode.containerInfo;f=!0;c.child.return=c;c=c.child;continue}}else if($g(c,b),
null!==c.child){c.child.return=c;c=c.child;continue}if(c===a)break;for(;null===c.sibling;){if(null===c.return||c.return===a)return;c=c.return;4===c.tag&&(d=!1)}c.sibling.return=c.return;c=c.sibling}}function eh(a,b){switch(b.tag){case 0:case 11:case 14:case 15:Vb(Xb,Ji,b);break;case 1:break;case 5:var c=b.stateNode;if(null!=c){var d=b.memoizedProps,e=null!==a?a.memoizedProps:d;a=b.type;var f=b.updateQueue;b.updateQueue=null;if(null!==f){c[pc]=d;"input"===a&&"radio"===d.type&&null!=d.name&&Ff(c,d);
Qd(a,e);b=Qd(a,d);for(e=0;e<f.length;e+=2){var g=f[e],h=f[e+1];"style"===g?cg(c,h):"dangerouslySetInnerHTML"===g?fh(c,h):"children"===g?Wb(c,h):Cd(c,g,h,b)}switch(a){case "input":Ed(c,d);break;case "textarea":$f(c,d);break;case "select":b=c._wrapperState.wasMultiple,c._wrapperState.wasMultiple=!!d.multiple,a=d.value,null!=a?gb(c,!!d.multiple,a,!1):b!==!!d.multiple&&(null!=d.defaultValue?gb(c,!!d.multiple,d.defaultValue,!0):gb(c,!!d.multiple,d.multiple?[]:"",!1))}}}break;case 6:if(null===b.stateNode)throw m(Error(162));
b.stateNode.nodeValue=b.memoizedProps;break;case 3:break;case 12:break;case 13:c=b;null===b.memoizedState?d=!1:(d=!0,c=b.child,xe=Y());if(null!==c)a:for(a=c;;){if(5===a.tag)f=a.stateNode,d?(f=f.style,"function"===typeof f.setProperty?f.setProperty("display","none","important"):f.display="none"):(f=a.stateNode,e=a.memoizedProps.style,e=void 0!==e&&null!==e&&e.hasOwnProperty("display")?e.display:null,f.style.display=bg("display",e));else if(6===a.tag)a.stateNode.nodeValue=d?"":a.memoizedProps;else if(13===
a.tag&&null!==a.memoizedState){f=a.child.sibling;f.return=a;a=f;continue}else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===c)break a;for(;null===a.sibling;){if(null===a.return||a.return===c)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}gh(b);break;case 19:gh(b);break;case 17:break;case 20:break;default:throw m(Error(163));}}function gh(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=new Ki);b.forEach(function(b){var d=Li.bind(null,
a,b);c.has(b)||(c.add(b),b.then(d,d))})}}function hh(a,b,c){c=Ba(c,null);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){Zc||(Zc=!0,ye=d);ve(a,b)};return c}function ih(a,b,c){c=Ba(c,null);c.tag=3;var d=a.type.getDerivedStateFromError;if("function"===typeof d){var e=b.value;c.payload=function(){ve(a,b);return d(e)}}var f=a.stateNode;null!==f&&"function"===typeof f.componentDidCatch&&(c.callback=function(){"function"!==typeof d&&(null===Ha?Ha=new Set([this]):Ha.add(this),ve(a,b));
var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:""})});return c}function ea(){return(q&(ha|ia))!==J?1073741821-(Y()/10|0):0!==$c?$c:$c=1073741821-(Y()/10|0)}function qb(a,b,c){b=b.mode;if(0===(b&2))return 1073741823;var d=Ud();if(0===(b&4))return 99===d?1073741823:1073741822;if((q&ha)!==J)return W;if(null!==c)a=1073741821-25*(((1073741821-a+(c.timeoutMs|0||5E3)/10)/25|0)+1);else switch(d){case 99:a=1073741823;break;case 98:a=1073741821-10*(((1073741821-a+15)/10|0)+1);break;
case 97:case 96:a=1073741821-25*(((1073741821-a+500)/25|0)+1);break;case 95:a=1;break;default:throw m(Error(326));}null!==Ra&&a===W&&--a;return a}function ad(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);var d=a.return,e=null;if(null===d&&3===a.tag)e=a.stateNode;else for(;null!==d;){c=d.alternate;d.childExpirationTime<b&&(d.childExpirationTime=b);null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);if(null===d.return&&3===
d.tag){e=d.stateNode;break}d=d.return}null!==e&&(b>e.firstPendingTime&&(e.firstPendingTime=b),a=e.lastPendingTime,0===a||b<a)&&(e.lastPendingTime=b);return e}function Sa(a,b,c){if(a.callbackExpirationTime<c){var d=a.callbackNode;null!==d&&d!==ng&&og(d);a.callbackExpirationTime=c;1073741823===c?a.callbackNode=Hc(ze.bind(null,a,O.bind(null,a,c))):(d=null,1!==c&&(d={timeout:10*(1073741821-c)-Y()}),a.callbackNode=Vd(b,ze.bind(null,a,O.bind(null,a,c)),d))}}function ze(a,b,c){var d=a.callbackNode,e=null;
try{return e=b(c),null!==e?ze.bind(null,a,e):null}finally{null===e&&d===a.callbackNode&&(a.callbackNode=null,a.callbackExpirationTime=0)}}function Ae(){(q&(1|ha|ia))===J&&(Mi(),Yb())}function Ni(a,b){var c=a.firstBatch;return null!==c&&c._defer&&c._expirationTime>=b?(Vd(97,function(){c._onComplete();return null}),!0):!1}function Mi(){if(null!==Ta){var a=Ta;Ta=null;a.forEach(function(a,c){Hc(O.bind(null,c,a))});V()}}function jh(a,b){var c=q;q|=1;try{return a(b)}finally{q=c,q===J&&V()}}function Be(a,
b,c,d){var e=q;q|=4;try{return Ma(98,a.bind(null,b,c,d))}finally{q=e,q===J&&V()}}function kh(a,b){var c=q;q&=-2;q|=Ce;try{return a(b)}finally{q=c,q===J&&V()}}function Ua(a,b){a.finishedWork=null;a.finishedExpirationTime=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,Oi(c));if(null!==u)for(c=u.return;null!==c;){var d=c;switch(d.tag){case 1:var e=d.type.childContextTypes;null!==e&&void 0!==e&&Ec(d);break;case 3:lb(d);Td(d);break;case 5:he(d);break;case 4:lb(d);break;case 13:w(z,d);break;case 19:w(z,
d);break;case 10:be(d)}c=c.return}Ra=a;u=Na(a.current,null,b);W=b;P=Va;Zb=ta=1073741823;bd=null;$b=!1}function O(a,b,c){if((q&(ha|ia))!==J)throw m(Error(327));if(a.firstPendingTime<b)return null;if(c&&a.finishedExpirationTime===b)return Ia.bind(null,a);Yb();if(a!==Ra||b!==W)Ua(a,b);else if(P===cd)if($b)Ua(a,b);else{var d=a.lastPendingTime;if(d<b)return O.bind(null,a,d)}if(null!==u){d=q;q|=ha;var e=dd.current;null===e&&(e=Wc);dd.current=Wc;if(c){if(1073741823!==b){var f=ea();if(f<b)return q=d,$d(),
dd.current=e,O.bind(null,a,f)}}else $c=0;do try{if(c)for(;null!==u;)u=lh(u);else for(;null!==u&&!Pi();)u=lh(u);break}catch(Eg){$d();Hg();f=u;if(null===f||null===f.return)throw Ua(a,b),q=d,Eg;a:{var g=a,h=f.return,k=f,l=Eg,n=W;k.effectTag|=1024;k.firstEffect=k.lastEffect=null;if(null!==l&&"object"===typeof l&&"function"===typeof l.then){var v=l,x=0!==(z.current&se);l=h;do{var w;if(w=13===l.tag)null!==l.memoizedState?w=!1:(w=l.memoizedProps,w=void 0===w.fallback?!1:!0!==w.unstable_avoidThisFallback?
!0:x?!1:!0);if(w){h=l.updateQueue;null===h?(h=new Set,h.add(v),l.updateQueue=h):h.add(v);if(0===(l.mode&2)){l.effectTag|=64;k.effectTag&=-1957;1===k.tag&&(null===k.alternate?k.tag=17:(n=Ba(1073741823,null),n.tag=Mc,Ca(k,n)));k.expirationTime=1073741823;break a}k=g;g=n;x=k.pingCache;null===x?(x=k.pingCache=new Qi,h=new Set,x.set(v,h)):(h=x.get(v),void 0===h&&(h=new Set,x.set(v,h)));h.has(g)||(h.add(g),k=Ri.bind(null,k,v,g),v.then(k,k));l.effectTag|=2048;l.expirationTime=n;break a}l=l.return}while(null!==
l);l=Error((xa(k.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+Bd(k))}P!==De&&(P=mh);l=ue(l,k);k=h;do{switch(k.tag){case 3:k.effectTag|=2048;k.expirationTime=n;n=hh(k,l,n);sg(k,n);break a;case 1:if(v=l,g=k.type,h=k.stateNode,0===(k.effectTag&64)&&("function"===typeof g.getDerivedStateFromError||null!==h&&"function"===typeof h.componentDidCatch&&
(null===Ha||!Ha.has(h)))){k.effectTag|=2048;k.expirationTime=n;n=ih(k,v,n);sg(k,n);break a}}k=k.return}while(null!==k)}u=nh(f)}while(1);q=d;$d();dd.current=e;if(null!==u)return O.bind(null,a,b)}a.finishedWork=a.current.alternate;a.finishedExpirationTime=b;if(Ni(a,b))return null;Ra=null;switch(P){case Va:throw m(Error(328));case mh:return d=a.lastPendingTime,d<b?O.bind(null,a,d):c?Ia.bind(null,a):(Ua(a,b),Hc(O.bind(null,a,b)),null);case ed:if(1073741823===ta&&!c&&(c=xe+oh-Y(),10<c)){if($b)return Ua(a,
b),O.bind(null,a,b);d=a.lastPendingTime;if(d<b)return O.bind(null,a,d);a.timeoutHandle=Ee(Ia.bind(null,a),c);return null}return Ia.bind(null,a);case cd:if(!c){if($b)return Ua(a,b),O.bind(null,a,b);c=a.lastPendingTime;if(c<b)return O.bind(null,a,c);1073741823!==Zb?c=10*(1073741821-Zb)-Y():1073741823===ta?c=0:(c=10*(1073741821-ta)-5E3,d=Y(),b=10*(1073741821-b)-d,c=d-c,0>c&&(c=0),c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3E3>c?3E3:4320>c?4320:1960*Si(c/1960))-c,b<c&&(c=b));if(10<c)return a.timeoutHandle=
Ee(Ia.bind(null,a),c),null}return Ia.bind(null,a);case De:return!c&&1073741823!==ta&&null!==bd&&(d=ta,e=bd,b=e.busyMinDurationMs|0,0>=b?b=0:(c=e.busyDelayMs|0,d=Y()-(10*(1073741821-d)-(e.timeoutMs|0||5E3)),b=d<=c?0:c+b-d),10<b)?(a.timeoutHandle=Ee(Ia.bind(null,a),b),null):Ia.bind(null,a);default:throw m(Error(329));}}function wg(a,b){a<ta&&1<a&&(ta=a);null!==b&&a<Zb&&1<a&&(Zb=a,bd=b)}function lh(a){var b=ph(a.alternate,a,W);a.memoizedProps=a.pendingProps;null===b&&(b=nh(a));qh.current=null;return b}
function nh(a){u=a;do{var b=u.alternate;a=u.return;if(0===(u.effectTag&1024)){a:{var c=b;b=u;var d=W;var e=b.pendingProps;switch(b.tag){case 2:break;case 16:break;case 15:case 0:break;case 1:G(b.type)&&Ec(b);break;case 3:lb(b);Td(b);e=b.stateNode;e.pendingContext&&(e.context=e.pendingContext,e.pendingContext=null);if(null===c||null===c.child)Xc(b),b.effectTag&=-3;Fe(b);break;case 5:he(b);var f=Oa(Jb.current);d=b.type;if(null!==c&&null!=b.stateNode)rh(c,b,d,e,f),c.ref!==b.ref&&(b.effectTag|=128);else if(e){var g=
Oa(ba.current);if(Xc(b)){d=void 0;e=b.stateNode;c=b.type;g=b.memoizedProps;e[la]=b;e[pc]=g;switch(c){case "iframe":case "object":case "embed":v("load",e);break;case "video":case "audio":for(var h=0;h<Eb.length;h++)v(Eb[h],e);break;case "source":v("error",e);break;case "img":case "image":case "link":v("error",e);v("load",e);break;case "form":v("reset",e);v("submit",e);break;case "details":v("toggle",e);break;case "input":Ef(e,g);v("invalid",e);na(f,"onChange");break;case "select":e._wrapperState={wasMultiple:!!g.multiple};
v("invalid",e);na(f,"onChange");break;case "textarea":Zf(e,g),v("invalid",e),na(f,"onChange")}Pd(c,g);h=null;for(d in g)if(g.hasOwnProperty(d)){var k=g[d];"children"===d?"string"===typeof k?e.textContent!==k&&(h=["children",k]):"number"===typeof k&&e.textContent!==""+k&&(h=["children",""+k]):Ya.hasOwnProperty(d)&&null!=k&&na(f,d)}switch(c){case "input":vc(e);Gf(e,g,!0);break;case "textarea":vc(e);d=e.textContent;d===e._wrapperState.initialValue&&(e.value=d);break;case "select":case "option":break;
default:"function"===typeof g.onClick&&(e.onclick=Dc)}e=h;b.updateQueue=e;(e=null!==e?!0:!1)&&Ub(b)}else{c=9===f.nodeType?f:f.ownerDocument;"http://www.w3.org/1999/xhtml"===g&&(g=ag(d));"http://www.w3.org/1999/xhtml"===g?"script"===d?(c=c.createElement("div"),c.innerHTML="<script>\x3c/script>",c=c.removeChild(c.firstChild)):"string"===typeof e.is?c=c.createElement(d,{is:e.is}):(c=c.createElement(d),"select"===d&&(g=c,e.multiple?g.multiple=!0:e.size&&(g.size=e.size))):c=c.createElementNS(g,d);c[la]=
b;c[pc]=e;sh(c,b,!1,!1);var l=Qd(d,e);switch(d){case "iframe":case "object":case "embed":v("load",c);g=e;break;case "video":case "audio":for(g=0;g<Eb.length;g++)v(Eb[g],c);g=e;break;case "source":v("error",c);g=e;break;case "img":case "image":case "link":v("error",c);v("load",c);g=e;break;case "form":v("reset",c);v("submit",c);g=e;break;case "details":v("toggle",c);g=e;break;case "input":Ef(c,e);g=Dd(c,e);v("invalid",c);na(f,"onChange");break;case "option":g=Md(c,e);break;case "select":c._wrapperState=
{wasMultiple:!!e.multiple};g=K({},e,{value:void 0});v("invalid",c);na(f,"onChange");break;case "textarea":Zf(c,e);g=Nd(c,e);v("invalid",c);na(f,"onChange");break;default:g=e}Pd(d,g);h=void 0;k=d;var n=c,q=g;for(h in q)if(q.hasOwnProperty(h)){var x=q[h];"style"===h?cg(n,x):"dangerouslySetInnerHTML"===h?(x=x?x.__html:void 0,null!=x&&fh(n,x)):"children"===h?"string"===typeof x?("textarea"!==k||""!==x)&&Wb(n,x):"number"===typeof x&&Wb(n,""+x):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==
h&&"autoFocus"!==h&&(Ya.hasOwnProperty(h)?null!=x&&na(f,h):null!=x&&Cd(n,h,x,l))}switch(d){case "input":vc(c);Gf(c,e,!1);break;case "textarea":vc(c);f=c.textContent;f===c._wrapperState.initialValue&&(c.value=f);break;case "option":null!=e.value&&c.setAttribute("value",""+za(e.value));break;case "select":f=c;g=e;f.multiple=!!g.multiple;h=g.value;null!=h?gb(f,!!g.multiple,h,!1):null!=g.defaultValue&&gb(f,!!g.multiple,g.defaultValue,!0);break;default:"function"===typeof g.onClick&&(c.onclick=Dc)}(e=
dg(d,e))&&Ub(b);b.stateNode=c}null!==b.ref&&(b.effectTag|=128)}else if(null===b.stateNode)throw m(Error(166));break;case 6:if(c&&null!=b.stateNode)th(c,b,c.memoizedProps,e);else{if("string"!==typeof e&&null===b.stateNode)throw m(Error(166));d=Oa(Jb.current);Oa(ba.current);Xc(b)?(e=b.stateNode,d=b.memoizedProps,e[la]=b,e.nodeValue!==d&&Ub(b)):(e=(9===d.nodeType?d:d.ownerDocument).createTextNode(e),e[la]=b,b.stateNode=e)}break;case 11:break;case 13:w(z,b);e=b.memoizedState;if(0!==(b.effectTag&64)){b.expirationTime=
d;break a}e=null!==e;d=!1;null===c?Xc(b):(f=c.memoizedState,d=null!==f,e||null===f||(f=c.child.sibling,null!==f&&(g=b.firstEffect,null!==g?(b.firstEffect=f,f.nextEffect=g):(b.firstEffect=b.lastEffect=f,f.nextEffect=null),f.effectTag=8)));if(e&&!d&&0!==(b.mode&2))if(null===c&&!0!==b.memoizedProps.unstable_avoidThisFallback||0!==(z.current&se))P===Va&&(P=ed);else if(P===Va||P===ed)P=cd;if(e||d)b.effectTag|=4;break;case 7:break;case 8:break;case 12:break;case 4:lb(b);Fe(b);break;case 10:be(b);break;
case 9:break;case 14:break;case 17:G(b.type)&&Ec(b);break;case 18:break;case 19:w(z,b);e=b.memoizedState;if(null===e)break;f=0!==(b.effectTag&64);g=e.rendering;if(null===g)if(f)Yc(e,!1);else{if(P!==Va||null!==c&&0!==(c.effectTag&64))for(c=b.child;null!==c;){g=Uc(c);if(null!==g){b.effectTag|=64;Yc(e,!1);e=g.updateQueue;null!==e&&(b.updateQueue=e,b.effectTag|=4);b.firstEffect=b.lastEffect=null;e=d;for(d=b.child;null!==d;)f=d,c=e,f.effectTag&=2,f.nextEffect=null,f.firstEffect=null,f.lastEffect=null,
g=f.alternate,null===g?(f.childExpirationTime=0,f.expirationTime=c,f.child=null,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null):(f.childExpirationTime=g.childExpirationTime,f.expirationTime=g.expirationTime,f.child=g.child,f.memoizedProps=g.memoizedProps,f.memoizedState=g.memoizedState,f.updateQueue=g.updateQueue,c=g.dependencies,f.dependencies=null===c?null:{expirationTime:c.expirationTime,firstContext:c.firstContext,responders:c.responders}),d=d.sibling;D(z,z.current&
Ga|Tb,b);b=b.child;break a}c=c.sibling}}else{if(!f)if(c=Uc(g),null!==c){if(b.effectTag|=64,f=!0,Yc(e,!0),null===e.tail&&"hidden"===e.tailMode){d=c.updateQueue;null!==d&&(b.updateQueue=d,b.effectTag|=4);b=b.lastEffect=e.lastEffect;null!==b&&(b.nextEffect=null);break}}else Y()>e.tailExpiration&&1<d&&(b.effectTag|=64,f=!0,Yc(e,!1),b.expirationTime=b.childExpirationTime=d-1);e.isBackwards?(g.sibling=b.child,b.child=g):(d=e.last,null!==d?d.sibling=g:b.child=g,e.last=g)}if(null!==e.tail){0===e.tailExpiration&&
(e.tailExpiration=Y()+500);d=e.tail;e.rendering=d;e.tail=d.sibling;e.lastEffect=b.lastEffect;d.sibling=null;e=z.current;e=f?e&Ga|Tb:e&Ga;D(z,e,b);b=d;break a}break;case 20:break;default:throw m(Error(156));}b=null}e=u;if(1===W||1!==e.childExpirationTime){d=0;for(f=e.child;null!==f;)c=f.expirationTime,g=f.childExpirationTime,c>d&&(d=c),g>d&&(d=g),f=f.sibling;e.childExpirationTime=d}if(null!==b)return b;null!==a&&0===(a.effectTag&1024)&&(null===a.firstEffect&&(a.firstEffect=u.firstEffect),null!==u.lastEffect&&
(null!==a.lastEffect&&(a.lastEffect.nextEffect=u.firstEffect),a.lastEffect=u.lastEffect),1<u.effectTag&&(null!==a.lastEffect?a.lastEffect.nextEffect=u:a.firstEffect=u,a.lastEffect=u))}else{b=Hi(u,W);if(null!==b)return b.effectTag&=1023,b;null!==a&&(a.firstEffect=a.lastEffect=null,a.effectTag|=1024)}b=u.sibling;if(null!==b)return b;u=a}while(null!==u);P===Va&&(P=De);return null}function Ia(a){var b=Ud();Ma(99,Ti.bind(null,a,b));null!==ac&&Vd(97,function(){Yb();return null});return null}function Ti(a,
b){Yb();if((q&(ha|ia))!==J)throw m(Error(327));var c=a.finishedWork,d=a.finishedExpirationTime;if(null===c)return null;a.finishedWork=null;a.finishedExpirationTime=0;if(c===a.current)throw m(Error(177));a.callbackNode=null;a.callbackExpirationTime=0;var e=c.expirationTime,f=c.childExpirationTime;e=f>e?f:e;a.firstPendingTime=e;e<a.lastPendingTime&&(a.lastPendingTime=e);a===Ra&&(u=Ra=null,W=0);1<c.effectTag?null!==c.lastEffect?(c.lastEffect.nextEffect=c,e=c.firstEffect):e=c:e=c.firstEffect;if(null!==
e){f=q;q|=ia;qh.current=null;Ge=Bc;var g=Wf();if(Jd(g)){if("selectionStart"in g)var h={start:g.selectionStart,end:g.selectionEnd};else a:{h=(h=g.ownerDocument)&&h.defaultView||window;var k=h.getSelection&&h.getSelection();if(k&&0!==k.rangeCount){h=k.anchorNode;var l=k.anchorOffset,v=k.focusNode;k=k.focusOffset;try{h.nodeType,v.nodeType}catch(tb){h=null;break a}var w=0,x=-1,z=-1,D=0,H=0,r=g,y=null;b:for(;;){for(var F;;){r!==h||0!==l&&3!==r.nodeType||(x=w+l);r!==v||0!==k&&3!==r.nodeType||(z=w+k);3===
r.nodeType&&(w+=r.nodeValue.length);if(null===(F=r.firstChild))break;y=r;r=F}for(;;){if(r===g)break b;y===h&&++D===l&&(x=w);y===v&&++H===k&&(z=w);if(null!==(F=r.nextSibling))break;r=y;y=r.parentNode}r=F}h=-1===x||-1===z?null:{start:x,end:z}}else h=null}h=h||{start:0,end:0}}else h=null;He={focusedElem:g,selectionRange:h};Bc=!1;n=e;do try{for(;null!==n;){if(0!==(n.effectTag&256)){var L=n.alternate;g=n;switch(g.tag){case 0:case 11:case 15:Vb(Ui,pb,g);break;case 1:if(g.effectTag&256&&null!==L){var E=
L.memoizedProps,B=L.memoizedState,K=g.stateNode,P=K.getSnapshotBeforeUpdate(g.elementType===g.type?E:X(g.type,E),B);K.__reactInternalSnapshotBeforeUpdate=P}break;case 3:case 5:case 6:case 4:case 17:break;default:throw m(Error(163));}}n=n.nextEffect}}catch(tb){if(null===n)throw m(Error(330));Qa(n,tb);n=n.nextEffect}while(null!==n);n=e;do try{for(L=b;null!==n;){var A=n.effectTag;A&16&&Wb(n.stateNode,"");if(A&128){var p=n.alternate;if(null!==p){var t=p.ref;null!==t&&("function"===typeof t?t(null):t.current=
null)}}switch(A&14){case 2:dh(n);n.effectTag&=-3;break;case 6:dh(n);n.effectTag&=-3;eh(n.alternate,n);break;case 4:eh(n.alternate,n);break;case 8:E=n;ah(E,L);E.return=null;E.child=null;E.memoizedState=null;E.updateQueue=null;E.dependencies=null;var N=E.alternate;null!==N&&(N.return=null,N.child=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null)}n=n.nextEffect}}catch(tb){if(null===n)throw m(Error(330));Qa(n,tb);n=n.nextEffect}while(null!==n);t=He;p=Wf();A=t.focusedElem;L=t.selectionRange;
if(p!==A&&A&&A.ownerDocument&&Vf(A.ownerDocument.documentElement,A)){null!==L&&Jd(A)&&(p=L.start,t=L.end,void 0===t&&(t=p),"selectionStart"in A?(A.selectionStart=p,A.selectionEnd=Math.min(t,A.value.length)):(t=(p=A.ownerDocument||document)&&p.defaultView||window,t.getSelection&&(t=t.getSelection(),E=A.textContent.length,N=Math.min(L.start,E),L=void 0===L.end?N:Math.min(L.end,E),!t.extend&&N>L&&(E=L,L=N,N=E),E=Uf(A,N),B=Uf(A,L),E&&B&&(1!==t.rangeCount||t.anchorNode!==E.node||t.anchorOffset!==E.offset||
t.focusNode!==B.node||t.focusOffset!==B.offset)&&(p=p.createRange(),p.setStart(E.node,E.offset),t.removeAllRanges(),N>L?(t.addRange(p),t.extend(B.node,B.offset)):(p.setEnd(B.node,B.offset),t.addRange(p))))));p=[];for(t=A;t=t.parentNode;)1===t.nodeType&&p.push({element:t,left:t.scrollLeft,top:t.scrollTop});"function"===typeof A.focus&&A.focus();for(A=0;A<p.length;A++)t=p[A],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}He=null;Bc=!!Ge;Ge=null;a.current=c;n=e;do try{for(A=d;null!==n;){var C=
n.effectTag;if(C&36){var G=n.alternate;p=n;t=A;switch(p.tag){case 0:case 11:case 15:Vb(Vi,bc,p);break;case 1:var I=p.stateNode;if(p.effectTag&4)if(null===G)I.componentDidMount();else{var R=p.elementType===p.type?G.memoizedProps:X(p.type,G.memoizedProps);I.componentDidUpdate(R,G.memoizedState,I.__reactInternalSnapshotBeforeUpdate)}var O=p.updateQueue;null!==O&&xg(p,O,I,t);break;case 3:var Q=p.updateQueue;if(null!==Q){N=null;if(null!==p.child)switch(p.child.tag){case 5:N=p.child.stateNode;break;case 1:N=
p.child.stateNode}xg(p,Q,N,t)}break;case 5:var T=p.stateNode;null===G&&p.effectTag&4&&(t=T,dg(p.type,p.memoizedProps)&&t.focus());break;case 6:break;case 4:break;case 12:break;case 13:case 19:case 17:case 20:break;default:throw m(Error(163));}}if(C&128){var M=n.ref;if(null!==M){var U=n.stateNode;switch(n.tag){case 5:var S=U;break;default:S=U}"function"===typeof M?M(S):M.current=S}}C&512&&(Ie=!0);n=n.nextEffect}}catch(tb){if(null===n)throw m(Error(330));Qa(n,tb);n=n.nextEffect}while(null!==n);n=null;
Wi();q=f}else a.current=c;if(Ie)Ie=!1,ac=a,Je=d,Ke=b;else for(n=e;null!==n;)b=n.nextEffect,n.nextEffect=null,n=b;b=a.firstPendingTime;0!==b?(C=ea(),C=Zd(C,b),Sa(a,C,b)):Ha=null;"function"===typeof Le&&Le(c.stateNode,d);1073741823===b?a===Me?cc++:(cc=0,Me=a):cc=0;if(Zc)throw Zc=!1,a=ye,ye=null,a;if((q&Ce)!==J)return null;V();return null}function Yb(){if(null===ac)return!1;var a=ac,b=Je,c=Ke;ac=null;Je=0;Ke=90;return Ma(97<c?97:c,Xi.bind(null,a,b))}function Xi(a,b){if((q&(ha|ia))!==J)throw m(Error(331));
b=q;q|=ia;for(a=a.current.firstEffect;null!==a;){try{var c=a;if(0!==(c.effectTag&512))switch(c.tag){case 0:case 11:case 15:Vb(Ne,pb,c),Vb(pb,Oe,c)}}catch(d){if(null===a)throw m(Error(330));Qa(a,d)}c=a.nextEffect;a.nextEffect=null;a=c}q=b;V();return!0}function uh(a,b,c){b=ue(c,b);b=hh(a,b,1073741823);Ca(a,b);a=ad(a,1073741823);null!==a&&Sa(a,99,1073741823)}function Qa(a,b){if(3===a.tag)uh(a,a,b);else for(var c=a.return;null!==c;){if(3===c.tag){uh(c,a,b);break}else if(1===c.tag){var d=c.stateNode;if("function"===
typeof c.type.getDerivedStateFromError||"function"===typeof d.componentDidCatch&&(null===Ha||!Ha.has(d))){a=ue(b,a);a=ih(c,a,1073741823);Ca(c,a);c=ad(c,1073741823);null!==c&&Sa(c,99,1073741823);break}}c=c.return}}function Ri(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);Ra===a&&W===c?P===cd||P===ed&&1073741823===ta&&Y()-xe<oh?Ua(a,W):$b=!0:a.lastPendingTime<c||(b=a.pingTime,0!==b&&b<c||(a.pingTime=c,a.finishedExpirationTime===c&&(a.finishedExpirationTime=0,a.finishedWork=null),b=ea(),b=Zd(b,c),Sa(a,
b,c)))}function Li(a,b){var c=a.stateNode;null!==c&&c.delete(b);c=ea();b=qb(c,a,null);c=Zd(c,b);a=ad(a,b);null!==a&&Sa(a,c,b)}function Yi(a){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)return!0;try{var c=b.inject(a);Le=function(a,e){try{b.onCommitFiberRoot(c,a,void 0,64===(a.current.effectTag&64))}catch(f){}};we=function(a){try{b.onCommitFiberUnmount(c,a)}catch(e){}}}catch(d){}return!0}function Zi(a,b,c,d){this.tag=
a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.effectTag=0;this.lastEffect=this.firstEffect=this.nextEffect=null;this.childExpirationTime=this.expirationTime=0;this.alternate=null}function pe(a){a=a.prototype;return!(!a||!a.isReactComponent)}function $i(a){if("function"===typeof a)return pe(a)?1:0;if(void 0!==
a&&null!==a){a=a.$$typeof;if(a===zd)return 11;if(a===Ad)return 14}return 2}function Na(a,b,c){c=a.alternate;null===c?(c=fa(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.effectTag=0,c.nextEffect=null,c.firstEffect=null,c.lastEffect=null);c.childExpirationTime=a.childExpirationTime;c.expirationTime=a.expirationTime;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;
b=a.dependencies;c.dependencies=null===b?null:{expirationTime:b.expirationTime,firstContext:b.firstContext,responders:b.responders};c.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}function Rc(a,b,c,d,e,f){var g=2;d=a;if("function"===typeof a)pe(a)&&(g=1);else if("string"===typeof a)g=5;else a:switch(a){case ya:return Ea(c.children,e,f,b);case aj:g=8;e|=7;break;case xf:g=8;e|=1;break;case wc:return a=fa(12,c,b,e|8),a.elementType=wc,a.type=wc,a.expirationTime=f,a;case xc:return a=fa(13,c,b,
e),a.type=xc,a.elementType=xc,a.expirationTime=f,a;case yd:return a=fa(19,c,b,e),a.elementType=yd,a.expirationTime=f,a;default:if("object"===typeof a&&null!==a)switch(a.$$typeof){case zf:g=10;break a;case yf:g=9;break a;case zd:g=11;break a;case Ad:g=14;break a;case Af:g=16;d=null;break a}throw m(Error(130),null==a?a:typeof a,"");}b=fa(g,c,b,e);b.elementType=a;b.type=d;b.expirationTime=f;return b}function Ea(a,b,c,d){a=fa(7,a,d,b);a.expirationTime=c;return a}function ee(a,b,c){a=fa(6,a,null,b);a.expirationTime=
c;return a}function fe(a,b,c){b=fa(4,null!==a.children?a.children:[],a.key,b);b.expirationTime=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}function bj(a,b,c){this.tag=b;this.current=null;this.containerInfo=a;this.pingCache=this.pendingChildren=null;this.finishedExpirationTime=0;this.finishedWork=null;this.timeoutHandle=-1;this.pendingContext=this.context=null;this.hydrate=c;this.callbackNode=this.firstBatch=null;this.pingTime=this.lastPendingTime=
this.firstPendingTime=this.callbackExpirationTime=0}function vh(a,b,c){a=new bj(a,b,c);b=fa(3,null,null,2===b?7:1===b?3:0);a.current=b;return b.stateNode=a}function wh(a,b,c,d,e,f){var g=b.current;a:if(c){c=c._reactInternalFiber;b:{if(2!==Ab(c)||1!==c.tag)throw m(Error(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break b;case 1:if(G(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break b}}h=h.return}while(null!==h);throw m(Error(171));}if(1===c.tag){var k=c.type;if(G(k)){c=
fg(c,k,h);break a}}c=h}else c=Aa;null===b.context?b.context=c:b.pendingContext=c;b=f;e=Ba(d,e);e.payload={element:a};b=void 0===b?null:b;null!==b&&(e.callback=b);Ca(g,e);Sb(g,d);return d}function fd(a,b,c,d){var e=b.current,f=ea(),g=Rb.suspense;e=qb(f,e,g);return wh(a,b,c,e,g,d)}function Pe(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function cj(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;
return{$$typeof:eb,key:null==d?null:""+d,children:a,containerInfo:b,implementation:c}}function dc(a){var b=1073741821-25*(((1073741821-ea()+500)/25|0)+1);b<=xh&&--b;this._expirationTime=xh=b;this._root=a;this._callbacks=this._next=null;this._hasChildren=this._didComplete=!1;this._children=null;this._defer=!0}function ec(){this._callbacks=null;this._didCommit=!1;this._onCommit=this._onCommit.bind(this)}function gd(a,b,c){this._internalRoot=vh(a,b,c)}function hd(a,b){this._internalRoot=vh(a,2,b)}function Wa(a){return!(!a||
1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||" react-mount-point-unstable "!==a.nodeValue))}function dj(a,b){b||(b=a?9===a.nodeType?a.documentElement:a.firstChild:null,b=!(!b||1!==b.nodeType||!b.hasAttribute("data-reactroot")));if(!b)for(var c;c=a.lastChild;)a.removeChild(c);return new gd(a,0,b)}function id(a,b,c,d,e){var f=c._reactRootContainer,g=void 0;if(f){g=f._internalRoot;if("function"===typeof e){var h=e;e=function(){var a=Pe(g);h.call(a)}}fd(b,g,a,e)}else{f=c._reactRootContainer=
dj(c,d);g=f._internalRoot;if("function"===typeof e){var k=e;e=function(){var a=Pe(g);k.call(a)}}kh(function(){fd(b,g,a,e)})}return Pe(g)}function yh(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Wa(b))throw m(Error(200));return cj(a,b,null,c)}if(!ka)throw m(Error(227));var jc=null,Xa={},kc=[],kd={},Ya={},ld={},Vh=function(a,b,c,d,e,f,g,h,k){var l=Array.prototype.slice.call(arguments,3);try{b.apply(c,l)}catch(vg){this.onError(vg)}},ub=!1,lc=null,mc=!1,md=null,Wh={onError:function(a){ub=
!0;lc=a}},od=null,pf=null,bf=null,vb=null,Yh=function(a){if(a){var b=a._dispatchListeners,c=a._dispatchInstances;if(Array.isArray(b))for(var d=0;d<b.length&&!a.isPropagationStopped();d++)af(a,b[d],c[d]);else b&&af(a,b,c);a._dispatchListeners=null;a._dispatchInstances=null;a.isPersistent()||a.constructor.release(a)}},Qe={injectEventPluginOrder:function(a){if(jc)throw m(Error(101));jc=Array.prototype.slice.call(a);Ze()},injectEventPluginsByName:function(a){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){var d=
a[c];if(!Xa.hasOwnProperty(c)||Xa[c]!==d){if(Xa[c])throw m(Error(102),c);Xa[c]=d;b=!0}}b&&Ze()}},zh=Math.random().toString(36).slice(2),la="__reactInternalInstance$"+zh,pc="__reactEventHandlers$"+zh,wa=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),ab={animationend:qc("Animation","AnimationEnd"),animationiteration:qc("Animation","AnimationIteration"),animationstart:qc("Animation","AnimationStart"),transitionend:qc("Transition",
"TransitionEnd")},rd={},ff={};wa&&(ff=document.createElement("div").style,"AnimationEvent"in window||(delete ab.animationend.animation,delete ab.animationiteration.animation,delete ab.animationstart.animation),"TransitionEvent"in window||delete ab.transitionend.transition);var Ah=rc("animationend"),Bh=rc("animationiteration"),Ch=rc("animationstart"),Dh=rc("transitionend"),Eb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),
va=null,sd=null,sc=null,K=ka.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.assign;K(Q.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():"unknown"!==typeof a.returnValue&&(a.returnValue=!1),this.isDefaultPrevented=tc)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():"unknown"!==typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=tc)},persist:function(){this.isPersistent=
tc},isPersistent:uc,destructor:function(){var a=this.constructor.Interface,b;for(b in a)this[b]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null;this.isPropagationStopped=this.isDefaultPrevented=uc;this._dispatchInstances=this._dispatchListeners=null}});Q.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};Q.extend=function(a){function b(){return c.apply(this,
arguments)}var c=this,d=function(){};d.prototype=c.prototype;d=new d;K(d,b.prototype);b.prototype=d;b.prototype.constructor=b;b.Interface=K({},c.Interface,a);b.extend=c.extend;hf(b);return b};hf(Q);var ej=Q.extend({data:null}),fj=Q.extend({data:null}),ci=[9,13,27,32],td=wa&&"CompositionEvent"in window,fc=null;wa&&"documentMode"in document&&(fc=document.documentMode);var gj=wa&&"TextEvent"in window&&!fc,nf=wa&&(!td||fc&&8<fc&&11>=fc),mf=String.fromCharCode(32),ua={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",
captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",
captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},lf=!1,bb=!1,hj={eventTypes:ua,extractEvents:function(a,b,c,d){var e=void 0;var f=void 0;if(td)b:{switch(a){case "compositionstart":e=ua.compositionStart;break b;case "compositionend":e=ua.compositionEnd;break b;case "compositionupdate":e=ua.compositionUpdate;break b}e=void 0}else bb?jf(a,c)&&(e=ua.compositionEnd):"keydown"===a&&229===c.keyCode&&(e=ua.compositionStart);e?(nf&&
"ko"!==c.locale&&(bb||e!==ua.compositionStart?e===ua.compositionEnd&&bb&&(f=gf()):(va=d,sd="value"in va?va.value:va.textContent,bb=!0)),e=ej.getPooled(e,b,c,d),f?e.data=f:(f=kf(c),null!==f&&(e.data=f)),$a(e),f=e):f=null;(a=gj?di(a,c):ei(a,c))?(b=fj.getPooled(ua.beforeInput,b,c,d),b.data=a,$a(b)):b=null;return null===f?b:null===b?f:[f,b]}},ud=null,cb=null,db=null,Gd=function(a,b){return a(b)},Pf=function(a,b,c,d){return a(b,c,d)},wd=function(){},Qf=Gd,Z=!1,fi={color:!0,date:!0,datetime:!0,"datetime-local":!0,
email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},ja=ka.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;ja.hasOwnProperty("ReactCurrentDispatcher")||(ja.ReactCurrentDispatcher={current:null});ja.hasOwnProperty("ReactCurrentBatchConfig")||(ja.ReactCurrentBatchConfig={suspense:null});var hi=/^(.*)[\\\/]/,C="function"===typeof Symbol&&Symbol.for,Sc=C?Symbol.for("react.element"):60103,eb=C?Symbol.for("react.portal"):60106,ya=C?Symbol.for("react.fragment"):
60107,xf=C?Symbol.for("react.strict_mode"):60108,wc=C?Symbol.for("react.profiler"):60114,zf=C?Symbol.for("react.provider"):60109,yf=C?Symbol.for("react.context"):60110,aj=C?Symbol.for("react.concurrent_mode"):60111,zd=C?Symbol.for("react.forward_ref"):60112,xc=C?Symbol.for("react.suspense"):60113,yd=C?Symbol.for("react.suspense_list"):60120,Ad=C?Symbol.for("react.memo"):60115,Af=C?Symbol.for("react.lazy"):60116;C&&Symbol.for("react.fundamental");C&&Symbol.for("react.responder");var wf="function"===
typeof Symbol&&Symbol.iterator,ji=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bf=Object.prototype.hasOwnProperty,Df={},Cf={},H={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){H[a]=
new B(a,0,!1,a,null,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var b=a[0];H[b]=new B(b,1,!1,a[1],null,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){H[a]=new B(a,2,!1,a.toLowerCase(),null,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){H[a]=new B(a,2,!1,a,null,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){H[a]=
new B(a,3,!1,a.toLowerCase(),null,!1)});["checked","multiple","muted","selected"].forEach(function(a){H[a]=new B(a,3,!0,a,null,!1)});["capture","download"].forEach(function(a){H[a]=new B(a,4,!1,a,null,!1)});["cols","rows","size","span"].forEach(function(a){H[a]=new B(a,6,!1,a,null,!1)});["rowSpan","start"].forEach(function(a){H[a]=new B(a,5,!1,a.toLowerCase(),null,!1)});var Re=/[\-:]([a-z])/g,Se=function(a){return a[1].toUpperCase()};"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var b=
a.replace(Re,Se);H[b]=new B(b,1,!1,a,null,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var b=a.replace(Re,Se);H[b]=new B(b,1,!1,a,"http://www.w3.org/1999/xlink",!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var b=a.replace(Re,Se);H[b]=new B(b,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1)});["tabIndex","crossOrigin"].forEach(function(a){H[a]=new B(a,1,!1,a.toLowerCase(),null,!1)});H.xlinkHref=new B("xlinkHref",1,
!1,"xlink:href","http://www.w3.org/1999/xlink",!0);["src","href","action","formAction"].forEach(function(a){H[a]=new B(a,1,!1,a.toLowerCase(),null,!0)});var If={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}},xb=null,yb=null,Te=!1;wa&&(Te=tf("input")&&(!document.documentMode||9<document.documentMode));var ij={eventTypes:If,_isInputEventSupported:Te,extractEvents:function(a,b,c,d){var e=
b?Ja(b):window,f=void 0,g=void 0,h=e.nodeName&&e.nodeName.toLowerCase();"select"===h||"input"===h&&"file"===e.type?f=ni:sf(e)?Te?f=ri:(f=pi,g=oi):(h=e.nodeName)&&"input"===h.toLowerCase()&&("checkbox"===e.type||"radio"===e.type)&&(f=qi);if(f&&(f=f(a,b)))return Hf(f,c,d);g&&g(a,e,b);"blur"===a&&(a=e._wrapperState)&&a.controlled&&"number"===e.type&&Fd(e,"number",e.value)}},gc=Q.extend({view:null,detail:null}),ti={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},Eh=0,Fh=0,Gh=!1,Hh=!1,
hc=gc.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Hd,button:null,buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)},movementX:function(a){if("movementX"in a)return a.movementX;var b=Eh;Eh=a.screenX;return Gh?"mousemove"===a.type?a.screenX-b:0:(Gh=!0,0)},movementY:function(a){if("movementY"in a)return a.movementY;var b=Fh;Fh=
a.screenY;return Hh?"mousemove"===a.type?a.screenY-b:0:(Hh=!0,0)}}),Ih=hc.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),ic={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",
dependencies:["pointerout","pointerover"]}},jj={eventTypes:ic,extractEvents:function(a,b,c,d){var e="mouseover"===a||"pointerover"===a,f="mouseout"===a||"pointerout"===a;if(e&&(c.relatedTarget||c.fromElement)||!f&&!e)return null;e=d.window===d?d:(e=d.ownerDocument)?e.defaultView||e.parentWindow:window;f?(f=b,b=(b=c.relatedTarget||c.toElement)?oc(b):null):f=null;if(f===b)return null;var g=void 0,h=void 0,k=void 0,l=void 0;if("mouseout"===a||"mouseover"===a)g=hc,h=ic.mouseLeave,k=ic.mouseEnter,l="mouse";
else if("pointerout"===a||"pointerover"===a)g=Ih,h=ic.pointerLeave,k=ic.pointerEnter,l="pointer";var m=null==f?e:Ja(f);e=null==b?e:Ja(b);a=g.getPooled(h,f,c,d);a.type=l+"leave";a.target=m;a.relatedTarget=e;c=g.getPooled(k,b,c,d);c.type=l+"enter";c.target=e;c.relatedTarget=m;d=b;if(f&&d)a:{b=f;e=d;l=0;for(g=b;g;g=ma(g))l++;g=0;for(k=e;k;k=ma(k))g++;for(;0<l-g;)b=ma(b),l--;for(;0<g-l;)e=ma(e),g--;for(;l--;){if(b===e||b===e.alternate)break a;b=ma(b);e=ma(e)}b=null}else b=null;e=b;for(b=[];f&&f!==e;){l=
f.alternate;if(null!==l&&l===e)break;b.push(f);f=ma(f)}for(f=[];d&&d!==e;){l=d.alternate;if(null!==l&&l===e)break;f.push(d);d=ma(d)}for(d=0;d<b.length;d++)qd(b[d],"bubbled",a);for(d=f.length;0<d--;)qd(f[d],"captured",c);return[a,c]}},ui=Object.prototype.hasOwnProperty,U=ka.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Scheduler,kj=U.unstable_cancelCallback,Ue=U.unstable_now,lj=U.unstable_scheduleCallback,mj=U.unstable_shouldYield,Jh=U.unstable_requestPaint,nj=U.unstable_runWithPriority,oj=U.unstable_getCurrentPriorityLevel,
pj=U.unstable_ImmediatePriority,qj=U.unstable_UserBlockingPriority,rj=U.unstable_NormalPriority,sj=U.unstable_LowPriority,tj=U.unstable_IdlePriority;new Map;new Map;new Set;new Map;var uj=Q.extend({animationName:null,elapsedTime:null,pseudoElement:null}),vj=Q.extend({clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),wj=gc.extend({relatedTarget:null}),xj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",
Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},
zj=gc.extend({key:function(a){if(a.key){var b=xj[a.key]||a.key;if("Unidentified"!==b)return b}return"keypress"===a.type?(a=zc(a),13===a?"Enter":String.fromCharCode(a)):"keydown"===a.type||"keyup"===a.type?yj[a.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Hd,charCode:function(a){return"keypress"===a.type?zc(a):0},keyCode:function(a){return"keydown"===a.type||"keyup"===a.type?a.keyCode:0},which:function(a){return"keypress"===
a.type?zc(a):"keydown"===a.type||"keyup"===a.type?a.keyCode:0}}),Aj=hc.extend({dataTransfer:null}),Bj=gc.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Hd}),Cj=Q.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),Dj=hc.extend({deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?
-a.wheelDelta:0},deltaZ:null,deltaMode:null}),Kh=[["blur","blur",0],["cancel","cancel",0],["click","click",0],["close","close",0],["contextmenu","contextMenu",0],["copy","copy",0],["cut","cut",0],["auxclick","auxClick",0],["dblclick","doubleClick",0],["dragend","dragEnd",0],["dragstart","dragStart",0],["drop","drop",0],["focus","focus",0],["input","input",0],["invalid","invalid",0],["keydown","keyDown",0],["keypress","keyPress",0],["keyup","keyUp",0],["mousedown","mouseDown",0],["mouseup","mouseUp",
0],["paste","paste",0],["pause","pause",0],["play","play",0],["pointercancel","pointerCancel",0],["pointerdown","pointerDown",0],["pointerup","pointerUp",0],["ratechange","rateChange",0],["reset","reset",0],["seeked","seeked",0],["submit","submit",0],["touchcancel","touchCancel",0],["touchend","touchEnd",0],["touchstart","touchStart",0],["volumechange","volumeChange",0],["drag","drag",1],["dragenter","dragEnter",1],["dragexit","dragExit",1],["dragleave","dragLeave",1],["dragover","dragOver",1],["mousemove",
"mouseMove",1],["mouseout","mouseOut",1],["mouseover","mouseOver",1],["pointermove","pointerMove",1],["pointerout","pointerOut",1],["pointerover","pointerOver",1],["scroll","scroll",1],["toggle","toggle",1],["touchmove","touchMove",1],["wheel","wheel",1],["abort","abort",2],[Ah,"animationEnd",2],[Bh,"animationIteration",2],[Ch,"animationStart",2],["canplay","canPlay",2],["canplaythrough","canPlayThrough",2],["durationchange","durationChange",2],["emptied","emptied",2],["encrypted","encrypted",2],
["ended","ended",2],["error","error",2],["gotpointercapture","gotPointerCapture",2],["load","load",2],["loadeddata","loadedData",2],["loadedmetadata","loadedMetadata",2],["loadstart","loadStart",2],["lostpointercapture","lostPointerCapture",2],["playing","playing",2],["progress","progress",2],["seeking","seeking",2],["stalled","stalled",2],["suspend","suspend",2],["timeupdate","timeUpdate",2],[Dh,"transitionEnd",2],["waiting","waiting",2]],Lh={},Ve={},We=0;for(;We<Kh.length;We++){var Xe=Kh[We],Mh=
Xe[0],Ye=Xe[1],Ej=Xe[2],Nh="on"+(Ye[0].toUpperCase()+Ye.slice(1)),Oh={phasedRegistrationNames:{bubbled:Nh,captured:Nh+"Capture"},dependencies:[Mh],eventPriority:Ej};Lh[Ye]=Oh;Ve[Mh]=Oh}var Ph={eventTypes:Lh,getEventPriority:function(a){a=Ve[a];return void 0!==a?a.eventPriority:2},extractEvents:function(a,b,c,d){var e=Ve[a];if(!e)return null;switch(a){case "keypress":if(0===zc(c))return null;case "keydown":case "keyup":a=zj;break;case "blur":case "focus":a=wj;break;case "click":if(2===c.button)return null;
case "auxclick":case "dblclick":case "mousedown":case "mousemove":case "mouseup":case "mouseout":case "mouseover":case "contextmenu":a=hc;break;case "drag":case "dragend":case "dragenter":case "dragexit":case "dragleave":case "dragover":case "dragstart":case "drop":a=Aj;break;case "touchcancel":case "touchend":case "touchmove":case "touchstart":a=Bj;break;case Ah:case Bh:case Ch:a=uj;break;case Dh:a=Cj;break;case "scroll":a=gc;break;case "wheel":a=Dj;break;case "copy":case "cut":case "paste":a=vj;
break;case "gotpointercapture":case "lostpointercapture":case "pointercancel":case "pointerdown":case "pointermove":case "pointerout":case "pointerover":case "pointerup":a=Ih;break;default:a=Q}b=a.getPooled(e,b,c,d);$a(b);return b}},wi=Ph.getEventPriority,Cc=[],Bc=!0,Sf=new ("function"===typeof WeakMap?WeakMap:Map),Fj=wa&&"documentMode"in document&&11>=document.documentMode,Yf={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},
fb=null,Ld=null,Cb=null,Kd=!1,Gj={eventTypes:Yf,extractEvents:function(a,b,c,d){var e=d.window===d?d.document:9===d.nodeType?d:d.ownerDocument,f;if(!(f=!e)){a:{e=Rf(e);f=ld.onSelect;for(var g=0;g<f.length;g++)if(!e.has(f[g])){e=!1;break a}e=!0}f=!e}if(f)return null;e=b?Ja(b):window;switch(a){case "focus":if(sf(e)||"true"===e.contentEditable)fb=e,Ld=b,Cb=null;break;case "blur":Cb=Ld=fb=null;break;case "mousedown":Kd=!0;break;case "contextmenu":case "mouseup":case "dragend":return Kd=!1,Xf(c,d);case "selectionchange":if(Fj)break;
case "keydown":case "keyup":return Xf(c,d)}return null}};Qe.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" "));(function(a,b,c){od=a;pf=b;bf=c})(pd,df,Ja);Qe.injectEventPluginsByName({SimpleEventPlugin:Ph,EnterLeaveEventPlugin:jj,ChangeEventPlugin:ij,SelectEventPlugin:Gj,BeforeInputEventPlugin:hj});var jd=void 0,fh=function(a){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,
c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if("http://www.w3.org/2000/svg"!==a.namespaceURI||"innerHTML"in a)a.innerHTML=b;else{jd=jd||document.createElement("div");jd.innerHTML="<svg>"+b+"</svg>";for(b=jd.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}}),Wb=function(a,b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b},Db={animationIterationCount:!0,
borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,
strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Hj=["Webkit","ms","Moz","O"];Object.keys(Db).forEach(function(a){Hj.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);Db[b]=Db[a]})});var Ai=K({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),Ge=null,He=null,Ee="function"===typeof setTimeout?setTimeout:void 0,Oi="function"===typeof clearTimeout?clearTimeout:
void 0;new Set;var Sd=[],hb=-1,Aa={},I={current:Aa},M={current:!1},La=Aa,Ci=nj,Wd=lj,og=kj,Bi=oj,Gc=pj,hg=qj,ig=rj,jg=sj,kg=tj,ng={},Pi=mj,Wi=void 0!==Jh?Jh:function(){},oa=null,Xd=null,Yd=!1,Qh=Ue(),Y=1E4>Qh?Ue:function(){return Ue()-Qh},ae={current:null},Jc=null,jb=null,Ic=null,rg=0,Mc=2,Da=!1,Rb=ja.ReactCurrentBatchConfig,Cg=(new ka.Component).refs,Oc={isMounted:function(a){return(a=a._reactInternalFiber)?2===Ab(a):!1},enqueueSetState:function(a,b,c){a=a._reactInternalFiber;var d=ea(),e=Rb.suspense;
d=qb(d,a,e);e=Ba(d,e);e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Ca(a,e);Sb(a,d)},enqueueReplaceState:function(a,b,c){a=a._reactInternalFiber;var d=ea(),e=Rb.suspense;d=qb(d,a,e);e=Ba(d,e);e.tag=1;e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Ca(a,e);Sb(a,d)},enqueueForceUpdate:function(a,b){a=a._reactInternalFiber;var c=ea(),d=Rb.suspense;c=qb(c,a,d);d=Ba(c,d);d.tag=Mc;void 0!==b&&null!==b&&(d.callback=b);Ca(a,d);Sb(a,c)}},Tc=Array.isArray,sb=Dg(!0),oe=Dg(!1),Ib={},ba={current:Ib},Kb={current:Ib},
Jb={current:Ib},Ga=1,se=1,Tb=2,z={current:0},pb=0,Ui=2,Xb=4,Ji=8,Vi=16,bc=32,Oe=64,Ne=128,Vc=ja.ReactCurrentDispatcher,Lb=0,Fa=null,F=null,ca=null,nb=null,R=null,mb=null,Ob=0,da=null,Pb=0,Mb=!1,qa=null,Nb=0,Wc={readContext:aa,useCallback:S,useContext:S,useEffect:S,useImperativeHandle:S,useLayoutEffect:S,useMemo:S,useReducer:S,useRef:S,useState:S,useDebugValue:S,useResponder:S},Ei={readContext:aa,useCallback:function(a,b){ob().memoizedState=[a,void 0===b?null:b];return a},useContext:aa,useEffect:function(a,
b){return le(516,Ne|Oe,a,b)},useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return le(4,Xb|bc,Kg.bind(null,b,a),c)},useLayoutEffect:function(a,b){return le(4,Xb|bc,a,b)},useMemo:function(a,b){var c=ob();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=ob();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a=d.queue={last:null,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};a=a.dispatch=Mg.bind(null,Fa,a);return[d.memoizedState,
a]},useRef:function(a){var b=ob();a={current:a};return b.memoizedState=a},useState:function(a){var b=ob();"function"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a=b.queue={last:null,dispatch:null,lastRenderedReducer:Ig,lastRenderedState:a};a=a.dispatch=Mg.bind(null,Fa,a);return[b.memoizedState,a]},useDebugValue:Lg,useResponder:Lf},Gg={readContext:aa,useCallback:function(a,b){var c=Qb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ie(b,d[1]))return d[0];c.memoizedState=[a,
b];return a},useContext:aa,useEffect:function(a,b){return me(516,Ne|Oe,a,b)},useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return me(4,Xb|bc,Kg.bind(null,b,a),c)},useLayoutEffect:function(a,b){return me(4,Xb|bc,a,b)},useMemo:function(a,b){var c=Qb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ie(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a},useReducer:Jg,useRef:function(a){return Qb().memoizedState},useState:function(a){return Jg(Ig,
a)},useDebugValue:Lg,useResponder:Lf},ra=null,rb=null,Pa=!1,Fi=ja.ReactCurrentOwner,pa=!1,Gi={},sh=void 0,Fe=void 0,rh=void 0,th=void 0;sh=function(a,b,c,d){for(c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(20===c.tag)a.appendChild(c.stateNode.instance);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};Fe=function(a){};
rh=function(a,b,c,d,e){var f=a.memoizedProps;if(f!==d){var g=b.stateNode;Oa(ba.current);a=null;switch(c){case "input":f=Dd(g,f);d=Dd(g,d);a=[];break;case "option":f=Md(g,f);d=Md(g,d);a=[];break;case "select":f=K({},f,{value:void 0});d=K({},d,{value:void 0});a=[];break;case "textarea":f=Nd(g,f);d=Nd(g,d);a=[];break;default:"function"!==typeof f.onClick&&"function"===typeof d.onClick&&(g.onclick=Dc)}Pd(c,d);g=c=void 0;var h=null;for(c in f)if(!d.hasOwnProperty(c)&&f.hasOwnProperty(c)&&null!=f[c])if("style"===
c){var k=f[c];for(g in k)k.hasOwnProperty(g)&&(h||(h={}),h[g]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(Ya.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in d){var l=d[c];k=null!=f?f[c]:void 0;if(d.hasOwnProperty(c)&&l!==k&&(null!=l||null!=k))if("style"===c)if(k){for(g in k)!k.hasOwnProperty(g)||l&&l.hasOwnProperty(g)||(h||(h={}),h[g]="");for(g in l)l.hasOwnProperty(g)&&k[g]!==l[g]&&(h||
(h={}),h[g]=l[g])}else h||(a||(a=[]),a.push(c,h)),h=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,k=k?k.__html:void 0,null!=l&&k!==l&&(a=a||[]).push(c,""+l)):"children"===c?k===l||"string"!==typeof l&&"number"!==typeof l||(a=a||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(Ya.hasOwnProperty(c)?(null!=l&&na(e,c),a||k===l||(a=[])):(a=a||[]).push(c,l))}h&&(a=a||[]).push("style",h);e=a;(b.updateQueue=e)&&Ub(b)}};th=function(a,b,c,d){c!==d&&Ub(b)};var Ki=
"function"===typeof WeakSet?WeakSet:Set,Qi="function"===typeof WeakMap?WeakMap:Map,Si=Math.ceil,dd=ja.ReactCurrentDispatcher,qh=ja.ReactCurrentOwner,J=0,Ce=8,ha=16,ia=32,Va=0,mh=1,ed=2,cd=3,De=4,q=J,Ra=null,u=null,W=0,P=Va,ta=1073741823,Zb=1073741823,bd=null,$b=!1,xe=0,oh=500,n=null,Zc=!1,ye=null,Ha=null,Ie=!1,ac=null,Ke=90,Je=0,Ta=null,cc=0,Me=null,$c=0,xh=0,Sb=function(a,b){if(50<cc)throw cc=0,Me=null,m(Error(185));a=ad(a,b);if(null!==a){a.pingTime=0;var c=Ud();if(1073741823===b)if((q&Ce)!==J&&
(q&(ha|ia))===J)for(var d=O(a,1073741823,!0);null!==d;)d=d(!0);else Sa(a,99,1073741823),q===J&&V();else Sa(a,c,b);(q&4)===J||98!==c&&99!==c||(null===Ta?Ta=new Map([[a,b]]):(c=Ta.get(a),(void 0===c||c>b)&&Ta.set(a,b)))}},ph=void 0;ph=function(a,b,c){var d=b.expirationTime;if(null!==a){var e=b.pendingProps;if(a.memoizedProps!==e||M.current)pa=!0;else if(d<c){pa=!1;switch(b.tag){case 3:Wg(b);ne();break;case 5:Fg(b);if(b.mode&4&&1!==c&&e.hidden)return b.expirationTime=b.childExpirationTime=1,null;break;
case 1:G(b.type)&&Fc(b);break;case 4:ge(b,b.stateNode.containerInfo);break;case 10:pg(b,b.memoizedProps.value);break;case 13:if(null!==b.memoizedState){d=b.child.childExpirationTime;if(0!==d&&d>=c)return Xg(a,b,c);D(z,z.current&Ga,b);b=sa(a,b,c);return null!==b?b.sibling:null}D(z,z.current&Ga,b);break;case 19:d=b.childExpirationTime>=c;if(0!==(a.effectTag&64)){if(d)return Yg(a,b,c);b.effectTag|=64}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null);D(z,z.current,b);if(!d)return null}return sa(a,
b,c)}}else pa=!1;b.expirationTime=0;switch(b.tag){case 2:d=b.type;null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;e=ib(b,I.current);kb(b,c);e=je(null,b,d,a,e,c);b.effectTag|=1;if("object"===typeof e&&null!==e&&"function"===typeof e.render&&void 0===e.$$typeof){b.tag=1;Hg();if(G(d)){var f=!0;Fc(b)}else f=!1;b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null;var g=d.getDerivedStateFromProps;"function"===typeof g&&Nc(b,d,g,a);e.updater=Oc;b.stateNode=e;e._reactInternalFiber=
b;de(b,d,a,c);b=re(null,b,d,!0,f,c)}else b.tag=0,T(null,b,e,c),b=b.child;return b;case 16:e=b.elementType;null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;e=Di(e);b.type=e;f=b.tag=$i(e);a=X(e,a);switch(f){case 0:b=qe(null,b,e,a,c);break;case 1:b=Vg(null,b,e,a,c);break;case 11:b=Rg(null,b,e,a,c);break;case 14:b=Sg(null,b,e,X(e.type,a),d,c);break;default:throw m(Error(306),e,"");}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:X(d,e),qe(a,b,d,e,c);
case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:X(d,e),Vg(a,b,d,e,c);case 3:Wg(b);d=b.updateQueue;if(null===d)throw m(Error(282));e=b.memoizedState;e=null!==e?e.element:null;Gb(b,d,b.pendingProps,null,c);d=b.memoizedState.element;if(d===e)ne(),b=sa(a,b,c);else{e=b.stateNode;if(e=(null===a||null===a.child)&&e.hydrate)rb=Fb(b.stateNode.containerInfo.firstChild),ra=b,e=Pa=!0;e?(b.effectTag|=2,b.child=oe(b,null,d,c)):(T(a,b,d,c),ne());b=b.child}return b;case 5:return Fg(b),null===a&&Pg(b),
d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:null,g=e.children,Rd(d,e)?g=null:null!==f&&Rd(d,f)&&(b.effectTag|=16),Ug(a,b),b.mode&4&&1!==c&&e.hidden?(b.expirationTime=b.childExpirationTime=1,b=null):(T(a,b,g,c),b=b.child),b;case 6:return null===a&&Pg(b),null;case 13:return Xg(a,b,c);case 4:return ge(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=sb(b,null,d,c):T(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:X(d,e),Rg(a,b,d,e,c);case 7:return T(a,
b,b.pendingProps,c),b.child;case 8:return T(a,b,b.pendingProps.children,c),b.child;case 12:return T(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;g=b.memoizedProps;f=e.value;pg(b,f);if(null!==g){var h=g.value;f=Ka(h,f)?0:("function"===typeof d._calculateChangedBits?d._calculateChangedBits(h,f):1073741823)|0;if(0===f){if(g.children===e.children&&!M.current){b=sa(a,b,c);break a}}else for(h=b.child,null!==h&&(h.return=b);null!==h;){var k=h.dependencies;if(null!==
k){g=h.child;for(var l=k.firstContext;null!==l;){if(l.context===d&&0!==(l.observedBits&f)){1===h.tag&&(l=Ba(c,null),l.tag=Mc,Ca(h,l));h.expirationTime<c&&(h.expirationTime=c);l=h.alternate;null!==l&&l.expirationTime<c&&(l.expirationTime=c);qg(h.return,c);k.expirationTime<c&&(k.expirationTime=c);break}l=l.next}}else g=10===h.tag?h.type===b.type?null:h.child:h.child;if(null!==g)g.return=h;else for(g=h;null!==g;){if(g===b){g=null;break}h=g.sibling;if(null!==h){h.return=g.return;g=h;break}g=g.return}h=
g}}T(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,f=b.pendingProps,d=f.children,kb(b,c),e=aa(e,f.unstable_observedBits),d=d(e),b.effectTag|=1,T(a,b,d,c),b.child;case 14:return e=b.type,f=X(e,b.pendingProps),f=X(e.type,f),Sg(a,b,e,f,d,c);case 15:return Tg(a,b,b.type,b.pendingProps,d,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:X(d,e),null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),b.tag=1,G(d)?(a=!0,Fc(b)):a=!1,kb(b,c),Ag(b,d,e,c),de(b,d,e,c),re(null,
b,d,!0,a,c);case 19:return Yg(a,b,c)}throw m(Error(156));};var Le=null,we=null,fa=function(a,b,c,d){return new Zi(a,b,c,d)};ud=function(a,b,c){switch(b){case "input":Ed(a,c);b=c.name;if("radio"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll("input[name="+JSON.stringify(""+b)+'][type="radio"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=pd(d);if(!e)throw m(Error(90));vf(d);Ed(d,e)}}}break;case "textarea":$f(a,c);break;case "select":b=c.value,null!=
b&&gb(a,!!c.multiple,b,!1)}};dc.prototype.render=function(a){if(!this._defer)throw m(Error(250));this._hasChildren=!0;this._children=a;var b=this._root._internalRoot,c=this._expirationTime,d=new ec;wh(a,b,null,c,null,d._onCommit);return d};dc.prototype.then=function(a){if(this._didComplete)a();else{var b=this._callbacks;null===b&&(b=this._callbacks=[]);b.push(a)}};dc.prototype.commit=function(){var a=this._root._internalRoot,b=a.firstBatch;if(!this._defer||null===b)throw m(Error(251));if(this._hasChildren){var c=
this._expirationTime;if(b!==this){this._hasChildren&&(c=this._expirationTime=b._expirationTime,this.render(this._children));for(var d=null,e=b;e!==this;)d=e,e=e._next;if(null===d)throw m(Error(251));d._next=e._next;this._next=b;a.firstBatch=this}this._defer=!1;b=c;if((q&(ha|ia))!==J)throw m(Error(253));Hc(O.bind(null,a,b));V();b=this._next;this._next=null;b=a.firstBatch=b;null!==b&&b._hasChildren&&b.render(b._children)}else this._next=null,this._defer=!1};dc.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=
!0;var a=this._callbacks;if(null!==a)for(var b=0;b<a.length;b++)(0,a[b])()}};ec.prototype.then=function(a){if(this._didCommit)a();else{var b=this._callbacks;null===b&&(b=this._callbacks=[]);b.push(a)}};ec.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var a=this._callbacks;if(null!==a)for(var b=0;b<a.length;b++){var c=a[b];if("function"!==typeof c)throw m(Error(191),c);c()}}};hd.prototype.render=gd.prototype.render=function(a,b){var c=this._internalRoot,d=new ec;b=void 0===
b?null:b;null!==b&&d.then(b);fd(a,c,null,d._onCommit);return d};hd.prototype.unmount=gd.prototype.unmount=function(a){var b=this._internalRoot,c=new ec;a=void 0===a?null:a;null!==a&&c.then(a);fd(null,b,null,c._onCommit);return c};hd.prototype.createBatch=function(){var a=new dc(this),b=a._expirationTime,c=this._internalRoot,d=c.firstBatch;if(null===d)c.firstBatch=a,a._next=null;else{for(c=null;null!==d&&d._expirationTime>=b;)c=d,d=d._next;a._next=d;null!==c&&(c._next=a)}return a};(function(a,b,c,
d){Gd=a;Pf=b;wd=c;Qf=d})(jh,Be,Ae,function(a,b){var c=q;q|=2;try{return a(b)}finally{q=c,q===J&&V()}});var Rh={createPortal:yh,findDOMNode:function(a){if(null==a)a=null;else if(1!==a.nodeType){var b=a._reactInternalFiber;if(void 0===b){if("function"===typeof a.render)throw m(Error(188));throw m(Error(268),Object.keys(a));}a=Nf(b);a=null===a?null:a.stateNode}return a},hydrate:function(a,b,c){if(!Wa(b))throw m(Error(200));return id(null,a,b,!0,c)},render:function(a,b,c){if(!Wa(b))throw m(Error(200));
return id(null,a,b,!1,c)},unstable_renderSubtreeIntoContainer:function(a,b,c,d){if(!Wa(c))throw m(Error(200));if(null==a||void 0===a._reactInternalFiber)throw m(Error(38));return id(a,b,c,!1,d)},unmountComponentAtNode:function(a){if(!Wa(a))throw m(Error(40));return a._reactRootContainer?(kh(function(){id(null,null,a,!1,function(){a._reactRootContainer=null})}),!0):!1},unstable_createPortal:function(){return yh.apply(void 0,arguments)},unstable_batchedUpdates:jh,unstable_interactiveUpdates:function(a,
b,c,d){Ae();return Be(a,b,c,d)},unstable_discreteUpdates:Be,unstable_flushDiscreteUpdates:Ae,flushSync:function(a,b){if((q&(ha|ia))!==J)throw m(Error(187));var c=q;q|=1;try{return Ma(99,a.bind(null,b))}finally{q=c,V()}},unstable_createRoot:function(a,b){if(!Wa(a))throw m(Error(299),"unstable_createRoot");return new hd(a,null!=b&&!0===b.hydrate)},unstable_createSyncRoot:function(a,b){if(!Wa(a))throw m(Error(299),"unstable_createRoot");return new gd(a,1,null!=b&&!0===b.hydrate)},unstable_flushControlled:function(a){var b=
q;q|=1;try{Ma(99,a)}finally{q=b,q===J&&V()}},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{Events:[df,Ja,pd,Qe.injectEventPluginsByName,kd,$a,function(a){nd(a,$h)},qf,rf,Ac,nc,Yb,{current:!1}]}};(function(a){var b=a.findFiberByHostInstance;return Yi(K({},a,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ja.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=Nf(a);return null===a?null:a.stateNode},findFiberByHostInstance:function(a){return b?
b(a):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))})({findFiberByHostInstance:oc,bundleType:0,version:"16.9.0",rendererPackageName:"react-dom"});var Sh={default:Rh},Th=Sh&&Rh||Sh;return Th.default||Th});
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:react', location = '/static/lib/react/react-dom-AMD.js' */
define("react-dom",function(){return window.ReactDOM});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:react', location = '/static/lib/react/prop-types.js' */
!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.PropTypes=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function emptyFunction(){}function emptyFunctionWithReset(){}var ReactPropTypesSecret=require(3);emptyFunctionWithReset.resetWarningCache=emptyFunction,module.exports=function(){function e(e,t,n,r,o,p){if(p!==ReactPropTypesSecret){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return n.PropTypes=n,n}},{3:3}],2:[function(require,module,exports){module.exports=require(1)()},{1:1}],3:[function(require,module,exports){"use strict";module.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},{}]},{},[2])(2)});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:react', location = '/static/lib/react/prop-types-AMD.js' */
define("prop-types",function(){return window.PropTypes});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:reselect', location = '/static/lib/redux/reselect.js' */
(function(e,f){if("function"===typeof define&&define.amd)define("Reselect",["exports"],f);else if("undefined"!==typeof exports)f(exports);else{var h={};f(h);e.Reselect=h}})(this,function(e){function f(a,c){return a===c}function h(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f,k=null,d=null;return function(){a:{var b=k;var m=arguments;if(null===b||null===m||b.length!==m.length)b=!1;else{for(var n=b.length,g=0;g<n;g++)if(!c(b[g],m[g])){b=!1;break a}b=!0}}b||(d=a.apply(null,arguments));
k=arguments;return d}}function p(a){a=Array.isArray(a[0])?a[0]:a;if(!a.every(function(a){return"function"===typeof a}))throw a=a.map(function(a){return typeof a}).join(", "),Error("Selector creators expect all input-selectors to be functions, "+("instead received the following types: ["+a+"]"));return a}function l(a){for(var c=arguments.length,k=Array(1<c?c-1:0),d=1;d<c;d++)k[d-1]=arguments[d];return function(){for(var b=arguments.length,d=Array(b),c=0;c<b;c++)d[c]=arguments[c];var g=0,e=d.pop(),
f=p(d),l=a.apply(void 0,[function(){g++;return e.apply(null,arguments)}].concat(k));b=h(function(){for(var a=[],b=f.length,d=0;d<b;d++)a.push(f[d].apply(null,arguments));return l.apply(null,a)});b.resultFunc=e;b.recomputations=function(){return g};b.resetRecomputations=function(){return g=0};return b}}e.__esModule=!0;e.defaultMemoize=h;e.createSelectorCreator=l;e.createStructuredSelector=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:q;if("object"!==typeof a)throw Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+
typeof a);var e=Object.keys(a);return c(e.map(function(d){return a[d]}),function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return b.reduce(function(a,b,c){a[e[c]]=b;return a},{})})};var q=e.createSelector=l(h)});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:reselect', location = '/static/lib/redux/reselect-AMD.js' */
define("reselect",function(){return window.Reselect});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:rest-actor-util', location = '/static/bitbucket/internal/util/rest-actor.js' */
define("bitbucket/internal/util/rest-actor",["exports","lodash","bitbucket/util/server"],function(a,h,k){function g(a,f,b){f in a?Object.defineProperty(a,f,{value:b,enumerable:!0,configurable:!0,writable:!0}):a[f]=b;return a}Object.defineProperty(a,"__esModule",{value:!0});a.restActorsForTypes=a.restActorForType=a.promiseRequestFailure=a.requestFailure=a.requestAborted=a.requestSuccess=a.NO_FILTER=a.DEFAULT_PAGE_SIZE=a.REQUEST_ABORTED=a.REQUEST_SUCCESS=a.REQUEST_FAILURE=a.duplicateStrategy=void 0;
a.duplicateStrategy={ABORT_OLD:"ABORT_OLD",DEFAULT:"DEFAULT",DROP_NEW:"DROP_NEW"};var m=a.REQUEST_FAILURE="REQUEST_FAILURE",r=a.REQUEST_SUCCESS="REQUEST_SUCCESS",t=a.REQUEST_ABORTED="REQUEST_ABORTED";a.DEFAULT_PAGE_SIZE=25;a.NO_FILTER="";var q=a.requestSuccess=function(a,f,b,c){return function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return b({type:(0,h.get)(a,"meta.successType",r),payload:(0,h.isFunction)(c)?c(e):e,meta:{originalAction:a,request:f}})}},u=a.requestAborted=
function(a,f,b){return b({type:(0,h.get)(a,"meta.abortedType",t),payload:null,meta:{originalAction:a,request:f}})},v=a.requestFailure=function(a,f,b){return function(c,e,k){var l=null;if(c){l=c.responseText;try{l=JSON.parse(c.responseText)}catch(y){}}return b({type:(0,h.get)(a,"meta.failureType",m),payload:{textStatus:e,error:k,response:l},meta:{originalAction:a,request:f}})}},w=a.promiseRequestFailure=function(a,f,b){return function(c){return b({type:(0,h.get)(a,"meta.failureType",m),payload:{error:c},
meta:{originalAction:a,request:f}})}},x=a.restActorForType=function(a,f){var b,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},e=c.duplicateStrategy,n=void 0===e?"DEFAULT":e,l=c.successTransform;c=c.restTransport;var m=void 0===c?k.rest:c,p=(b={},g(b,k.method.DELETE,{}),g(b,k.method.GET,{}),g(b,k.method.PATCH,{}),g(b,k.method.POST,{}),g(b,k.method.PUT,{}),b);b=function(b,c,e){if(b.type===a){var d=f(b,e);if(null===d)u(b,d,c);else if(d.type=d.type||k.method.GET,e=(0,h.get)(p,[d.type,d.url]),
"DROP_NEW"!==n||!e){"ABORT_OLD"===n&&e&&e.abort&&e.abort();var g=m(d);"function"===typeof g.fail?g.done(q(b,d,c,l)).fail(v(b,d,c)):g.then(q(b,d,c,l),w(b,d,c));"DROP_NEW"!==n&&"ABORT_OLD"!==n||(0,h.set)(p,[d.type,d.url],g.always(function(){(0,h.get)(p,[d.type,d.url])===g&&(0,h.unset)(p,[d.type,d.url])}))}}};Object.defineProperty(b,"name",{value:"restActorFor_"+a,writable:!1});return b};a.restActorsForTypes=function(a){return(0,h.map)(a,function(a,b){return x(b,a)})}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:store', location = '/static/bitbucket/internal/util/store/selectors.js' */
define("bitbucket/internal/util/store/selectors",["exports","lodash","reselect","bitbucket/internal/util/store/reducers"],function(c,f,e,n){function k(a){if(Array.isArray(a)){for(var b=0,g=Array(a.length);b<a.length;b++)g[b]=a[b];return g}return Array.from(a)}Object.defineProperty(c,"__esModule",{value:!0});c._defaultTransform=c.getSelectorsForApp=c.keyPathForProps=c.singlePropSelector=c.filteredPropsSelector=void 0;var p=function(a){return function(){for(var b=arguments.length,g=Array(b),d=0;d<b;d++)g[d]=
arguments[d];return a.reduce(function(a,b,d){a[b]=g[d];return a},{})}},q=c.filteredPropsSelector=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:p(a),g=a.map(function(a){return function(b){return b[a]}}),d=(0,e.createSelector)(g,b);return function(a,b){return d(b)}};c.singlePropSelector=function(a){return q([a],function(a){return a})};var r=c.keyPathForProps=function(a,b){return a.map(function(a){return(0,n.getKeyFromProp)(a,b)})},t=function(){var a=0<arguments.length&&void 0!==
arguments[0]?arguments[0]:{},b=arguments[1],g=arguments[2];return function(d){var c=d.payload,f=d.type,e=c.requestType;if(g)return c=g(d),["requests"].concat(k(c));d=["requests",f];return e?[].concat(d,[e],k(r(a[e],c))):[].concat(d,[b(c)])}};c.getSelectorsForApp=function(a){var b=a.appName,c=a.getId,d=t(a.requestTypeKeyProps,c,a.requestKeyCreator),l=function(a){return(0,f.get)(a,b)},m=(0,e.createSelector)([l],function(a){return(0,f.get)(a,"entities")}),h=function(a){return(0,e.createSelector)([l,
a],function(a,b){return(0,f.get)(a,d(b))})},k=function(a){return(0,e.createSelector)([h(a)],function(a){return(0,f.get)(a,"pagingMeta",{})})};return{getAllFetchedForRequest:function(a){return(0,e.createSelector)([k(a)],function(a){return(0,f.get)(a,"isLastPage",!1)})},getAppState:l,getEntities:m,getEntitiesForRequest:function(a){return(0,e.createSelector)([h(a),m],function(a,b){return(a=(0,f.get)(a,"ids"))&&a.length?a.map(function(a){return b[a]}):n.EMPTY_ARRAY})},getEntity:function(a){return(0,e.createSelector)([m,
a],function(a,b){return(0,f.get)(a,c(b))})},getLoadingForRequest:function(a){return(0,e.createSelector)([h(a)],function(a){return(0,f.get)(a,"loading",!1)})},getPagingMetaForRequest:k,getResponseForRequest:function(a){return(0,e.createSelector)([h(a)],function(a){return(0,f.get)(a,"response",null)})},getErrorsForRequest:function(a){return(0,e.createSelector)([h(a)],function(a){return(0,f.get)(a,"errors",null)})},getRequestInfo:h}};c._defaultTransform=p});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:store', location = '/static/bitbucket/internal/util/store/commit.js' */
define("bitbucket/internal/util/store/commit","exports lodash redux reselect bitbucket/util/navbuilder bitbucket/util/server bitbucket/internal/enums bitbucket/internal/util/entity bitbucket/internal/util/rest-actor ./reducers ./selectors ./store".split(" "),function(g,r,n,c,h,t,u,b,D,y,E,f){function k(a,v,b){v in a?Object.defineProperty(a,v,{value:b,enumerable:!0,configurable:!0,writable:!0}):a[v]=b;return a}Object.defineProperty(g,"__esModule",{value:!0});g._reducer=g._actors=g.selectors=g.actionCreators=
void 0;var w=h&&h.__esModule?h:{default:h};h=f&&f.__esModule?f:{default:f};var l,m,p;t=(0,h.default)();f=u.Entity.COMMIT;var z=u.Entity.PULL_REQUEST,A=u.Entity.REPOSITORY;h=(0,D.restActorsForTypes)((l={},k(l,"LOAD_COMMIT",function(a){var b=a.payload;a=b.repository;b=b.commit;return{url:w.default.rest().repository(a).commit(b.id).withParams({avatarSize:u.AvatarSize.SMALL}).build()}}),k(l,"LOAD_COMMITS",function(a,b){var c=F(function(){return a})(b);if((0,r.get)(c,"loading"))return null;if((0,r.get)(c,
"pagingMeta.isLastPage"))throw Error("Cannot request beyond the last page");b=(0,r.get)(c,"pagingMeta.nextPageStart",0);var d=a.payload,e=d.requestType,g=d.followRenames,h=d.from,k=d.fromRepo,v=d.ignoreMissing,f=d.limit;c=void 0===f?(0,r.get)(c,"pagingMeta.limit",D.DEFAULT_PAGE_SIZE):f;f=d.merges;var l=d.path,n=d.pullRequest,m=d.repository,p=d.since,q=d.to,t=d.until;d=d.withCounts;var x=void 0;switch(e){case "COMPARE":x=w.default.rest().repository(m).compare().commits().withDefinedParams({from:h,
to:q,fromRepo:k});break;case A:x=w.default.rest().repository(m).commits().withDefinedParams({followRenames:g,ignoreMissing:v,merges:f,path:l,since:p,until:t,withCounts:d});break;case z:x=w.default.rest().pullRequest(n).commits().withDefinedParams({withCounts:d});break;default:throw Error("Invalid request type");}return{url:x.withParams({avatarSize:u.AvatarSize.SMALL,limit:c,start:b}).build()}}),l));t.addActors(h);l=(m={},k(m,"COMPARE",[["repository",b.getRepositoryId],"from","fromRepo","limit","repository",
"to"]),k(m,z,[["pullRequest",b.getPullRequestId],"pullRequest.fromRef.latestCommit","pullRequest.toRef.latestCommit","withCounts"]),k(m,A,[["repository",b.getRepositoryId],"followRenames","ignoreMissing","merges","path","repository","since","until","withCounts"]),m);n=(0,n.combineReducers)({entities:(0,y.entitiesReducer)({loadPageSuccess:["LOAD_COMMITS_SUCCESS"],loadSingleSuccess:["LOAD_COMMIT_SUCCESS","SET_COMMIT"]},b.getCommitId),requests:(0,n.combineReducers)((p={},k(p,"LOAD_COMMIT",(0,y.singleEntityRequestReducer)({start:"LOAD_COMMIT",
end:["LOAD_COMMIT_FAILURE","LOAD_COMMIT_SUCCESS"],getId:b.getCommitId})),k(p,"LOAD_COMMITS",(0,y.getRequestPageReducersByType)({requestTypeKeyProps:l,getId:b.getCommitId,LOAD_PAGE:"LOAD_COMMITS",LOAD_PAGE_FAILURE:"LOAD_COMMITS_FAILURE",LOAD_PAGE_SUCCESS:"LOAD_COMMITS_SUCCESS"})),p))});t.addReducers(k({},f,n));var e=g.actionCreators={loadCommit:function(a){return{type:"LOAD_COMMIT",payload:{repository:a.repository,commit:a.commit},meta:{successType:"LOAD_COMMIT_SUCCESS",failureType:"LOAD_COMMIT_FAILURE"}}},
setCommit:function(a){return{type:"SET_COMMIT",payload:a}},loadCompareCommits:function(a){return{type:"LOAD_COMMITS",payload:{requestType:"COMPARE",from:a.from,fromRepo:a.fromRepo,limit:a.limit,repository:a.repository,to:a.to},meta:{successType:"LOAD_COMMITS_SUCCESS",failureType:"LOAD_COMMITS_FAILURE"}}},loadPullRequestCommits:function(a){var b=a.withCounts;return{type:"LOAD_COMMITS",payload:{requestType:z,limit:a.limit,pullRequest:a.pullRequest,withCounts:void 0===b?!0:b},meta:{successType:"LOAD_COMMITS_SUCCESS",
failureType:"LOAD_COMMITS_FAILURE"}}},loadRepositoryCommits:function(a){return{type:"LOAD_COMMITS",payload:{requestType:A,followRenames:a.followRenames,ignoreMissing:a.ignoreMissing,limit:a.limit,merges:a.merges,path:a.path,repository:a.repository,since:a.since,until:a.until,withCounts:a.withCounts},meta:{successType:"LOAD_COMMITS_SUCCESS",failureType:"LOAD_COMMITS_FAILURE"}}}};b=(0,E.getSelectorsForApp)({appName:f,getId:b.getCommitId,requestTypeKeyProps:l});var F=b.getRequestInfo,B=b.getEntitiesForRequest,
G=b.getPagingMetaForRequest,q=b.getLoadingForRequest,C=b.getAllFetchedForRequest,H=function(a){return G((0,c.createSelector)([a],e.loadPullRequestCommits))};g.selectors={getCommit:b.getEntity,getCommitLoading:function(a){return q((0,c.createSelector)([a],e.loadCommit))},getPullRequestCommits:function(a){return B((0,c.createSelector)([a],e.loadPullRequestCommits))},getPullRequestsCommitsTotal:function(a){return(0,c.createSelector)([H(a)],function(a){return(0,r.get)(a,"totalCount",0)})},getPullRequestCommitsLoading:function(a){return q((0,
c.createSelector)([a],e.loadPullRequestCommits))},getPullRequestCommitsAllFetched:function(a){return C((0,c.createSelector)([a],e.loadPullRequestCommits))},getRepositoryCommits:function(a){return B((0,c.createSelector)([a],e.loadRepositoryCommits))},getRepositoryCommitsLoading:function(a){return q((0,c.createSelector)([a],e.loadRepositoryCommits))},getRepositoryCommitsAllFetched:function(a){return C((0,c.createSelector)([a],e.loadRepositoryCommits))},getCompareCommits:function(a){return B((0,c.createSelector)([a],
e.loadCompareCommits))},getCompareCommitsLoading:function(a){return q((0,c.createSelector)([a],e.loadCompareCommits))},getCompareCommitsAllFetched:function(a){return C((0,c.createSelector)([a],e.loadCompareCommits))}};g._actors=h;g._reducer=n});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:store', location = '/static/bitbucket/internal/util/store/project.js' */
define("bitbucket/internal/util/store/project","exports lodash redux reselect bitbucket/util/navbuilder bitbucket/util/server bitbucket/internal/enums bitbucket/internal/util/entity bitbucket/internal/util/rest-actor ./reducers ./selectors ./store".split(" "),function(b,n,h,k,d,w,t,c,u,p,x,g){function e(a,c,b){c in a?Object.defineProperty(a,c,{value:b,enumerable:!0,configurable:!0,writable:!0}):a[c]=b;return a}Object.defineProperty(b,"__esModule",{value:!0});b._reducer=b._actors=b.selectors=b.actionCreators=
void 0;var q=d&&d.__esModule?d:{default:d};d=g&&g.__esModule?g:{default:g};var f,l;g=(0,d.default)();var v=t.Entity.PROJECT;d=(0,u.restActorsForTypes)((f={},e(f,"LOAD_PROJECT",function(a){a=a.payload;return{url:q.default.rest().project(a).build()}}),e(f,"SAVE_PROJECT",function(a){a=a.payload;return{url:q.default.rest().project(a).build(),type:w.method.PUT,data:a}}),e(f,"LOAD_PROJECTS",function(a,c){var b=y(a)(c);if((0,n.get)(b,"loading"))return null;if((0,n.get)(b,"pagingMeta.isLastPage"))throw Error("Cannot request beyond the last page");
c=(0,n.get)(b,"pagingMeta.nextPageStart",0);var d=a.payload;a=d.filter;var e=d.permission;d=d.limit;b=void 0===d?(0,n.get)(b,"pagingMeta.limit",u.DEFAULT_PAGE_SIZE):d;return{url:q.default.rest().projects().withDefinedParams({avatarSize:t.AvatarSize.SMALL,name:a,permission:e,limit:b,start:c}).build()}}),f));g.addActors(d);f=e({},"ALL",["filter","permission"]);h=(0,h.combineReducers)({entities:(0,p.entitiesReducer)({loadPageSuccess:["LOAD_PROJECTS_SUCCESS"],loadSingleSuccess:["LOAD_PROJECT_SUCCESS",
"SAVE_PROJECT_SUCCESS","SET_PROJECT"]},c.getProjectId),requests:(0,h.combineReducers)((l={},e(l,"LOAD_PROJECT",(0,p.singleEntityRequestReducer)({start:"LOAD_PROJECT",end:["LOAD_PROJECT_FAILURE","LOAD_PROJECT_SUCCESS"],getId:c.getProjectId})),e(l,"SAVE_PROJECT",(0,p.singleEntityRequestReducer)({start:["SAVE_PROJECT"],end:["SAVE_PROJECT_FAILURE","SAVE_PROJECT_SUCCESS"],getId:c.getProjectId})),e(l,"LOAD_PROJECTS",(0,p.getRequestPageReducersByType)({requestTypeKeyProps:f,getId:c.getProjectId,LOAD_PAGE:"LOAD_PROJECTS",
LOAD_PAGE_FAILURE:"LOAD_PROJECTS_FAILURE",LOAD_PAGE_SUCCESS:"LOAD_PROJECTS_SUCCESS"})),l))});g.addReducers(e({},v,h));var m=b.actionCreators={loadProject:function(a){return{type:"LOAD_PROJECT",payload:a,meta:{successType:"LOAD_PROJECT_SUCCESS",failureType:"LOAD_PROJECT_FAILURE"}}},saveProject:function(a){return{type:"SAVE_PROJECT",payload:a,meta:{successType:"SAVE_PROJECT_SUCCESS",failureType:"SAVE_PROJECT_FAILURE"}}},setProject:function(a){return{type:"SET_PROJECT",payload:a}},loadProjects:function(a){return{type:"LOAD_PROJECTS",
payload:{requestType:"ALL",filter:a.filter,permission:a.permission,limit:a.limit},meta:{successType:"LOAD_PROJECTS_SUCCESS",failureType:"LOAD_PROJECTS_FAILURE"}}}};c=(0,x.getSelectorsForApp)({appName:v,getId:c.getProjectId,requestTypeKeyProps:f});var y=c.getRequestInfo,z=c.getEntitiesForRequest,r=c.getLoadingForRequest,A=c.getAllFetchedForRequest;b.selectors={getProject:c.getEntity,getProjectLoading:function(a){return r((0,k.createSelector)([a],m.loadProject))},getProjectSaving:function(a){return r((0,
k.createSelector)([a],m.loadProject))},getProjects:function(a){return z((0,k.createSelector)([a],m.loadProjects))},getProjectsLoading:function(a){return r((0,k.createSelector)([a],m.loadProjects))},getProjectsAllFetched:function(a){return A((0,k.createSelector)([a],m.loadProjects))}};b._actors=d;b._reducer=h});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:store', location = '/static/bitbucket/internal/util/store/reducers.js' */
define("bitbucket/internal/util/store/reducers","exports icepick lodash redux bitbucket/internal/util/get-id bitbucket/internal/util/object".split(" "),function(b,l,h,t,p,G){function u(a){if(Array.isArray(a)){for(var c=0,d=Array(a.length);c<a.length;c++)d[c]=a[c];return d}return Array.from(a)}function k(a,c,d){c in a?Object.defineProperty(a,c,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[c]=d;return a}Object.defineProperty(b,"__esModule",{value:!0});b.singleEntityRequestReducer=b.keyByPayloadId=
b.actionTypeIn=b.isRequestType=b.keyByRequestProps=b.keyByRequestProp=b.getKeyFromProp=b.getOriginalRequestPayload=b.getRequestPayload=b.composeReducers=b.reduceIf=b.errorsReducer=b.getRequestPageReducersByRequestProps=b.getRequestReducersByRequestProps=b.getRequestPageReducersByType=b.getRequestReducer=b.getRequestPageReducer=b._legacyPagingReducer=b.entitiesReducer=b.toggleReducer=b.versionBy=b.keyBy=b.reduceByTypes=b.reduceByType=b.preserveIfEquivalent=b.preserveEquivalentArraysUnion=b.preserveEqualArrays=
b.EMPTY_OBJECT=b.EMPTY_ARRAY=b.UNKEYED=void 0;var A=function(){return function(a,c){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a)){var d=[],b=!0,e=!1,g=void 0;try{for(var v=a[Symbol.iterator](),z;!(b=(z=v.next()).done)&&(d.push(z.value),!c||d.length!==c);b=!0);}catch(H){e=!0,g=H}finally{try{if(!b&&v["return"])v["return"]()}finally{if(e)throw g;}}return d}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),B=function(a){return a!==Object(a)?a:(0,l.freeze)(a)},
I=b.UNKEYED="@@_UNKEYED_@@";b.EMPTY_ARRAY=[];b.EMPTY_OBJECT={};var w=b.preserveEqualArrays=function(a,c){return Array.isArray(a)&&Array.isArray(c)?(0,h.isEqual)(a,c)?a:c:c},J=b.preserveEquivalentArraysUnion=function(a,c){return Array.isArray(a)&&Array.isArray(c)?(c=(0,h.unionWith)(a,c,h.isEqual),(0,h.isEqual)(a,c)?a:c):c};b.preserveIfEquivalent=function(a,c){return(0,G.shallowEqual)(a,c)?a:c};var m=b.reduceByType=function(a,c){return function(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:
B(a),b=arguments[1],e=arguments[2];return c[b.type]?B(c[b.type](d,b,e)):d}},q=b.reduceByTypes=function(a,c){return m(a,Array.from(c).reduce(function(a,c){c=A(c,2);var d=c[0],b=c[1];(0,h.castArray)(d).forEach(function(c){return a[c]=b});return a},{}))},C=b.keyBy=function(a){return function(c){return function(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:(0,l.freeze)({}),b=arguments[1],e=arguments[2],g=a(b);return null==g?d:(0,l.set)(d,g,c(d[g],b,e))}}};b.versionBy=function(a){return function(c){return function(){var b=
0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},f=arguments[1],e=arguments[2],g=a(f);return null==g?b:g in b?(0,l.set)(b,g,c(b[g],f,e)):k({},g,c(void 0,f,e))}}};var x=b.toggleReducer=function(a){var c=a.on,b=a.off,f=a.toggle,e=a.reset;a=a.initialValue;var g=void 0===a?!1:a;return q(g,new Map([[void 0===c?[]:c,function(){return!0}],[void 0===b?[]:b,function(){return!1}],[void 0===f?[]:f,function(a){return!a}],[void 0===e?[]:e,function(){return g}]]))};b.entitiesReducer=function(a,c){var b=
a.loadPageSuccess,f=a.loadSingleSuccess,e=a.deleteSingleSuccess;a=a.transformer;var g=void 0===a?h.identity:a;return q({},new Map([[void 0===b?[]:b,function(a,b){b=b.payload;return(0,l.merge)(a,b.values.reduce(function(a,b){a[(0,p.getIdString)(c)(b)]=g(b);return a},{}),w)}],[void 0===f?[]:f,function(a,b){b=b.payload;return(0,l.merge)(a,k({},(0,p.getIdString)(c)(b),b),w)}],[void 0===e?[]:e,function(a,c){c=c.payload;return(0,h.omit)(a,c)}]]))};b._legacyPagingReducer=function(){var a=arguments[1],c=
2<arguments.length&&void 0!==arguments[2]?arguments[2]:!0;return q({},new Map([[0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],function(b,f){f=f.payload;return(0,l.merge)(b,{lastPageMeta:(0,h.omit)(f,"values"),ids:f.values.map((0,p.getIdString)(a))},c?J:w)}]]))};var K=b.getRequestPageReducer=function(a){var c=a.LOAD_PAGE,b=a.LOAD_PAGE_SUCCESS,f=a.LOAD_PAGE_FAILURE,e=a.LOAD_PAGE_ABORTED,g=a.getId;return(0,t.combineReducers)({loading:x({on:[c],off:[b,f,e]}),pagingMeta:m({},k({},b,function(a,
b){a=b.payload;return(0,h.omit)(a,"values")})),ids:m([],k({},b,function(a,b){var c=b.payload;b=D(b);b=(0,h.get)(b,"refresh",!1);c=c.values.map((0,p.getIdString)(g));return b?c:a.concat(c)}))})},L=b.getRequestReducer=function(a){var b,d,f=a.REQUEST,e=a.REQUEST_SUCCESS;a=a.REQUEST_FAILURE;return(0,t.combineReducers)({loading:x({on:[f],off:[e,a]}),response:m(null,(b={},k(b,f,function(){return null}),k(b,e,function(a,b){return b.payload}),b)),errors:m(null,(d={},k(d,f,function(){return null}),k(d,a,function(a,
b){return b.payload.error}),d))})};b.getRequestPageReducersByType=function(a){var b=a.requestTypeKeyProps,d=a.LOAD_PAGE,f=a.LOAD_PAGE_FAILURE,e=a.LOAD_PAGE_SUCCESS,g=a.getId;a=(0,h.mapValues)(b,function(a,b){return n(r(M(b)),N({requestProps:a,LOAD_PAGE:d,LOAD_PAGE_FAILURE:f,LOAD_PAGE_SUCCESS:e,getId:g}))});return n(a)};b.getRequestReducersByRequestProps=function(a){var b=a.requestProps,d=a.REQUEST,f=a.REQUEST_FAILURE,e=a.REQUEST_SUCCESS,g=a.REQUEST_ABORTED;a=a.getId;return n(r(y(d,f,e,g)),E(b),L({REQUEST:d,
REQUEST_FAILURE:f,REQUEST_SUCCESS:e,REQUEST_ABORTED:g,getId:a}))};var N=b.getRequestPageReducersByRequestProps=function(a){var b=a.requestProps,d=a.LOAD_PAGE,f=a.LOAD_PAGE_FAILURE,e=a.LOAD_PAGE_SUCCESS,g=a.LOAD_PAGE_ABORTED;a=a.getId;return n(r(y(d,f,e,g)),E(b),K({LOAD_PAGE:d,LOAD_PAGE_FAILURE:f,LOAD_PAGE_SUCCESS:e,LOAD_PAGE_ABORTED:g,getId:a}))};b.errorsReducer=function(a){var b=new Map([[1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],function(){return a}],[2<arguments.length&&void 0!==
arguments[2]?arguments[2]:[],function(a,b){return(a=b.payload.response)&&a.errors||[{message:"An unknown error occurred."}]}]]);return q(a,b)};var r=b.reduceIf=function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(c){return function(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:b,e=arguments[1];return a(e)?c(d,e):d}}},n=b.composeReducers=function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];a=b.pop();return(0,h.flowRight)(b)((0,
h.isPlainObject)(a)?(0,t.combineReducers)(a):a)},F=b.getRequestPayload=function(a){return D(a)||a.payload},D=b.getOriginalRequestPayload=function(a){return(0,h.get)(a,"meta.originalAction.payload")},O=b.getKeyFromProp=function(a,b){a=(0,h.castArray)(a);var c=A(a,2);a=c[0];c=c[1];b=(0,h.get)(b,a);c&&b&&(b=c(b));(0,h.isString)(b)||(b=JSON.stringify(b));return a+":"+(b||I)},P=b.keyByRequestProp=function(a){return C(function(b){b=F(b);return O(a,b)})},E=b.keyByRequestProps=function(a){return h.flowRight.apply(void 0,
u(a.map(P)))},M=b.isRequestType=function(a){return function(b){b=F(b);return(0,h.get)(b,"requestType")===a}},y=b.actionTypeIn=function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];return function(a){return b.includes(a.type)}},Q=b.keyByPayloadId=function(a){return C(function(b){return a(b.payload)})};b.singleEntityRequestReducer=function(a){var b=a.start,d=a.end;a=a.getId;return n(r(y.apply(void 0,u((0,h.castArray)(b)).concat(u((0,h.castArray)(d))))),Q(a),{loading:x({on:b,
off:d})})}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:store', location = '/static/bitbucket/internal/util/store/repository.js' */
define("bitbucket/internal/util/store/repository","exports lodash redux reselect bitbucket/util/navbuilder bitbucket/util/server bitbucket/internal/enums bitbucket/internal/util/entity bitbucket/internal/util/rest-actor ./reducers ./selectors ./store".split(" "),function(g,v,r,c,f,A,t,d,z,w,B,n){function e(a,c,b){c in a?Object.defineProperty(a,c,{value:b,enumerable:!0,configurable:!0,writable:!0}):a[c]=b;return a}Object.defineProperty(g,"__esModule",{value:!0});g._reducer=g._actors=g.selectors=g.actionCreators=
void 0;var l=f&&f.__esModule?f:{default:f};f=n&&n.__esModule?n:{default:n};var h,k,u;n=(0,f.default)();var C=t.Entity.REPOSITORY,x=t.Entity.USER,y=t.Entity.PROJECT;f=(0,z.restActorsForTypes)((h={},e(h,"LOAD_REPOSITORY",function(a){a=a.payload;return{url:l.default.rest().repository(a).build()}}),e(h,"SAVE_REPOSITORY",function(a){a=a.payload;return{url:l.default.rest().repository(a).build(),type:A.method.PUT,data:a}}),e(h,"LOAD_REPOSITORIES",function(a,c){var b=D(a)(c);if((0,v.get)(b,"loading"))return null;
if((0,v.get)(b,"pagingMeta.isLastPage"))throw Error("Cannot request beyond the last page");c=(0,v.get)(b,"pagingMeta.nextPageStart",0);a=a.payload;var d=a.filter,e=a.limit;b=void 0===e?(0,v.get)(b,"pagingMeta.limit",z.DEFAULT_PAGE_SIZE):e;e=a.permission;var g=a.project,f=a.repository,h=a.user,k=a.visibility;switch(a.requestType){case "ALL":a=l.default.rest().allRepos().withDefinedParams({filter:d,permission:e,visibility:k});break;case y:a=l.default.rest().project(g).allRepos().withDefinedParams({name:d});
break;case x:a=l.default.rest().users(h.slug).repos().withDefinedParams({name:d});break;case "FORKS":a=l.default.rest().repository(f).forks().withDefinedParams({name:d});break;case "RELATED":a=l.default.rest().repository(f).related().withDefinedParams({name:d});break;case "RECENT":a=l.default.rest().profile().recent().repos().withDefinedParams({permission:e});break;default:throw Error("Invalid request type");}return{url:a.withParams({avatarSize:t.AvatarSize.SMALL,limit:b,start:c}).build()}}),h));
n.addActors(f);h=(k={},e(k,"ALL",["visibility","permission","filter"]),e(k,y,[["project",d.getProjectId],"filter"]),e(k,"FORKS",[["repository",d.getRepositoryId],"filter"]),e(k,"RELATED",[["repository",d.getRepositoryId],"filter"]),e(k,"RECENT",["permission"]),e(k,x,[["repository",d.getUserId],"filter"]),k);r=(0,r.combineReducers)({entities:(0,w.entitiesReducer)({loadPageSuccess:["LOAD_REPOSITORIES_SUCCESS"],loadSingleSuccess:["LOAD_REPOSITORY_SUCCESS","SAVE_REPOSITORY_SUCCESS","SET_REPOSITORY"]},
d.getRepositoryId),requests:(0,r.combineReducers)((u={},e(u,"LOAD_REPOSITORY",(0,w.singleEntityRequestReducer)({start:"LOAD_REPOSITORY",end:["LOAD_REPOSITORY_FAILURE","LOAD_REPOSITORY_SUCCESS"],getId:d.getRepositoryId})),e(u,"SAVE_REPOSITORY",(0,w.singleEntityRequestReducer)({start:["SAVE_REPOSITORY"],end:["SAVE_REPOSITORY_FAILURE","SAVE_REPOSITORY_SUCCESS"],getId:d.getRepositoryId})),e(u,"LOAD_REPOSITORIES",(0,w.getRequestPageReducersByType)({requestTypeKeyProps:h,getId:d.getRepositoryId,LOAD_PAGE:"LOAD_REPOSITORIES",
LOAD_PAGE_FAILURE:"LOAD_REPOSITORIES_FAILURE",LOAD_PAGE_SUCCESS:"LOAD_REPOSITORIES_SUCCESS"})),u))});n.addReducers(e({},t.Entity.REPOSITORY,r));var b=g.actionCreators={loadRepository:function(a){return{type:"LOAD_REPOSITORY",payload:a,meta:{successType:"LOAD_REPOSITORY_SUCCESS",failureType:"LOAD_REPOSITORY_FAILURE"}}},saveRepository:function(a){return{type:"SAVE_REPOSITORY",payload:a,meta:{successType:"SAVE_REPOSITORY_SUCCESS",failureType:"SAVE_REPOSITORY_FAILURE"}}},setRepository:function(a){return{type:"SET_REPOSITORY",
payload:a}},loadAllRepositories:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return{type:"LOAD_REPOSITORIES",payload:{requestType:"ALL",filter:a.filter,limit:a.limit,permission:a.permission,visibility:a.visibility},meta:{successType:"LOAD_REPOSITORIES_SUCCESS",failureType:"LOAD_REPOSITORIES_FAILURE"}}},loadProjectRepositories:function(a){return{type:"LOAD_REPOSITORIES",payload:{requestType:y,project:a.project,filter:a.filter,limit:a.limit},meta:{successType:"LOAD_REPOSITORIES_SUCCESS",
failureType:"LOAD_REPOSITORIES_FAILURE"}}},loadUserRepositories:function(a){return{type:"LOAD_REPOSITORIES",payload:{requestType:x,user:a.user,filter:a.filter,limit:a.limit},meta:{successType:"LOAD_REPOSITORIES_SUCCESS",failureType:"LOAD_REPOSITORIES_FAILURE"}}},loadRelatedRepositories:function(a){return{type:"LOAD_REPOSITORIES",payload:{requestType:"RELATED",repository:a.repository,filter:a.filter,limit:a.limit},meta:{successType:"LOAD_REPOSITORIES_SUCCESS",failureType:"LOAD_REPOSITORIES_FAILURE"}}},
loadRepositoryForks:function(a){return{type:"LOAD_REPOSITORIES",payload:{requestType:"FORKS",repository:a.repository,filter:a.filter,limit:a.limit},meta:{successType:"LOAD_REPOSITORIES_SUCCESS",failureType:"LOAD_REPOSITORIES_FAILURE"}}},loadRecentRepositories:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return{type:"LOAD_REPOSITORIES",payload:{requestType:"RECENT",permission:a.permission,limit:a.limit},meta:{successType:"LOAD_REPOSITORIES_SUCCESS",failureType:"LOAD_REPOSITORIES_FAILURE"}}}};
d=(0,B.getSelectorsForApp)({appName:C,getId:d.getRepositoryId,requestTypeKeyProps:h});var D=d.getRequestInfo,p=d.getEntitiesForRequest,m=d.getLoadingForRequest,q=d.getAllFetchedForRequest;g.selectors={getRepository:d.getEntity,getRepositoryLoading:function(a){return m((0,c.createSelector)([a],b.loadRepository))},getRepositorySaving:function(a){return m((0,c.createSelector)([a],b.saveRepository))},getAllRepositories:function(a){return p((0,c.createSelector)([a],b.loadAllRepositories))},getAllRepositoriesLoading:function(a){return m((0,
c.createSelector)([a],b.loadAllRepositories))},getAllRepositoriesAllFetched:function(a){return q((0,c.createSelector)([a],b.loadAllRepositories))},getProjectRepositories:function(a){return p((0,c.createSelector)([a],b.loadProjectRepositories))},getProjectRepositoriesLoading:function(a){return m((0,c.createSelector)([a],b.loadProjectRepositories))},getProjectRepositoriesAllFetched:function(a){return q((0,c.createSelector)([a],b.loadProjectRepositories))},getUserRepositories:function(a){return p((0,
c.createSelector)([a],b.loadUserRepositories))},getUserRepositoriesLoading:function(a){return m((0,c.createSelector)([a],b.loadUserRepositories))},getUserRepositoriesAllFetched:function(a){return q((0,c.createSelector)([a],b.loadUserRepositories))},getRelatedRepositories:function(a){return p((0,c.createSelector)([a],b.loadRelatedRepositories))},getRelatedRepositoriesLoading:function(a){return m((0,c.createSelector)([a],b.loadRelatedRepositories))},getRelatedRepositoriesAllFetched:function(a){return q((0,
c.createSelector)([a],b.loadRelatedRepositories))},getRepositoryForks:function(a){return p((0,c.createSelector)([a],b.loadRepositoryForks))},getRepositoryForksLoading:function(a){return m((0,c.createSelector)([a],b.loadRepositoryForks))},getRepositoryForksAllFetched:function(a){return q((0,c.createSelector)([a],b.loadRepositoryForks))},getRecentRepositories:function(a){return p((0,c.createSelector)([a],b.loadRecentRepositories))},getRecentRepositoriesLoading:function(a){return m((0,c.createSelector)([a],
b.loadRecentRepositories))},getRecentRepositoriesAllFetched:function(a){return q((0,c.createSelector)([a],b.loadRecentRepositories))}};g._actors=f;g._reducer=r});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:store', location = '/static/bitbucket/internal/util/store/application-properties.js' */
define("bitbucket/internal/util/store/application-properties","exports icepick lodash redux reselect bitbucket/internal/util/store/reducers bitbucket/internal/util/store/store".split(" "),function(c,l,g,d,h,m,a){function e(b,f,a){f in b?Object.defineProperty(b,f,{value:a,enumerable:!0,configurable:!0,writable:!0}):b[f]=a;return b}Object.defineProperty(c,"__esModule",{value:!0});c.selectors=c.actionCreators=void 0;a=a&&a.__esModule?a:{default:a};a=(0,a.default)();d=(0,d.combineReducers)({properties:(0,
m.reduceByType)({},e({},"SET_PROPERTIES",function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=arguments[1];return(0,l.merge)(b,a.payload)}))});a.addReducers(e({},"APPLICATION_PROPERTIES",d));c.actionCreators={setProperties:function(b){return{type:"SET_PROPERTIES",payload:b}},setProperty:function(b,a){return{type:"SET_PROPERTIES",payload:e({},b,a)}}};var k=(0,h.createSelector)([function(b){return(0,g.get)(b,["APPLICATION_PROPERTIES"])}],function(b){return(0,g.get)(b,"properties")});
c.selectors={getProperties:k,getProperty:function(b){return(0,h.createSelector)([k],function(a){return a.hasOwnProperty(b)?a[b]:void 0})}}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:store', location = '/static/bitbucket/internal/util/store/use-application-property.js' */
define("bitbucket/internal/util/store/use-application-property",["module","exports","react-redux","./application-properties"],function(b,a,c,d){Object.defineProperty(a,"__esModule",{value:!0});a.default=function(a){return(0,c.useSelector)(d.selectors.getProperty(a))};b.exports=a["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:store', location = '/static/bitbucket/internal/util/store/pull-request.js' */
define("bitbucket/internal/util/store/pull-request","exports lodash redux reselect bitbucket/util/navbuilder bitbucket/util/server bitbucket/internal/enums bitbucket/internal/util/entity bitbucket/internal/util/rest-actor ./reducers ./selectors ./store".split(" "),function(g,u,n,c,h,B,v,b,z,p,C,d){function e(a,b,e){b in a?Object.defineProperty(a,b,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[b]=e;return a}Object.defineProperty(g,"__esModule",{value:!0});g._reducer=g._actors=g.selectors=
g.actionCreators=void 0;var t=h&&h.__esModule?h:{default:h};h=d&&d.__esModule?d:{default:d};var k,m,q;d=(0,h.default)();var A=v.Entity.PULL_REQUEST,w=v.Entity.COMMIT;h=(0,z.restActorsForTypes)((k={},e(k,"LOAD_PULL_REQUEST",function(a){a=a.payload;return{url:t.default.rest().pullRequest(a).withParams({avatarSize:v.AvatarSize.SMALL,markup:!0}).build()}}),e(k,"SAVE_PULL_REQUEST",function(a){a=a.payload;return{url:t.default.rest().pullRequest(a).build(),type:B.method.PUT,data:a}}),e(k,"LOAD_PULL_REQUESTS",
function(a,b){var c=D(a)(b);if((0,u.get)(c,"loading"))return null;if((0,u.get)(c,"pagingMeta.isLastPage"))throw Error("Cannot request beyond the last page");b=(0,u.get)(c,"pagingMeta.nextPageStart",0);a=a.payload;var f=a.at,g=a.closedSince,h=a.commit,k=a.direction,d=a.limit;c=void 0===d?(0,u.get)(c,"pagingMeta.limit",z.DEFAULT_PAGE_SIZE):d;d=a.order;var n=a.participantStatus,m=a.repository,q=a.role,l=a.roles,p=a.state,r=void 0;switch(a.requestType){case "DASHBOARD":r=t.default.rest().addPathComponents("dashboard",
"pull-requests").withDefinedParams({state:p,role:q,participantStatus:n,order:d,closedSince:g});break;case w:r=t.default.rest().repository(m).commits(h.id).pullRequests();break;case "REPOSITORY_ALL":r=t.default.rest().repository(m).allPullRequests().withDefinedParams({direction:k,at:f,state:p,order:d});l&&l.length&&(r=l.reduce(function(a,b,c){var d,f=b.role;b=b.user;return a.withParams((d={},e(d,"role."+(c+1),f),e(d,"username."+(c+1),b),d))},r));break;default:throw Error("Invalid request type");}return{url:r.withParams({avatarSize:v.AvatarSize.SMALL,
limit:c,start:b,withProperties:!0,withAttributes:!0}).build()}}),k));d.addActors(h);k=(m={},e(m,"DASHBOARD",["closedSince","order","participantStatus","role","state"]),e(m,w,[["repository",b.getRepositoryId],["commit",b.getCommitId]]),e(m,"REPOSITORY_ALL",[["repository",b.getRepositoryId],"at","direction","order","state","roles"]),m);n=(0,n.combineReducers)({entities:(0,p.entitiesReducer)({loadPageSuccess:["LOAD_PULL_REQUESTS_SUCCESS"],loadSingleSuccess:["LOAD_PULL_REQUEST_SUCCESS","SAVE_PULL_REQUEST_SUCCESS",
"SET_PULL_REQUEST"]},b.getPullRequestId),requests:(0,n.combineReducers)((q={},e(q,"LOAD_PULL_REQUEST",(0,p.singleEntityRequestReducer)({start:"LOAD_PULL_REQUEST",end:["LOAD_PULL_REQUEST_FAILURE","LOAD_PULL_REQUEST_SUCCESS"],getId:b.getPullRequestId})),e(q,"SAVE_PULL_REQUEST",(0,p.singleEntityRequestReducer)({start:["SAVE_PULL_REQUEST"],end:["SAVE_PULL_REQUEST_FAILURE","SAVE_PULL_REQUEST_SUCCESS"],getId:b.getPullRequestId})),e(q,"LOAD_PULL_REQUESTS",(0,p.getRequestPageReducersByType)({requestTypeKeyProps:k,
getId:b.getPullRequestId,LOAD_PAGE:"LOAD_PULL_REQUESTS",LOAD_PAGE_FAILURE:"LOAD_PULL_REQUESTS_FAILURE",LOAD_PAGE_SUCCESS:"LOAD_PULL_REQUESTS_SUCCESS"})),q))});d.addReducers(e({},A,n));var f=g.actionCreators={loadPullRequest:function(a){return{type:"LOAD_PULL_REQUEST",payload:a,meta:{successType:"LOAD_PULL_REQUEST_SUCCESS",failureType:"LOAD_PULL_REQUEST_FAILURE"}}},savePullRequest:function(a){return{type:"SAVE_PULL_REQUEST",payload:a,meta:{successType:"SAVE_PULL_REQUEST_SUCCESS",failureType:"SAVE_PULL_REQUEST_FAILURE"}}},
setPullRequest:function(a){return{type:"SET_PULL_REQUEST",payload:a}},loadRepositoryPullRequests:function(a){return{type:"LOAD_PULL_REQUESTS",payload:{at:a.at,direction:a.direction,limit:a.limit,order:a.order,repository:a.repository,roles:a.roles,state:a.state,requestType:"REPOSITORY_ALL"},meta:{successType:"LOAD_PULL_REQUESTS_SUCCESS",failureType:"LOAD_PULL_REQUESTS_FAILURE"}}},loadCommitPullRequests:function(a){return{type:"LOAD_PULL_REQUESTS",payload:{commit:a.commit,limit:a.limit,repository:a.repository,
requestType:w},meta:{successType:"LOAD_PULL_REQUESTS_SUCCESS",failureType:"LOAD_PULL_REQUESTS_FAILURE"}}},loadDashboardPullRequests:function(a){return{type:"LOAD_PULL_REQUESTS",payload:{closedSince:a.closedSince,requestType:"DASHBOARD",limit:a.limit,order:a.order,participantStatus:a.participantStatus,role:a.role,state:a.state},meta:{successType:"LOAD_PULL_REQUESTS_SUCCESS",failureType:"LOAD_PULL_REQUESTS_FAILURE"}}}};b=(0,C.getSelectorsForApp)({appName:A,getId:b.getPullRequestId,requestTypeKeyProps:k});
var D=b.getRequestInfo,x=b.getEntitiesForRequest,l=b.getLoadingForRequest,y=b.getAllFetchedForRequest;g.selectors={getPullRequest:b.getEntity,getPullRequestLoading:function(a){return l((0,c.createSelector)([a],f.loadPullRequest))},getPullRequestSaving:function(a){return l((0,c.createSelector)([a],f.savePullRequest))},getRepositoryPullRequests:function(a){return x((0,c.createSelector)([a],f.loadRepositoryPullRequests))},getRepositoryPullRequestsLoading:function(a){return l((0,c.createSelector)([a],
f.loadRepositoryPullRequests))},getRepositoryPullRequestsAllFetched:function(a){return y((0,c.createSelector)([a],f.loadRepositoryPullRequests))},getCommitPullRequests:function(a){return x((0,c.createSelector)([a],f.loadCommitPullRequests))},getCommitPullRequestsLoading:function(a){return l((0,c.createSelector)([a],f.loadCommitPullRequests))},getCommitPullRequestsAllFetched:function(a){return y((0,c.createSelector)([a],f.loadCommitPullRequests))},getDashboardPullRequests:function(a){return x((0,c.createSelector)([a],
f.loadDashboardPullRequests))},getDashboardPullRequestsLoading:function(a){return l((0,c.createSelector)([a],f.loadDashboardPullRequests))},getDashboardPullRequestsAllFetched:function(a){return y((0,c.createSelector)([a],f.loadDashboardPullRequests))}};g._actors=h;g._reducer=n});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:store', location = '/static/bitbucket/internal/util/store/store.js' */
define("bitbucket/internal/util/store/store",["exports","lodash","redux"],function(b,f,g){Object.defineProperty(b,"__esModule",{value:!0});b._makeStore=b.actorsForTypes=b.actorForTypes=b.actorForType=b.actorIf=b.actorMiddleware=void 0;var m=Object.assign||function(a){for(var c=1;c<arguments.length;c++){var d=arguments[c],e;for(e in d)Object.prototype.hasOwnProperty.call(d,e)&&(a[e]=d[e])}return a},n=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||g.compose,h=[],p=b.actorMiddleware=function(a){return function(c){return function(d){var e=
a.getState(),b=c(d),f=a.getState();h.forEach(function(c){return c(d,a.dispatch,e,f)});return b}}},k=b.actorIf=function(a){return function(c){return function(d,e,b){if(a(d))return c(d,e,b)}}},q=function(a){return function(c){return c.type===a}},r=b.actorForType=function(a){return k(q(a))},t=function(a){return function(c){return a.includes(c.type)}};b.actorForTypes=function(a){return k(t(a))};b.actorsForTypes=function(a){return(0,f.map)(a,function(a,b){return r(b)(a)})};var l=function(){var a={},b=
(0,g.createStore)(function(){},{},n((0,g.applyMiddleware)(p)));b.addReducers=function(d){var e=(0,f.intersection)(Object.keys(a),Object.keys(d)).filter(function(b){return a[b]!==d[b]});if(e.length)throw Error("The following new reducers would clash with existing reducers: "+e.toString());a=m({},a,d);b.replaceReducer((0,g.combineReducers)(a));b.dispatch({type:"___RE_INIT__"})};b.addActors=function(){for(var b=arguments.length,a=Array(b),c=0;c<b;c++)a[c]=arguments[c];1===a.length&&(0,f.isArray)(a[0])&&
(a=a[0]);a.forEach(function(a){h.includes(a)||h.push(a)})};return b};b.default=(0,f.once)(l);b._makeStore=l});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:store', location = '/static/bitbucket/internal/util/store/user.js' */
define("bitbucket/internal/util/store/user","exports lodash redux reselect bitbucket/util/navbuilder bitbucket/internal/enums bitbucket/internal/util/entity bitbucket/internal/util/rest-actor ./reducers ./selectors ./store".split(" "),function(d,q,f,c,g,w,n,x,p,t,l){function h(a,b,h){b in a?Object.defineProperty(a,b,{value:h,enumerable:!0,configurable:!0,writable:!0}):a[b]=h;return a}Object.defineProperty(d,"__esModule",{value:!0});d._reducer=d._actors=d.selectors=d.actionCreators=void 0;var u=g&&
g.__esModule?g:{default:g};g=l&&l.__esModule?l:{default:l};var m,r,e,b;l=(0,g.default)();var y=w.Entity.USER;g=(0,x.restActorsForTypes)((m={},h(m,"LOAD_USER",function(a){a=a.payload;return{url:u.default.rest().users(a.slug).build()}}),h(m,"LOAD_USERS",function(a,b){var d=B(function(){return a})(b);if((0,q.get)(d,"loading"))return null;if((0,q.get)(d,"pagingMeta.isLastPage"))throw Error("Cannot request beyond the last page");b=(0,q.get)(d,"pagingMeta.nextPageStart",0);var c=a.payload,g=c.direction,
e=c.limit;d=void 0===e?(0,q.get)(d,"pagingMeta.limit",x.DEFAULT_PAGE_SIZE):e;e=c.filter;var l=c.permission,m=c.group,k=c.permissions,n=c.repository,p=c.role,f=void 0;switch(c.requestType){case "PR_PARTICIPANTS":f=u.default.rest().repository(n).participants().withDefinedParams({direction:g,filter:e,role:p});break;case "ALL":f=u.default.rest().users().withDefinedParams({filter:e,permission:l,group:m});k&&k.length&&(f=k.reduce(function(a,b,c){var d=b.permission,e=b.repository;b=b.project;if(e){var f;
return a.withParams((f={},h(f,"permission."+(c+1),d),h(f,"repositoryId."+(c+1),e.id),f))}if(b){var g;return a.withParams((g={},h(g,"permission."+(c+1),d),h(g,"projectId."+(c+1),b.id),g))}return a},f));break;default:throw Error("Invalid request type");}return{url:f.withParams({avatarSize:w.AvatarSize.SMALL,limit:d,start:b}).build()}}),m));l.addActors(g);m=(r={},h(r,"PR_PARTICIPANTS",[["repository",n.getRepositoryId],"direction","role","filter"]),h(r,"ALL",["permission","permissions","group","filter"]),
r);f=(0,f.combineReducers)({entities:(0,p.entitiesReducer)({loadPageSuccess:["LOAD_USERS_SUCCESS"],loadSingleSuccess:["LOAD_USER_SUCCESS","SET_USER","SET_CURRENT_USER"]},n.getUserId),current:(0,p.reduceByType)(null,(e={},h(e,"SET_CURRENT_USER",function(a,b){a=b.payload;return(0,n.getUserId)(a)}),h(e,"CLEAR_CURRENT_USER",function(){return null}),e)),requests:(0,f.combineReducers)((b={},h(b,"LOAD_USER",(0,p.singleEntityRequestReducer)({start:"LOAD_USER",end:["LOAD_USER_FAILURE","LOAD_USER_SUCCESS"],
getId:n.getUserId})),h(b,"LOAD_USERS",(0,p.getRequestPageReducersByType)({requestTypeKeyProps:m,getId:n.getUserId,LOAD_PAGE:"LOAD_USERS",LOAD_PAGE_FAILURE:"LOAD_USERS_FAILURE",LOAD_PAGE_SUCCESS:"LOAD_USERS_SUCCESS"})),b))});l.addReducers(h({},y,f));var k=d.actionCreators={loadUser:function(a){return{type:"LOAD_USER",payload:{slug:a.slug},meta:{successType:"LOAD_USER_SUCCESS",failureType:"LOAD_USER_FAILURE"}}},setUser:function(a){return{type:"SET_USER",payload:a}},setCurrentUser:function(a){return{type:"SET_CURRENT_USER",
payload:a}},loadUsers:function(a){return{type:"LOAD_USERS",payload:{requestType:"ALL",filter:a.filter,group:a.group,limit:a.limit,permission:a.permission,permissions:a.permissions},meta:{successType:"LOAD_USERS_SUCCESS",failureType:"LOAD_USERS_FAILURE"}}},loadRepositoryPrParticipants:function(a){return{type:"LOAD_USERS",payload:{requestType:"PR_PARTICIPANTS",direction:a.direction,filter:a.filter,limit:a.limit,repository:a.repository,role:a.role},meta:{successType:"LOAD_USERS_SUCCESS",failureType:"LOAD_USERS_FAILURE"}}}};
b=(0,t.getSelectorsForApp)({appName:y,getId:n.getUserId,requestTypeKeyProps:m});p=b.getAppState;t=b.getEntity;e=b.getEntities;var B=b.getRequestInfo,z=b.getEntitiesForRequest,v=b.getLoadingForRequest,A=b.getAllFetchedForRequest;b=(0,c.createSelector)([p],function(a){return(0,q.get)(a,"current")});e=(0,c.createSelector)([e,b],function(a,b){return(0,q.get)(a,b)});d.selectors={getUser:t,getUserLoading:function(a){return v((0,c.createSelector)([a],k.loadUser))},getCurrentUser:e,getUsers:function(a){return z((0,
c.createSelector)([a],k.loadUsers))},getUsersLoading:function(a){return v((0,c.createSelector)([a],k.loadUsers))},getUsersAllFetched:function(a){return A((0,c.createSelector)([a],k.loadUsers))},getRepositoryPrParticipants:function(a){return z((0,c.createSelector)([a],k.loadRepositoryPrParticipants))},getRepositoryPrParticipantsLoading:function(a){return v((0,c.createSelector)([a],k.loadRepositoryPrParticipants))},getRepositoryPrParticipantsAllFetched:function(a){return A((0,c.createSelector)([a],
k.loadRepositoryPrParticipants))}};d._actors=g;d._reducer=f});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:redux-util', location = '/static/bitbucket/internal/util/redux.js' */
define("bitbucket/internal/util/redux",["exports","redux"],function(a,d){Object.defineProperty(a,"__esModule",{value:!0});a.legacyCustomCreateStore=a.createActorStore=a.actorMiddleware=void 0;var k=a.actorMiddleware=function(){for(var a=arguments.length,d=Array(a),b=0;b<a;b++)d[b]=arguments[b];return function(b){return function(c){return function(a){var e=b.getState(),h=c(a),f=b.getState();d.forEach(function(c){return c(a,b.dispatch,e,f)});return h}}}},g=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||
d.compose;a.createActorStore=function(a,f){for(var b=arguments.length,e=Array(2<b?b-2:0),c=2;c<b;c++)e[c-2]=arguments[c];return(0,d.createStore)((0,d.combineReducers)(a),f,g((0,d.applyMiddleware)(k.apply(void 0,e))))};a.legacyCustomCreateStore=function(a,f){for(var b=arguments.length,e=Array(2<b?b-2:0),c=2;c<b;c++)e[c-2]=arguments[c];return(0,d.createStore)((0,d.combineReducers)(a),f,g(d.applyMiddleware.apply(void 0,e)))}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:react-redux', location = '/static/lib/redux/react-redux.js' */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("redux"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","react","redux","react-dom"],t):t((e=e||self).ReactRedux={},e.React,e.Redux,e.ReactDOM)}(this,function(e,t,r,n){"use strict";var o="default"in t?t.default:t;function u(e,t){return e(t={exports:{}},t.exports),t.exports}var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function a(){}function c(){}c.resetWarningCache=a;var s=u(function(e){e.exports=function(){function e(e,t,r,n,o,u){if(u!==i){var a=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var r={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:c,resetWarningCache:a};return r.PropTypes=r,r}()}),f=o.createContext(null);var p=function(e){e()},d=function(){return p},l=null,y={notify:function(){}};var v=function(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=y,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return!!this.unsubscribe},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=function(){var e=d(),t=[],r=[];return{clear:function(){r=l,t=l},notify:function(){var n=t=r;e(function(){for(var e=0;n.length>e;e++)n[e]()})},get:function(){return r},subscribe:function(e){var n=!0;return r===t&&(r=t.slice()),r.push(e),function(){n&&t!==l&&(n=!1,r===t&&(r=t.slice()),r.splice(r.indexOf(e),1))}}}}())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=y)},e}();function m(e){var r=e.store,n=e.context,u=e.children,i=t.useMemo(function(){var e=new v(r);return e.onStateChange=e.notifyNestedSubs,{store:r,subscription:e}},[r]),a=t.useMemo(function(){return r.getState()},[r]);return t.useEffect(function(){var e=i.subscription;return e.trySubscribe(),a!==r.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}},[i,a]),o.createElement((n||f).Provider,{value:i},u)}function h(){return(h=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function b(e,t){if(null==e)return{};var r,n,o={},u=Object.keys(e);for(n=0;u.length>n;n++)0>t.indexOf(r=u[n])&&(o[r]=e[r]);return o}m.propTypes={store:s.shape({subscribe:s.func.isRequired,dispatch:s.func.isRequired,getState:s.func.isRequired}),context:s.object,children:s.any};var P,S=u(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,o=r?Symbol.for("react.portal"):60106,u=r?Symbol.for("react.fragment"):60107,i=r?Symbol.for("react.strict_mode"):60108,a=r?Symbol.for("react.profiler"):60114,c=r?Symbol.for("react.provider"):60109,s=r?Symbol.for("react.context"):60110,f=r?Symbol.for("react.async_mode"):60111,p=r?Symbol.for("react.concurrent_mode"):60111,d=r?Symbol.for("react.forward_ref"):60112,l=r?Symbol.for("react.suspense"):60113,y=r?Symbol.for("react.suspense_list"):60120,v=r?Symbol.for("react.memo"):60115,m=r?Symbol.for("react.lazy"):60116,h=r?Symbol.for("react.fundamental"):60117,b=r?Symbol.for("react.responder"):60118;function P(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case f:case p:case u:case a:case i:case l:return e;default:switch(e=e&&e.$$typeof){case s:case d:case c:return e;default:return t}}case m:case v:case o:return t}}}function S(e){return P(e)===p}t.typeOf=P,t.AsyncMode=f,t.ConcurrentMode=p,t.ContextConsumer=s,t.ContextProvider=c,t.Element=n,t.ForwardRef=d,t.Fragment=u,t.Lazy=m,t.Memo=v,t.Portal=o,t.Profiler=a,t.StrictMode=i,t.Suspense=l,t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===u||e===p||e===a||e===i||e===l||e===y||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===v||e.$$typeof===c||e.$$typeof===s||e.$$typeof===d||e.$$typeof===h||e.$$typeof===b)},t.isAsyncMode=function(e){return S(e)||P(e)===f},t.isConcurrentMode=S,t.isContextConsumer=function(e){return P(e)===s},t.isContextProvider=function(e){return P(e)===c},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return P(e)===d},t.isFragment=function(e){return P(e)===u},t.isLazy=function(e){return P(e)===m},t.isMemo=function(e){return P(e)===v},t.isPortal=function(e){return P(e)===o},t.isProfiler=function(e){return P(e)===a},t.isStrictMode=function(e){return P(e)===i},t.isSuspense=function(e){return P(e)===l}});(P=S)&&P.__esModule&&Object.prototype.hasOwnProperty.call(P,"default");var g=u(function(e){e.exports=S}),w=g.isContextConsumer,O={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},C={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},x={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},R={};function E(e){return g.isMemo(e)?x:R[e.$$typeof]||O}R[g.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0};var M=Object.defineProperty,T=Object.getOwnPropertyNames,j=Object.getOwnPropertySymbols,$=Object.getOwnPropertyDescriptor,N=Object.getPrototypeOf,q=Object.prototype;var _=function e(t,r,n){if("string"!=typeof r){if(q){var o=N(r);o&&o!==q&&e(t,o,n)}var u=T(r);j&&(u=u.concat(j(r)));for(var i=E(t),a=E(r),c=0;u.length>c;++c){var s=u[c];if(!(C[s]||n&&n[s]||a&&a[s]||i&&i[s])){var f=$(r,s);try{M(t,s,f)}catch(e){}}}return t}return t},D=function(e,t,r,n,o,u,i,a){if(!e){var c;if(void 0===t)c=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=[r,n,o,u,i,a],f=0;(c=Error(t.replace(/%s/g,function(){return s[f++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}},k=[],F=[null,null];function W(e,t){return[t.payload,e[1]+1]}var A=function(){return[null,0]},H="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?t.useLayoutEffect:t.useEffect;function U(e,r){void 0===r&&(r={});var n=r.getDisplayName,u=void 0===n?function(e){return"ConnectAdvanced("+e+")"}:n,i=r.methodName,a=void 0===i?"connectAdvanced":i,c=r.renderCountProp,s=void 0===c?void 0:c,p=r.shouldHandleStateChanges,d=void 0===p||p,l=r.storeKey,y=void 0===l?"store":l,m=r.withRef,P=void 0!==m&&m,S=r.forwardRef,g=void 0!==S&&S,O=r.context,C=void 0===O?f:O,x=b(r,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]);D(void 0===s,"renderCountProp is removed. render counting is built into the latest React Dev Tools profiling extension"),D(!P,"withRef is removed. To access the wrapped instance, use a ref on the connected component");D("store"===y,"storeKey has been removed and does not do anything. To use a custom Redux store for specific components, create a custom React context with React.createContext(), and pass the context object to React Redux's Provider and specific components like: <Provider context={MyContext}><ConnectedComponent context={MyContext} /></Provider>. You may also pass a {context : MyContext} option to connect");var R=C;return function(r){var n=r.displayName||r.name||"Component",i=u(n),c=h({},x,{getDisplayName:u,methodName:a,renderCountProp:s,shouldHandleStateChanges:d,storeKey:y,displayName:i,wrappedComponentName:n,WrappedComponent:r}),f=x.pure;var p=f?t.useMemo:function(e){return e()};function l(n){var u=t.useMemo(function(){var e=n.forwardedRef,t=b(n,["forwardedRef"]);return[n.context,e,t]},[n]),a=u[0],s=u[1],f=u[2],l=t.useMemo(function(){return a&&a.Consumer&&w(o.createElement(a.Consumer,null))?a:R},[a,R]),y=t.useContext(l),m=!!n.store;D(m||!!y&&!!y.store,'Could not find "store" in the context of "'+i+'". Either wrap the root component in a <Provider>, or pass a custom React context provider to <Provider> and the corresponding React context consumer to '+i+" in connect options.");var P=n.store||y.store,S=t.useMemo(function(){return function(t){return e(t.dispatch,c)}(P)},[P]),g=t.useMemo(function(){if(!d)return F;var e=new v(P,m?null:y.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]},[P,m,y]),O=g[0],C=g[1],x=t.useMemo(function(){return m?y:h({},y,{subscription:O})},[m,y,O]),E=t.useReducer(W,k,A),M=E[0][0],T=E[1];if(M&&M.error)throw M.error;var j=t.useRef(),$=t.useRef(f),N=t.useRef(),q=t.useRef(!1),_=p(function(){return N.current&&f===$.current?N.current:S(P.getState(),f)},[P,M,f]);H(function(){$.current=f,j.current=_,q.current=!1,N.current&&(N.current=null,C())}),H(function(){if(d){var e=!1,t=null,r=function(){if(!e){var r,n,o=P.getState();try{r=S(o,$.current)}catch(e){n=e,t=e}n||(t=null),r===j.current?q.current||C():(j.current=r,N.current=r,q.current=!0,T({type:"STORE_UPDATED",payload:{latestStoreState:o,error:n}}))}};O.onStateChange=r,O.trySubscribe(),r();return function(){if(e=!0,O.tryUnsubscribe(),O.onStateChange=null,t)throw t}}},[P,O,S]);var U=t.useMemo(function(){return o.createElement(r,h({},_,{ref:s}))},[s,r,_]);return t.useMemo(function(){return d?o.createElement(l.Provider,{value:x},U):U},[l,U,x])}var m=f?o.memo(l):l;if(m.WrappedComponent=r,m.displayName=i,g){var P=o.forwardRef(function(e,t){return o.createElement(m,h({},e,{forwardedRef:t}))});return P.displayName=i,P.WrappedComponent=r,_(P,r)}return _(m,r)}}var I=Object.prototype.hasOwnProperty;function L(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function K(e,t){if(L(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(var n=0;r.length>n;n++)if(!I.call(t,r[n])||!L(e[r[n]],t[r[n]]))return!1;return!0}function z(e){return function(t,r){var n=e(t,r);function o(){return n}return o.dependsOnOwnProps=!1,o}}function V(e){return null!=e.dependsOnOwnProps?!!e.dependsOnOwnProps:1!==e.length}function Y(e,t){return function(t,r){var n=function(e,t){return n.dependsOnOwnProps?n.mapToProps(e,t):n.mapToProps(e)};return n.dependsOnOwnProps=!0,n.mapToProps=function(t,r){n.mapToProps=e,n.dependsOnOwnProps=V(e);var o=n(t,r);return"function"==typeof o&&(n.mapToProps=o,n.dependsOnOwnProps=V(o),o=n(t,r)),o},n}}function B(e,t,r){return h({},r,{},e,{},t)}var G=[function(e){return"function"==typeof e?function(e){return function(t,r){var n,o=r.pure,u=r.areMergedPropsEqual,i=!1;return function(t,r,a){var c=e(t,r,a);return i?o&&u(c,n)||(n=c):(i=!0,n=c),n}}}(e):void 0},function(e){return e?void 0:function(){return B}}];function J(e,t,r,n){return function(o,u){return r(e(o,u),t(n,u),u)}}function Q(e,t,r,n,o){var u,i,a,c,s,f=o.areStatesEqual,p=o.areOwnPropsEqual,d=o.areStatePropsEqual,l=!1;function y(o,l){var y,v,m=!p(l,i),h=!f(o,u);return u=o,i=l,m&&h?(a=e(u,i),t.dependsOnOwnProps&&(c=t(n,i)),s=r(a,c,i)):m?(e.dependsOnOwnProps&&(a=e(u,i)),t.dependsOnOwnProps&&(c=t(n,i)),s=r(a,c,i)):h?(y=e(u,i),v=!d(y,a),a=y,v&&(s=r(a,c,i)),s):s}return function(o,f){return l?y(o,f):(a=e(u=o,i=f),c=t(n,i),s=r(a,c,i),l=!0,s)}}function X(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,o=t.initMergeProps,u=b(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),i=r(e,u),a=n(e,u),c=o(e,u);return(u.pure?Q:J)(i,a,c,e,u)}function Z(e,t,r){for(var n=t.length-1;n>=0;n--){var o=t[n](e);if(o)return o}return function(t,n){throw Error("Invalid value of type "+typeof e+" for "+r+" argument when connecting component "+n.wrappedComponentName+".")}}function ee(e,t){return e===t}var te,re,ne,oe,ue,ie,ae,ce,se,fe,pe,de,le=(oe=void 0===(ne=(re=void 0===te?{}:te).connectHOC)?U:ne,ie=void 0===(ue=re.mapStateToPropsFactories)?[function(e){return"function"==typeof e?Y(e):void 0},function(e){return e?void 0:z(function(){return{}})}]:ue,ce=void 0===(ae=re.mapDispatchToPropsFactories)?[function(e){return"function"==typeof e?Y(e):void 0},function(e){return e?void 0:z(function(e){return{dispatch:e}})},function(e){return e&&"object"==typeof e?z(function(t){return r.bindActionCreators(e,t)}):void 0}]:ae,fe=void 0===(se=re.mergePropsFactories)?G:se,de=void 0===(pe=re.selectorFactory)?X:pe,function(e,t,r,n){void 0===n&&(n={});var o=n.pure,u=void 0===o||o,i=n.areStatesEqual,a=void 0===i?ee:i,c=n.areOwnPropsEqual,s=void 0===c?K:c,f=n.areStatePropsEqual,p=void 0===f?K:f,d=n.areMergedPropsEqual,l=void 0===d?K:d,y=b(n,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),v=Z(e,ie,"mapStateToProps"),m=Z(t,ce,"mapDispatchToProps"),P=Z(r,fe,"mergeProps");return oe(de,h({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:!!e,initMapStateToProps:v,initMapDispatchToProps:m,initMergeProps:P,pure:u,areStatesEqual:a,areOwnPropsEqual:s,areStatePropsEqual:p,areMergedPropsEqual:l},y))});function ye(){var e=t.useContext(f);return D(e,"could not find react-redux context value; please ensure the component is wrapped in a <Provider>"),e}function ve(e){void 0===e&&(e=f);var r=e===f?ye:function(){return t.useContext(e)};return function(){return r().store}}var me=ve();function he(e){void 0===e&&(e=f);var t=e===f?me:ve(e);return function(){return t().dispatch}}var be=he(),Pe="undefined"!=typeof window?t.useLayoutEffect:t.useEffect,Se=function(e,t){return e===t};function ge(e){void 0===e&&(e=f);var r=e===f?ye:function(){return t.useContext(e)};return function(e,n){void 0===n&&(n=Se),D(e,"You must pass a selector to useSelectors");var o=r();return function(e,r,n,o){var u,i=t.useReducer(function(e){return e+1},0)[1],a=t.useMemo(function(){return new v(n,o)},[n,o]),c=t.useRef(),s=t.useRef(),f=t.useRef();try{u=e!==s.current||c.current?e(n.getState()):f.current}catch(e){var p="An error occured while selecting the store state: "+e.message+".";throw c.current&&(p+="\nThe error may be correlated with this previous error:\n"+c.current.stack+"\n\nOriginal stack trace:"),Error(p)}return Pe(function(){s.current=e,f.current=u,c.current=void 0}),Pe(function(){function e(){try{var e=s.current(n.getState());if(r(e,f.current))return;f.current=e}catch(e){c.current=e}i({})}return a.onStateChange=e,a.trySubscribe(),e(),function(){return a.tryUnsubscribe()}},[n,a]),u}(e,n,o.store,o.subscription)}}var we=ge();p=n.unstable_batchedUpdates,Object.defineProperty(e,"batch",{enumerable:!0,get:function(){return n.unstable_batchedUpdates}}),e.Provider=m,e.ReactReduxContext=f,e.connect=le,e.connectAdvanced=U,e.createDispatchHook=he,e.createSelectorHook=ge,e.createStoreHook=ve,e.shallowEqual=K,e.useDispatch=be,e.useSelector=we,e.useStore=me,Object.defineProperty(e,"__esModule",{value:!0})});
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:react-redux', location = '/static/lib/redux/react-redux-AMD.js' */
define("react-redux",function(){return window.ReactRedux});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:alerts-dialog', location = '/static/bitbucket/internal/feature/alerts/containers/alerts.js' */
define("bitbucket/internal/feature/alerts/containers/alerts","exports @atlassian/aui react react-redux ../action-creators ../components/alerts-empty ../components/alerts-list ../selectors".split(" "),function(d,f,e,h,k,l,m,n){Object.defineProperty(d,"__esModule",{value:!0});d.Alerts=void 0;var p=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(f),g=e&&e.__esModule?e:{default:e};f=d.Alerts=function(a){var b=
a.alerts;a=a.remove;if(!b||0===b.length)return g.default.createElement(l.AlertsEmpty,null);var c="Alerts";return g.default.createElement("div",{id:"bitbucket-alerts",className:"bitbucket-alerts"},g.default.createElement(m.AlertsList,{title:c,alerts:b,onRemove:a}))};d.default=(0,h.connect)(function(a){return{alerts:(0,n.alertsBySeverity)(a)}},{remove:k.remove})(f)});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:alerts-dialog', location = '/static/bitbucket/internal/feature/alerts/components/alerts-list.js' */
define("bitbucket/internal/feature/alerts/components/alerts-list",["exports","classnames","prop-types","react","../constants"],function(d,b,l,f,m){function g(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(d,"__esModule",{value:!0});d.AlertsList=d.Alert=void 0;var n=g(b);b=g(l);var c=g(f),h=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],e;for(e in c)Object.prototype.hasOwnProperty.call(c,e)&&(a[e]=c[e])}return a},k=d.Alert=function(a){var b=a.alertKey,
d=a.anchorCallback,e=a.anchorText,f=a.anchorLink,g=a.closeable,h=a.closeCallback,k=a.description,l=a.title,m=a.type,p=a.onRemove;a=function(a){f||a.preventDefault();d&&d()};e=e?c.default.createElement("p",null,f?c.default.createElement("a",{href:f,onClick:a},e):c.default.createElement("button",{className:"aui-button aui-button-link",onClick:d},e)):null;a=g?c.default.createElement("span",{className:"aui-icon icon-close",role:"button",tabIndex:"0",onClick:function(a){a.preventDefault();h&&h();p(b)}}):
null;return c.default.createElement("li",{className:(0,n.default)("aui-message",m,{closeable:g})},c.default.createElement("p",null,c.default.createElement("strong",null,l)," ",k),e,a)};f={alertKey:b.default.string.isRequired,type:b.default.oneOf(m.TYPES).isRequired,title:b.default.string.isRequired,description:b.default.string,anchorText:b.default.string,anchorCallback:b.default.func,anchorLink:b.default.string,closeable:b.default.bool,closeCallback:b.default.func};k.propTypes=h({},f,{onRemove:b.default.func.isRequired});
(d.AlertsList=function(a){var b=a.alerts,d=a.onRemove;return c.default.createElement("div",{className:"alerts-list-container"},c.default.createElement("h3",null,a.title),c.default.createElement("ul",{className:"alerts-list"},b.map(function(a){return c.default.createElement(k,h({key:a.alertKey},a,{onRemove:d}))})))}).propTypes={alerts:b.default.arrayOf(b.default.shape(f)).isRequired,title:b.default.string.isRequired,onRemove:b.default.func.isRequired}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:alerts-dialog', location = '/static/bitbucket/internal/feature/alerts/components/alerts-empty.js' */
define("bitbucket/internal/feature/alerts/components/alerts-empty",["exports","@atlassian/aui","react"],function(c,e,a){Object.defineProperty(c,"__esModule",{value:!0});c.AlertsEmpty=void 0;var f=function(b){if(b&&b.__esModule)return b;var a={};if(null!=b)for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c]);a.default=b;return a}(e),d=a&&a.__esModule?a:{default:a};c.AlertsEmpty=function(){return d.default.createElement("div",{className:"alerts-empty"},d.default.createElement("div",
{className:"empty-img"}),d.default.createElement("p",null,"Everything looks good. We\u0027ll let you know here if there\u0027s anything you should know about."))}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:alerts-dialog', location = '/static/bitbucket/internal/feature/alerts/actions.js' */
define("bitbucket/internal/feature/alerts/actions",["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});a.ADD_ALERT="alerts/ADD_ALERT";a.REMOVE_ALERT="alerts/REMOVE_ALERT";a.DIALOG_OPEN="alerts/DIALOG_OPEN";a.DIALOG_CLOSED="alerts/DIALOG_CLOSED"});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:alerts-dialog', location = '/static/bitbucket/internal/feature/alerts/alerts-trigger.js' */
define("bitbucket/internal/feature/alerts/alerts-trigger","module exports @atlassian/aui classnames lodash ./selectors".split(" "),function(m,f,g,d,n,h){Object.defineProperty(f,"__esModule",{value:!0});var p=function(b){if(b&&b.__esModule)return b;var a={};if(null!=b)for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c]);a.default=b;return a}(g),k=d&&d.__esModule?d:{default:d},q=function(){function b(a,b){for(var c=0;c<b.length;c++){var e=b[c];e.enumerable=e.enumerable||!1;e.configurable=
!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(a,c,d){c&&b(a.prototype,c);d&&b(a,d);return a}}(),l=function(b){return(0,n.get)(b,"0.type")};g=function(){function b(a,c){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");this.$el=a;this.stateStore=c;this.stateStore.subscribe(this.maybeUpdate.bind(this));this.render(this.getAlerts())}q(b,[{key:"getAlerts",value:function(){return(0,h.alertsBySeverity)(this.stateStore.getState())}},{key:"maybeUpdate",
value:function(){var a=this.getAlerts();this.alertCount===a.length&&this.mostSevere===l(a)||this.render(a)}},{key:"render",value:function(a){this.alertCount=a.length;this.mostSevere=l(a);if(!a||0===a.length)return this.$el.attr("class",(0,k.default)("alerts-menu",{hidden:!(0,h.dialogOpen)(this.stateStore.getState())})),this.$el.html(bitbucket.internal.feature.alerts.alerts.emptyTrigger());a="Alerts";this.$el.attr("class",(0,k.default)("alerts-menu",this.mostSevere));
this.$el.html(bitbucket.internal.feature.alerts.alerts.trigger({count:this.alertCount,mostSevereType:this.mostSevere,title:a}))}}]);return b}();f.default=g;m.exports=f["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:alerts-dialog', location = '/static/bitbucket/internal/feature/alerts/reducers.js' */
define("bitbucket/internal/feature/alerts/reducers",["module","exports","lodash","bitbucket/internal/util/store/reducers","./actions"],function(h,g,k,l,f){function e(a,c,b){c in a?Object.defineProperty(a,c,{value:b,enumerable:!0,configurable:!0,writable:!0}):a[c]=b;return a}Object.defineProperty(g,"__esModule",{value:!0});var d,b=Object.assign||function(a){for(var c=1;c<arguments.length;c++){var b=arguments[c],d;for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])}return a};g.default=
(0,l.reduceByType)({alerts:{},dialog:{open:!1}},(d={},e(d,f.ADD_ALERT,function(a,c){return b({},a,{alerts:b({},a.alerts,e({},c.payload.alertKey,b({},c.payload)))})}),e(d,f.REMOVE_ALERT,function(a,c){return b({},a,{alerts:(0,k.omit)(a.alerts,c.payload)})}),e(d,f.DIALOG_CLOSED,function(a){return b({},a,{dialog:b({},a.dialog,{open:!1})})}),e(d,f.DIALOG_OPEN,function(a){return b({},a,{dialog:b({},a.dialog,{open:!0})})}),d));h.exports=g["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:alerts-dialog', location = '/static/bitbucket/internal/feature/alerts/selectors.js' */
define("bitbucket/internal/feature/alerts/selectors",["exports","lodash","reselect","./constants"],function(b,d,c,e){function f(a,b){var c=e.TYPES.indexOf(a.type),d=e.TYPES.indexOf(b.type);return c-d||a.title.localeCompare(b.title)}Object.defineProperty(b,"__esModule",{value:!0});b.dialogOpen=b.alertsBySeverity=void 0;b.alertsBySeverity=(0,c.createSelector)([function(a){return a.ui.alerts}],function(a){return(0,d.values)(a).sort(f)});b.dialogOpen=(0,c.createSelector)([function(a){return a.ui.dialog}],
function(a){return a.open})});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:alerts-dialog', location = '/static/bitbucket/internal/feature/alerts/alerts.soy' */
// This file was automatically generated from alerts.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.feature.alerts.alerts.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.feature == 'undefined') { bitbucket.internal.feature = {}; }
if (typeof bitbucket.internal.feature.alerts == 'undefined') { bitbucket.internal.feature.alerts = {}; }
if (typeof bitbucket.internal.feature.alerts.alerts == 'undefined') { bitbucket.internal.feature.alerts.alerts = {}; }


bitbucket.internal.feature.alerts.alerts.emptyTrigger = function(opt_data, opt_ignored) {
  return '<span class="aui-icon aui-icon-small aui-icon-success"></span>';
};
if (goog.DEBUG) {
  bitbucket.internal.feature.alerts.alerts.emptyTrigger.soyTemplateName = 'bitbucket.internal.feature.alerts.alerts.emptyTrigger';
}


bitbucket.internal.feature.alerts.alerts.trigger = function(opt_data, opt_ignored) {
  return '<div><span class="aui-icon aui-icon-small aui-iconfont-' + soy.$$escapeHtml(opt_data.mostSevereType) + '">' + soy.$$escapeHtml(opt_data.title) + '</span><span class="alerts-count">' + soy.$$escapeHtml(opt_data.count) + '</span></div>';
};
if (goog.DEBUG) {
  bitbucket.internal.feature.alerts.alerts.trigger.soyTemplateName = 'bitbucket.internal.feature.alerts.alerts.trigger';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:alerts-dialog', location = '/static/bitbucket/internal/feature/alerts/alerts.js' */
define("bitbucket/internal/feature/alerts/alerts","exports lodash react react-dom react-redux bitbucket/util/events bitbucket/internal/bbui/aui-react/inline-dialog bitbucket/internal/feature/alerts/reducers bitbucket/internal/util/redux ./action-creators ./alerts-trigger ./containers/alerts".split(" "),function(c,A,g,h,k,l,m,n,p,e,q,r){function b(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});c.onReady=function(a){var b=a.clone();b.attr({"data-aui-trigger":!0,
"aria-controls":"alerts-content"});a.replaceWith(b);new t.default(b,d);a=document.createElement("div");a.id="alerts-content-container";document.body.appendChild(a);u.default.render(f.default.createElement(v.default,{id:"alerts-content",alignment:"bottom right",onShow:w,onHide:x},f.default.createElement(k.Provider,{store:d},f.default.createElement(y.default,null))),a)};c.add=function(a){return d.dispatch((0,e.add)(a)).payload.alertKey};var f=b(g),u=b(h),z=b(l),v=b(m);c=b(n);var t=b(q),y=b(r),d=(0,
p.createActorStore)({ui:c.default}),w=function(){d.dispatch((0,e.openDialog)());z.default.trigger("bitbucket.internal.DO_NOT_USE.ui.alerts.dialog.opened")},x=function(){return d.dispatch((0,e.closeDialog)())}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:alerts-dialog', location = '/static/bitbucket/internal/feature/alerts/constants.js' */
define("bitbucket/internal/feature/alerts/constants",["exports"],function(b){Object.defineProperty(b,"__esModule",{value:!0});var a=b.AlertType={ERROR:"error",WARNING:"warning",INFO:"info",SUCCESS:"success"};b.TYPES=[a.ERROR,a.WARNING,a.INFO,a.SUCCESS]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:alerts-dialog', location = '/static/bitbucket/internal/feature/alerts/action-creators.js' */
define("bitbucket/internal/feature/alerts/action-creators",["exports","./actions"],function(a,b){Object.defineProperty(a,"__esModule",{value:!0});a.openDialog=a.closeDialog=a.remove=a.add=void 0;var e=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var d=arguments[b],c;for(c in d)Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}return a};a.add=function(a){return{type:b.ADD_ALERT,payload:e({alertKey:a.title.toLowerCase().split(" ").join("")+Date.now()},a)}};a.remove=function(a){return{type:b.REMOVE_ALERT,
payload:a}};a.closeDialog=function(){return{type:b.DIALOG_CLOSED}};a.openDialog=function(){return{type:b.DIALOG_OPEN}}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:alerts-dialog', location = '/static/bitbucket/internal/feature/alerts/alerts-init.js' */
document.addEventListener("DOMContentLoaded",function(){var a=jQuery("#alerts-trigger");if(a.length)require("bitbucket/internal/feature/alerts/alerts").onReady(a)});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:integrity-check-alert', location = '/static/bitbucket/internal/feature/integrity/alert.js' */
define("bitbucket/internal/feature/integrity/alert",["exports","@atlassian/aui","bitbucket/util/navbuilder","bitbucket/internal/feature/alerts/alerts","bitbucket/internal/util/ajax"],function(b,k,e,l,f){Object.defineProperty(b,"__esModule",{value:!0});b.init=function(a){if(a&&0!==a.length){var c=void 0,d=void 0;switch(a[0]){case "acknowledged":return;case "started":d=g.INFO;c=h.STARTED;break;case "inconsistency":if("started"===a[1])d=g.WARN,c=h.INCONSISTENT;else return;break;case "completed":"inconsistency"===
a[1]?(d=g.WARN,c=h.INCONSISTENT_COMPLETED):(d=g.INFO,c=h.COMPLETED);break;default:console.warn("Could not identify integrity checks state.",a);return}a=m({type:d,closeCallback:function(){n.default.rest({url:p.default.newBuilder("admin").addPathComponents("integrity-check","acknowledge").build(),type:"POST"})}},c);(0,l.add)(a);return a}};b=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);c.default=a;return c}(k);var p=
e&&e.__esModule?e:{default:e},n=f&&f.__esModule?f:{default:f},m=Object.assign||function(a){for(var c=1;c<arguments.length;c++){var d=arguments[c],b;for(b in d)Object.prototype.hasOwnProperty.call(d,b)&&(a[b]=d[b])}return a},g={INFO:"info",WARN:"warning"},h={STARTED:{closeable:!1,title:"Integrity checks are running",description:"Check the application logs for further information."},INCONSISTENT:{closeable:!1,title:"Integrity checks are running and some inconsistencies were found",
description:"Check the application logs for further information."},COMPLETED:{closeable:!0,title:"Integrity checks are complete",description:"Check the application logs for further information."},INCONSISTENT_COMPLETED:{closeable:!0,title:"Integrity checks are complete and some inconsistencies were found",description:"Check the application logs for information on any restore actions carried out."}}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:integrity-check-alert', location = '/static/bitbucket/internal/feature/integrity/alert.soy' */
// This file was automatically generated from alert.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.feature.integrity.alert.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.feature == 'undefined') { bitbucket.internal.feature = {}; }
if (typeof bitbucket.internal.feature.integrity == 'undefined') { bitbucket.internal.feature.integrity = {}; }
if (typeof bitbucket.internal.feature.integrity.alert == 'undefined') { bitbucket.internal.feature.integrity.alert = {}; }


bitbucket.internal.feature.integrity.alert.bitbucketIntegrityCheckRunning = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '' + ((opt_data.integrityCheckState) ? '<script type="text/javascript">require(\'bitbucket/internal/feature/integrity/alert\').init(' + soy.$$filterNoAutoescape(JSON.stringify(opt_data.integrityCheckState).replace(/\//g, '\\/').replace(/\74!--/g, '\\74!--')) + ');<\/script>' : '');
};
if (goog.DEBUG) {
  bitbucket.internal.feature.integrity.alert.bitbucketIntegrityCheckRunning.soyTemplateName = 'bitbucket.internal.feature.integrity.alert.bitbucketIntegrityCheckRunning';
}
;
;
/* module-key = 'com.atlassian.plugins.atlassian-plugins-webresource-plugin:i18n', location = 'js/data/i18n.js' */
(function(){var b=WRM.format;var a={getText:function(c){console.warn('Call to "getText" function was not replaced with either raw translation or a call to the "format" function. Have you included the "jsI18n" transformation in your webresource configuration?');if(arguments.length>1){return a.format.apply(null,arguments)}return c},format:b};if(typeof define==="function"){define("wrm/i18n",[],function(){return a})}WRM.I18n=a;AJS.I18n=a}());;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-page-data:page-data-loader', location = '/static/lib/page-data-loader.js' */
var _PageDataPlugin=function(){function k(){e.each(f,function(a,d){e.each(d,function(b,c){c.reject(h[a]?Error("Provider "+a+" not included with context "+b):Error("Provider "+a+" not included on page."))})})}var l=Object.prototype.hasOwnProperty,e=jQuery,h={},f={};e(document).ready(k);return{load:function(a,d){for(var b in d)if(l.call(d,b)){var c=f[b]||(f[b]={});c=c[a]||(c[a]=e.Deferred());var g=h[b]||(h[b]={});g[a]=d[b];if("pending"!==c.state())throw Error("Attempt to set context "+a+" for plugin key "+
b+" multiple times.");c.resolve(g[a])}},data:h,ready:function(a,d){var b=Array.prototype.slice.call(arguments,2),c=f[a]||(f[a]={}),g=c[d]||(c[d]=e.Deferred());b.forEach(function(a){g.done(a)});return g},_domReady:k}}();define("lib/page-data-loader",function(){return _PageDataPlugin});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-client-web-fragments:web-fragment-manager', location = '/static/bitbucket/internal/util/web-fragment-manager.js' */
var _slicedToArray=function(){return function(n,h){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n)){var p=[],l=!0,q=!1,r=void 0;try{for(var e=n[Symbol.iterator](),t;!(l=(t=e.next()).done)&&(p.push(t.value),!h||p.length!==h);l=!0);}catch(m){q=!0,r=m}finally{try{if(!l&&e["return"])e["return"]()}finally{if(q)throw r;}}return p}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();
window.WebFragments=function(){function n(a){var b=Array.prototype.slice.call(arguments,1),c,k=b.length;for(c=0;c<k;c++){var d=b[c];if(d){var g=m(d),f,u=g.length;for(f=0;f<u;f++){var e=g[f];a[e]=d[e]}}}return a}function h(a,b){return"function"===typeof a?a(n({},b)):a}function p(a,b,c){var k,d={type:c.toUpperCase()};if(e.call(a,"serverCondition")&&!a.serverCondition)return null;b=n({},b,a.serverContext,a.params);if(e.call(a,"condition")&&!h(a.condition,b))return null;a["context-provider"]&&"function"===
typeof a["context-provider"]&&(b=h(a["context-provider"],b));c=m(a);var g=0;for(k=c.length;g<k;g++){var f=c[g];/con(dition|text-provider)|params/.test(f)||(d[f]=h(a[f],b))}if(a.params){var u=d.params={};c=m(a.params);g=0;for(k=c.length;g<k;g++)f=c[g],u[f]=h(a.params[f],b)}return d}function l(a){var b=t[a];return function(c,k){var d=b[c],g=[];if(d&&d.length){var f,e=d.length;for(f=0;f<e;f++){var h=p(d[f],k,a);h&&g.push(h)}}-1===c.indexOf("bitbucket.internal.")&&(new RegExp("[\\?\x26]web\\."+a+"s(\x3d|\x26|$)")).test(window.location.search)&&
g.push(x[a](c,k));return g}}function q(a){var b=t[a];return function(a){if(!a)throw Error("No descriptor provided");if("string"!==typeof a.location)throw Error("No location provided, or location was not a string.");if("string"!==typeof a.completeModuleKey)throw Error("No completeModuleKey provided, or completeModuleKey was not a string.");v(a);b[a.location]||(b[a.location]=[]);b[a.location].push(a);b[a.location].sort(r)}}function r(a,b){return(0<=a.weight?a.weight:1E3)-(0<=b.weight?b.weight:1E3)}
var e=Object.prototype.hasOwnProperty,t={item:{},section:{},panel:{}},m=function(a){var b=[],c;for(c in a)e.call(a,c)&&b.push(c);return b},v=void 0;v=window._PageDataPlugin&&_PageDataPlugin.ready?function(a){_PageDataPlugin.ready(a.completeModuleKey,a.location,function(b){e.call(b,"serverCondition")&&(a.serverCondition=b.serverCondition);e.call(b,"serverContext")&&(a.serverContext=b.serverContext)})}:function(a){return a};var x={item:function(a,b){return{url:"#example-web-item-url",pluginKey:"org.example.plugins",
moduleKey:"example-web-item",completeModuleKey:"org.example.plugins:example-web-item",linkText:"Client Web Item: "+a,hasTooltip:!0,tooltip:"Client Context Items: "+m(b).join(", "),hasIcon:!1,iconUrl:null,iconWidth:0,iconHeight:0,styleClass:"plugin-point",linkId:null,description:null,params:{},type:"ITEM",weight:1E3}},section:function(a,b){return{name:"example-web-section",key:"example-web-section",location:a,labelText:"Client Web Section: "+a,type:"SECTION",params:{},weight:1E3}},panel:function(a,
b){return{view:'\x3cdiv class\x3d"plugin-point web-panel"\x3e\x3cstrong\x3eClient Web Panel\x3c/strong\x3e: '+a+"\x3cbr /\x3e\x3cstrong\x3eClient Context Items\x3c/strong\x3e: "+m(b).join(", ")+"\x3c/div\x3e",weight:1E3}}},w=l("panel");l("item");return{getWebItems:l("item"),getWebSections:l("section"),getWebPanels:function(a,b){a=w(a,b);var c=a.length;for(b=0;b<c;b++)a[b]=a[b].view;return a},getWebFragmentDescriptors:function(a,b){return(a=(b=t[b])&&b[a])&&a.slice()||[]},addWebItemDescriptor:q("item"),
addWebSectionDescriptor:q("section"),addWebPanelDescriptor:q("panel"),getWebFragments:function(a,b,c){"string"!==typeof b&&(c=b,b=a);a=this.getWebItems(a,c);b=this.getWebSections(b,c);b=a.concat(b);b.sort(r);return b},_getValue:h,_formatI18n:function(a,b,c){var k=(a===b?c:a)||b||c||"";return function(a){var b=[],c=m(a);c.sort();var d,e=c.length;for(d=0;d<e;d++)b.push(a[c[d]]);return AJS.format(k,b)}},_getWebPanels:w,_getDeprecatedWebFragments:function(a,b,c){b=b.map(function(a){return a.toLowerCase()}).map(function(b){return[b,
WebFragments.getWebFragmentDescriptors(a,b)]});b.some(function(a){return _slicedToArray(a,2)[1].some(function(a){return"com.atlassian.bitbucket.server.bitbucket-client-web-fragments"!==a.pluginKey})})&&console.warn("The client-side web-fragment location '"+a+"' is deprecated and will be removed in a future release.");return b.reduce(function(a,b){b=_slicedToArray(b,2);var d=b[0];b=b[1].map(function(a){return p(a,c,d)}).filter(function(a){return a});"panel"===d&&b.forEach(function(a){return a.html=
a.view||""});return a.concat(b)},[]).sort(r)}}}();define("bitbucket/internal/util/web-fragment-manager",function(){return window.WebFragments});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-announcement-banner:announcement-banner-resources', location = '/static/bitbucket/internal/feature/announcement-banner/announcement-banner.soy' */
// This file was automatically generated from announcement-banner.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.feature.announcementBanner.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.feature == 'undefined') { bitbucket.internal.feature = {}; }
if (typeof bitbucket.internal.feature.announcementBanner == 'undefined') { bitbucket.internal.feature.announcementBanner = {}; }


bitbucket.internal.feature.announcementBanner.banner = function(opt_data, opt_ignored) {
  return '' + ((opt_data.enabled) ? '<div id="bitbucket-announcement-banner" class="aui-banner announcement-banner" role="banner"><div class="announcement-banner-content">' + soy.$$filterNoAutoescape(opt_data.html) + '</div></div>' : '');
};
if (goog.DEBUG) {
  bitbucket.internal.feature.announcementBanner.banner.soyTemplateName = 'bitbucket.internal.feature.announcementBanner.banner';
}
;
;
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:ajs-amd', location = 'lib/amd/ajs-amd.js' */
define("ajs",function(){return AJS});;
;
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:wrm-amd', location = 'lib/amd/wrm-amd.js' */
define("wrm/context-path",function(){return AJS.contextPath});define("wrm/data",function(){var a=function(){};if(WRM){if(typeof WRM.data==="function"){a=WRM.data}else{if(WRM.data&&typeof WRM.data.claim==="function"){a=WRM.data.claim}}}return{claim:a}});define("wrm",function(){if(WRM.data instanceof Function){WRM.data.claim=WRM.data}return WRM});;
;
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:backbone-amd', location = 'lib/amd/backbone-amd.js' */
define("backbone",function(){return Backbone});;
;
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:jquery-amd', location = 'lib/amd/jquery-amd.js' */
define("jquery",function(){return AJS.$});;
;
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin-api:underscore-amd', location = 'lib/amd/underscore-amd.js' */
define("underscore",function(){return _});;
;
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:configure-integration-data', location = 'admin/configure-integration-data.js' */
define("hipchat/admin/configure-integration-data",["jquery"],function(f){var e="com.atlassian.plugins.base-hipchat-integration-plugin";var d="configure-integration-data";var c="configure-integration";var a=WRM.data instanceof Function?WRM.data:WRM.data.claim;var b=a(e+":"+d+"."+c);return b});;
;
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:resources', location = 'admin/configure-hipchat.js' */
require(["hipchat/admin/configure-integration-data"],function(a){AJS.toInit(function(g){var d=g("#hipchat-integration-configuration").val();var k=window.localStorage;if(d){var j={self:g("#hipchat-route-config").val(),serverPing:g("#hipchat-route-check-server-connectivity").val(),clientPing:g("#hipchat-route-check-client-connectivity").val(),beginInstall:g("#hipchat-route-begin-install").val(),completeInstall:g("#hipchat-route-complete-install").val(),installableUrl:g("#hipchat-route-installable-url").val(),uninstall:g("#hipchat-route-uninstall").val(),redirectUrl:g("#hipchat-route-redirectUrl").val()};var e={screenshotResource:g("#hipchat-server-resource-screenshot").val(),screenshotResource2x:g("#hipchat-server-resource-screenshot-2x").val(),uninstalling:g("#hipchat-server-resource-uninstalling").val()};var l=HipChat.Templates.Configuration;var b=g("#hipchat-configuration-panel");if(a.linkId){var i=a.linkId}var h=(function(){var m;return{installing:function(){g("#hipchat-installing .hipchat-install-message").spin("large")},error:function(n){b.html(l.error({msg:n}))},uninstallError:function(n){if(n.status==401){b.html(l.uninstallPermissionError())}else{b.html(l.uninstallConnectionError())}},confirmUninstall:function(){var n=g.Deferred();if(!m){m=new AJS.Dialog(600,300,"hipchat-remove-link-dialog");m.addHeader("Remove integration","remove-warning");m.addPanel("Message Panel",l.removeLinkMessage());m.addButton("Remove integration",function(){m.hide();h.uninstall();n.resolve()});m.addCancel("Cancel",function(){m.hide();n.reject()})}m.show();return n.promise()},uninstall:function(){b.html(l.uninstalling({uninstallingImage:e.uninstalling}));g("#hipchat-uninstalling .hipchat-install-message").spin("large")},reinstallationSucceeded:function(){try{var n=require("aui/flag");n({type:"success",title:"Hipchat Integration updated",persistent:false,body:"Your Hipchat Integration has been successfully updated to the latest version, enjoy the new features."})}catch(o){}}}})();var f={serverPing:function(){return g.ajax(j.serverPing,{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({serverUrl:""})})},serverPingToUrl:function(m){return g.ajax(j.serverPing,{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({serverUrl:m})})},beginInstall:function(n,m){return g.ajax(j.beginInstall,{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({installableUrl:n,reinstall:m})})},completeInstall:function(m){return g.ajax(j.completeInstall,{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({installableUrl:m})})},remove:function(m){return g.ajax({url:j.uninstall+"/"+m,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({})})},reinstall:function(m){return g.ajax({url:j.uninstall+"/"+m,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({reinstall:true})})},removeDefault:function(){return g.ajax(j.uninstall,{type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({})})}};var c={initialize:function(m){switch(m){case"installing":c.installing();break;case"installed":c.installed(i);break;case"uninstalling":c.uninstalling();break;case"reinstall":c.reinstalling();break;case"configure":default:c.configure()}},redirect:function(m){window.location.replace(m)},navigate:function(m){window.location.assign(m)},configure:function(){f.serverPing().done(function(){g("#hipchat-install").removeAttr("disabled")}).fail(function(){g("#hipchat-server-failure").removeClass("hidden")}).always(function(){g("#hipchat-loading").hide()});g("#hipchat-install").click(function(n){n.preventDefault();if(g(this).attr("aria-disabled")){return}g(this).attr("aria-disabled","true");AJS.trigger("analyticsEvent",{name:"notifications.hipchat.server.registration.started",data:{}});f.beginInstall(undefined,false).done(c.navigate)});g("#enable-btf-install").click(function(n){n.preventDefault();window.onbeforeunload=null;m()});AJS.trigger("analyticsEvent",{name:"notifications.hipchat.server.discovered",data:{}});function m(){g(".hipchat-install-form").toggleClass("hipchat-btf");g("#btf-url").focus();g("#btf-install").click(function(o){g("#btf-error").hide();o.preventDefault();var n=g("#btf-url").val();var p=/^https?:\/\//i;if(!p.test(n)){n="https://"+n}f.serverPingToUrl(n).done(function(){f.beginInstall(n,false).done(c.navigate)}).fail(function(){g("#btf-error").show()})})}g("#btf-install-cancel").click(function(n){n.preventDefault();g(".hipchat-install-form").toggleClass("hipchat-btf")})},installing:function(){h.installing();f.completeInstall(j.installableUrl).done(function(m){c.redirect(j.self)}).error(h.error)},installed:function(){g("#hipchat-uninstall").click(function(m){m.preventDefault();if(g(this).attr("aria-disabled")){return}h.confirmUninstall().done(function(){f.remove(i).done(c.redirect).error(h.uninstallError)})});g(".hipchat-reinstall").click(function(){if(g(this).attr("aria-disabled")){return}var m=g(this);m.attr("aria-disabled",true);m.find(".aui-icon-wait").css("display","inline-block");f.reinstall(i).done(c.redirect).error(h.uninstallError)});if(k.getItem("hipchat-reinstalling")){h.reinstallationSucceeded();k.removeItem("hipchat-reinstalling")}},uninstalling:function(){f.removeDefault().done(function(){c.redirect(j.redirectUrl)}).error(h.uninstallError)},reinstalling:function(){function o(r){var u=window.location.search.substring(1);var t=u.split("&");for(var s=0;s<t.length;s++){var v=t[s].split("=");if(v[0]==r){if(v.length>1){return v[1]}else{return null}}}}var q=o("installable_url");if(q===undefined){console.log("ERROR: the 'installable_url' parameter was missing from the request URL:'"+window.location.search+"'")}else{var n=decodeURIComponent(q);var m=document.createElement("a");m.href=n;var p=m.protocol+"//"+m.host;f.serverPingToUrl(p).done(function(){k.setItem("hipchat-reinstalling",true);f.beginInstall(p,true).done(c.navigate)}).fail(function(){g("#btf-error").show()})}}};c.initialize(d)}})});;
;
/* module-key = 'com.atlassian.plugins.base-hipchat-integration-plugin:resources', location = 'admin/configure-hipchat.soy' */
// This file was automatically generated from configure-hipchat.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace HipChat.Templates.Configuration.
 */

if (typeof HipChat == 'undefined') { var HipChat = {}; }
if (typeof HipChat.Templates == 'undefined') { HipChat.Templates = {}; }
if (typeof HipChat.Templates.Configuration == 'undefined') { HipChat.Templates.Configuration = {}; }


HipChat.Templates.Configuration.installing = function(opt_data, opt_ignored) {
  return '' + HipChat.Templates.Configuration.connected({id: 'hipchat-installing', installHeading: 'Integrating with Hipchat', installImage: opt_data.installingImage, showRemove: false});
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.installing.soyTemplateName = 'HipChat.Templates.Configuration.installing';
}


HipChat.Templates.Configuration.uninstalling = function(opt_data, opt_ignored) {
  return '' + HipChat.Templates.Configuration.connected({id: 'hipchat-uninstalling', installHeading: 'Removing Hipchat Integration', installImage: opt_data.uninstallingImage, showRemove: false});
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.uninstalling.soyTemplateName = 'HipChat.Templates.Configuration.uninstalling';
}


HipChat.Templates.Configuration.connected = function(opt_data, opt_ignored) {
  return '<div id="' + soy.$$escapeHtml(opt_data.id) + '">' + ((opt_data.showRemove) ? HipChat.Templates.Configuration.uninstallButton(null) : '') + ((opt_data.installImage) ? '<img src="' + soy.$$escapeHtml(opt_data.installImage) + '" />' : '') + ((opt_data.installHeading) ? '<h5>' + soy.$$escapeHtml(opt_data.installHeading) + '</h5>' : '') + '<hr/><div class="hipchat-install-message">' + ((opt_data.installMessageHtml) ? '<p>' + soy.$$filterNoAutoescape(opt_data.installMessageHtml) + '</p>' : '') + '</div></div>';
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.connected.soyTemplateName = 'HipChat.Templates.Configuration.connected';
}


HipChat.Templates.Configuration.error = function(opt_data, opt_ignored) {
  return '' + HipChat.Templates.Configuration.message({type: 'error', title: 'Error encountered creating your Hipchat link', content: soy.$$escapeHtml("Something went wrong integrating Bitbucket and Hipchat. We probably had trouble connecting to the Hipchat server. Check that the connection between your server and Hipchat is working correctly and try again.") + '<p>' + soy.$$escapeHtml('Try uninstalling the existing integration from Hipchat before trying again.') + '</p>'});
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.error.soyTemplateName = 'HipChat.Templates.Configuration.error';
}


HipChat.Templates.Configuration.uninstallConnectionError = function(opt_data, opt_ignored) {
  return '' + HipChat.Templates.Configuration.message({type: 'error', title: 'Error encountered removing your Hipchat link', content: '' + soy.$$escapeHtml("Something went wrong removing the integration in Hipchat. We probably had trouble connecting to the Hipchat server. You may need to remove the integration from Hipchat\'s admin page. The link has been removed from Bitbucket.")});
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.uninstallConnectionError.soyTemplateName = 'HipChat.Templates.Configuration.uninstallConnectionError';
}


HipChat.Templates.Configuration.uninstallPermissionError = function(opt_data, opt_ignored) {
  return '' + HipChat.Templates.Configuration.message({type: 'error', title: 'Error encountered removing your Hipchat link', content: '' + soy.$$escapeHtml('You do not have permission to remove this integration, please contact your site admin if you wish to remove the Hipchat integration.')});
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.uninstallPermissionError.soyTemplateName = 'HipChat.Templates.Configuration.uninstallPermissionError';
}


HipChat.Templates.Configuration.refreshToken = function(opt_data, opt_ignored) {
  return '' + HipChat.Templates.Configuration.message({type: 'error', title: 'Setting up your Hipchat link', content: '' + soy.$$escapeHtml('Error encountered creating your Hipchat link')});
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.refreshToken.soyTemplateName = 'HipChat.Templates.Configuration.refreshToken';
}


HipChat.Templates.Configuration.message = function(opt_data, opt_ignored) {
  return '<div class="aui-message aui-message-' + soy.$$escapeHtml(opt_data.type) + ' ' + ((opt_data.altClass) ? soy.$$escapeHtml(opt_data.altClass) : '') + '"><p class="title"><strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' + ((opt_data.content) ? '<p>' + soy.$$filterNoAutoescape(opt_data.content) + '</p>' : '') + '</div>';
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.message.soyTemplateName = 'HipChat.Templates.Configuration.message';
}


HipChat.Templates.Configuration.removeLinkMessage = function(opt_data, opt_ignored) {
  return '<div class=\'remove-link-message\'>' + soy.$$filterNoAutoescape("\u003cp>Are you sure you want to completely remove your Hipchat integration?\u003c\/p>\u003cp>The Bitbucket plugin will not be removed from Hipchat.\u003c\/p>") + '</div>';
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.removeLinkMessage.soyTemplateName = 'HipChat.Templates.Configuration.removeLinkMessage';
}


HipChat.Templates.Configuration.installButton = function(opt_data, opt_ignored) {
  return '<div class="hipchat-install-form"><button class="aui-button aui-button-primary" type="submit" id="hipchat-install" disabled="disabled">' + soy.$$escapeHtml('Connect Hipchat') + '</button><div id="hipchat-loading"><span class="aui-icon aui-icon-wait"></span> ' + soy.$$escapeHtml('Checking your server can see Hipchat') + '</div><div id="hipchat-server-failure" class="hidden"><p><span class="aui-icon aui-icon-small aui-iconfont-warning hipchat-failure-marker"></span> ' + soy.$$escapeHtml('Unable to reach Hipchat') + '</p><p class="details">' + soy.$$escapeHtml("If Bitbucket does not have access to the internet you won\'t be able to integrate with Hipchat.") + '</p></div><div><button class="cancel aui-link aui-button aui-button-link" id="enable-btf-install">' + soy.$$escapeHtml('Or, if you\x27re using Hipchat Server, click here.') + '</button>' + HipChat.Templates.Configuration.btfInstall(null) + '</div></div>';
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.installButton.soyTemplateName = 'HipChat.Templates.Configuration.installButton';
}


HipChat.Templates.Configuration.btfInstall = function(opt_data, opt_ignored) {
  return '<form class="aui top-label" id="hipchat-btf-install"><fieldset class="top-label"><div class="field-group top-label"><label for="hipchat-btf-url" style="text-align:center">' + soy.$$escapeHtml('First things first, let us know where we can find your Hipchat Server:') + '</label><input class="text long-field" type="text" id="btf-url" name="btf-url" data-aui-notification-field="" placeholder="http://www.hipchat.com"></input><div class="error" id="btf-error">' + soy.$$escapeHtml('We couldn\x27t reach your server') + '</div></div></fieldset><div class="buttons-container"><button class="aui-button aui-button-primary" type="submit" id="btf-install">' + soy.$$escapeHtml('Connect Hipchat') + '</button><a class="cancel" href="#" id="btf-install-cancel">Cancel</a></div></form>';
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.btfInstall.soyTemplateName = 'HipChat.Templates.Configuration.btfInstall';
}


HipChat.Templates.Configuration.uninstallButton = function(opt_data, opt_ignored) {
  return '<button class="aui-button aui-button-subtle" id="hipchat-uninstall"><span class="aui-icon aui-icon-small aui-iconfont-delete">Configure</span> ' + soy.$$escapeHtml('Remove integration') + '</button>';
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.uninstallButton.soyTemplateName = 'HipChat.Templates.Configuration.uninstallButton';
}


HipChat.Templates.Configuration.inviteButton = function(opt_data, opt_ignored) {
  return '<input type="hidden" id="inviteButtonWaitingForMapping" value="' + soy.$$escapeHtml(opt_data.inviteButtonWaitingForMapping) + '"/><a class="aui-button aui-button-subtle hidden" id="hipchat-invite-button" href="' + soy.$$escapeHtml(opt_data.adminInviteUrl) + '"><span class="aui-icon aui-icon-small aui-iconfont-space-personal">Invite</span> ' + soy.$$escapeHtml('Invite users to Hipchat') + '</a>';
};
if (goog.DEBUG) {
  HipChat.Templates.Configuration.inviteButton.soyTemplateName = 'HipChat.Templates.Configuration.inviteButton';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:user-link', location = '/static/bitbucket/internal/widget/user/user-link.soy' */
// This file was automatically generated from user-link.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.widget.user.userLink.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.widget == 'undefined') { bitbucket.internal.widget = {}; }
if (typeof bitbucket.internal.widget.user == 'undefined') { bitbucket.internal.widget.user = {}; }
if (typeof bitbucket.internal.widget.user.userLink == 'undefined') { bitbucket.internal.widget.user.userLink = {}; }


bitbucket.internal.widget.user.userLink.userLink = function(opt_data, opt_ignored) {
  var output = '';
  var displayName__soy3 = opt_data.user.displayName || opt_data.user.name;
  output += (opt_data.href || opt_data.user.type == 'NORMAL' && opt_data.user.slug && !!(require('bitbucket/internal/model/page-state').getCurrentUser())) ? '<a href="' + soy.$$escapeHtml(opt_data.href ? opt_data.href : require('bitbucket/util/navbuilder').user(opt_data.user).build()) + '" ' + ((opt_data.extraClasses) ? 'class="' + soy.$$escapeHtml(opt_data.extraClasses) + '"' : '') + ((! opt_data.skipTitle) ? 'title="' + soy.$$escapeHtml(displayName__soy3) + '"' : '') + '>' + soy.$$escapeHtml(soy.$$truncate(displayName__soy3, 100, true)) + '</a>' : '<span' + ((opt_data.extraClasses) ? ' class="' + soy.$$escapeHtml(opt_data.extraClasses) + '"' : '') + ((! opt_data.skipTitle) ? ' title="' + soy.$$escapeHtml(displayName__soy3) + '"' : '') + '>' + soy.$$escapeHtml(soy.$$truncate(displayName__soy3, 100, true)) + '</span>';
  return output;
};
if (goog.DEBUG) {
  bitbucket.internal.widget.user.userLink.userLink.soyTemplateName = 'bitbucket.internal.widget.user.userLink.userLink';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:avatar', location = '/static/bitbucket/internal/widget/avatar/access-key-avatar.soy' */
// This file was automatically generated from access-key-avatar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.widget.avatar.accessKeyAvatar.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.widget == 'undefined') { bitbucket.internal.widget = {}; }
if (typeof bitbucket.internal.widget.avatar == 'undefined') { bitbucket.internal.widget.avatar = {}; }
if (typeof bitbucket.internal.widget.avatar.accessKeyAvatar == 'undefined') { bitbucket.internal.widget.avatar.accessKeyAvatar = {}; }


bitbucket.internal.widget.avatar.accessKeyAvatar.accessKey = function(opt_data, opt_ignored) {
  return '<span title="' + soy.$$escapeHtml(opt_data.text) + '"><span class="aui-avatar aui-avatar-' + soy.$$escapeHtml(opt_data.size) + ' key-avatar"></span><span class="access-key-label">' + soy.$$escapeHtml(opt_data.label || opt_data.text) + '</span></span>';
};
if (goog.DEBUG) {
  bitbucket.internal.widget.avatar.accessKeyAvatar.accessKey.soyTemplateName = 'bitbucket.internal.widget.avatar.accessKeyAvatar.accessKey';
}


bitbucket.internal.widget.avatar.accessKeyAvatar.accessKeyWithText = function(opt_data, opt_ignored) {
  return bitbucket.internal.widget.avatar.accessKeyAvatar.accessKey(opt_data) + '<span class="access-key-text" title="' + soy.$$escapeHtml(opt_data.text) + '">' + soy.$$escapeHtml(opt_data.text) + '</span>';
};
if (goog.DEBUG) {
  bitbucket.internal.widget.avatar.accessKeyAvatar.accessKeyWithText.soyTemplateName = 'bitbucket.internal.widget.avatar.accessKeyAvatar.accessKeyWithText';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:avatar', location = '/static/bitbucket/internal/widget/avatar/group-avatar.soy' */
// This file was automatically generated from group-avatar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.widget.avatar.groupAvatar.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.widget == 'undefined') { bitbucket.internal.widget = {}; }
if (typeof bitbucket.internal.widget.avatar == 'undefined') { bitbucket.internal.widget.avatar = {}; }
if (typeof bitbucket.internal.widget.avatar.groupAvatar == 'undefined') { bitbucket.internal.widget.avatar.groupAvatar = {}; }


bitbucket.internal.widget.avatar.groupAvatar.groupAvatar = function(opt_data, opt_ignored) {
  return '<span class="aui-avatar aui-avatar-' + soy.$$escapeHtml(opt_data.size) + ' group-avatar' + soy.$$escapeHtml(opt_data.extraClasses ? ' ' + opt_data.extraClasses : '') + '" data-groupname="' + soy.$$escapeHtml(opt_data.name) + '"></span>';
};
if (goog.DEBUG) {
  bitbucket.internal.widget.avatar.groupAvatar.groupAvatar.soyTemplateName = 'bitbucket.internal.widget.avatar.groupAvatar.groupAvatar';
}


bitbucket.internal.widget.avatar.groupAvatar.groupAvatarWithName = function(opt_data, opt_ignored) {
  return '<span title="' + soy.$$escapeHtml(opt_data.name) + '"' + ((opt_data.extraClasses) ? ' class="' + soy.$$escapeHtml(opt_data.extraClasses) + '"' : '') + '><span class="aui-avatar aui-avatar-' + soy.$$escapeHtml(opt_data.size) + ' group-avatar' + soy.$$escapeHtml(opt_data.avatarClasses ? ' ' + opt_data.avatarClasses : '') + '" data-groupname="' + soy.$$escapeHtml(opt_data.name) + '"></span>' + soy.$$escapeHtml(opt_data.name) + '</span>';
};
if (goog.DEBUG) {
  bitbucket.internal.widget.avatar.groupAvatar.groupAvatarWithName.soyTemplateName = 'bitbucket.internal.widget.avatar.groupAvatar.groupAvatarWithName';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:avatar', location = '/static/bitbucket/internal/widget/avatar/avatar.soy' */
// This file was automatically generated from avatar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.widget.avatar.avatar.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.widget == 'undefined') { bitbucket.internal.widget = {}; }
if (typeof bitbucket.internal.widget.avatar == 'undefined') { bitbucket.internal.widget.avatar = {}; }
if (typeof bitbucket.internal.widget.avatar.avatar == 'undefined') { bitbucket.internal.widget.avatar.avatar = {}; }


bitbucket.internal.widget.avatar.avatar.avatar = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: require('bitbucket/util/navbuilder')._avatarUrl(opt_data.person, ({XSMALL:32,SMALL:48,MEDIUM:64,LARGE:96,XLARGE:128,XXLARGE:192,XXXLARGE:256})[opt_data.size.toUpperCase()]).build(), accessibilityText: opt_data.person.displayName || opt_data.person.name, title: opt_data.tooltip, badgeContent: opt_data.badgeContent, extraClasses: 'user-avatar' + (opt_data.hideBadge ? ' badge-hidden' : '') + (opt_data.extraClasses ? ' ' + opt_data.extraClasses : ''), imageClasses: opt_data.imageClasses, extraAttributes: {'data-username': opt_data.person.name}, id: opt_data.id});
};
if (goog.DEBUG) {
  bitbucket.internal.widget.avatar.avatar.avatar.soyTemplateName = 'bitbucket.internal.widget.avatar.avatar.avatar';
}


bitbucket.internal.widget.avatar.avatar.avatarWithName = function(opt_data, opt_ignored) {
  var output = '';
  var personName__soy14 = opt_data.person.displayName || opt_data.person.name;
  output += '<div class="avatar-with-name' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + ((opt_data.deleted) ? ' deleted-user' : '') + '" title="' + soy.$$escapeHtml(personName__soy14) + '">' + bitbucket.internal.widget.avatar.avatar.avatar({size: opt_data.size, person: opt_data.person, imageClasses: opt_data.imageClasses, extraClasses: opt_data.avatarClasses, badgeContent: opt_data.badgeContent, hideBadge: opt_data.hideBadge, id: opt_data.id}) + ((opt_data.link && ! opt_data.deleted) ? bitbucket.internal.widget.user.userLink.userLink({user: opt_data.person, href: opt_data.href, extraClasses: opt_data.linkExtraClasses, skipTitle: true}) : '<span class="display-name">' + soy.$$escapeHtml(personName__soy14) + '</span>') + '</div>';
  return output;
};
if (goog.DEBUG) {
  bitbucket.internal.widget.avatar.avatar.avatarWithName.soyTemplateName = 'bitbucket.internal.widget.avatar.avatar.avatarWithName';
}


bitbucket.internal.widget.avatar.avatar.avatarWithNameAndEmail = function(opt_data, opt_ignored) {
  return bitbucket.internal.widget.avatar.avatar.avatarWithName(opt_data) + '<span class="email-address" title="' + soy.$$escapeHtml(opt_data.person.emailAddress) + '">' + soy.$$escapeHtml(opt_data.person.emailAddress) + '</span>';
};
if (goog.DEBUG) {
  bitbucket.internal.widget.avatar.avatar.avatarWithNameAndEmail.soyTemplateName = 'bitbucket.internal.widget.avatar.avatar.avatarWithNameAndEmail';
}


bitbucket.internal.widget.avatar.avatar.avatarSizeInPx = function(opt_data, opt_ignored) {
  return '' + soy.$$escapeHtml(({XSMALL:32,SMALL:48,MEDIUM:64,LARGE:96,XLARGE:128,XXLARGE:192,XXXLARGE:256})[opt_data.size.toUpperCase()]) + ((opt_data.showPx) ? 'px' : '');
};
if (goog.DEBUG) {
  bitbucket.internal.widget.avatar.avatar.avatarSizeInPx.soyTemplateName = 'bitbucket.internal.widget.avatar.avatar.avatarSizeInPx';
}


bitbucket.internal.widget.avatar.avatar.avatarWithBadge = function(opt_data, opt_ignored) {
  return '' + bitbucket.internal.widget.avatar.avatar.avatar({size: opt_data.size, person: opt_data.person, tooltip: opt_data.tooltip, imageClasses: opt_data.imageClasses, extraClasses: opt_data.extraClasses, id: opt_data.id, hideBadge: opt_data.hideBadge, badgeContent: '<span class="badge' + soy.$$escapeHtml(opt_data.badgeClasses ? ' ' + opt_data.badgeClasses : '') + '">' + soy.$$escapeHtml(opt_data.badgeText) + '</span>'});
};
if (goog.DEBUG) {
  bitbucket.internal.widget.avatar.avatar.avatarWithBadge.soyTemplateName = 'bitbucket.internal.widget.avatar.avatar.avatarWithBadge';
}


bitbucket.internal.widget.avatar.avatar.avatarWithNameAndBadge = function(opt_data, opt_ignored) {
  return '' + bitbucket.internal.widget.avatar.avatar.avatarWithName({size: opt_data.size, person: opt_data.person, extraClasses: opt_data.extraClasses, avatarClasses: opt_data.avatarClasses, imageClasses: opt_data.imageClasses, id: opt_data.id, hideBadge: opt_data.hideBadge, badgeContent: '<span class="badge' + soy.$$escapeHtml(opt_data.badgeClasses ? ' ' + opt_data.badgeClasses : '') + '">' + soy.$$escapeHtml(opt_data.badgeText) + '</span>'});
};
if (goog.DEBUG) {
  bitbucket.internal.widget.avatar.avatar.avatarWithNameAndBadge.soyTemplateName = 'bitbucket.internal.widget.avatar.avatar.avatarWithNameAndBadge';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:person-model', location = '/static/bitbucket/internal/model/person.js' */
define("bitbucket/internal/model/person",["module","exports","backbone-brace"],function(c,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.default=(a&&a.__esModule?a:{default:a}).default.Model.extend({namedAttributes:{emailAddress:"string",name:"string"},idAttribute:"name",initialize:function(){null==this.namedAttributes.id&&this.setId(this.attributes[this.idAttribute])}});c.exports=b["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:stash-user-model', location = '/static/bitbucket/internal/model/stash-user.js' */
define("bitbucket/internal/model/stash-user",["module","exports","bitbucket/internal/model/person"],function(c,b,a){Object.defineProperty(b,"__esModule",{value:!0});a=(a&&a.__esModule?a:{default:a}).default.extend({namedAttributes:{active:"boolean",avatarUrl:"string",displayName:"string",id:"number",isAdmin:"boolean",link:Object,links:Object,type:"string",slug:"string"}});b.default=a;c.exports=b["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:baconjs', location = '/static/lib/baconjs/bacon.js' */
(function(){var E,ha={}.hasOwnProperty,k=[].slice,v=function(a,b){function c(){this.constructor=a}for(var d in b)ha.call(b,d)&&(a[d]=b[d]);c.prototype=b.prototype;a.prototype=new c;a.__super__=b.prototype;return a},F=function(a,b){return function(){return a.apply(b,arguments)}};var e={toString:function(){return"Bacon"},version:"0.7.42"};var M=("undefined"!==typeof global&&null!==global?global:this).Error;var l={indexOf:Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){var c,
d;var f=c=0;for(d=a.length;c<d;f=++c){var e=a[f];if(b===e)return f}return-1},indexWhere:function(a,b){var c,d;var f=c=0;for(d=a.length;c<d;f=++c){var e=a[f];if(b(e))return f}return-1},head:function(a){return a[0]},always:function(a){return function(){return a}},negate:function(a){return function(b){return!a(b)}},empty:function(a){return 0===a.length},tail:function(a){return a.slice(1,a.length)},filter:function(a,b){var c;var d=[];var f=0;for(c=b.length;f<c;f++){var e=b[f];a(e)&&d.push(e)}return d},
map:function(a,b){var c;var d=[];var f=0;for(c=b.length;f<c;f++){var e=b[f];d.push(a(e))}return d},each:function(a,b){var c;for(c in a){var d=a[c];b(c,d)}},toArray:function(a){return y(a)?a:[a]},contains:function(a,b){return-1!==l.indexOf(a,b)},id:function(a){return a},last:function(a){return a[a.length-1]},all:function(a,b){var c;null==b&&(b=l.id);var d=0;for(c=a.length;d<c;d++){var f=a[d];if(!b(f))return!1}return!0},any:function(a,b){var c;null==b&&(b=l.id);var d=0;for(c=a.length;d<c;d++){var f=
a[d];if(b(f))return!0}return!1},without:function(a,b){return l.filter(function(b){return b!==a},b)},remove:function(a,b){a=l.indexOf(b,a);if(0<=a)return b.splice(a,1)},fold:function(a,b,c){var d;var f=0;for(d=a.length;f<d;f++){var e=a[f];b=c(b,e)}return b},flatMap:function(a,b){return l.fold(b,[],function(b,d){return b.concat(a(d))})},cached:function(a){var b=B;return function(){b===B&&(b=a(),a=void 0);return b}},toString:function(a){var b,c;try{T++;if(null==a)return"undefined";if(r(a))return"function";
if(y(a))return 5<T?"[..]":"["+l.map(l.toString,a).toString()+"]";if(null!=(null!=a?a.toString:void 0)&&a.toString!==Object.prototype.toString)return a.toString();if("object"===typeof a){if(5<T)return"{..}";var d=[];for(c in a)if(ha.call(a,c)){try{var f=a[c]}catch(h){f=b=h}d.push(l.toString(c)+":"+l.toString(f))}return"{"+d+"}"}return a}finally{T--}}};var T=0;e._=l;e.scheduler={setTimeout:function(a,b){return setTimeout(a,b)},setInterval:function(a,b){return setInterval(a,b)},clearInterval:function(a){return clearInterval(a)},
now:function(){return(new Date).getTime()}};e.fromBinder=function(a,b){null==b&&(b=l.id);return new w(t(e,"fromBinder",a,b),function(c){var d;var f=d=!1;var h=function(){if(!d)return"undefined"!==typeof m&&null!==m?(m(),d=!0):f=!0};var m=a(function(){var a;var d=1<=arguments.length?k.call(arguments,0):[];var f=b.apply(this,d);y(f)&&l.last(f)instanceof N||(f=[f]);var m=e.more;var g=0;for(a=f.length;g<a;g++)if(d=f[g],m=c(d=Z(d)),m===e.noMore||d.isEnd()){h();break}return m});f&&h();return h})};e.$={};
e.$.asEventStream=function(a,b,c){if(r(b)){var d=[b,void 0];c=d[0];b=d[1]}return g(this.selector||this,"asEventStream",a,e.fromBinder(function(c){return function(d){c.on(a,b,d);return function(){return c.off(a,b,d)}}}(this),c))};null!=(E="undefined"!==typeof jQuery&&null!==jQuery?jQuery:"undefined"!==typeof Zepto&&null!==Zepto?Zepto:void 0)&&(E.fn.asEventStream=e.$.asEventStream);e.fromEventTarget=function(a,b,c){var d,f,h,m,n,ia;var z=null!=(d=null!=(f=null!=(h=a.addEventListener)?h:a.addListener)?
f:a.bind)?d:a.on;var u=null!=(m=null!=(n=null!=(ia=a.removeEventListener)?ia:a.removeListener)?n:a.unbind)?m:a.off;return g(e,"fromEventTarget",a,b,e.fromBinder(function(c){z.call(a,b,c);return function(){return u.call(a,b,c)}},c))};e.fromPromise=function(a,b){return g(e,"fromPromise",a,e.fromBinder(function(c){a.then(c,function(b){return c(G(b))});return function(){if(b)return"function"===typeof a.abort?a.abort():void 0}},function(b){return[b,p()]}))};e.noMore=["\x3cno-more\x3e"];e.more=["\x3cmore\x3e"];
e.later=function(a,b){return g(e,"later",a,b,e.fromPoll(a,function(){return[b,p()]}))};e.sequentially=function(a,b){var c=0;return g(e,"sequentially",a,b,e.fromPoll(a,function(){var a=b[c++];return c<b.length?a:c===b.length?[a,p()]:p()}))};e.repeatedly=function(a,b){var c=0;return g(e,"repeatedly",a,b,e.fromPoll(a,function(){return b[c++%b.length]}))};e.spy=function(a){return U.push(a)};var U=[];var O=function(a){var b;if(U.length&&!O.running)try{O.running=!0;var c=0;for(b=U.length;c<b;c++){var d=
U[c];d(a)}}finally{delete O.running}};var ja=function(a){return function(){var b=arguments[0];var c=2<=arguments.length?k.call(arguments,1):[];if("object"===typeof b&&c.length){var d=b;var f=c[0];b=function(){return d[f].apply(d,arguments)};c=c.slice(1)}return a.apply(null,[b].concat(k.call(c)))}};E=function(a,b){return ja(function(){var c=arguments[0];var d=2<=arguments.length?k.call(arguments,1):[];var f=ka(b,[function(b,a){return c.apply(null,k.call(b).concat([a]))}]);return g.apply(null,[e,a,
c].concat(k.call(d),[e.combineAsArray(d).flatMap(f)]))})};e.fromCallback=E("fromCallback",function(){var a=arguments[0];var b=2<=arguments.length?k.call(arguments,1):[];return e.fromBinder(function(c){aa(a,b)(c);return q},function(b){return[b,p()]})});e.fromNodeCallback=E("fromNodeCallback",function(){var a=arguments[0];var b=2<=arguments.length?k.call(arguments,1):[];return e.fromBinder(function(c){aa(a,b)(c);return q},function(b,a){return b?[G(b),p()]:[a,p()]})});e.fromPoll=function(a,b){return g(e,
"fromPoll",a,b,e.fromBinder(function(b){var c=e.scheduler.setInterval(b,a);return function(){return e.scheduler.clearInterval(c)}},b))};e.interval=function(a,b){null==b&&(b={});return g(e,"interval",a,b,e.fromPoll(a,function(){return H(b)}))};e.constant=function(a){return new I(t(e,"constant",a),function(b){b(ba(a));b(p());return q})};e.never=function(){return new w(t(e,"never"),function(a){a(p());return q})};e.once=function(a){return new w(t(e,"once",a),function(b){b(Z(a));b(p());return q})};e.fromArray=
function(a){ta(a);if(a.length){var b=0;return new w(t(e,"fromArray",a),function(c){var d=!1;var f=e.more;var h=function(){if(f!==e.noMore&&!d){var m=a[b++];f=c(Z(m));if(f!==e.noMore)return b===a.length?c(p()):C.afterTransaction(h)}};h();return function(){return d=!0}})}return g(e,"fromArray",a,e.never())};e.mergeAll=function(){var a=1<=arguments.length?k.call(arguments,0):[];y(a[0])&&(a=a[0]);return a.length?new w(t.apply(null,[e,"mergeAll"].concat(k.call(a))),function(b){var c=0;var d=l.map(function(d){return function(f){return d.dispatcher.subscribe(function(d){if(d.isEnd())return c++,
c===a.length?b(p()):e.more;d=b(d);d===e.noMore&&f();return d})}},a);return la.apply(null,d)}):e.never()};e.zipAsArray=function(){var a=1<=arguments.length?k.call(arguments,0):[];y(a[0])&&(a=a[0]);return g.apply(null,[e,"zipAsArray"].concat(k.call(a),[e.zipWith(a,function(){return 1<=arguments.length?k.call(arguments,0):[]})]))};e.zipWith=function(){var a=arguments[0];var b=2<=arguments.length?k.call(arguments,1):[];r(a)||(a=[a,b[0]],b=a[0],a=a[1]);b=l.map(function(b){return b.toEventStream()},b);
return g.apply(null,[e,"zipWith",a].concat(k.call(b),[e.when(b,a)]))};e.groupSimultaneous=function(){var a;var b=1<=arguments.length?k.call(arguments,0):[];1===b.length&&y(b[0])&&(b=b[0]);var c=function(){var c;var f=[];var e=0;for(c=b.length;e<c;e++)a=b[e],f.push(new ua(a));return f}();return g.apply(null,[e,"groupSimultaneous"].concat(k.call(b),[e.when(c,function(){return 1<=arguments.length?k.call(arguments,0):[]})]))};e.combineAsArray=function(){var a,b,c;var d=1<=arguments.length?k.call(arguments,
0):[];1===d.length&&y(d[0])&&(d=d[0]);var f=b=0;for(c=d.length;b<c;f=++b){var h=d[f];P(h)||(d[f]=e.constant(h))}return d.length?(f=function(){var b;var c=[];var f=0;for(b=d.length;f<b;f++)a=d[f],c.push(new A(a,!0));return c}(),g.apply(null,[e,"combineAsArray"].concat(k.call(d),[e.when(f,function(){return 1<=arguments.length?k.call(arguments,0):[]}).toProperty()]))):e.constant([])};e.onValues=function(){var a;var b=2<=arguments.length?k.call(arguments,0,a=arguments.length-1):(a=0,[]);a=arguments[a++];
return e.combineAsArray(b).onValues(a)};e.combineWith=function(){var a=arguments[0];var b=2<=arguments.length?k.call(arguments,1):[];return g.apply(null,[e,"combineWith",a].concat(k.call(b),[e.combineAsArray(b).map(function(b){return a.apply(null,b)})]))};e.combineTemplate=function(a){var b=[];var c=[];var d=function(b){return b[b.length-1]};var f=function(b,a,c){return d(b)[a]=c};var h=function(b,a){return function(c,d){return f(c,b,d[a])}};var m=function(b,a){return function(c){return f(c,b,a)}};
var n=function(b){return y(b)?[]:{}};var k=function(a,d){if(P(d))return c.push(d),b.push(h(a,c.length-1));if(d!==Object(d)||"function"===typeof d||d instanceof RegExp||d instanceof Date)return b.push(m(a,d));b.push(function(b){return function(a){var c=n(d);f(a,b,c);return a.push(c)}}(a));z(d);return b.push(function(b){return b.pop()})};var z=function(b){return l.each(b,k)};z(a);return g(e,"combineTemplate",a,e.combineAsArray(c).map(function(c){var d;var f=n(a);var e=[f];var h=0;for(d=b.length;h<d;h++){var m=
b[h];m(e,c)}return f}))};e.retry=function(a){if(!r(a.source))throw new M("'source' option has to be a function");var b=a.source;var c=a.retries||0;var d=a.maxRetries||c;var f=a.delay||function(){return 0};var h=a.isRetryable||function(){return!0};var m=function(a){var m={source:b,retries:c-1,maxRetries:d,delay:f,isRetryable:h};return e.later(f(a)).filter(!1).concat(e.once().flatMap(function(){return e.retry(m)}))};return g(e,"retry",a,b().flatMapError(function(b){return h(b)&&0<c?m({error:b,retriesDone:d-
c}):e.once(G(b))}))};var va=0;var N=function(){function a(){this.id=++va}a.prototype.isEvent=function(){return!0};a.prototype.isEnd=function(){return!1};a.prototype.isInitial=function(){return!1};a.prototype.isNext=function(){return!1};a.prototype.isError=function(){return!1};a.prototype.hasValue=function(){return!1};a.prototype.filter=function(){return!0};a.prototype.inspect=function(){return this.toString()};a.prototype.log=function(){return this.toString()};return a}();var V=function(a){function b(a,
d){b.__super__.constructor.call(this);!d&&r(a)||a instanceof b?(this.valueF=a,this.valueInternal=void 0):(this.valueF=void 0,this.valueInternal=a)}v(b,a);b.prototype.isNext=function(){return!0};b.prototype.hasValue=function(){return!0};b.prototype.value=function(){this.valueF instanceof b?(this.valueInternal=this.valueF.value(),this.valueF=void 0):this.valueF&&(this.valueInternal=this.valueF(),this.valueF=void 0);return this.valueInternal};b.prototype.fmap=function(b){if(this.valueInternal){var a=
this.valueInternal;return this.apply(function(){return b(a)})}var c=this;return this.apply(function(){return b(c.value())})};b.prototype.apply=function(a){return new b(a)};b.prototype.filter=function(b){return b(this.value())};b.prototype.toString=function(){return l.toString(this.value())};b.prototype.log=function(){return this.value()};return b}(N);var Q=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}v(b,a);b.prototype.isInitial=function(){return!0};b.prototype.isNext=
function(){return!1};b.prototype.apply=function(a){return new b(a)};b.prototype.toNext=function(){return new V(this)};return b}(V);var ma=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}v(b,a);b.prototype.isEnd=function(){return!0};b.prototype.fmap=function(){return this};b.prototype.apply=function(){return this};b.prototype.toString=function(){return"\x3cend\x3e"};return b}(N);var G=function(a){function b(b){this.error=b}v(b,a);b.prototype.isError=function(){return!0};
b.prototype.fmap=function(){return this};b.prototype.apply=function(){return this};b.prototype.toString=function(){return"\x3cerror\x3e "+l.toString(this.error)};return b}(N);var wa=0;var x=function(){function a(b){this.id=++wa;g(b,this);this.initialDesc=this.desc}a.prototype.subscribe=function(b){return C.wrappedSubscribe(this,b)};a.prototype.subscribeInternal=function(b){return this.dispatcher.subscribe(b)};a.prototype.onValue=function(){var b=J(arguments);return this.subscribe(function(a){if(a.hasValue())return b(a.value())})};
a.prototype.onValues=function(b){return this.onValue(function(a){return b.apply(null,a)})};a.prototype.onError=function(){var b=J(arguments);return this.subscribe(function(a){if(a.isError())return b(a.error)})};a.prototype.onEnd=function(){var b=J(arguments);return this.subscribe(function(a){if(a.isEnd())return b()})};a.prototype.errors=function(){return g(this,"errors",this.filter(function(){return!1}))};a.prototype.filter=function(){var b=arguments[0];var a=2<=arguments.length?k.call(arguments,
1):[];return R(this,b,a,function(b){return g(this,"filter",b,this.withHandler(function(a){return a.filter(b)?this.push(a):e.more}))})};a.prototype.takeWhile=function(){var b=arguments[0];var a=2<=arguments.length?k.call(arguments,1):[];return R(this,b,a,function(b){return g(this,"takeWhile",b,this.withHandler(function(a){if(a.filter(b))return this.push(a);this.push(p());return e.noMore}))})};a.prototype.endOnError=function(){var b=arguments[0];var a=2<=arguments.length?k.call(arguments,1):[];null==
b&&(b=!0);return R(this,b,a,function(b){return g(this,"endOnError",this.withHandler(function(a){return a.isError()&&b(a.error)?(this.push(a),this.push(p())):this.push(a)}))})};a.prototype.take=function(b){return 0>=b?e.never():g(this,"take",b,this.withHandler(function(a){if(a.hasValue()){b--;if(0<b)return this.push(a);0===b&&this.push(a);this.push(p());return e.noMore}return this.push(a)}))};a.prototype.map=function(){var b=arguments[0];var a=2<=arguments.length?k.call(arguments,1):[];return b instanceof
I?b.sampledBy(this,xa):R(this,b,a,function(b){return g(this,"map",b,this.withHandler(function(a){return this.push(a.fmap(b))}))})};a.prototype.mapError=function(){var b=J(arguments);return g(this,"mapError",b,this.withHandler(function(a){return a.isError()?this.push(H(b(a.error))):this.push(a)}))};a.prototype.mapEnd=function(){var b=J(arguments);return g(this,"mapEnd",b,this.withHandler(function(a){return a.isEnd()?(this.push(H(b(a))),this.push(p()),e.noMore):this.push(a)}))};a.prototype.doAction=
function(){var a=J(arguments);return g(this,"doAction",a,this.withHandler(function(b){b.hasValue()&&a(b.value());return this.push(b)}))};a.prototype.skip=function(a){return g(this,"skip",a,this.withHandler(function(b){return b.hasValue()&&0<a?(a--,e.more):this.push(b)}))};a.prototype.skipDuplicates=function(a){null==a&&(a=function(a,b){return a===b});return g(this,"skipDuplicates",this.withStateMachine(B,function(b,d){return d.hasValue()?d.isInitial()||b===B||!a(b.get(),d.value())?[new L(d.value()),
[d]]:[b,[]]:[b,[d]]}))};a.prototype.skipErrors=function(){return g(this,"skipErrors",this.withHandler(function(a){return a.isError()?e.more:this.push(a)}))};a.prototype.withStateMachine=function(a,c){var b=a;return g(this,"withStateMachine",a,c,this.withHandler(function(a){var d;a=c(b,a);var f=a[0];a=a[1];b=f;var g=e.more;f=0;for(d=a.length;f<d&&(g=a[f],g=this.push(g),g!==e.noMore);f++);return g}))};a.prototype.scan=function(a,c){var b;c=W(c);var f=na(a);var h=function(a){return function(d){var h=
!1;var m=q;var g=e.more;var n=function(){if(!h)return f.forEach(function(a){h=!0;g=d(new Q(function(){return a}));if(g===e.noMore)return m(),m=q})};m=a.dispatcher.subscribe(function(a){if(a.hasValue()){if(h&&a.isInitial())return e.more;a.isInitial()||n();h=!0;var b=f.getOrElse(void 0);var m=c(b,a.value());f=new L(m);return d(a.apply(function(){return m}))}a.isEnd()&&(g=n());if(g!==e.noMore)return d(a)});C.whenDoneWith(b,n);return m}}(this);return b=new I(t(this,"scan",a,c),h)};a.prototype.fold=function(a,
c){return g(this,"fold",a,c,this.scan(a,c).sampledBy(this.filter(!1).mapEnd().toProperty()))};a.prototype.zip=function(a,c){null==c&&(c=Array);return g(this,"zip",a,e.zipWith([this,a],c))};a.prototype.diff=function(a,c){c=W(c);return g(this,"diff",a,c,this.scan([a],function(a,b){return[b,c(a[0],b)]}).filter(function(a){return 2===a.length}).map(function(a){return a[1]}))};a.prototype.flatMap=function(){return ca(this,X(arguments))};a.prototype.flatMapFirst=function(){return ca(this,X(arguments),!0)};
a.prototype.flatMapWithConcurrencyLimit=function(){var a=arguments[0];var c=2<=arguments.length?k.call(arguments,1):[];return g.apply(null,[this,"flatMapWithConcurrencyLimit",a].concat(k.call(c),[ca(this,X(c),!1,a)]))};a.prototype.flatMapLatest=function(){var a=X(arguments);var c=this.toEventStream();return g(this,"flatMapLatest",a,c.flatMap(function(b){return oa(a(b)).takeUntil(c)}))};a.prototype.flatMapError=function(a){return g(this,"flatMapError",a,this.mapError(function(a){return G(a)}).flatMap(function(b){return b instanceof
G?a(b.error):e.once(b)}))};a.prototype.flatMapConcat=function(){return g.apply(null,[this,"flatMapConcat"].concat(k.call(arguments),[this.flatMapWithConcurrencyLimit.apply(this,[1].concat(k.call(arguments)))]))};a.prototype.bufferingThrottle=function(a){return g(this,"bufferingThrottle",a,this.flatMapConcat(function(b){return e.once(b).concat(e.later(a).filter(!1))}))};a.prototype.not=function(){return g(this,"not",this.map(function(a){return!a}))};a.prototype.log=function(){var a=1<=arguments.length?
k.call(arguments,0):[];this.subscribe(function(b){return"undefined"!==typeof console&&null!==console?"function"===typeof console.log?console.log.apply(console,k.call(a).concat([b.log()])):void 0:void 0});return this};a.prototype.slidingWindow=function(a,c){null==c&&(c=0);return g(this,"slidingWindow",a,c,this.scan([],function(b,c){return b.concat([c]).slice(-a)}).filter(function(a){return a.length>=c}))};a.prototype.combine=function(a,c){var b=W(c);return g(this,"combine",a,c,e.combineAsArray(this,
a).map(function(a){return b(a[0],a[1])}))};a.prototype.decode=function(a){return g(this,"decode",a,this.combine(e.combineTemplate(a),function(a,b){return b[a]}))};a.prototype.awaiting=function(a){return g(this,"awaiting",a,e.groupSimultaneous(this,a).map(function(a){return 0===a[1].length}).toProperty(!1).skipDuplicates())};a.prototype.name=function(a){this._name=a;return this};a.prototype.withDescription=function(){return t.apply(null,arguments).apply(this)};a.prototype.toString=function(){return this._name?
this._name:this.desc.toString()};a.prototype.internalDeps=function(){return this.initialDesc.deps()};return a}();x.prototype.reduce=x.prototype.fold;x.prototype.assign=x.prototype.onValue;x.prototype.inspect=x.prototype.toString;var ca=function(a,b,c,d){var f=[a];var h=[];var m=new w(t(a,"flatMap"+(c?"First":""),b),function(f){var m=new da;var g=[];var n=function(a){var c=oa(b(a.value()));h.push(c);return m.add(function(a,b){return c.dispatcher.subscribe(function(d){if(d.isEnd())return l.remove(c,
h),k(),D(b),e.noMore;d instanceof Q&&(d=d.toNext());d=f(d);d===e.noMore&&a();return d})})};var k=function(){var a;if(a=g.shift())return n(a)};var D=function(a){a();if(m.empty())return f(p())};m.add(function(b,h){return a.dispatcher.subscribe(function(a){return a.isEnd()?D(h):a.isError()?f(a):c&&1<m.count()?e.more:m.unsubscribed?e.noMore:d&&m.count()>d?g.push(a):n(a)})});return m.unsubscribe});m.internalDeps=function(){return h.length?f.concat(h):f};return m};var w=function(a){function b(a,d,f){r(a)&&
(f=d,d=a,a=[]);b.__super__.constructor.call(this,a);Y(d);this.dispatcher=new ea(d,f);O(this)}v(b,a);b.prototype.delay=function(a){return g(this,"delay",a,this.flatMap(function(b){return e.later(a,b)}))};b.prototype.debounce=function(a){return g(this,"debounce",a,this.flatMapLatest(function(b){return e.later(a,b)}))};b.prototype.debounceImmediate=function(a){return g(this,"debounceImmediate",a,this.flatMapFirst(function(b){return e.once(b).concat(e.later(a).filter(!1))}))};b.prototype.throttle=function(a){return g(this,
"throttle",a,this.bufferWithTime(a).map(function(a){return a[a.length-1]}))};b.prototype.bufferWithTime=function(a){return g(this,"bufferWithTime",a,this.bufferWithTimeOrCount(a,Number.MAX_VALUE))};b.prototype.bufferWithCount=function(a){return g(this,"bufferWithCount",a,this.bufferWithTimeOrCount(void 0,a))};b.prototype.bufferWithTimeOrCount=function(a,b){var c=function(c){if(c.values.length===b)return c.flush();if(void 0!==a)return c.schedule()};return g(this,"bufferWithTimeOrCount",a,b,this.buffer(a,
c,c))};b.prototype.buffer=function(a,b,f){null==b&&(b=q);null==f&&(f=q);var c={scheduled:!1,end:void 0,values:[],flush:function(){this.scheduled=!1;if(0<this.values.length){var a=this.push(H(this.values));this.values=[];if(null!=this.end)return this.push(this.end);if(a!==e.noMore)return f(this)}else if(null!=this.end)return this.push(this.end)},schedule:function(){if(!this.scheduled)return this.scheduled=!0,a(function(a){return function(){return a.flush()}}(this))}};var d=e.more;if(!r(a)){var n=a;
a=function(a){return e.scheduler.setTimeout(a,n)}}return g(this,"buffer",this.withHandler(function(a){c.push=function(a){return function(b){return a.push(b)}}(this);a.isError()?d=this.push(a):a.isEnd()?(c.end=a,c.scheduled||c.flush()):(c.values.push(a.value()),b(c));return d}))};b.prototype.merge=function(a){ya(a);return g(this,"merge",a,e.mergeAll(this,a))};b.prototype.toProperty=function(a){var b=0===arguments.length?B:na(function(){return a});var c=this.dispatcher;return new I(t(this,"toProperty",
a),function(a){var d=!1;var f=q;var h=e.more;var g=function(){if(!d)return b.forEach(function(b){d=!0;h=a(new Q(b));if(h===e.noMore)return f(),f=q})};f=c.subscribe(function(c){if(c.hasValue()){if(d&&c.isInitial())return e.more;c.isInitial()||g();d=!0;b=new L(c);return a(c)}c.isEnd()&&(h=g());if(h!==e.noMore)return a(c)});g();return f})};b.prototype.toEventStream=function(){return this};b.prototype.sampledBy=function(a,b){return g(this,"sampledBy",a,b,this.toProperty().sampledBy(a,b))};b.prototype.concat=
function(a){var c=this;return new b(t(c,"concat",a),function(b){var d=q;var f=c.dispatcher.subscribe(function(c){return c.isEnd()?d=a.dispatcher.subscribe(b):b(c)});return function(){f();return d()}})};b.prototype.takeUntil=function(a){var b={};return g(this,"takeUntil",a,e.groupSimultaneous(this.mapEnd(b),a.skipErrors()).withHandler(function(c){var d;if(c.hasValue()){var f=c.value();c=f[0];a=f[1];if(a.length)return this.push(p());var g=e.more;f=0;for(d=c.length;f<d;f++)g=c[f],g=g===b?this.push(p()):
this.push(H(g));return g}return this.push(c)}))};b.prototype.skipUntil=function(a){var b=a.take(1).map(!0).toProperty(!1);return g(this,"skipUntil",a,this.filter(b))};b.prototype.skipWhile=function(){var a=arguments[0];var b=2<=arguments.length?k.call(arguments,1):[];var f=!1;return R(this,a,b,function(a){return g(this,"skipWhile",a,this.withHandler(function(b){if(!f&&b.hasValue()&&a(b.value()))return e.more;b.hasValue()&&(f=!0);return this.push(b)}))})};b.prototype.holdWhen=function(a){var b=a.startWith(!1);
var c=b.filter(function(a){return!a});var h=b.filter(l.id);return g(this,"holdWhen",a,this.filter(!1).merge(b.flatMapConcat(function(a){return function(b){return b?a.scan([],function(a,b){return a.concat(b)}).sampledBy(c).take(1).flatMap(e.fromArray):a.takeUntil(h)}}(this))))};b.prototype.startWith=function(a){return g(this,"startWith",a,e.once(a).concat(this))};b.prototype.withHandler=function(a){return new b(t(this,"withHandler",a),this.dispatcher.subscribe,a)};return b}(x);var I=function(a){function b(a,
d,f){r(a)&&(f=d,d=a,a=[]);b.__super__.constructor.call(this,a);Y(d);this.dispatcher=new za(this,d,f);O(this)}v(b,a);b.prototype.sampledBy=function(a,d){if(null!=d)d=W(d);else{var c=!0;d=function(a){return a.value()}}var h=new A(this,!1,c);c=new A(a,!0,c);h=e.when([h,c],d);h=a instanceof b?h.toProperty():h;return g(this,"sampledBy",a,d,h)};b.prototype.sample=function(a){return g(this,"sample",a,this.sampledBy(e.interval(a,{})))};b.prototype.changes=function(){return new w(t(this,"changes"),function(a){return function(b){return a.dispatcher.subscribe(function(a){if(!a.isInitial())return b(a)})}}(this))};
b.prototype.withHandler=function(a){return new b(t(this,"withHandler",a),this.dispatcher.subscribe,a)};b.prototype.toProperty=function(){Aa(arguments);return this};b.prototype.toEventStream=function(){return new w(t(this,"toEventStream"),function(a){return function(b){return a.dispatcher.subscribe(function(a){a.isInitial()&&(a=a.toNext());return b(a)})}}(this))};b.prototype.and=function(a){return g(this,"and",a,this.combine(a,function(a,b){return a&&b}))};b.prototype.or=function(a){return g(this,
"or",a,this.combine(a,function(a,b){return a||b}))};b.prototype.delay=function(a){return this.delayChanges("delay",a,function(b){return b.delay(a)})};b.prototype.debounce=function(a){return this.delayChanges("debounce",a,function(b){return b.debounce(a)})};b.prototype.throttle=function(a){return this.delayChanges("throttle",a,function(b){return b.throttle(a)})};b.prototype.delayChanges=function(){var a;var b=2<=arguments.length?k.call(arguments,0,a=arguments.length-1):(a=0,[]);a=arguments[a++];return g.apply(null,
[this].concat(k.call(b),[pa(this,a(this.changes()))]))};b.prototype.takeUntil=function(a){var b=this.changes().takeUntil(a);return g(this,"takeUntil",a,pa(this,b))};b.prototype.startWith=function(a){return g(this,"startWith",a,this.scan(a,function(a,b){return b}))};b.prototype.bufferingThrottle=function(){var a;return(a=b.__super__.bufferingThrottle.apply(this,arguments)).bufferingThrottle.apply(a,arguments).toProperty()};return b}(x);var R=function(a,b,c,d){if(b instanceof I)return a=b.sampledBy(a,
function(a,b){return[a,b]}),d.call(a,function(a){return a[0]}).map(function(a){return a[1]});b=aa(b,c);return d.call(a,b)};var pa=function(a,b){var c=new w(t(a,"justInitValue"),function(b){var d=void 0;var h=a.dispatcher.subscribe(function(a){a.isEnd()||(d=a);return e.noMore});C.whenDoneWith(c,function(){null!=d&&b(d);return b(p())});return h});return c.concat(b).toProperty()};var ea=function(){function a(a,c){this._subscribe=a;this._handleEvent=c;this.subscribe=F(this.subscribe,this);this.handleEvent=
F(this.handleEvent,this);this.subscriptions=[];this.queue=[];this.ended=this.pushing=!1;this.unsubSrc=this.prevError=void 0}a.prototype.hasSubscribers=function(){return 0<this.subscriptions.length};a.prototype.removeSub=function(a){return this.subscriptions=l.without(a,this.subscriptions)};a.prototype.push=function(a){a.isEnd()&&(this.ended=!0);return C.inTransaction(a,this,this.pushIt,[a])};a.prototype.pushToSubscriptions=function(a){var b;try{var d=this.subscriptions;var f=0;for(b=d.length;f<b;f++){var h=
d[f];var g=h.sink(a);(g===e.noMore||a.isEnd())&&this.removeSub(h)}return!0}catch(n){throw a=n,this.pushing=!1,this.queue=[],a;}};a.prototype.pushIt=function(a){if(this.pushing)return this.queue.push(a),e.more;if(a!==this.prevError){a.isError()&&(this.prevError=a);this.pushing=!0;this.pushToSubscriptions(a);for(this.pushing=!1;this.queue.length;)a=this.queue.shift(),this.push(a);if(this.hasSubscribers())return e.more;this.unsubscribeFromSource();return e.noMore}};a.prototype.handleEvent=function(a){return this._handleEvent?
this._handleEvent(a):this.push(a)};a.prototype.unsubscribeFromSource=function(){this.unsubSrc&&this.unsubSrc();return this.unsubSrc=void 0};a.prototype.subscribe=function(a){if(this.ended)return a(p()),q;Y(a);var b={sink:a};this.subscriptions.push(b);1===this.subscriptions.length&&(this.unsubSrc=this._subscribe(this.handleEvent),Y(this.unsubSrc));return function(a){return function(){a.removeSub(b);if(!a.hasSubscribers())return a.unsubscribeFromSource()}}(this)};return a}();var za=function(a){function b(a,
d,e){this.property=a;this.subscribe=F(this.subscribe,this);b.__super__.constructor.call(this,d,e);this.current=B;this.currentValueRootId=void 0;this.propertyEnded=!1}v(b,a);b.prototype.push=function(a){a.isEnd()&&(this.propertyEnded=!0);a.hasValue()&&(this.current=new L(a),this.currentValueRootId=C.currentEventId());return b.__super__.push.call(this,a)};b.prototype.maybeSubSource=function(a,b){return b===e.noMore?q:this.propertyEnded?(a(p()),q):ea.prototype.subscribe.call(this,a)};b.prototype.subscribe=
function(a){var b=e.more;if(this.current.isDefined&&(this.hasSubscribers()||this.propertyEnded)){var c=C.currentEventId();var h=this.currentValueRootId;!this.propertyEnded&&h&&c&&c!==h?C.whenDoneWith(this.property,function(b){return function(){if(b.currentValueRootId===h)return a(ba(b.current.get().value()))}}(this)):C.inTransaction(void 0,this,function(){return b=a(ba(this.current.get().value()))},[])}return this.maybeSubSource(a,b)};return b}(ea);E=function(a){function b(){this.guardedSink=F(this.guardedSink,
this);this.subscribeAll=F(this.subscribeAll,this);this.unsubAll=F(this.unsubAll,this);this.sink=void 0;this.subscriptions=[];this.ended=!1;b.__super__.constructor.call(this,t(e,"Bus"),this.subscribeAll)}v(b,a);b.prototype.unsubAll=function(){var a;var b=this.subscriptions;var e=0;for(a=b.length;e<a;e++){var h=b[e];"function"===typeof h.unsub&&h.unsub()}};b.prototype.subscribeAll=function(a){var b;this.sink=a;var c=Ba(this.subscriptions);var e=0;for(b=c.length;e<b;e++)a=c[e],this.subscribeInput(a);
return this.unsubAll};b.prototype.guardedSink=function(a){return function(b){return function(c){return c.isEnd()?(b.unsubscribeInput(a),e.noMore):b.sink(c)}}(this)};b.prototype.subscribeInput=function(a){return a.unsub=a.input.dispatcher.subscribe(this.guardedSink(a.input))};b.prototype.unsubscribeInput=function(a){var b,c;var e=this.subscriptions;var g=b=0;for(c=e.length;b<c;g=++b){var k=e[g];if(k.input===a){"function"===typeof k.unsub&&k.unsub();this.subscriptions.splice(g,1);break}}};b.prototype.plug=
function(a){Ca(a);if(!this.ended){var b={input:a};this.subscriptions.push(b);null!=this.sink&&this.subscribeInput(b);return function(b){return function(){return b.unsubscribeInput(a)}}(this)}};b.prototype.end=function(){this.ended=!0;this.unsubAll();return"function"===typeof this.sink?this.sink(p()):void 0};b.prototype.push=function(a){return"function"===typeof this.sink?this.sink(H(a)):void 0};b.prototype.error=function(a){return"function"===typeof this.sink?this.sink(G(a)):void 0};return b}(w);
var A=function(){function a(a,c,d){this.obs=a;this.sync=c;this.lazy=null!=d?d:!1;this.queue=[]}a.prototype.subscribe=function(a){return this.obs.dispatcher.subscribe(a)};a.prototype.toString=function(){return this.obs.toString()};a.prototype.markEnded=function(){return this.ended=!0};a.prototype.consume=function(){return this.lazy?{value:l.always(this.queue[0])}:this.queue[0]};a.prototype.push=function(a){return this.queue=[a]};a.prototype.mayHave=function(){return!0};a.prototype.hasAtLeast=function(){return this.queue.length};
a.prototype.flatten=!0;return a}();var Da=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}v(b,a);b.prototype.consume=function(){return this.queue.shift()};b.prototype.push=function(a){return this.queue.push(a)};b.prototype.mayHave=function(a){return!this.ended||this.queue.length>=a};b.prototype.hasAtLeast=function(a){return this.queue.length>=a};b.prototype.flatten=!1;return b}(A);var ua=function(a){function b(a){b.__super__.constructor.call(this,a,!0)}v(b,a);b.prototype.consume=
function(){var a=this.queue;this.queue=[];return{value:function(){return a}}};b.prototype.push=function(a){return this.queue.push(a.value())};b.prototype.hasAtLeast=function(){return!0};return b}(A);A.isTrigger=function(a){return a instanceof A?a.sync:a instanceof w};A.fromObservable=function(a){return a instanceof A?a:a instanceof I?new A(a,!1):new Da(a,!0)};var t=function(){var a=arguments[0];var b=arguments[1];var c=3<=arguments.length?k.call(arguments,2):[];return(a||b)instanceof qa?a||b:new qa(a,
b,c)};var ra=function(a){return y(a)?l.flatMap(ra,a):P(a)?[a]:a instanceof A?[a.obs]:[]};var qa=function(){function a(a,c,d){this.context=a;this.method=c;this.args=d;this.cached=void 0}a.prototype.deps=function(){return this.cached||(this.cached=ra([this.context].concat(this.args)))};a.prototype.apply=function(a){a.desc=this;return a};a.prototype.toString=function(){return l.toString(this.context)+"."+l.toString(this.method)+"("+l.map(l.toString,this.args)+")"};return a}();var g=function(){var a;
var b=2<=arguments.length?k.call(arguments,0,a=arguments.length-1):(a=0,[]);a=arguments[a++];return t.apply(null,b).apply(a)};e.when=function(){var a,b,c,d;if(0===arguments.length)return e.never();var f=arguments.length;S("when: expecting arguments in the form (Observable+,function)+",0===f%2);var g=[];var m=[];var n=0;for(a=[];n<f;){a[n]=arguments[n];a[n+1]=arguments[n+1];var q=l.toArray(arguments[n]);var z=Ea(arguments[n+1]);var u={f:z,ixs:[]};var K=!1;var D=0;for(c=q.length;D<c;D++){var r=q[D];
z=l.indexOf(g,r);K||(K=A.isTrigger(r));0>z&&(g.push(r),z=g.length-1);var x=u.ixs;var v=0;for(d=x.length;v<d;v++){var y=x[v];y.index===z&&y.count++}u.ixs.push({index:z,count:1})}S("At least one EventStream required",K||!q.length);0<q.length&&m.push(u);n+=2}if(!g.length)return e.never();g=l.map(A.fromObservable,g);var B=l.any(g,function(a){return a.flatten})&&Fa(l.map(function(a){return a.obs},g));return b=new w(t.apply(null,[e,"when"].concat(k.call(a))),function(a){var c=[];var d=!1;var f=function(a){var b;
var c=a.ixs;a=0;for(b=c.length;a<b;a++)if(n=c[a],!g[n.index].hasAtLeast(n.count))return!1;return!0};var h=function(a){return!a.sync||a.ended};var k=function(a){var b;var c=a.ixs;a=0;for(b=c.length;a<b;a++)if(n=c[a],!g[n.index].mayHave(n.count))return!0};var z=function(a){return!a.source.flatten};var u=function(u){return function(K){var q=function(){return C.whenDoneWith(b,r)};var D=function(){var b;if(0<c.length){var d=e.more;d=c.pop();var h=0;for(b=m.length;h<b;h++){var k=m[h];if(f(k)){var u=function(){var a;
var b=k.ixs;var c=[];var d=0;for(a=b.length;d<a;d++)n=b[d],c.push(g[n.index].consume());return c}();d=a(d.e.apply(function(){var a;var b=[];var c=0;for(a=u.length;c<a;c++){var d=u[c];b.push(d.value())}return k.f.apply(k,b)}));c.length&&(c=l.filter(z,c));return d===e.noMore?d:D()}}}else return e.more};var r=function(){var b=D();d&&(d=!1,l.all(g,h)||l.all(m,k))&&(b=e.noMore,a(p()));b===e.noMore&&K();return b};return u.subscribe(function(b){if(b.isEnd())d=!0,u.markEnded(),q();else if(b.isError())var f=
a(b);else u.push(b),u.sync&&(c.push({source:u,e:b}),B||C.hasWaiters()?q():r());f===e.noMore&&K();return f||e.more})}};return la.apply(null,function(){var a;var b=[];var c=0;for(a=g.length;c<a;c++)r=g[c],b.push(u(r));return b}())})};var Fa=function(a,b){null==b&&(b=[]);var c=function(a){if(l.contains(b,a))return!0;var d=a.internalDeps();if(d.length)return b.push(a),l.any(d,c);b.push(a);return!1};return l.any(a,c)};e.update=function(){var a;var b=arguments[0];var c=2<=arguments.length?k.call(arguments,
1):[];var d=function(a){return function(){var b=1<=arguments.length?k.call(arguments,0):[];return function(c){return a.apply(null,[c].concat(b))}}};for(a=c.length-1;0<a;)c[a]instanceof Function||(c[a]=function(a){return function(){return a}}(c[a])),c[a]=d(c[a]),a-=2;return g.apply(null,[e,"update",b].concat(k.call(c),[e.when.apply(e,c).scan(b,function(a,b){return b(a)})]))};var la=function(){var a=1<=arguments.length?k.call(arguments,0):[];return(new da(a)).unsubscribe};var da=function(){function a(a){var b;
null==a&&(a=[]);this.unsubscribe=F(this.unsubscribe,this);this.unsubscribed=!1;this.subscriptions=[];this.starting=[];var d=0;for(b=a.length;d<b;d++){var e=a[d];this.add(e)}}a.prototype.add=function(a){if(!this.unsubscribed){var b=!1;var d=q;this.starting.push(a);var e=function(c){return function(){if(!c.unsubscribed)return b=!0,c.remove(d),l.remove(a,c.starting)}}(this);d=a(this.unsubscribe,e);this.unsubscribed||b||this.subscriptions.push(d);l.remove(a,this.starting);return d}};a.prototype.remove=
function(a){if(!this.unsubscribed&&void 0!==l.remove(a,this.subscriptions))return a()};a.prototype.unsubscribe=function(){var a;if(!this.unsubscribed){this.unsubscribed=!0;var c=this.subscriptions;var d=0;for(a=c.length;d<a;d++){var e=c[d];e()}this.subscriptions=[];return this.starting=[]}};a.prototype.count=function(){return this.unsubscribed?0:this.subscriptions.length+this.starting.length};a.prototype.empty=function(){return 0===this.count()};return a}();e.CompositeUnsubscribe=da;var L=function(){function a(a){this.value=
a}a.prototype.getOrElse=function(){return this.value};a.prototype.get=function(){return this.value};a.prototype.filter=function(b){return b(this.value)?new a(this.value):B};a.prototype.map=function(b){return new a(b(this.value))};a.prototype.forEach=function(a){return a(this.value)};a.prototype.isDefined=!0;a.prototype.toArray=function(){return[this.value]};a.prototype.inspect=function(){return"Some("+this.value+")"};a.prototype.toString=function(){return this.inspect()};return a}();var B={getOrElse:function(a){return a},
filter:function(){return B},map:function(){return B},forEach:function(){},isDefined:!1,toArray:function(){return[]},inspect:function(){return"None"},toString:function(){return this.inspect()}};var C=function(){var a=void 0;var b=[];var c={};var d=[];var f=0;var g=function(b){return a?d.push(b):b()};var k=function(){for(;0<b.length;)n(0)};var n=function(a){var d=b[a];var e=d.id;var f=c[e];b.splice(a,1);delete c[e];p(d);d=0;for(e=f.length;d<e;d++)a=f[d],a()};var p=function(a){var d;a=a.internalDeps();
var e=0;for(d=a.length;e<d;e++){var f=a[e];p(f);c[f.id]&&(f=l.indexOf(b,f),n(f))}};return{whenDoneWith:function(d,e){if(a){var f=c[d.id];return null==f?(c[d.id]=[e],b.push(d)):f.push(e)}return e()},hasWaiters:function(){return 0<b.length},inTransaction:function(b,c,e,g){if(a)return e.apply(c,g);a=b;try{var h=e.apply(c,g);k()}finally{for(a=void 0;f<d.length;)b=d[f],f++,b();f=0;d=[]}return h},currentEventId:function(){if(a)return a.id},wrappedSubscribe:function(a,b){var c;var d=c=!1;var f=function(){return d=
!0};var h=function(){c=!0;return f()};f=a.dispatcher.subscribe(function(a){return g(function(){if(!c){var d=b(a);if(d===e.noMore)return h()}})});d&&f();return h},afterTransaction:g}}();e.EventStream=w;e.Property=I;e.Observable=x;e.Bus=E;e.Initial=Q;e.Next=V;e.End=ma;e.Error=G;var q=function(){};var xa=function(a,b){return a};var ba=function(a){return new Q(a,!0)};var H=function(a){return new V(a,!0)};var p=function(){return new ma};var Z=function(a){return a instanceof N?a:H(a)};var Ba=function(a){return a.slice(0)};
var S=function(a,b){if(!b)throw new M(a);};var ya=function(a){if(!(a instanceof w))throw new M("not an EventStream : "+a);};var Ca=function(a){if(!(a instanceof x))throw new M("not an Observable : "+a);};var Y=function(a){return S("not a function : "+a,r(a))};var r=function(a){return"function"===typeof a};var y=function(a){return a instanceof Array};var P=function(a){return a instanceof x};var ta=function(a){if(!y(a))throw new M("not an array : "+a);};var Aa=function(a){return S("no arguments supported",
0===a.length)};var ka=function(a,b){return function(){var c=1<=arguments.length?k.call(arguments,0):[];return a.apply(null,b.concat(c))}};var X=function(a){return 1===a.length&&P(a[0])?l.always(a[0]):J(a)};var J=function(a){a=Array.prototype.slice.call(a);return sa.apply(null,a)};var sa=ja(function(){var a=arguments[0];var b=2<=arguments.length?k.call(arguments,1):[];return r(a)?b.length?ka(a,b):a:fa(a)?Ga(a,b):l.always(a)});var aa=function(a,b){return sa.apply(null,[a].concat(k.call(b)))};var Ea=
function(a){return r(a)?a:l.always(a)};var oa=function(a){return P(a)?a:e.once(a)};var fa=function(a){return"string"===typeof a&&1<a.length&&"."===a.charAt(0)};e.isFieldKey=fa;var Ga=function(a,b){var c=a.slice(1).split(".");var d=l.map(Ha(b),c);return function(b){var c;var e=0;for(c=d.length;e<c;e++)a=d[e],b=a(b);return b}};var Ha=function(a){return function(b){return function(c){if(null!=c){var d=c[b];return r(d)?d.apply(c,a):d}}}};var Ia=function(a){return a.slice(1)};var W=function(a){if(r(a))return a;
if(fa(a)){var b=Ia(a);return function(a,d){return a[b](d)}}return S("not a function or a field key: "+a,!1)};var na=function(a){return a instanceof L||a===B?a:new L(a)};"undefined"!==typeof define&&null!==define&&null!=define.amd?(define([],function(){return e}),this.Bacon=e):"undefined"!==typeof module&&null!==module&&null!=module.exports?(module.exports=e,e.Bacon=e):this.Bacon=e}).call(this);;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:baconjs', location = '/static/lib/Bacon-AMD.js' */
define("baconjs",["jquery"],function(b){var a=window.Bacon||window.module.exports;b.fn.asEventStream=a.$.asEventStream;return a});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:performance-util', location = '/static/bitbucket/internal/util/performance.js' */
define("bitbucket/internal/util/performance",["module","exports","jquery"],function(q,g,e){function p(f,a){function c(){d=null;l=!0;b.fire();b=new h.default.Callbacks;l=!1;a()}var b=new h.default.Callbacks,l=!1,d=null;return{name:f,forceExecute:function(){d&&(clearTimeout(d),c())},queue:function(a){l?a():(b.add(a),d||(d=setTimeout(c,0)))}}}Object.defineProperty(g,"__esModule",{value:!0});var h=e&&e.__esModule?e:{default:e},n=p("READ",function(){m.forceExecute()}),m=p("WRITE",function(){n.forceExecute()});
g.default={queueDOMRead:n.queue.bind(n),queueDOMWrite:m.queue.bind(m),enqueueCapped:function(f,a,c){c=c||1;var b=0;return function(){b>=c||(b++,f(function(){try{return a.apply(this,arguments)}finally{b--}}))}},frameBatchedMap:function(f,a,c){a=h.default.extend({initial:500,min:10,max:Infinity},a);c=c||function(b){b()};return function(b){function l(){for(var a=Math.min(k+d,b.length);k<a;k++)g[k]=f(b[k])}var d=a.initial,e=h.default.Deferred(),k=0,g=[];requestAnimationFrame(function r(){if("pending"===
e.state()){var f=(new Date).getTime();c(l);var h=(new Date).getTime();d=Math.min(a.max,Math.max(a.min,Math.ceil(15/(h-f)*d)));k===b.length?e.resolve(g):requestAnimationFrame(r)}});return e}}};q.exports=g["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bacon-util', location = '/static/bitbucket/internal/util/bacon.js' */
define("bitbucket/internal/util/bacon","module exports baconjs jquery lodash bitbucket/internal/util/events bitbucket/internal/util/function bitbucket/internal/util/performance".split(" "),function(r,m,n,p,t,u,v,w){function d(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(m,"__esModule",{value:!0});var f=d(n),g=d(p),h=d(t),q=d(u),x=d(v),y=d(w);n=h.default.once(function(){function a(){return{left:b.scrollLeft(),top:b.scrollTop()}}var b=(0,g.default)(window),c=f.default.fromBinder(function(a){var e=
y.default.enqueueCapped(requestAnimationFrame,a),c=h.default.debounce(e,20);b.on("scroll",e).on("scroll",c);return function(){b.off("scroll",e).off("scroll",c)}}).map(a).skipDuplicates(function(a,b){return a.left===b.left&&a.top===b.top}).toProperty(a());c.onValue(g.default.noop);return c});p=h.default.once(function(){var a=(0,g.default)(window);a=f.default.fromBinder(function(a){var b=q.default.chain().on("window.resize",function(b,c){a(new f.default.Next({width:b,height:c}))});return function(){b.destroy()}}).toProperty({width:a.width(),
height:a.height()});a.onValue(g.default.noop);return a});m.default={events:function(a){return f.default.fromBinder(function(b){return q.default.chain().on(a,b).destroy})},split:function(a,b){return f.default.fromBinder(function(c){var k=[],e,l=[];l.push(a.onValue(function(a){var f=b(a);e&&f!==e&&(c(k),k=[]);e=f;k.push(a)}));l.push(a.onEnd(function(){0<k.length&&c(k);c(new f.default.End)}));return h.default.partial(x.default.applyAll,l)})},toArray:function(a){var b=[];a.onValue(function(a){b.push(a)});
return b},getWindowScrollProperty:n,getWindowSizeProperty:p,takeBetween:function(a,b){var c=b.start,k=b.end,e=b.startInclusive,l=b.endInclusive,d=b.equals||function(a,b){return a===b};if(d(c,k))return e||l?a.skipWhile(function(a){return!d(a,c)}).take(1):f.default.never();var g,h;return a.skipWhile(function(a){return h||g?!1:d(a,c)?(g=!0,!e):d(a,k)?(h=!0,!l):!0}).takeWhile(function(a){return d(a,c)?(g=!0,e):d(a,k)?(h=!0,l):!(h&&g)})}};r.exports=m["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:keyboard-shortcuts', location = '/static/bitbucket/internal/widget/keyboard-shortcuts/keyboard-shortcuts.soy' */
// This file was automatically generated from keyboard-shortcuts.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.widget == 'undefined') { bitbucket.internal.widget = {}; }
if (typeof bitbucket.internal.widget.keyboardShortcuts == 'undefined') { bitbucket.internal.widget.keyboardShortcuts = {}; }
if (typeof bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts == 'undefined') { bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts = {}; }


bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutsContent = function(opt_data, opt_ignored) {
  var param6 = '';
  var contextNameList7 = opt_data.contextNames;
  var contextNameListLen7 = contextNameList7.length;
  for (var contextNameIndex7 = 0; contextNameIndex7 < contextNameListLen7; contextNameIndex7++) {
    var contextNameData7 = contextNameList7[contextNameIndex7];
    param6 += (contextNameIndex7 % 2 == 0) ? bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortContext({contextName: contextNameData7, contextShortcuts: opt_data.contexts[contextNameIndex7]}) : '';
  }
  var param5 = '' + aui.group.item({content: param6});
  var param15 = '';
  var contextNameList16 = opt_data.contextNames;
  var contextNameListLen16 = contextNameList16.length;
  for (var contextNameIndex16 = 0; contextNameIndex16 < contextNameListLen16; contextNameIndex16++) {
    var contextNameData16 = contextNameList16[contextNameIndex16];
    param15 += (contextNameIndex16 % 2 == 1) ? bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortContext({contextName: contextNameData16, contextShortcuts: opt_data.contexts[contextNameIndex16]}) : '';
  }
  param5 += aui.group.item({content: param15});
  var output = '' + aui.group.group({extraClasses: 'keyboard-shortcut-help', extraAttributes: {tabindex: '0'}, content: param5});
  return output;
};
if (goog.DEBUG) {
  bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutsContent.soyTemplateName = 'bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutsContent';
}


bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortContext = function(opt_data, opt_ignored) {
  var output = '<div class="keyboard-shortcut-context"><h3>' + soy.$$escapeHtml(opt_data.contextName) + '</h3><dl>';
  var shortcutList29 = opt_data.contextShortcuts;
  var shortcutListLen29 = shortcutList29.length;
  for (var shortcutIndex29 = 0; shortcutIndex29 < shortcutListLen29; shortcutIndex29++) {
    var shortcutData29 = shortcutList29[shortcutIndex29];
    output += (! shortcutData29.hidden) ? bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutItem({shortcut: shortcutData29}) : '';
  }
  output += '</dl></div>';
  return output;
};
if (goog.DEBUG) {
  bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortContext.soyTemplateName = 'bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortContext';
}


bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutItem = function(opt_data, opt_ignored) {
  var output = '<dt>' + soy.$$escapeHtml(opt_data.shortcut.description) + '</dt>';
  var optionList40 = opt_data.shortcut.keys;
  var optionListLen40 = optionList40.length;
  for (var optionIndex40 = 0; optionIndex40 < optionListLen40; optionIndex40++) {
    var optionData40 = optionList40[optionIndex40];
    output += ((! (optionIndex40 == 0) && ! (optionIndex40 == optionListLen40 - 1)) ? '<dd class=\'separator\'>' + soy.$$escapeHtml(',') + '</dd>' : '') + ((! (optionIndex40 == 0) && optionIndex40 == optionListLen40 - 1) ? '<dd class=\'separator\'>' + soy.$$escapeHtml(' or') + '</dd>' : '') + '<dd>' + bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutOption({sequence: optionData40}) + '</dd>';
  }
  return output;
};
if (goog.DEBUG) {
  bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutItem.soyTemplateName = 'bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutItem';
}


bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutOption = function(opt_data, opt_ignored) {
  var output = '';
  var keypressList57 = opt_data.sequence;
  var keypressListLen57 = keypressList57.length;
  for (var keypressIndex57 = 0; keypressIndex57 < keypressListLen57; keypressIndex57++) {
    var keypressData57 = keypressList57[keypressIndex57];
    output += ((! (keypressIndex57 == 0)) ? ' ' + soy.$$escapeHtml('then') + ' ' : '') + ((keypressData57.modifiers) ? bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutModifier({keypress: keypressData57}) : bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutKey({key: keypressData57}));
  }
  return output;
};
if (goog.DEBUG) {
  bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutOption.soyTemplateName = 'bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutOption';
}


bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutModifier = function(opt_data, opt_ignored) {
  var output = '';
  var modifierList72 = opt_data.keypress.modifiers;
  var modifierListLen72 = modifierList72.length;
  for (var modifierIndex72 = 0; modifierIndex72 < modifierListLen72; modifierIndex72++) {
    var modifierData72 = modifierList72[modifierIndex72];
    output += bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutKey({key: modifierData72});
  }
  output += bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutKey({key: opt_data.keypress.key});
  return output;
};
if (goog.DEBUG) {
  bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutModifier.soyTemplateName = 'bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutModifier';
}


bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutKey = function(opt_data, opt_ignored) {
  return '<kbd>' + soy.$$escapeHtml(opt_data.key) + '</kbd>';
};
if (goog.DEBUG) {
  bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutKey.soyTemplateName = 'bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutKey';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:keyboard-shortcuts', location = '/static/bitbucket/internal/widget/keyboard-shortcuts/keyboard-shortcuts.js' */
define("bitbucket/internal/widget/keyboard-shortcuts/keyboard-shortcuts","module exports @atlassian/aui jquery lodash bitbucket/internal/util/events bitbucket/internal/util/navigator".split(" "),function(r,l,t,u,v,w,x){function m(a){return a&&a.__esModule?a:{default:a}}function c(){if(!(this instanceof c))return new c;this._enabledContexts=[]}function n(a,b){a=g.default.extend({},a);a.keys=d.default.map(a.keys,function(a){return d.default.map(a,function(a){if(d.default.every(["key","modifiers"],d.default.partial(d.default.has,
a)))return a;var f=1<a.length?a.split("+"):a;return d.default.isArray(f)&&1!==f.length?{key:f.pop(),modifiers:b&&!1===b.convertOSModifier?f:d.default.map(f,c.convertOSModifier)}:a})});a.displayContext||(a.displayContext=c._contextDisplayInfo[a.context]?c._contextDisplayInfo[a.context].displayName:a.context.replace(/\b[a-z]/g,function(a){return a.toUpperCase()}));h[a.displayContext]||(h[a.displayContext]=[]);h[a.displayContext].push(a)}function p(a,b){q.default.trigger("bitbucket.internal.DO_NOT_USE.ui.keyboard.shortcutClicked",
null,{context:a,keyEventName:b})}Object.defineProperty(l,"__esModule",{value:!0});var b=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(t),g=m(u),d=m(v),q=m(w),y=/^[cC]trl$/i,k,h={};c.prototype._setRegistry=function(a){this._registry=a};c.prototype._initContent=function(){this._dialog=b.dialog2(aui.dialog.dialog2({titleText:"Keyboard shortcuts",content:bitbucket.internal.widget.keyboardShortcuts.keyboardShortcuts.keyboardShortcutsContent({contextNames:d.default.keys(h),
contexts:d.default.values(h)}),size:"large",id:"keyboard-shortcut-dialog"}))};c.prototype._bind=function(a){this._$trigger=a;var b=this;this._$trigger.on("click",function(a){a.preventDefault();b._show()})};c.prototype.enableContext=function(a){-1===g.default.inArray(a,this._enabledContexts)&&(k=a,this._registry.enableContext(a),k=void 0,this._enabledContexts.push(a))};c.prototype.resetContexts=function(){b.trigger("remove-bindings.keyboardshortcuts");this._enabledContexts=[];b.trigger("add-bindings.keyboardshortcuts")};
c.prototype._show=function(){this._hasShown||(this._initContent(),this._hasShown=!0);this._dialog.show()};c.prototype.addCustomShortcut=function(a,b,c,d){n({keys:b,context:a,displayContext:d,description:c},{convertOSModifier:!1})};c.convertOSModifier=function(a){return(0,x.isMac)()?a.replace(y,"\u2318"):a};c.internalizeShortcuts=function(a){d.default.forEach(a,n)};c._contextDisplayInfo={repository:{displayName:"Within A Repository"},"branch-compare":{displayName:"Branch compare"},
"branch-list":{displayName:"Branch list"},commit:{displayName:"Commit"},commits:{displayName:"Commit List"},"diff-tree":{displayName:"Commit"},"diff-view":{displayName:"Diff View"},filebrowser:{displayName:"Directory Browsing"},
global:{displayName:"Global"},"pull-request":{displayName:"Within A Pull Request"},"pull-request-list":{displayName:"Pull Request List"},"pull-request-overview":{displayName:"Within A Pull Request"},sourceview:{displayName:"Source View"}};var e=
new c;l.default={onReady:function(){e._bind((0,g.default)(".keyboard-shortcut-link"));var a=g.default.Deferred();(0,g.default)(document).ready(function(){setTimeout(function(){a.resolve()},0)});b.bind("register-contexts.keyboardshortcuts",function(b,c){e._setRegistry(c.shortcutRegistry);e.enableContext("global");a.done(function(){q.default.trigger("bitbucket.internal.DO_NOT_USE.widget.keyboard-shortcuts.register-contexts",e,e)})});b.bind("shortcuts-loaded.keyboardshortcuts",function(a,b){c.internalizeShortcuts(b.shortcuts)});
b.params["keyboardshortcut-hash"]="bundled";b.trigger("initialize.keyboardshortcuts");window.require("bitbucket/internal/util/shortcuts",null).bind("keyboardShortcutsDialog",e._show.bind(e))},addTooltip:function(a,f){f=d.default.chain(f).split("+").map(c.convertOSModifier).map(function(a){return"shift"===a?"Shift":"ctrl"===a?c.convertOSModifier("Ctrl"):a}).value().join(" + ");var e=a.attr("title");
a.attr("title",e+b.format(" (type \u0027\u0027{0}\u0027\u0027)",f));return{remove:function(){a.attr("title",e)}}},bindKeyboardShortcutAnalytics:function(a,b){b.onValue(p.bind(null,k,a))},getEnablingContext:function(){return k},showDialog:function(){e&&e._show()},resetContexts:function(){e.resetContexts()},fireKeyboardShocutAnalyticsEvent:p};r.exports=l["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:base-layout', location = '/static/bitbucket/internal/layout/base/base.js' */
define("bitbucket/internal/layout/base/base","module exports @atlassian/aui jquery lodash bitbucket/util/navbuilder bitbucket/internal/model/page-state bitbucket/internal/model/stash-user bitbucket/internal/util/analytics bitbucket/internal/util/client-storage bitbucket/internal/util/events bitbucket/internal/util/history bitbucket/internal/widget/aui/form/form".split(" "),function(m,f,g,n,p,q,r,t,u,v,w,x,y){function b(a){return a&&a.__esModule?a:{default:a}}function z(a){a&&(a.isAdmin=!!(0,d.default)("#header").find("a.admin-link").length,
A.default.setCurrentUser(new B.default(a)))}function C(a){h.default.getSessionItem(a)||(h.default.setSessionItem(a,!0),D.default.add("demographics",{d_lang:document.documentElement.lang},!0))}Object.defineProperty(f,"__esModule",{value:!0});var E=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(g),d=b(n),k=b(p),l=b(q),A=b(r),B=b(t),D=b(u),h=b(v),e=b(w),F=b(x),G=b(y);location.search&&(g=l.default.parse(location.href).getQueryParamValue("eve"))&&
e.default.on(g,function(){console.log([e.default.name()],this,arguments)});e.default.on("bitbucket.internal.DO_NOT_USE.history.changestate",function(a){var b=(0,d.default)("#login-link");b.length&&a.state&&b.attr("href",l.default.login().next().build());(0,d.default)("body").children(".tipsy").remove()});f.default={onReady:function(a,b){z(a);G.default.onReady();E.params["build-number"]=encodeURIComponent((0,d.default)("#product-version").attr("data-system-build-number"));var c=(0,d.default)(window);
a=k.default.debounce(function(){e.default.trigger("window.resize.debounced",c,c.width(),c.height())},200);c.on("resize",a);a=k.default.throttle(function(){e.default.trigger("window.scroll.throttled",c,c.scrollTop())},25);c.on("scroll",a);F.default.setTitleSuffix(" - "+b);C(h.default.buildKey("demographic-analytics","user"))}};m.exports=f["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:keyboard-shortcuts-util', location = '/static/bitbucket/internal/util/shortcuts.js' */
define("bitbucket/internal/util/shortcuts","module exports @atlassian/aui baconjs bitbucket/util/events bitbucket/internal/util/navigator bitbucket/internal/util/shortcuts/create-keyboard-shortcuts-handler bitbucket/internal/widget/keyboard-shortcuts/keyboard-shortcuts".split(" "),function(m,f,g,n,p,q,r,t){function d(a){return a&&a.__esModule?a:{default:a}}function l(a){var b=e[a];b.lazy.whenIType&&b.lazy.whenIType.unbind();var c=u.whenIType(b.lazy.keys);b.lazy.whenIType=c;c.execute(b._sink);c.execute(h.default.fireKeyboardShocutAnalyticsEvent.bind(null,
b.lazy.analyticsContext,a))}function k(a){e.hasOwnProperty(a)||(e[a]={analyticsBound:!1,lazy:{keys:null,whenIType:null,analyticsContext:null},baconSink:function(a){this._sink&&this._sink(a)},_sink:null,stream:v.default.fromBinder(function(b){var c=e[a];c._sink=b;c.lazy.keys&&l(a);return function(){c._sink=null;c.lazy.whenIType&&c.lazy.whenIType.unbind()}})});return e[a]}Object.defineProperty(f,"__esModule",{value:!0});var u=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,
c)&&(b[c]=a[c]);b.default=a;return b}(g),v=d(n),w=d(p);g=d(r);var h=d(t),e={};f.default={createKeyboardShortcutsHandler:g.default,registerLazy:function(a,b,c){(0,q.isMac)()&&(c=c.replace(/ctrl/i,"meta"));b.unbind();b=k(a);b.lazy.keys=c;b.lazy.analyticsContext=h.default.getEnablingContext();b._sink&&l(a)},setup:function(a,b,c){var d=k(a);b.execute(d.baconSink.bind(d));d.analyticsBound||(d.analyticsBound=!0,h.default.bindKeyboardShortcutAnalytics(a,e[a].stream));w.default.trigger("bitbucket.internal.DO_NOT_USE.keyboard.shortcuts."+
a,b,c)},bind:function(a,b){return k(a).stream.onValue(b)}};m.exports=f["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:keyboard-shortcuts-util', location = '/static/bitbucket/internal/util/shortcuts/create-keyboard-shortcuts-handler.js' */
define("bitbucket/internal/util/shortcuts/create-keyboard-shortcuts-handler",["module","exports"],function(e,b){Object.defineProperty(b,"__esModule",{value:!0});var f=["input","select","textarea"];b.default=function(b){return function(a){var c=a.currentTarget,d=a.target,e=a.key,g=f.includes(d.tagName&&d.tagName.toLowerCase())||d.isContentEditable;c!==d&&g||a.altKey||a.ctrlKey||a.metaKey||(c=b[e],"function"===typeof c&&(a.preventDefault(),a.stopPropagation(),c()))}};e.exports=b["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-javascript-errors', location = '/static/bitbucket/internal/bbui/javascript-errors/not-implemented-error.js' */
define("bitbucket/internal/bbui/javascript-errors/not-implemented-error",["module","exports"],function(e,d){function f(b,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}});a&&(Object.setPrototypeOf?Object.setPrototypeOf(b,a):b.__proto__=a)}Object.defineProperty(d,"__esModule",{value:!0});var g=function(b){function a(b){if(!(this instanceof
a))throw new TypeError("Cannot call a class as a function");var c=(a.__proto__||Object.getPrototypeOf(a)).call(this,b);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");c=!c||"object"!==typeof c&&"function"!==typeof c?this:c;c.name="NotImplementedError";c.message=b||"This method has not been implemented";return c}f(a,b);return a}(Error);d.default=g;e.exports=d["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-javascript-errors', location = '/static/bitbucket/internal/bbui/javascript-errors/javascript-errors.js' */
define("bitbucket/internal/bbui/javascript-errors/javascript-errors",["exports","./not-implemented-error"],function(b,a){Object.defineProperty(b,"__esModule",{value:!0});b.NotImplementedError=void 0;b.NotImplementedError=(a&&a.__esModule?a:{default:a}).default});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-urls', location = '/static/bitbucket/internal/bbui/urls/urls.js' */
define("bitbucket/internal/bbui/urls/urls",["module","exports","../javascript-errors/javascript-errors"],function(f,c,a){Object.defineProperty(c,"__esModule",{value:!0});var b=a&&a.__esModule?a:{default:a},g=function(){function b(e,b){for(var a=0;a<b.length;a++){var d=b[a];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(e,d.key,d)}}return function(e,a,c){a&&b(e.prototype,a);c&&b(e,c);return e}}();a=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
}g(a,[{key:"fileChanges",value:function(a,c){throw new b.default.NotImplementedError;}},{key:"avatarUrl",value:function(a,c){throw new b.default.NotImplementedError;}},{key:"user",value:function(a){throw new b.default.NotImplementedError;}},{key:"pullRequest",value:function(a){throw new b.default.NotImplementedError;}},{key:"createPullRequest",value:function(a){throw new b.default.NotImplementedError;}},{key:"allPullRequests",value:function(a){throw new b.default.NotImplementedError;}},{key:"help",
value:function(a){throw new b.default.NotImplementedError;}},{key:"search",value:function(a){throw new b.default.NotImplementedError;}},{key:"project",value:function(a){throw new b.default.NotImplementedError;}},{key:"repo",value:function(a){throw new b.default.NotImplementedError;}},{key:"remote",value:function(a){throw new b.default.NotImplementedError;}}]);return a}();c.default=a;f.exports=c["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bitbucket-urls', location = '/static/bitbucket/internal/impl/urls.js' */
define("bitbucket/internal/impl/urls","module exports bitbucket/util/navbuilder bitbucket/internal/bbui/javascript-errors/javascript-errors bitbucket/internal/bbui/urls/urls bitbucket/internal/util/object".split(" "),function(g,e,h,k,l,m){function d(a){return a&&a.__esModule?a:{default:a}}function b(){f.default.call(this)}Object.defineProperty(e,"__esModule",{value:!0});var c=d(h),n=d(k),f=d(l);d(m).default.inherits(b,f.default);b.prototype.avatarUrl=function(a,b){return c.default._avatarUrl(a,b).build()};
b.prototype.pullRequest=function(a){return c.default.currentRepo().pullRequest(a).build()};b.prototype.inboxPullRequest=function(a,b,d){return c.default.project(a).repo(b).pullRequest(d).build()};b.prototype.createPullRequest=function(a){return c.default.project(a.project).repo(a).createPullRequest().build()};b.prototype.allPullRequests=function(a,b){return b?c.default.project(a.project).repo(a).allPullRequests().state(b).build():c.default.project(a.project).repo(a).allPullRequests().build()};b.prototype.help=
function(a){switch(a){case "help.mirroring.clone.dialog":return 'http:\/\/docs.atlassian.com\/bitbucketserver\/docs-067\/Clone+a+repository?utm_campaign=in-app-help&utm_medium=in-app-help&utm_source=stash#Clonearepository-mirrorclone';case "help.mirroring.getting.started":return 'http:\/\/docs.atlassian.com\/bitbucketserver\/docs-067\/Smart+Mirroring?utm_campaign=in-app-help&utm_medium=in-app-help&utm_source=stash';case "help.mirroring.setup":return 'http:\/\/docs.atlassian.com\/bitbucketserver\/docs-067\/Set+up+a+mirror?utm_campaign=in-app-help&utm_medium=in-app-help&utm_source=stash';case "help.pull.request":return 'http:\/\/docs.atlassian.com\/bitbucketserver\/docs-067\/Using+pull+requests+in+Bitbucket+Server?utm_campaign=in-app-help&utm_medium=in-app-help&utm_source=stash';case "help.search.guide":return 'http:\/\/go.atlassian.com\/bitbucket.go.search.guide?utm_campaign=in-app-help&utm_medium=in-app-help&utm_source=stash';case "help.search.troubleshoot":return 'http:\/\/go.atlassian.com\/bitbucket.go.search.troubleshoot?utm_campaign=in-app-help&utm_medium=in-app-help&utm_source=stash';
case "help.search.query":return 'http:\/\/go.atlassian.com\/bitbucket.go.search.query?utm_campaign=in-app-help&utm_medium=in-app-help&utm_source=stash';default:throw new n.default.NotImplementedError;}};b.prototype.search=function(a){return c.default.search(a).build()};b.prototype.project=function(a){return c.default.project(a).build()};b.prototype.repo=function(a){return c.default.project(a.project).repo(a).build()};b.prototype.user=function(a){return a.slug?c.default.user(a.slug).build():void 0};b.prototype.remote=function(a){return c.default.project(a.project.key).repo(a.slug).clone(a.scmId).buildAbsolute()};
e.default=new b;g.exports=e["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:react-functional', location = '/static/bitbucket/internal/util/components/react-functional.js' */
define("bitbucket/internal/util/components/react-functional",["exports","lodash","react"],function(e,h,f){function k(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(e,"__esModule",{value:!0});e.withForwardedRef=e.pure=e.getDisplayName=
e.compose=void 0;Object.defineProperty(e,"compose",{enumerable:!0,get:function(){return h.flowRight}});var l=f&&f.__esModule?f:{default:f},m=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var g=arguments[b],c;for(c in g)Object.prototype.hasOwnProperty.call(g,c)&&(a[c]=g[c])}return a},n=function(){function a(b,a){for(var c=0;c<a.length;c++){var d=a[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,g,c){g&&
a(b.prototype,g);c&&a(b,c);return b}}(),p=e.getDisplayName=function(a){return"string"===typeof a?a:a.displayName||a.name||"Component"};e.pure=function(a){var b=function(b){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var a=(c.__proto__||Object.getPrototypeOf(c)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?this:a}k(c,b);n(c,[{key:"render",
value:function(){return a(this.props)}}]);return c}(f.PureComponent);b.displayName="Pure("+p(a)+")";b.propTypes=a.propTypes;b.defaultProps=a.defaultProps;return b};e.withForwardedRef=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"forwardedRef";return function(b){return(0,f.forwardRef)(function(e,c){var d={};a in d?Object.defineProperty(d,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):d[a]=c;return l.default.createElement(b,m({},e,d))})}}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-tipsy', location = '/static/bitbucket/internal/bbui/tipsy/tipsy.js' */
define("bitbucket/internal/bbui/tipsy/tipsy","exports jquery prop-types react bitbucket/internal/util/components/react-functional @atlassian/aui".split(" "),function(f,d,p,e,q){function l(a){return a&&a.__esModule?a:{default:a}}function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function r(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(f,"__esModule",{value:!0});f.TipsyWithRef=void 0;var g=l(d);d=l(p);var n=l(e),t=function(){function a(b,c){for(var h=0;h<c.length;h++){var a=c[h];a.enumerable=a.enumerable||!1;a.configurable=!0;"value"in a&&(a.writable=!0);Object.defineProperty(b,a.key,a)}}return function(b,c,h){c&&a(b.prototype,
c);h&&a(b,h);return b}}(),u=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return function(c){return b.filter(function(c){return c}).forEach(function(b){return b.current=c})}};e=function(a){function b(){var c,a,d,e;if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");for(var g=arguments.length,f=Array(g),k=0;k<g;k++)f[k]=arguments[k];return e=(a=(d=m(this,(c=b.__proto__||Object.getPrototypeOf(b)).call.apply(c,[this].concat(f))),d),d.el=n.default.createRef(),
a),m(d,e)}r(b,a);t(b,[{key:"componentDidMount",value:function(){var c=this,a=this.props,b=a.gravity,d=a.offset,e=a.hoverable,f=a.tooltipClassName,k=a.delay;a=a.disabled;(0,g.default)(this.el.current).tooltip({gravity:b,offset:d,hoverable:e,className:f,delayIn:k,title:function(){return c.props.condition?c.props.condition(c.el.current)?c.props.title:"":c.props.title}});a&&(0,g.default)(this.el.current).tipsy("disable").tipsy("hide")}},{key:"componentDidUpdate",value:function(a){var b=this.props.disabled;
!0===a.disabled&&!1===b?(0,g.default)(this.el.current).tipsy("enable"):!1===a.disabled&&!0===b&&(0,g.default)(this.el.current).tipsy("disable").tipsy("hide")}},{key:"componentWillUnmount",value:function(){(0,g.default)(this.el.current).tipsy("disable").tipsy("hide")}},{key:"render",value:function(){var a=this.props,b=a.children,d=a.className;a=a.title;return n.default.createElement("span",{ref:u(this.el,this.props.innerRef),className:d,title:a},b)}}],[{key:"isTruncatedCondition",value:function(a){return a.offsetWidth<
a.scrollWidth}}]);return b}(e.Component);e.propTypes={children:d.default.node,title:d.default.string.isRequired,className:d.default.string,delay:d.default.number,gravity:d.default.oneOf("n s e w ne nw se sw".split(" ")),hoverable:d.default.bool,offset:d.default.number,tooltipClassName:d.default.string,condition:d.default.func,disabled:d.default.bool};e.defaultProps={delay:0,className:"",gravity:"n",hoverable:!0,offset:0,tooltipClassName:"",disabled:!1};f.default=e;f.TipsyWithRef=(0,q.withForwardedRef)("innerRef")(e)});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:icons', location = '/static/bitbucket/internal/images/icons/icons.soy' */
// This file was automatically generated from icons.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.images.icons.icons.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.images == 'undefined') { bitbucket.internal.images = {}; }
if (typeof bitbucket.internal.images.icons == 'undefined') { bitbucket.internal.images.icons = {}; }
if (typeof bitbucket.internal.images.icons.icons == 'undefined') { bitbucket.internal.images.icons.icons = {}; }


bitbucket.internal.images.icons.icons.createRepo = function(opt_data, opt_ignored) {
  return '<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="#B1B1B1" fill-rule="evenodd"><path d="M13.272 13.272h9.344a1.387 1.387 0 0 0-.01-2.772h-9.334V9.337 1.384a1.387 1.387 0 0 0-2.772.01V10.5H1.394C.617 10.5 0 11.12 0 11.886c0 .771.618 1.386 1.38 1.386h9.16l-.04 9.334c0 .777.62 1.394 1.386 1.394a1.38 1.38 0 0 0 1.386-1.38v-6.733-2.637z"/></g></svg>';
};
if (goog.DEBUG) {
  bitbucket.internal.images.icons.icons.createRepo.soyTemplateName = 'bitbucket.internal.images.icons.icons.createRepo';
}


bitbucket.internal.images.icons.icons.importRepo = function(opt_data, opt_ignored) {
  return '<svg width="21" height="23" viewBox="0 0 21 23" xmlns="http://www.w3.org/2000/svg"><g fill="#B1B1B1" fill-rule="evenodd"><path d="M7 0h9.778c1.167 0 2.162.421 2.986 1.263.824.843 1.236 1.86 1.236 3.05v11.5a4.23 4.23 0 0 1-.837 2.566 4.24 4.24 0 0 1-2.138 1.566 4.192 4.192 0 0 1-1.504 2.201c-.74.57-1.58.854-2.521.854H4.2c-1.16 0-2.15-.421-2.97-1.263-.82-.843-1.23-1.86-1.23-3.05v-11.5C0 6.223.277 5.36.831 4.6a4.084 4.084 0 0 1 2.144-1.544A4.192 4.192 0 0 1 4.479.854 4.028 4.028 0 0 1 7 0zm12.578 15.813v-11.5c0-.787-.273-1.462-.82-2.028-.547-.565-1.207-.848-1.98-.848H7c-.518 0-.99.132-1.416.394-.427.262-.764.61-1.012 1.044H14c1.16 0 2.15.421 2.97 1.263.82.843 1.23 1.86 1.23 3.05v11.118a2.876 2.876 0 0 0 1.006-1.056c.248-.442.372-.92.372-1.438zm-2.756 2.897V7.21c0-.794-.275-1.471-.826-2.033A2.693 2.693 0 0 0 14 4.335H4.222c-.773 0-1.433.28-1.98.842a2.808 2.808 0 0 0-.82 2.033v11.5c0 .794.273 1.471.82 2.033a2.663 2.663 0 0 0 1.98.842H14c.78 0 1.446-.28 1.996-.842.55-.562.826-1.24.826-2.033z"/><path d="M9.873 17.853c-.356.424-.93.43-1.292 0l-3.734-4.426c-.357-.424-.193-.767.307-.767H8.222V6.652h1.95v6.008h3.063c.555 0 .722.337.36.767l-3.722 4.426z"/></g></svg>';
};
if (goog.DEBUG) {
  bitbucket.internal.images.icons.icons.importRepo.soyTemplateName = 'bitbucket.internal.images.icons.icons.importRepo';
}


bitbucket.internal.images.icons.icons.logo = function(opt_data, opt_ignored) {
  return '<svg width="42" height="48" viewBox="0 0 42 48" xmlns="http://www.w3.org/2000/svg"><title>logo-BB</title><g fill="#205081" fill-rule="evenodd"><path d="M21 0C9.472 0 .002 3.063.002 6.942c0 1.02 2.47 15.517 3.5 21.233.411 2.654 7.205 6.33 17.498 6.33 10.293 0 16.88-3.676 17.498-6.33 1.03-5.716 3.5-20.212 3.5-21.233C41.792 3.062 32.528 0 21 0zm0 29.809c-3.706 0-6.588-2.859-6.588-6.534s2.882-6.533 6.588-6.533 6.588 2.858 6.588 6.533c0 3.471-2.882 6.534-6.588 6.534zm0-20.826c-7.411 0-13.381-1.225-13.381-2.858S13.589 3.267 21 3.267c7.411 0 13.381 1.225 13.381 2.858S28.411 8.983 21 8.983z"/><path d="M36.194 33.688c-.412 0-.618.204-.618.204s-5.147 4.083-14.41 4.083c-9.264 0-14.411-4.083-14.411-4.083s-.412-.204-.618-.204c-.411 0-.823.204-.823.817v.204c.823 4.287 1.441 7.35 1.441 7.758.618 3.063 6.794 5.513 14.205 5.513 7.41 0 13.587-2.45 14.204-5.513 0-.408.618-3.47 1.441-7.758v-.204c.206-.409 0-.817-.411-.817z"/><ellipse cx="21" cy="23.071" rx="3.294" ry="3.267"/></g></svg>';
};
if (goog.DEBUG) {
  bitbucket.internal.images.icons.icons.logo.soyTemplateName = 'bitbucket.internal.images.icons.icons.logo';
}


bitbucket.internal.images.icons.icons.allCommits = function(opt_data, opt_ignored) {
  return '<svg xmlns="http://www.w3.org/2000/svg" width="12" height="15" viewBox="0 0 12 14"><path    style="fill:#999" d="M13,11.91a2.47,2.47,0,0,0,.32-0.27A2.22,2.22,0,0,0,14,10V2.31A2.22,2.22,0,0,0,13.32.68,2.22,2.22,0,0,0,11.69,0H6.31A2.22,2.22,0,0,0,4.68.68,2.47,2.47,0,0,0,4.4,1H5.5A1.48,1.48,0,0,1,6.31.77h5.38a1.49,1.49,0,0,1,1.08.45,1.48,1.48,0,0,1,.45,1.09V10a1.47,1.47,0,0,1-.23.81v1.09Z" transform="translate(-2 0)"/><path    style="fill:#999" d="M4.31,2H9.69a2.22,2.22,0,0,1,1.63.68A2.22,2.22,0,0,1,12,4.31V12a2.31,2.31,0,0,1-2.31,2.31H4.31a2.22,2.22,0,0,1-1.63-.68A2.22,2.22,0,0,1,2,12V4.31a2.22,2.22,0,0,1,.68-1.63A2.22,2.22,0,0,1,4.31,2Zm6.92,10V4.31A1.54,1.54,0,0,0,9.69,2.77H4.31A1.54,1.54,0,0,0,2.77,4.31V12a1.54,1.54,0,0,0,1.54,1.54H9.69A1.54,1.54,0,0,0,11.23,12Z" transform="translate(-2 0)"/><polygon style="fill:#999" points="4.5 4 5.5 4 5.5 6.4 5.5 7 4.5 7 4.5 4" /><polygon style="fill:#999" points="4.5 9 5.5 9 5.5 11.4 5.5 12 4.5 12 4.5 9"/><path    style="fill:#999" d="M7,10A2,2,0,1,1,9,8,2,2,0,0,1,7,10ZM7,7A1,1,0,1,0,8,8,1,1,0,0,0,7,7Z" transform="translate(-2 0)"/></svg>';
};
if (goog.DEBUG) {
  bitbucket.internal.images.icons.icons.allCommits.soyTemplateName = 'bitbucket.internal.images.icons.icons.allCommits';
}


bitbucket.internal.images.icons.icons.commit = function(opt_data, opt_ignored) {
  return '<svg xmlns="http://www.w3.org/2000/svg" width="7" height="15" viewBox="0 0 7 15"><path style="fill:#999" d="M11.07,7.39a3.5,3.5,0,0,0-3-3.45V0h-1V3.94a3.48,3.48,0,0,0,0,6.9V15h1V10.84A3.5,3.5,0,0,0,11.07,7.39Zm-3.5,2.5a2.5,2.5,0,1,1,2.5-2.5A2.5,2.5,0,0,1,7.57,9.89Z" transform="translate(-4.07 0)"/></svg>';
};
if (goog.DEBUG) {
  bitbucket.internal.images.icons.icons.commit.soyTemplateName = 'bitbucket.internal.images.icons.icons.commit';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:react-icons', location = '/static/bitbucket/internal/widget/icons/icons-factory.js' */
define("bitbucket/internal/widget/icons/icons-factory","exports classnames lodash prop-types react bitbucket/internal/bbui/tipsy/tipsy bitbucket/internal/util/components/react-functional".split(" "),function(f,e,n,w,x,y,p){function h(c){return c&&c.__esModule?c:{default:c}}function q(c,d){var a={},b;for(b in c)0<=d.indexOf(b)||Object.prototype.hasOwnProperty.call(c,b)&&(a[b]=c[b]);return a}Object.defineProperty(f,"__esModule",{value:!0});f.svgIconFactory=f.iconfontIconFactory=void 0;var r=h(e);e=
h(w);var k=h(x),t=h(y),g=Object.assign||function(c){for(var d=1;d<arguments.length;d++){var a=arguments[d],b;for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&(c[b]=a[b])}return c},u=function(c){return(0,n.upperFirst)((0,n.camelCase)(c))+"Icon'"},v={className:e.default.string,children:e.default.node,size:e.default.oneOf(["small","large"]),tooltip:e.default.bool},l={className:null,children:null,size:"small",tooltip:!1},m={small:"aui-icon-small",large:"aui-icon-large"};f.iconfontIconFactory=function(c){var d=
function(a){var b=a.className,d=a.children,e=a.size,f=a.tooltip;a=q(a,["className","children","size","tooltip"]);b=(0,r.default)("aui-icon",m[e]||m[l.size],"aui-iconfont-"+c,b);return f?k.default.createElement(t.default,g({className:b},a),d):k.default.createElement("span",g({className:b},a),d)};d.propTypes=g({},v);d.defaultProps=g({},l);d.displayName=u(c);return(0,p.pure)(d)};f.svgIconFactory=function(c){var d="icon-"+c,a=function(b){var a=b.className,c=b.children,e=b.size,f=b.tooltip;b=q(b,["className",
"children","size","tooltip"]);a=(0,r.default)("aui-icon",m[e]||m[l.size],d,a);return f?k.default.createElement(t.default,g({className:a},b),c):k.default.createElement("span",g({className:a},b),c)};a.propTypes=g({},v);a.defaultProps=g({},l);a.displayName=u(c);return(0,p.pure)(a)}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:react-icons', location = '/static/bitbucket/internal/widget/icons/icons.js' */
define("bitbucket/internal/widget/icons/icons",["exports","react","./icons-factory"],function(a,c,b){Object.defineProperty(a,"__esModule",{value:!0});a.WarningIcon=a.FileUnknownIcon=a.TaskIcon=a.SubmoduleIcon=a.RepositorySmallIcon=a.NewArrowUpIcon=a.InfoFilledIcon=a.ForkSmallIcon=a.FolderOpenedIcon=a.FolderIcon=a.FileRenamedIcon=a.FileRemovedIcon=a.FileMovedIcon=a.FileModifiedIcon=a.FileCopiedIcon=a.FileConflictedIcon=a.FileAddedIcon=a.FailedBuildIcon=a.ErrorIcon=a.EditFilledIcon=a.CrossIcon=a.CommitsIcon=
a.CommentIcon=a.ChevronUpIcon=a.ChevronTripleUpIcon=a.ChevronRightIcon=a.ChevronRight=a.ChevronDown=a.ChevronDoubleUpIcon=a.ChevronDoubleDownIcon=a.ChevronDoubleRightIcon=a.ChevronDoubleLeftIcon=a.CheckIcon=a.BranchIcon=a.ArrowRightIcon=a.ArrowDownSmallIcon=a.ApproveIcon=a.AddonIcon=a.AddIcon=void 0;a.AddIcon=(0,b.iconfontIconFactory)("add");a.AddonIcon=(0,b.iconfontIconFactory)("addon");a.ApproveIcon=(0,b.iconfontIconFactory)("approve");a.ArrowDownSmallIcon=(0,b.iconfontIconFactory)("arrow-down-small");
a.ArrowRightIcon=(0,b.iconfontIconFactory)("arrow-right");a.BranchIcon=(0,b.iconfontIconFactory)("branch");a.CheckIcon=(0,b.iconfontIconFactory)("check");a.ChevronDoubleLeftIcon=(0,b.iconfontIconFactory)("chevron-double-left");a.ChevronDoubleRightIcon=(0,b.iconfontIconFactory)("chevron-double-right");a.ChevronDoubleDownIcon=(0,b.iconfontIconFactory)("chevron-double-down");a.ChevronDoubleUpIcon=(0,b.svgIconFactory)("chevron-double-up");a.ChevronDown=(0,b.iconfontIconFactory)("chevron-down");a.ChevronRight=
(0,b.iconfontIconFactory)("chevron-right");a.ChevronRightIcon=(0,b.iconfontIconFactory)("chevron-right");a.ChevronTripleUpIcon=(0,b.svgIconFactory)("chevron-triple-up");a.ChevronUpIcon=(0,b.svgIconFactory)("chevron-up");a.CommentIcon=(0,b.iconfontIconFactory)("comment");a.CommitsIcon=(0,b.iconfontIconFactory)("commits");a.CrossIcon=(0,b.iconfontIconFactory)("cross");a.EditFilledIcon=(0,b.iconfontIconFactory)("edit-filled");a.ErrorIcon=(0,b.iconfontIconFactory)("error");a.FailedBuildIcon=(0,b.iconfontIconFactory)("failed-build");
a.FileAddedIcon=(0,b.svgIconFactory)("file-added");a.FileConflictedIcon=(0,b.svgIconFactory)("file-conflicted");a.FileCopiedIcon=(0,b.svgIconFactory)("file-copied");a.FileModifiedIcon=(0,b.svgIconFactory)("file-modified");a.FileMovedIcon=(0,b.svgIconFactory)("file-moved");a.FileRemovedIcon=(0,b.svgIconFactory)("file-removed");a.FileRenamedIcon=(0,b.svgIconFactory)("file-renamed");a.FolderIcon=(0,b.svgIconFactory)("folder-closed");a.FolderOpenedIcon=(0,b.svgIconFactory)("folder-opened");a.ForkSmallIcon=
(0,b.iconfontIconFactory)("fork-small");a.InfoFilledIcon=(0,b.iconfontIconFactory)("info-filled");a.NewArrowUpIcon=(0,b.iconfontIconFactory)("new-arrow-up");a.RepositorySmallIcon=(0,b.iconfontIconFactory)("repository-small");a.SubmoduleIcon=(0,b.iconfontIconFactory)("submodule");a.TaskIcon=(0,b.iconfontIconFactory)("task");a.FileUnknownIcon=(0,b.svgIconFactory)("file-unknown");a.WarningIcon=(0,b.svgIconFactory)("warning")});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-aui-react', location = '/static/bitbucket/internal/bbui/aui-react/inline-dialog.js' */
define("bitbucket/internal/bbui/aui-react/inline-dialog","exports classnames lodash prop-types react react-dom ./component".split(" "),function(h,c,l,t,e,u,k){function f(a){return a&&a.__esModule?a:{default:a}}function n(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function p(a,b){if("function"!==
typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(h,"__esModule",{value:!0});h.InlineDialogTrigger=void 0;var v=f(c);c=f(t);var q=f(e),w=f(k),x=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var g=arguments[b],d;for(d in g)Object.prototype.hasOwnProperty.call(g,
d)&&(a[d]=g[d])}return a},r=function(){function a(b,g){for(var d=0;d<g.length;d++){var a=g[d];a.enumerable=a.enumerable||!1;a.configurable=!0;"value"in a&&(a.writable=!0);Object.defineProperty(b,a.key,a)}}return function(b,g,d){g&&a(b.prototype,g);d&&a(b,d);return b}}();k=h.InlineDialogTrigger=function(a){function b(a){n(this,b);var d=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));d.elementType="button";d.triggerProps={"aria-controls":a.dialogId,"aria-haspopup":!0,className:(0,v.default)("aui-button",
a.className),"data-aui-trigger":!0,role:"button",title:a.title,onFocus:a.onFocus,onBlur:a.onBlur};a.href&&(d.triggerProps=x({},d.triggerProps,{className:a.className,href:a.href,tabIndex:"0"}),d.elementType="a");return d}p(b,a);r(b,[{key:"render",value:function(){return q.default.createElement(this.elementType,this.triggerProps,this.props.children)}}]);return b}(e.Component);k.propTypes={children:c.default.node,className:c.default.string,dialogId:c.default.string.isRequired,href:c.default.string,title:c.default.string,
onFocus:c.default.func,onBlur:c.default.func};k.defaultProps={className:"",href:"",title:""};e=function(a){function b(){var a,d,c,e;n(this,b);for(var h=arguments.length,k=Array(h),f=0;f<h;f++)k[f]=arguments[f];return e=(d=(c=m(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(k))),c),c.onHide=function(a){(0,l.isFunction)(c.props.onHide)&&(0,l.defer)(function(){return c.props.onHide(a)})},c.onShow=function(a){(0,l.isFunction)(c.props.onShow)&&(0,l.defer)(function(){return c.props.onShow(a)})},
d),m(c,e)}p(b,a);r(b,[{key:"componentDidMount",value:function(){this._el=(0,u.findDOMNode)(this).querySelector("aui-inline-dialog");this._el.addEventListener("aui-hide",this.onHide);this._el.addEventListener("aui-show",this.onShow)}},{key:"componentWillUnmount",value:function(){this._el.removeEventListener("aui-hide",this.onHide);this._el.removeEventListener("aui-show",this.onShow)}},{key:"render",value:function(){var a=this.props,b=a.id;return q.default.createElement(w.default,{id:b,markup:'\x3caui-inline-dialog\n                            id\x3d"'+
b+'"\n                            class\x3d"'+a.className+'"\n                            alignment\x3d"'+a.alignment+'"\n                            responds-to\x3d"'+a.respondsTo+'"\n                         \x3e\x3c/aui-inline-dialog\x3e',containerSelector:"#"+b+" .aui-inline-dialog-contents"},a.children)}}]);return b}(e.Component);e.propTypes={alignment:c.default.string,children:c.default.node,className:c.default.string,id:c.default.string.isRequired,onHide:c.default.func,onShow:c.default.func,
respondsTo:c.default.oneOf(["toggle","hover"])};e.defaultProps={alignment:"right middle",className:"",respondsTo:"toggle"};h.default=e});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-aui-react', location = '/static/bitbucket/internal/bbui/aui-react/component.js' */
define("bitbucket/internal/bbui/aui-react/component","module exports classnames lodash prop-types react react-dom".split(" "),function(m,g,a,n,p,d,h){function e(c){return c&&c.__esModule?c:{default:c}}function q(c,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);c.prototype=Object.create(b&&b.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(c,b):
c.__proto__=b)}Object.defineProperty(g,"__esModule",{value:!0});var r=e(a),t=e(n);a=e(p);var l=e(d),k=e(h),u=function(){function c(b,f){for(var c=0;c<f.length;c++){var a=f[c];a.enumerable=a.enumerable||!1;a.configurable=!0;"value"in a&&(a.writable=!0);Object.defineProperty(b,a.key,a)}}return function(b,f,a){f&&c(b.prototype,f);a&&c(b,a);return b}}();h={children:a.default.node.isRequired,containerSelector:a.default.string,id:a.default.string,markup:a.default.string.isRequired,wrapperClass:a.default.string};
d=function(a){function b(){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var a=(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?this:a}q(b,a);u(b,[{key:"componentDidMount",value:function(){var a=this,b=k.default.findDOMNode(this);b.innerHTML=this.props.markup;b.firstChild.id=this.props.id;t.default.defer(function(){return a.updateContent()})}},
{key:"componentDidUpdate",value:function(){this.updateContent()}},{key:"componentWillUnmount",value:function(){this.getContainer()&&k.default.unmountComponentAtNode(this.getContainer());if(this.props.id){var a=document.querySelector("#"+this.props.id);a&&a.parentNode.removeChild(a)}}},{key:"getContainer",value:function(){return this._container?this._container:this._container=document.querySelector(this.props.containerSelector||"#"+this.props.id)}},{key:"updateContent",value:function(){var a=l.default.createElement("div",
{className:(0,r.default)(this.props.wrapperClass)},this.props.children);this.getContainer()&&k.default.render(a,this.getContainer())}},{key:"render",value:function(){return l.default.createElement("div",null)}}]);return b}(d.Component);d.propTypes=h;g.default=d;m.exports=g["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-aui-react', location = '/static/bitbucket/internal/bbui/aui-react/toggle-button.js' */
define("bitbucket/internal/bbui/aui-react/toggle-button",["module","exports","lodash","prop-types","react"],function(p,g,f,d,h){function n(b,a){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?b:a}function q(b,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,enumerable:!1,
writable:!0,configurable:!0}});a&&(Object.setPrototypeOf?Object.setPrototypeOf(b,a):b.__proto__=a)}Object.defineProperty(g,"__esModule",{value:!0});d=d&&d.__esModule?d:{default:d};var r=h&&h.__esModule?h:{default:h},t=Object.assign||function(b){for(var a=1;a<arguments.length;a++){var e=arguments[a],k;for(k in e)Object.prototype.hasOwnProperty.call(e,k)&&(b[k]=e[k])}return b},u=function(){function b(a,e){for(var b=0;b<e.length;b++){var c=e[b];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in
c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(a,e,d){e&&b(a.prototype,e);d&&b(a,d);return a}}(),m=function(b){function a(){var e,b,c,d;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");for(var f=arguments.length,g=Array(f),l=0;l<f;l++)g[l]=arguments[l];return d=(b=(c=n(this,(e=a.__proto__||Object.getPrototypeOf(a)).call.apply(e,[this].concat(g))),c),c.preventOnToggleTrigger=!1,c.onToggle=function(a){a=a.target.checked;if(!c.preventOnToggleTrigger){var b=
c.props.onToggle;b&&b(a)}},c.setBooleanProps=function(b){a.booleanProps.forEach(function(a){c.toggle.current[a]=b[a]})},c.toggle=(0,h.createRef)(),b),n(c,d)}q(a,b);u(a,[{key:"componentDidMount",value:function(){var a=this;this.setBooleanProps(this.props);(0,f.defer)(function(){a.preventOnToggleTrigger=!0;a.setBooleanProps(a.props);a.toggle.current.addEventListener("change",a.onToggle);(0,f.defer)(function(){a.preventOnToggleTrigger=!1})})}},{key:"componentDidUpdate",value:function(){var a=this;this.preventOnToggleTrigger=
!0;this.setBooleanProps(this.props);(0,f.defer)(function(){a.preventOnToggleTrigger=!1})}},{key:"componentWillUnmount",value:function(){this.toggle.current.removeEventListener("change",this.onToggle)}},{key:"render",value:function(){return r.default.createElement("aui-toggle",t({ref:this.toggle},(0,f.omit)(this.props,a.booleanProps.concat("onToggle"))))}}]);return a}(h.Component);m.booleanProps=["checked","disabled","busy"];m.propTypes={busy:d.default.bool,checked:d.default.bool,disabled:d.default.bool,
label:d.default.string.isRequired,onToggle:d.default.func};g.default=m;p.exports=g["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-aui-react', location = '/static/bitbucket/internal/bbui/aui-react/tabs.js' */
define("bitbucket/internal/bbui/aui-react/tabs",["exports","classnames","prop-types","react"],function(e,c,k,l){function h(a){return a&&a.__esModule?a:{default:a}}function m(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,
{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(e,"__esModule",{value:!0});e.Tabs=e.Tab=void 0;var p=h(c);c=h(k);var f=h(l),q=function(){function a(b,a){for(var d=0;d<a.length;d++){var g=a[d];g.enumerable=g.enumerable||!1;g.configurable=!0;"value"in g&&(g.writable=!0);Object.defineProperty(b,g.key,g)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();(e.Tab=function(a){return f.default.createElement("div",
{className:"tabs-pane active-pane"},a.children)}).propTypes={title:c.default.string.isRequired,children:c.default.node.isRequired,anchor:c.default.string};(e.Tabs=function(a){function b(a){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var d=m(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));d.onChange=function(b,a){d.setState(function(){return{selectedIndex:b}});if(d.props.onChange)d.props.onChange(b,a)};d.state={selectedIndex:a.startingIndex||0};return d}
n(b,a);q(b,[{key:"render",value:function(){var b=this,a=this.props,c=a.children;a=a.className;var e=this.state.selectedIndex,h=f.default.Children.toArray(c)[e];return f.default.createElement("div",{className:"aui-tabs horizontal-tabs "+(a||"")},f.default.createElement("ul",{className:"tabs-menu"},f.default.Children.map(c,function(a,c){var d=a.props;return f.default.createElement("li",{className:(0,p.default)("menu-item",{"active-tab":c===e})},f.default.createElement("a",{onClick:function(){return b.onChange(c,
d.anchor)},role:"button",tabIndex:0,href:d.anchor?"#"+d.anchor:null},d.title))})),h)}}]);return b}(f.default.Component)).propTypes={children:c.default.node.isRequired,onChange:c.default.func,startingIndex:c.default.number,className:c.default.string}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-aui-react', location = '/static/bitbucket/internal/bbui/aui-react/avatar.js' */
define("bitbucket/internal/bbui/aui-react/avatar","exports @atlassian/aui classnames prop-types react bitbucket/internal/enums bitbucket/internal/impl/urls".split(" "),function(d,b,f,v,k,r,l){function m(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(d,"__esModule",{value:!0});d.Avatar=d.ProjectAvatar=d.UserAvatar=void 0;var w=function(a){if(a&&a.__esModule)return a;var h={};if(null!=a)for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(h[b]=a[b]);h.default=a;return h}(b),n=m(f);
b=m(v);var c=m(k),p=m(l),e=Object.assign||function(a){for(var h=1;h<arguments.length;h++){var b=arguments[h],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}return a};k={avatarAttrs:b.default.object,avatarClassName:b.default.string,badges:b.default.arrayOf(b.default.shape({className:b.default.string,text:b.default.string})),className:b.default.string,linkClassName:b.default.string,size:b.default.string,tooltip:b.default.bool,tooltipText:b.default.string,visibleBadge:b.default.string,
withLink:b.default.bool,withName:b.default.bool,withEmail:b.default.bool};l={badges:[],size:"small",tooltip:!0,tooltipText:"",withName:!1,withEmail:!1};f=d.UserAvatar=function(a){var b=a.person.user||a.person,t=b.displayName||b.name,d=t,g=[];a.withName&&g.push(t);a.withEmail&&b.emailAddress&&(d+=" ("+b.emailAddress+")",g.push(c.default.createElement("span",{key:"email",className:"email-address"},b.emailAddress)));b={alt:t,avatarAttrs:{"data-username":b.name},avatarSrc:p.default.avatarUrl(b,r.AvatarSize[a.size.toUpperCase()]),
badges:a.badges,className:(0,n.default)("user-avatar",a.avatarClassName,{"badge-hidden":a.hideBadge},a.withName||a.withEmail?null:a.className),display:g,displayLink:a.withLink?p.default.user(b):void 0,linkClassName:a.withLink?a.linkClassName:void 0,size:a.size,title:a.tooltip&&(a.tooltipText||d),tooltip:a.tooltip,visibleBadge:a.visibleBadge};return c.default.createElement(u,e({},a,{avatarProps:b}))};f.defaultProps=e({},l);f.propTypes=e({},k,{person:b.default.object.isRequired});f=d.ProjectAvatar=
function(a){var b=a.project.name;if(a.project.avatarUrl)var d=p.default.avatarUrl(a.project,r.AvatarSize[a.size.toUpperCase()]);else throw Error("No avatar URL provided: "+JSON.stringify(a));return c.default.createElement(u,e({},a,{avatarProps:{alt:b,avatarSrc:d,badges:a.badges,isProject:!0,display:a.project.name,displayLink:"XXX TODO TEST",size:a.size,title:a.project.name,tooltip:a.tooltip,visibleBadge:a.visibleBadge}}))};f.defaultProps=e({},l,{avatarAttrs:{}});f.propTypes=e({},k,{project:b.default.object.isRequired});
var q=d.Avatar=function(a){var b=a.alt,d=a.avatarAttrs,f=a.avatarSrc,g=a.badges;g=void 0===g?[]:g;var k=a.isProject,l=a.className,m=a.size,q=a.title,p=a.tooltip,r=a.visibleBadge;a=(0,n.default)(l,"aui-avatar","aui-avatar-"+m,{"aui-avatar-badged":g.length,"aui-avatar-project":k});b={alt:b,ref:p?function(a){return w.$(a).tooltip()}:null,src:f,title:p?q:void 0};return c.default.createElement("span",e({className:a},d),c.default.createElement("span",{className:"aui-avatar-inner"},c.default.createElement("img",
e({alt:b.alt},b))),g.map(function(a){return c.default.createElement("span",{key:a.className,className:(0,n.default)("badge",a.className,{"badge-hidden":r!==a.className}),"aria-hidden":!r},a.text)}))};q.propTypes={alt:b.default.string,avatarAttrs:b.default.object,avatarSrc:b.default.string.isRequired,badges:b.default.array,isProject:b.default.bool,className:b.default.string,size:b.default.string,title:b.default.oneOfType([b.default.bool,b.default.string]),tooltip:b.default.bool,visibleBadge:b.default.string};
q.defaultProps={alt:null,avatarAttrs:{},badges:[],isProject:!1,className:null,size:"small",title:null,tooltip:!1,visibleBadge:null};var u=function(a){var b=a.avatarProps;return a.withName?c.default.createElement("div",{className:(0,n.default)(a.className,"avatar-with-name"),title:b.tooltip?b.title:void 0},c.default.createElement(q,e({},b,{tooltip:!1})),c.default.createElement(x,{display:b.display,href:a.withLink?b.displayLink:void 0,className:a.withLink?b.linkClassName:void 0})):c.default.createElement(q,
e({},b,{className:(0,n.default)(b.className,a.className)}))},x=function(a){var b=a.display,d=a.href;a=a.className;return d?c.default.createElement("a",{className:(0,n.default)("name",a),href:d},b):c.default.createElement("span",{className:"name"},b)}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-aui-react', location = '/static/bitbucket/internal/bbui/aui-react/flags.js' */
define("bitbucket/internal/bbui/aui-react/flags",["exports","classnames","lodash","prop-types","react"],function(d,e,l,n,m){function p(b){return b&&b.__esModule?b:{default:b}}function r(b,a){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?b:a}function t(b,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);b.prototype=Object.create(a&&
a.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}});a&&(Object.setPrototypeOf?Object.setPrototypeOf(b,a):b.__proto__=a)}Object.defineProperty(d,"__esModule",{value:!0});d.Flag=d.flagType=d.closeType=void 0;var u=p(e);e=p(n);var g=p(m),v=Object.assign||function(b){for(var a=1;a<arguments.length;a++){var k=arguments[a],h;for(h in k)Object.prototype.hasOwnProperty.call(k,h)&&(b[h]=k[h])}return b},w=function(){function b(a,k){for(var b=0;b<k.length;b++){var c=k[b];c.enumerable=
c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(a,c.key,c)}}return function(a,k,h){k&&b(a.prototype,k);h&&b(a,h);return a}}(),f=d.closeType={AUTO:"auto",MANUAL:"manual",NEVER:"never"};n=d.flagType={ERROR:"error",INFO:"info",SUCCESS:"success",WARNING:"warning"};var q=d.Flag=function(b){function a(){var b,h,c,e;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");for(var d=arguments.length,g=Array(d),f=0;f<d;f++)g[f]=arguments[f];return e=
(h=(c=r(this,(b=a.__proto__||Object.getPrototypeOf(a)).call.apply(b,[this].concat(g))),c),c.state={hidden:void 0},c.onTransitionEnd=(0,l.debounce)(function(){var a=c.props,b=a.id;a=a.onClose;c.state.hidden&&a&&a(b)},250),c.close=function(){return c.setState({hidden:!0})},h),r(c,e)}t(a,b);w(a,[{key:"componentDidMount",value:function(){var a=this;(0,l.defer)(function(){return a.setState({hidden:!1})});this.props.close===f.AUTO&&(this.autoCloseTimeout=setTimeout(this.close,5E3))}},{key:"componentWillUnmount",
value:function(){this.autoCloseTimeout&&clearTimeout(this.autoCloseTimeout)}},{key:"render",value:function(){var a=this.props,b=a.body,c=a.close,e=a.title;a=a.type;var d=this.state.hidden;return g.default.createElement("div",{className:"aui-flag","aria-hidden":(0,l.isBoolean)(d)?""+d:d,onTransitionEnd:this.onTransitionEnd},g.default.createElement("div",{className:(0,u.default)("aui-message","aui-message-"+a,"shadowed",a,{closeable:c!==f.NEVER,"aui-will-close":c===f.AUTO})},g.default.createElement("p",
{className:"title"},g.default.createElement("strong",null,e)),b,c===f.AUTO||c===f.MANUAL?g.default.createElement("span",{className:"aui-icon icon-close",role:"button",tabIndex:"0",onClick:this.close}):null))}}]);return a}(m.Component);q.propTypes={body:e.default.node,close:e.default.oneOf((0,l.values)(f)),id:e.default.string.isRequired,onClose:e.default.func,title:e.default.string,type:e.default.oneOf((0,l.values)(n))};q.defaultProps={close:f.MANUAL,type:n.INFO};m=function(b){var a=b.flags,d=b.onClose;
return g.default.createElement("div",{id:"aui-flag-container"},a&&a.map(function(a){return g.default.createElement(q,v({key:a.id},a,{onClose:d}))}))};m.propTypes={flags:e.default.array,onClose:e.default.func};d.default=m});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-aui-react', location = '/static/bitbucket/internal/bbui/aui-react/spinner.js' */
define("bitbucket/internal/bbui/aui-react/spinner",["exports","prop-types","react","bitbucket/internal/util/components/react-functional","@atlassian/aui"],function(c,b,a,e){function d(a){return f.default.createElement("aui-spinner",{size:a.size,filled:a.filled?"":void 0})}Object.defineProperty(c,"__esModule",{value:!0});c.SpinnerSize=void 0;b=b&&b.__esModule?b:{default:b};var f=a&&a.__esModule?a:{default:a};a=c.SpinnerSize={SMALL:"small",MEDIUM:"medium",LARGE:"large"};d.propTypes={size:b.default.oneOf([a.SMALL,
a.MEDIUM,a.LARGE]),filled:b.default.bool};d.defaultProps={size:a.SMALL,filled:!1};c.default=(0,e.pure)(d)});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-aui-react', location = '/static/bitbucket/internal/bbui/aui-react/dialog.js' */
define("bitbucket/internal/bbui/aui-react/dialog","exports @atlassian/aui classnames jquery lodash prop-types react react-dom bitbucket/internal/util/components/react-functional bitbucket/internal/widget/icons/icons".split(" "),function(d,m,a,g,p,y,f,z,A,B){function h(b){return b&&b.__esModule?b:{default:b}}function q(b,c){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!c||"object"!==typeof c&&"function"!==typeof c?b:c}function C(b,c){if("function"!==
typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);b.prototype=Object.create(c&&c.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(b,c):b.__proto__=c)}Object.defineProperty(d,"__esModule",{value:!0});d.getDialogContent=d.DialogWithRef=d.DialogSize=d.DialogContent=d.DialogFooter=d.DialogHeader=void 0;var D=h(a),r=h(g);a=h(y);var e=h(f),E=function(){function b(b,k){for(var c=
0;c<k.length;c++){var a=k[c];a.enumerable=a.enumerable||!1;a.configurable=!0;"value"in a&&(a.writable=!0);Object.defineProperty(b,a.key,a)}}return function(c,k,a){k&&b(c.prototype,k);a&&b(c,a);return c}}(),t=(0,p.once)(function(){var b=document.createElement("div");b.className="react-dialog-container";document.body.appendChild(b);return b}),v=d.DialogHeader=function(b){var c=b.headerActionContent,a=b.headerSecondaryContent,d=b.modal,u=b.onClose,F=b.showCloseButton;return e.default.createElement("header",
{className:"aui-dialog2-header"},e.default.createElement("h2",{className:"aui-dialog2-header-main"},b.titleContent),a?e.default.createElement("div",{className:"aui-dialog2-header-secondary"},a):null,c?e.default.createElement("div",{className:"aui-dialog2-header-actions"},c):null,!d&&u&&F?e.default.createElement("a",{className:"aui-dialog2-header-close",href:"#",onClick:u},e.default.createElement(B.CrossIcon,null,"Close")):null)};v.propTypes={headerSecondaryContent:a.default.node,
headerActionContent:a.default.node,modal:a.default.bool,onClose:a.default.func,showCloseButton:a.default.bool,titleContent:a.default.node};var w=d.DialogFooter=function(b){var a=b.footerActionContent;b=b.footerHintContent;return e.default.createElement("footer",{className:"aui-dialog2-footer"},a?e.default.createElement("div",{className:"aui-dialog2-footer-actions"},a):null,b?e.default.createElement("div",{className:"aui-dialog2-footer-hint"},b):null)};w.propTypes={footerActionContent:a.default.node,
footerHintContent:a.default.node};var x=d.DialogContent=function(b){return e.default.createElement("div",{className:"aui-dialog2-content"},b.children)};x.propTypes={children:a.default.node};g=d.DialogSize={SMALL:"small",MEDIUM:"medium",LARGE:"large",XLARGE:"xlarge"};f=function(b){function a(){var b,c,d,e;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");for(var f=arguments.length,n=Array(f),l=0;l<f;l++)n[l]=arguments[l];return e=(c=(d=q(this,(b=a.__proto__||Object.getPrototypeOf(a)).call.apply(b,
[this].concat(n))),d),d.container=document.createElement("div"),d.onKeyDownEsc=function(a){var b=a.keyCode,c=d.props,k=c.modal;c=c.onClose;"Escape"!==a.key&&b!==m.keyCode.ESCAPE||k||!c||c()},c),q(d,e)}C(a,b);E(a,[{key:"componentDidMount",value:function(){var a=document.body.style;this.allowBodyScroll=function(b){return function(){a.overflow=b}}(a.overflow);a.overflow="hidden";addEventListener("keydown",this.onKeyDownEsc);t().appendChild(this.container);m.FocusManager.global.enter((0,r.default)("#"+
this.props.id))}},{key:"componentWillUnmount",value:function(){this.allowBodyScroll();removeEventListener("keydown",this.onKeyDownEsc);t().removeChild(this.container);m.FocusManager.global.exit((0,r.default)("#"+this.props.id))}},{key:"render",value:function(){var a=this.props,b=a.children,c=a.className,d=a.headerSecondaryContent,f=a.headerActionContent,n=a.footerActionContent,l=a.footerHintContent,m=a.id,g=a.modal,h=a.onClose,p=a.showCloseButton,q=a.size,r=a.titleContent;a=a.warning;var t=this.props.dialogRef;
return(0,z.createPortal)(e.default.createElement("div",{ref:t},e.default.createElement("section",{role:"dialog",id:m,className:(0,D.default)("aui-layer","aui-dialog2","aui-dialog2-"+q,{"aui-dialog2-warning":a},c),"data-aui-focus":!1,"data-aui-blanketed":!0,style:{zIndex:3E3}},e.default.createElement(v,{headerActionContent:f,headerSecondaryContent:d,modal:g,onClose:h,showCloseButton:p,titleContent:r}),e.default.createElement(x,null,b),n||l?e.default.createElement(w,{footerActionContent:n,footerHintContent:l}):
null),e.default.createElement("div",{className:"aui-blanket",style:{zIndex:2980},"aria-hidden":!1,onClick:g?null:h,tabIndex:"0"})),this.container)}}]);return a}(f.PureComponent);f.propTypes={children:a.default.node,className:a.default.string,headerSecondaryContent:a.default.node,headerActionContent:a.default.node,footerActionContent:a.default.node,footerHintContent:a.default.node,id:a.default.string,modal:a.default.bool,onClose:function(a,c){return function(b){for(var d=arguments.length,e=Array(1<
d?d-1:0),f=1;f<d;f++)e[f-1]=arguments[f];return(c(b)?a.isRequired:a).apply(void 0,[b].concat(e))}}(a.default.func,function(a){return!a.modal}),showCloseButton:a.default.bool,size:a.default.oneOf((0,p.values)(g)),titleContent:a.default.node,warning:a.default.bool};f.defaultProps={modal:!1,size:g.MEDIUM,showCloseButton:!0,warning:!1};d.default=f;d.DialogWithRef=(0,A.withForwardedRef)("dialogRef")(f);d.getDialogContent=function(a){return a.querySelector(".aui-dialog2-content")}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-aui-react', location = '/static/bitbucket/internal/bbui/aui-react/messages.js' */
define("bitbucket/internal/bbui/aui-react/messages",["exports","classnames","prop-types","react"],function(c,b,k,l){function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});c.Message=c.WarningMessage=void 0;var m=e(b);b=e(k);var f=e(l),n=Object.assign||function(a){for(var g=1;g<arguments.length;g++){var b=arguments[g],d;for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])}return a};c.WarningMessage=function(a){return f.default.createElement(h,
n({type:"warning"},a))};var h=c.Message=function(a){var b=a.type,c=a.title,d=a.className;a=a.children;b=(0,m.default)("aui-message","aui-message-"+b,d);return f.default.createElement("div",{className:b},c&&f.default.createElement("p",{className:"title"},c),a)};h.propTypes={type:b.default.oneOf(Object.values({ERROR:"error",WARNING:"warning",SUCCESS:"success",INFO:"info"})),title:b.default.string,children:b.default.node,className:b.default.string}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-aui-react', location = '/static/bitbucket/internal/bbui/aui-react/form.js' */
define("bitbucket/internal/bbui/aui-react/form",["exports","classnames","prop-types","react"],function(d,b,k,f){function l(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(d,"__esModule",{value:!0});d.Radio=d.RadioGroup=d.Checkbox=d.TextField=d.Warnings=d.Errors=void 0;var y=l(b);b=l(k);var c=l(f),v=function(a){a=a.errors;return 1===a.length?c.default.createElement("p",{className:"error"},c.default.createElement("span",{className:"aui-icon aui-icon-small aui-iconfont-error"}),a[0]):c.default.createElement("ul",
{className:"error"},a.map(function(a){return c.default.createElement("li",{key:a},a)}))};v.propTypes={errors:b.default.array.isRequired};var w=function(a){a=a.warnings;return 1===a.length?c.default.createElement("p",{className:"warning"},c.default.createElement("span",{className:"aui-icon aui-icon-small aui-iconfont-warning"}),a[0]):c.default.createElement("ul",{className:"warning"},a.map(function(a){return c.default.createElement("li",{key:a},a)}))};w.propTypes={warnings:b.default.array.isRequired};
f=function(a){var b=a.required,d=a.title,g=a.name,h=a.description,e=a.descriptionHtml,m=a.onChange,k=a.value,f=a.errors,l=a.size,t=a.maxLength,n=a.autoFocus;n=void 0===n?!1:n;var p=a.autoComplete;p=void 0===p?!0:p;var q=a.disabled;q=void 0===q?!1:q;var r=a.type;r=void 0===r?"text":r;var u=a.min,z=a.step;a=a.warnings;b=(void 0===b?0:b)?c.default.createElement("span",{className:"aui-icon icon-required"},"(required)"):null;h=e?c.default.createElement("div",{className:"description",dangerouslySetInnerHTML:e}):
c.default.createElement("div",{className:"description"},h);e=Array.isArray(f)&&0<f.length;var x=Array.isArray(a)&&0<a.length&&!e;return c.default.createElement("div",{className:"field-group aui-react-text-field"},c.default.createElement("label",{htmlFor:g},d,b),c.default.createElement("input",{className:(0,y.default)("text",l&&l+"-field",e&&"error-outline",x&&"warning-outline"),type:r,id:g,name:g,value:k,onChange:m,maxLength:t,autoFocus:n,autoComplete:p?"on":"off",disabled:q,min:u,step:z}),e?c.default.createElement(v,
{errors:f}):null,x?c.default.createElement(w,{warnings:a}):null,h)};f.propTypes={required:b.default.bool,description:b.default.string,descriptionHtml:b.default.object,title:b.default.string.isRequired,name:b.default.string.isRequired,onChange:b.default.func,value:b.default.string,errors:b.default.array,warnings:b.default.array,size:b.default.oneOf(["short","medium","medium-long","long","full-width"]),maxLength:b.default.number,autoFocus:b.default.bool,autoComplete:b.default.bool,disabled:b.default.bool,
type:b.default.string,min:b.default.number,step:b.default.number};k=function(a){var b=a.checked,d=a.description,g=a.disabled,h=a.label,e=a.name,m=a.id;return c.default.createElement("div",{className:"checkbox"},c.default.createElement("input",{"data-grouping":"trigger",className:"checkbox",type:"checkbox",name:e,id:m||e,onChange:a.onChange,checked:void 0===b?!1:b,disabled:void 0===g?!1:g,autoFocus:a.autoFocus}),c.default.createElement("label",{htmlFor:m||e},h),c.default.createElement("div",{className:"description"},
d))};k.propTypes={checked:b.default.bool,description:b.default.string,disabled:b.default.bool,label:b.default.string.isRequired,name:b.default.string.isRequired,id:b.default.string,onChange:b.default.func,autoFocus:b.default.bool};var t=function(a){var b=a.name,d=a.label,g=a.onChange,h=a.value,e=a.className;e=void 0===e?"":e;a=c.default.Children.map(a.children,function(a,d){return c.default.cloneElement(a,{id:a.props.id||b+"-"+(d+1),name:b,onChange:g,checked:h===a.props.value})});return c.default.createElement("fieldset",
{className:"group "+e},c.default.createElement("legend",null,c.default.createElement("span",null,d)),a)};t.propTypes={children:b.default.node,className:b.default.string,label:b.default.string.isRequired,name:b.default.string.isRequired,onChange:b.default.func.isRequired,value:b.default.string};var u=function(a){var b=a.id,d=a.name,g=a.label,h=a.onChange,e=a.value,f=a.description;return c.default.createElement("div",{className:"radio"},c.default.createElement("input",{autoFocus:a.autoFocus,className:"radio",
type:"radio",checked:a.checked,name:d,id:b||d,onChange:function(){return h(e)}}),c.default.createElement("label",{htmlFor:b||d},g),f&&c.default.createElement("div",{className:"description"},f))};u.propTypes={name:b.default.string,id:b.default.string,checked:b.default.bool,label:b.default.oneOfType([b.default.string.isRequired,b.default.object.isRequired]),onChange:b.default.func,value:b.default.string.isRequired,description:b.default.string,autoFocus:b.default.bool};d.Errors=v;d.Warnings=w;d.TextField=
f;d.Checkbox=k;d.RadioGroup=t;d.Radio=u});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:highlight-text-react-util', location = '/static/bitbucket/internal/util/highlight.js' */
define("bitbucket/internal/util/highlight",["module","exports","lodash","prop-types","react"],function(h,f,k,b,e){function p(c){var b=c.text,d=c.query,a=c.tag,e=void 0===a?"mark":a;a=c.caseSensitive;var f=void 0===a?!1:a;c=c.leadingOnly;var h=void 0===c?!1:c,n=(0,k.compact)((f&&d?d:d.toLowerCase()).split(m).map(function(a){return a.trim()}));return n.some(function(a){return b.match(new RegExp(RegExp.escape(a),f?"":"i"))})?b.split(m).map(function(a,c){var b="",d=0;if(!n.some(function(c){var e=f&&a?
a:a.toLowerCase(),g=(h?k.startsWith:k.includes)(e,c);g&&(b=c,d=e.indexOf(c));return g}))return a;var g=l.default.createElement(e,{key:c,className:"term-highlight"},a.substr(d,b.length));return a===b?g:l.default.createElement("span",{key:c},a.substr(0,d),g,a.substr(d+b.length))}):b}Object.defineProperty(f,"__esModule",{value:!0});b=b&&b.__esModule?b:{default:b};var l=e&&e.__esModule?e:{default:e},q=Object.assign||function(c){for(var b=1;b<arguments.length;b++){var d=arguments[b],a;for(a in d)Object.prototype.hasOwnProperty.call(d,
a)&&(c[a]=d[a])}return c},m=/(\W)/g;e=function(b){var c=[],d={},a;for(a in b)0<=c.indexOf(a)||Object.prototype.hasOwnProperty.call(b,a)&&(d[a]=b[a]);return l.default.createElement("span",null,p(q({},d)))};e.defaultProps={tag:"mark",caseSensitive:!1};e.propTypes={text:b.default.string.isRequired,query:b.default.string.isRequired,tag:b.default.string,caseSensitive:b.default.bool};f.default=e;h.exports=f["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:repository-search-results', location = '/static/bitbucket/internal/feature/repository/search-results/search-results-list.js' */
define("bitbucket/internal/feature/repository/search-results/search-results-list","module exports prop-types react react-dom ./search-results-item".split(" "),function(m,h,e,f,n,p){function g(a){return a&&a.__esModule?a:{default:a}}function q(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,c):a.__proto__=c)}Object.defineProperty(h,"__esModule",{value:!0});e=g(e);var k=g(f),r=g(n),t=g(p),u=function(){function a(c,b){for(var d=0;d<b.length;d++){var a=b[d];a.enumerable=a.enumerable||!1;a.configurable=!0;"value"in a&&(a.writable=!0);Object.defineProperty(c,a.key,a)}}return function(c,b,d){b&&a(c.prototype,b);d&&a(c,d);return c}}();f=function(a){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var b=(c.__proto__||Object.getPrototypeOf(c)).apply(this,
arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?this:b}q(c,a);u(c,[{key:"shouldComponentUpdate",value:function(b){return b.query!==this.props.query||b.repositories!==this.props.repositories||b.focusedIndex!==this.props.focusedIndex}},{key:"componentDidUpdate",value:function(b){if(!b||this.props.focusedIndex!==b.focusedIndex)if(b=this.focusedListEl){var d=b.previousSibling;b.previousSibling&&
b.nextSibling?this.scrollIntoView(d,d):this.scrollIntoView(b,d)}}},{key:"scrollIntoView",value:function(b,d){this.repoList&&(this.repoList.scrollTop=d?b.offsetTop-20:0)}},{key:"renderListWrapper",value:function(b,d,a){var c=this;return k.default.createElement("ul",{className:"repository-list search-results-container"},b.map(function(b,e){return k.default.createElement(t.default,{focused:d===e,key:b.id,repository:b,onItemClick:a,query:c.props.query,ref:function(b){d===e?c.focusedListEl=r.default.findDOMNode(b):
null}})}))}},{key:"render",value:function(){var b=this,a=this.props,c=a.EmptyState,e=a.focusedIndex,f=a.LoadMore,g=a.onItemClick,h=a.onScroll,l=a.repositories;return k.default.createElement("div",{className:"repository-list-container",ref:function(a){b.repoList=a},onScroll:function(a){return h(a.target.scrollTop)}},a.title,l&&0<l.length?this.renderListWrapper(l,e,g):c,f)}}]);return c}(f.Component);f.propTypes={repositories:e.default.array,title:e.default.node,focusedIndex:e.default.number,onItemClick:e.default.func,
EmptyState:e.default.element,LoadMore:e.default.element,query:e.default.string};h.default=f;m.exports=h["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:repository-search-results', location = '/static/bitbucket/internal/feature/repository/search-results/search-results-item.js' */
define("bitbucket/internal/feature/repository/search-results/search-results-item","module exports classnames prop-types react bitbucket/util/navbuilder bitbucket/internal/bbui/aui-react/avatar bitbucket/internal/enums bitbucket/internal/util/highlight".split(" "),function(n,e,c,t,f,u,q,p,v){function g(a){return a&&a.__esModule?a:{default:a}}function w(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&
b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(e,"__esModule",{value:!0});var x=g(c);c=g(t);var d=g(f),y=g(u),r=g(v),z=function(){function a(b,k){for(var h=0;h<k.length;h++){var a=k[h];a.enumerable=a.enumerable||!1;a.configurable=!0;"value"in a&&(a.writable=!0);Object.defineProperty(b,a.key,a)}}return function(b,k,h){k&&a(b.prototype,k);h&&a(b,h);return b}}();f=function(a){function b(){if(!(this instanceof
b))throw new TypeError("Cannot call a class as a function");var a=(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!==typeof a&&"function"!==typeof a?this:a}w(b,a);z(b,[{key:"render",value:function(){var a=this.props,b=a.repository,c=a.id,f=a.focused,g=a.onItemClick;a=a.query;var m=b.name,l=b.project,e=l.name,n=l.type;l=l.owner;a&&m&&(m=d.default.createElement(r.default,{text:m,
query:a,leadingOnly:!0}),e=d.default.createElement(r.default,{text:e,query:a,leadingOnly:!0}));return d.default.createElement("li",{className:(0,x.default)("search-results-item","repository",{focused:f})},d.default.createElement("a",{href:y.default.project(b.project).repo(b).build(),className:"repository-link","data-entity":"repository","data-repository-id":b.id,"data-repository-slug":b.slug,"data-project-id":b.project.id,"data-project-key":b.project.key,id:c,title:b.name,onClick:function(a){return g(a)}},
n===p.ProjectType.PERSONAL?d.default.createElement(q.UserAvatar,{person:l,size:p.AvatarTShirtSize.MEDIUM}):d.default.createElement(q.ProjectAvatar,{project:b.project,size:p.AvatarTShirtSize.MEDIUM}),d.default.createElement("div",{className:"item-wrapper"},d.default.createElement("strong",{className:"item-name"},m),d.default.createElement("p",{className:"item-description"},e))))}}]);return b}(f.Component);f.propTypes={repository:c.default.object.isRequired,id:c.default.string,focused:c.default.bool,
onItemClick:c.default.func,query:c.default.string};e.default=f;n.exports=e["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:project-avatar', location = '/static/bitbucket/internal/feature/project/project-avatar/project-avatar.soy' */
// This file was automatically generated from project-avatar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.feature.project.projectAvatar.projectAvatar.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.feature == 'undefined') { bitbucket.internal.feature = {}; }
if (typeof bitbucket.internal.feature.project == 'undefined') { bitbucket.internal.feature.project = {}; }
if (typeof bitbucket.internal.feature.project.projectAvatar == 'undefined') { bitbucket.internal.feature.project.projectAvatar = {}; }
if (typeof bitbucket.internal.feature.project.projectAvatar.projectAvatar == 'undefined') { bitbucket.internal.feature.project.projectAvatar.projectAvatar = {}; }


bitbucket.internal.feature.project.projectAvatar.projectAvatar.avatar = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({tagName: opt_data.tagName, size: opt_data.size, avatarImageUrl: opt_data.imageUrl ? opt_data.imageUrl : opt_data.project ? require('bitbucket/util/navbuilder')._avatarUrl(opt_data.project, ({XSMALL:32,SMALL:48,MEDIUM:64,LARGE:96,XLARGE:128,XXLARGE:192,XXXLARGE:256})[opt_data.size.toUpperCase()]).build() : '', accessibilityText: opt_data.project ? opt_data.project.name : '', title: opt_data.tooltip, badgeContent: opt_data.badgeContent, isProject: ! opt_data.standardAvatar && ! opt_data.project.owner, imageClasses: opt_data.imageClasses, extraClasses: (opt_data.hideBadge ? ' badge-hidden' : '') + (opt_data.extraClasses ? ' ' + opt_data.extraClasses : ''), extraAttributes: opt_data.extraAttributes});
};
if (goog.DEBUG) {
  bitbucket.internal.feature.project.projectAvatar.projectAvatar.avatar.soyTemplateName = 'bitbucket.internal.feature.project.projectAvatar.projectAvatar.avatar';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:repository-item', location = '/static/bitbucket/internal/feature/repository/repository-item/repository-item.soy' */
// This file was automatically generated from repository-item.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.feature.repository.repositoryItem.repositoryItem.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.feature == 'undefined') { bitbucket.internal.feature = {}; }
if (typeof bitbucket.internal.feature.repository == 'undefined') { bitbucket.internal.feature.repository = {}; }
if (typeof bitbucket.internal.feature.repository.repositoryItem == 'undefined') { bitbucket.internal.feature.repository.repositoryItem = {}; }
if (typeof bitbucket.internal.feature.repository.repositoryItem.repositoryItem == 'undefined') { bitbucket.internal.feature.repository.repositoryItem.repositoryItem = {}; }


bitbucket.internal.feature.repository.repositoryItem.repositoryItem.repositoryItem = function(opt_data, opt_ignored) {
  return '<span class="repository-item" title="' + soy.$$escapeHtml(opt_data.repository.project.name) + ' / ' + soy.$$escapeHtml(opt_data.repository.name) + '" data-id="' + soy.$$escapeHtml(opt_data.repository.id) + '" data-repository="' + soy.$$escapeHtml(JSON.stringify(opt_data.repository).replace(/\//g, '\\/').replace(/\74!--/g, '\\74!--')) + '">' + bitbucket.internal.feature.repository.repositoryItem.repositoryItem.repositoryItemContent({avatarTagName: 'span', repository: opt_data.repository}) + '</span>';
};
if (goog.DEBUG) {
  bitbucket.internal.feature.repository.repositoryItem.repositoryItem.repositoryItem.soyTemplateName = 'bitbucket.internal.feature.repository.repositoryItem.repositoryItem.repositoryItem';
}


bitbucket.internal.feature.repository.repositoryItem.repositoryItem.repositoryItemContent = function(opt_data, opt_ignored) {
  return bitbucket.internal.feature.project.projectAvatar.projectAvatar.avatar({size: 'xsmall', project: opt_data.repository.project, tagName: opt_data.avatarTagName}) + '<span class="project-and-repository" title="' + soy.$$escapeHtml(opt_data.repository.project.name) + ' / ' + soy.$$escapeHtml(opt_data.repository.name) + '"><span class="project-name">' + ((opt_data.projectNameContent) ? soy.$$filterNoAutoescape(opt_data.projectNameContent) : soy.$$escapeHtml(opt_data.repository.project.name)) + '</span><span class="separator">/</span><span class="name">' + ((opt_data.repositoryNameContent) ? soy.$$filterNoAutoescape(opt_data.repositoryNameContent) : soy.$$escapeHtml(opt_data.repository.name)) + '</span></span>';
};
if (goog.DEBUG) {
  bitbucket.internal.feature.repository.repositoryItem.repositoryItem.repositoryItemContent.soyTemplateName = 'bitbucket.internal.feature.repository.repositoryItem.repositoryItem.repositoryItemContent';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bower-atlassian-highlight-text', location = '/static/bower/atlassian-highlight-text/lib/internal/util/highlight-text.js' */
define("internal/util/highlight-text",function(){var d=/[&"'<>`]/g,e=function(b){var a={"\x3c":"\x26lt;","\x3e":"\x26gt;","\x26":"\x26amp;","'":"\x26#39;","`":"\x26#96;"};return a.hasOwnProperty(b)?a[b]:"\x26quot;"},f=function(b){return RegExp.escape(b.replace(d,e))};return{highlight:function(b,a,c){if(!a||0===a.length)return b.replace(d,e);a="string"===typeof a?f(a):a.map(f).join("|");c=new RegExp(a,null==c?"gi":c);return b.replace(d,e).replace(c,"\x3cmark\x3e$\x26\x3c/mark\x3e")}}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:highlight-text-util', location = '/static/bitbucket/internal/util/highlight-text.js' */
define("bitbucket/internal/util/highlight-text",["module","exports","internal/util/highlight-text"],function(c,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.default=(a&&a.__esModule?a:{default:a}).default;c.exports=b["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:recent-repositories-menu-resources', location = '/static/bitbucket/internal/layout/base/menu/repositories/recent.js' */
define("bitbucket/internal/layout/base/menu/repositories/recent","module exports jquery react react-dom bitbucket/util/events bitbucket/util/navbuilder bitbucket/util/server bitbucket/internal/feature/repository/search-results/search-results-list bitbucket/internal/util/html bitbucket/internal/util/shortcuts".split(" "),function(g,c,h,k,l,m,n,p,q,r,t){function a(b){return b&&b.__esModule?b:{default:b}}Object.defineProperty(c,"__esModule",{value:!0});var d=a(h),u=a(k),v=a(l),e=a(m),w=a(n),x=a(p),y=
a(q),z=a(r),A=a(t);c.default={initMenu:function(b){var a=(0,d.default)("#"+b);b=(0,d.default)("#"+z.default.sanitizeId(a.attr("aria-controls"))).addClass("recent-repositories-menu");b.find(".aui-dropdown2-section").addClass("repository-list-container").find("ul").addClass("repository-list");var f=b.find(".recent-repositories-section ul"),c=(0,d.default)(bitbucket.internal.layout.base.menu.repositories.recent.loadingRecentReposMenuItem());A.default.bind("recentRepositories",function(){return a.click()});
b.on("aui-dropdown2-show",function(){e.default.trigger("bitbucket.internal.DO_NOT_USE.ui.nav.repositories.opened")});b.find(".public-repo-list-link-section").on("click","a",function(){e.default.trigger("bitbucket.internal.DO_NOT_USE.ui.nav.repositories.public.clicked")});var g=function(a){e.default.trigger("bitbucket.internal.DO_NOT_USE.ui.nav.repositories.item.clicked",null,{repositoryId:a.currentTarget.dataset.repositoryId})};f.append(c);(0,d.default)(window).on("load",function(){x.default.rest({url:w.default.rest().profile().recent().repos().withParams({avatarSize:bitbucket.internal.widget.avatar.avatar.avatarSizeInPx({size:"medium"}),
limit:10}).build(),statusCode:{"*":!1}}).done(function(a){a&&a.size?(f.replaceWith('\x3cdiv id\x3d"recent-repositories-list-container"/\x3e'),v.default.render(u.default.createElement(y.default,{repositories:a.values,onItemClick:g}),document.getElementById("recent-repositories-list-container"))):f.append((0,d.default)(bitbucket.internal.layout.base.menu.repositories.recent.noRecentReposMenuItem()));e.default.trigger("bitbucket.internal.DO_NOT_USE.feature.repositories.recent.loaded",this,a)}).fail(function(){f.append((0,
d.default)(bitbucket.internal.layout.base.menu.repositories.recent.errorLoadingRecentReposMenuItem()))}).always(function(){c.remove()})})}};g.exports=c["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:recent-repositories-menu-resources', location = '/static/bitbucket/internal/layout/base/menu/repositories/recent.soy' */
// This file was automatically generated from recent.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.layout.base.menu.repositories.recent.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.layout == 'undefined') { bitbucket.internal.layout = {}; }
if (typeof bitbucket.internal.layout.base == 'undefined') { bitbucket.internal.layout.base = {}; }
if (typeof bitbucket.internal.layout.base.menu == 'undefined') { bitbucket.internal.layout.base.menu = {}; }
if (typeof bitbucket.internal.layout.base.menu.repositories == 'undefined') { bitbucket.internal.layout.base.menu.repositories = {}; }
if (typeof bitbucket.internal.layout.base.menu.repositories.recent == 'undefined') { bitbucket.internal.layout.base.menu.repositories.recent = {}; }


bitbucket.internal.layout.base.menu.repositories.recent.loadingRecentReposMenuItem = function(opt_data, opt_ignored) {
  return '<li><span class="loading-recent-repos">' + soy.$$escapeHtml('Loading...') + '</span></li>';
};
if (goog.DEBUG) {
  bitbucket.internal.layout.base.menu.repositories.recent.loadingRecentReposMenuItem.soyTemplateName = 'bitbucket.internal.layout.base.menu.repositories.recent.loadingRecentReposMenuItem';
}


bitbucket.internal.layout.base.menu.repositories.recent.noRecentReposMenuItem = function(opt_data, opt_ignored) {
  return '<li><span class="no-recent-repos">' + soy.$$escapeHtml('No recently viewed repositories') + '</span></li>';
};
if (goog.DEBUG) {
  bitbucket.internal.layout.base.menu.repositories.recent.noRecentReposMenuItem.soyTemplateName = 'bitbucket.internal.layout.base.menu.repositories.recent.noRecentReposMenuItem';
}


bitbucket.internal.layout.base.menu.repositories.recent.errorLoadingRecentReposMenuItem = function(opt_data, opt_ignored) {
  return '<li><span>' + soy.$$escapeHtml('An error occurred') + '</span></li>';
};
if (goog.DEBUG) {
  bitbucket.internal.layout.base.menu.repositories.recent.errorLoadingRecentReposMenuItem.soyTemplateName = 'bitbucket.internal.layout.base.menu.repositories.recent.errorLoadingRecentReposMenuItem';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:inbox-dialog', location = '/static/bitbucket/internal/feature/inbox/inbox.js' */
define("bitbucket/internal/feature/inbox/inbox","module exports @atlassian/aui jquery lodash bitbucket/util/events bitbucket/util/navbuilder bitbucket/util/server bitbucket/util/state".split(" "),function(n,g,h,p,l,q,r,t,u){function f(c){return c&&c.__esModule?c:{default:c}}Object.defineProperty(g,"__esModule",{value:!0});var d=f(p),e=f(q),v=f(r),w=f(t),m=f(u),x=function(){function c(b,a){for(var c=0;c<a.length;c++){var d=a[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=
!0);Object.defineProperty(b,d.key,d)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}(),k=function(){function c(){var b=this;if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.whenInboxCountFetched=function(a){b.$inboxTrigger.attr("aria-label",h.format("View your {0} unapproved pull {0,choice,0#requests|1#request|1\u003crequests}",a.count));if(0<a.count){var c=(0,d.default)(aui.badges.badge({text:a.count}));b.$inboxTrigger.html(bitbucket.internal.feature.inbox.inbox.triggerIcon()).append(c);
(0,l.defer)(function(){c.addClass("visible")})}else b.$inboxTrigger.find(".aui-badge").removeClass("visible"),setTimeout(function(){b.$inboxTrigger.html(bitbucket.internal.feature.inbox.inbox.triggerIcon())},500);b.$inboxTrigger.attr("data-countLoaded",!0)};this.onShowDialog=function(){(0,d.default)(document).on("keyup",b.hideOnEscapeKeyUp);h.dialog2.on("show",b.hideOnDialogShown);(0,d.default)(".aui-dropdown2-active").trigger("aui-button-invoke");b.loadDialogResources().then(b.initialiseDialog)};
this.onHideDialog=function(){(0,d.default)(document).off("keyup",b.hideOnEscapeKeyUp);h.dialog2.off("show",b.hideOnDialogShown);(0,d.default)(document.activeElement).closest("#"+c.DIALOG_ID).length&&document.activeElement.blur()};this.hideOnEscapeKeyUp=function(a){a.keyCode===d.default.ui.keyCode.ESCAPE&&(b.$inboxInlineDialog.attr("open",!1),a.preventDefault())};this.hideOnDialogShown=function(){b.$inboxInlineDialog.attr("open",!1)};this.loadDialogResources=(0,l.once)(function(){var a=this.$inboxInlineDialog.find("aui-spinner");
return new Promise(function(b){window.WRM.require("wrc!bitbucket.pullRequest.inbox").done(function(){a.remove();b()}).always(function(){a.remove()})})});this.initialiseDialog=function(){var a=b.$inboxInlineDialog.find(".aui-inline-dialog-contents")[0];window.require("bitbucket/internal/feature/inbox/inbox-dialog",null).onReady(a)};this.$inboxTrigger=(0,d.default)("#"+c.TRIGGER_ID);this.$inboxTrigger.length&&m.default.getCurrentUser()&&(this.initializeInlineDialog(),this.addEventListeners())}x(c,[{key:"initializeInlineDialog",
value:function(){this.$inboxInlineDialog=(0,d.default)("#"+c.DIALOG_ID);this.$inboxInlineDialog.on("aui-show",this.onShowDialog).on("aui-hide",this.onHideDialog);this.updateInboxCount()}},{key:"addEventListeners",value:function(){var b=this,a=function(a){a.user.name===m.default.getCurrentUser().name&&b.updateInboxCount()};e.default.on("bitbucket.internal.DO_NOT_USE.widget.approve-button.added",a);e.default.on("bitbucket.internal.DO_NOT_USE.widget.approve-button.removed",a);e.default.on("bitbucket.internal.DO_NOT_USE.widget.needs-work.added",
a);e.default.on("bitbucket.internal.DO_NOT_USE.widget.needs-work.removed",a);e.default.on("bitbucket.internal.DO_NOT_USE.feature.pullRequest.self.added",a);e.default.on("bitbucket.internal.DO_NOT_USE.feature.pullRequest.self.removed",a)}},{key:"updateInboxCount",value:function(){this.fetchInboxCount().then(this.whenInboxCountFetched)}},{key:"fetchInboxCount",value:function(){return w.default.rest({url:v.default.rest().addPathComponents("inbox","pull-requests","count").build(),type:"GET",statusCode:{"*":!1}})}}]);
return c}();k.TRIGGER_ID="inbox-trigger";k.DIALOG_ID="inline-dialog-inbox-pull-requests-content";g.default={onReady:function(){new k}};n.exports=g["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:inbox-dialog', location = '/static/bitbucket/internal/feature/inbox/inbox-dialog.js' */
define("bitbucket/internal/feature/inbox/inbox-dialog","exports @atlassian/aui jquery lodash react react-dom bitbucket/util/navbuilder bitbucket/util/server bitbucket/util/state bitbucket/internal/bbui/inbox/inbox bitbucket/internal/enums".split(" "),function(h,v,w,x,k,y,z,A,B,l,C){function e(a){return a&&a.__esModule?a:{default:a}}function m(a,b,d){b in a?Object.defineProperty(a,b,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[b]=d;return a}function D(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function E(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(h,"__esModule",{value:!0});h.onReady=function(a){var b=F.default.getCurrentUser();a&&b&&(g=a,n.default.render(p.default.createElement(G,
{currentUser:b,pageSize:l.DEFAULT_PAGE_SIZE}),a))};var q=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(b[d]=a[d]);b.default=a;return b}(v),r=e(w),p=e(k),n=e(y),H=e(z),I=e(A),F=e(B),J=e(l),t=e(C),u=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var d=arguments[b],c;for(c in d)Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}return a},K=function(){function a(b,a){for(var c=0;c<a.length;c++){var d=a[c];d.enumerable=
d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),g=void 0,G=function(a){function b(a){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var c=D(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));c.onMorePrsRequested=function(a){c.state[a].loading||(c.setState(m({},a,u({},c.state[a],{loading:!0}))),I.default.rest({url:c.getInboxResourceUrlBuilder(a).build(),
type:"GET",statusCode:{0:c.handleError,401:c.handleError,500:c.handleError,502:c.handleError}}).done(function(b){c.setState(m({},a,u({},c.state[a],{pullRequests:c.state[a].pullRequests.concat(b.values),loading:!1,allFetched:b.isLastPage,nextPageStart:(0,x.get)(b,"nextPageStart",0)})))}))};c.getInboxResourceUrlBuilder=function(a){var b=c.mapTablePropToRole[a];return H.default.rest().addPathComponents("inbox","pull-requests").withParams({role:b,start:c.state[a].nextPageStart,limit:c.props.pageSize,
avatarSize:bitbucket.internal.widget.avatar.avatar.avatarSizeInPx({size:"medium"}),withAttributes:!0,state:"OPEN",order:"oldest"})};c.mapTablePropToRole={created:t.default.ParticipantRole.AUTHOR,reviewing:t.default.ParticipantRole.REVIEWER};c.state={created:{pullRequests:[],allFetched:!1,loading:!1,nextPageStart:0,onMoreItemsRequested:function(){return c.onMorePrsRequested("created")}},reviewing:{pullRequests:[],allFetched:!1,loading:!1,nextPageStart:0,onMoreItemsRequested:function(){return c.onMorePrsRequested("reviewing")}}};
return c}E(b,a);K(b,[{key:"handleError",value:function(a,b,e,f){a={};f&&(a=f.errors?f.errors[0]:f);n.default.unmountComponentAtNode(g);(0,r.default)(g).html((0,r.default)(bitbucket.internal.feature.inbox.inbox.error({title:"Could not retrieve inbox",text:a.message||"An unknown error occurred"})));return!1}},{key:"render",value:function(){var a=this.state,b=this.props;return p.default.createElement(J.default,{created:a.created,currentUser:b.currentUser,
pageSize:b.pageSize,reviewing:a.reviewing})}}]);return b}(k.Component)});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:inbox-dialog', location = '/static/bitbucket/internal/feature/inbox/inbox.soy' */
// This file was automatically generated from inbox.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.feature.inbox.inbox.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.feature == 'undefined') { bitbucket.internal.feature = {}; }
if (typeof bitbucket.internal.feature.inbox == 'undefined') { bitbucket.internal.feature.inbox = {}; }
if (typeof bitbucket.internal.feature.inbox.inbox == 'undefined') { bitbucket.internal.feature.inbox.inbox = {}; }


bitbucket.internal.feature.inbox.inbox.trigger = function(opt_data, opt_ignored) {
  return '<a href="#inbox" id="inbox-trigger" data-aui-trigger aria-controls="inline-dialog-inbox-pull-requests-content" aria-label="' + soy.$$escapeHtml('View your unapproved pull requests') + '" >' + bitbucket.internal.feature.inbox.inbox.triggerIcon(null) + '</a>';
};
if (goog.DEBUG) {
  bitbucket.internal.feature.inbox.inbox.trigger.soyTemplateName = 'bitbucket.internal.feature.inbox.inbox.trigger';
}


bitbucket.internal.feature.inbox.inbox.triggerIcon = function(opt_data, opt_ignored) {
  return '' + aui.icons.icon({icon: 'tray', useIconFont: true, accessibilityText: 'Inbox'});
};
if (goog.DEBUG) {
  bitbucket.internal.feature.inbox.inbox.triggerIcon.soyTemplateName = 'bitbucket.internal.feature.inbox.inbox.triggerIcon';
}


bitbucket.internal.feature.inbox.inbox.error = function(opt_data, opt_ignored) {
  return '<div class="focus-message communication-error"><div class="focus-message-icon aui-icon icon-skull"></div><h2>' + soy.$$escapeHtml(opt_data.title) + '</h2><p>' + soy.$$escapeHtml(opt_data.text) + '</p></div>';
};
if (goog.DEBUG) {
  bitbucket.internal.feature.inbox.inbox.error.soyTemplateName = 'bitbucket.internal.feature.inbox.inbox.error';
}


bitbucket.internal.feature.inbox.inbox.dialog = function(opt_data, opt_ignored) {
  return '<aui-inline-dialog id="inline-dialog-inbox-pull-requests-content" alignment="bottom right"><aui-spinner size="medium" /></aui-inline-dialog>';
};
if (goog.DEBUG) {
  bitbucket.internal.feature.inbox.inbox.dialog.soyTemplateName = 'bitbucket.internal.feature.inbox.inbox.dialog';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:inbox-dialog', location = '/static/bitbucket/internal/feature/inbox/inbox-init.js' */
document.addEventListener("DOMContentLoaded",function(){return require("bitbucket/internal/feature/inbox/inbox").onReady()});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:request-commit', location = '/static/bitbucket/internal/feature/commit/request-commit.js' */
define("bitbucket/internal/feature/commit/request-commit","module exports lodash bitbucket/util/navbuilder bitbucket/util/state bitbucket/internal/util/ajax".split(" "),function(l,b,m,n,p,q){function e(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(b,"__esModule",{value:!0});b.default=function(a){var c=a.commitId,g=a.project,d=a.repo;a=a.statusCode;var b=void 0===a?{}:a;if(f.hasOwnProperty(c))return f[c];var e=void 0;if(g&&d)e=h.default.rest().project(g).repo(d).commit(c).build();else if(r.default.getRepository())e=
h.default.rest().currentRepo().commit(c).build();else return Promise.reject(Error("Repository required"));f[c]=new Promise(function(a,d){k.default.rest({url:e,statusCode:t({},k.default.ignore404WithinRepository(),b)}).done(a).fail(function(a,e,g,b){delete f[c];d((0,m.get)(b,"errors.length")?Error(b.errors[0].message):Error("Commit request failed"))})});return f[c]};var h=e(n),r=e(p),k=e(q),t=Object.assign||function(a){for(var c=1;c<arguments.length;c++){var b=arguments[c],d;for(d in b)Object.prototype.hasOwnProperty.call(b,
d)&&(a[d]=b[d])}return a},f={};l.exports=b["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:commit-preview', location = '/static/bitbucket/internal/widget/commit-preview/commit-preview.soy' */
// This file was automatically generated from commit-preview.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.widget.commitPreview.commitPreview.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.widget == 'undefined') { bitbucket.internal.widget = {}; }
if (typeof bitbucket.internal.widget.commitPreview == 'undefined') { bitbucket.internal.widget.commitPreview = {}; }
if (typeof bitbucket.internal.widget.commitPreview.commitPreview == 'undefined') { bitbucket.internal.widget.commitPreview.commitPreview = {}; }


bitbucket.internal.widget.commitPreview.commitPreview.assistiveText = function(opt_data, opt_ignored) {
  return '<span id="' + soy.$$escapeHtml(opt_data.id) + '" class="assistive">' + soy.$$escapeHtml(opt_data.message) + '</span>';
};
if (goog.DEBUG) {
  bitbucket.internal.widget.commitPreview.commitPreview.assistiveText.soyTemplateName = 'bitbucket.internal.widget.commitPreview.commitPreview.assistiveText';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:commit-preview', location = '/static/bitbucket/internal/widget/commit-preview/commit-preview.js' */
require(["@atlassian/aui","jquery","lodash","bitbucket/util/navbuilder","bitbucket/internal/feature/commit/request-commit"],function(f,e,l,m,n){function h(b,a){b.tipsy({opacity:.98,trigger:a,gravity:function(){return b.attr("data-commit-preview-gravity")||e.fn.tipsy.autoNS.call(this)},className:"commit-preview-tipsy",title:function(){var a=b.attr("data-commit-message"),d=b.attr("data-commit-preview-prefix"),e="Loading...";if(a)return d?d+"\n\n"+g(a):g(a);
k(b).then(function(){"in"===b.data("tipsy").hoverState&&(b.tipsy("hide"),b.tipsy("show"))});return d?d+"\n\n"+e:e}})}function k(b){if(b.data("commit-loading"))return b.data("commit-loading");var a=b.attr("data-commitid")||b.text(),c=m.parse(b.attr("href")).path().match(/.*?\/(projects|users)\/([^\/]+)\/repos\/([^\/]+)\//);a=n({commitId:a,project:c&&("users"===c[1]?"~":"")+c[2],repo:c&&c[3],statusCode:{404:!1,"*":!1}}).then(function(a){return a.message?g(a.message):"No commit message"},
function(){return "Commit request failed"});a.then(function(a){return b.attr("data-commit-message",a)});b.data("commit-loading",a);return a}var g=function(b){var a=b.substring(0,b.substring(750).search(/\s/)+750);return a.length<b.length?a+"\u2026":a};e(document).on("mouseenter focus",".commitid:not(.no-preview):not([data-inited]), \n        .commit-preview-trigger:not([data-inited]), \n        .commits-table .message[data-commit-message]:not([data-inited])",
function(b){var a=e(this).attr("data-inited",!0),c=a.attr("data-trigger-mode")||"all";if("all"===c)h(a,"hover"),a.tipsy("show");else{h(a,"manual");var d=a.tipsy(!0);a.on("mouseenter",function(){return d.show()});a.on("mouseleave",function(){return d.hide()});"hover-accessible"===c&&k(a).then(function(b){var c=l.uniqueId("commit-desc-");e(bitbucket.internal.widget.commitPreview.commitPreview.assistiveText({id:c,message:b})).insertAfter(a);a.attr("aria-describedby",c)});"mouseenter"===b.type&&d.show()}})});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:upgrade', location = '/static/bitbucket/internal/util/upgrade.js' */
define("bitbucket/internal/util/upgrade",["exports","@atlassian/aui","bitbucket/util/server"],function(c,d,b){Object.defineProperty(c,"__esModule",{value:!0});c.pluginsDisabledAcknowledge=void 0;var e=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(d),f=b&&b.__esModule?b:{default:b};c.pluginsDisabledAcknowledge=function(){var a=e.contextPath()+"/mvc/maintenance/upgrade-notification";f.default.rest({url:a,
type:"DELETE"})}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:search-urls', location = '/bitbucket-plugin-search/internal/component/search-urls.js' */
define("bitbucket-plugin-search/internal/component/search-urls",["bitbucket/util/navbuilder","bitbucket/internal/bbui/aui-react/avatar","bitbucket/internal/enums"],function(b,g,e){var f=e.AvatarSize;return{commitSearchRestUrl:function(){return b.rest("search").addPathComponents("commits").build()},commitUrl:function(a){return b.repository(a.repository).commit(a.id).build()},fileUrl:function(a,c,d){a=b.repository(a).browse().path(c.split("/"));d&&(a=a.withFragment(d));return a.build()},projectAvatarUrl:function(a,
c){return b.project(a).avatar(c).build()},searchRestUrl:function(){return b.rest("search").addPathComponents("search").withParams({avatarSize:f.MEDIUM}).build()}}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:search-analytics-utils', location = '/bitbucket-plugin-search/internal/component/search-analytics-utils.js' */
define("bitbucket-plugin-search/internal/component/search-analytics-utils",["jquery","lodash"],function(b,a){var c={"com.atlassian.bitbucket.server.bitbucket-server-web-fragments:bitbucket.repository.nav.files":a.constant(1===b("#file-content").length?"source":"browse"),"com.atlassian.bitbucket.server.bitbucket-server-web-fragments:bitbucket.repository.nav.commits":a.constant(1===b(".commit-files").length?"commit":"commit-list"),"com.atlassian.bitbucket.server.bitbucket-server-web-fragments:bitbucket.repository.nav.branches":a.constant(1===
b(".branch-table").length?"branch-list":"compare"),"com.atlassian.bitbucket.server.bitbucket-server-web-fragments:bitbucket.repository.nav.compare":a.constant("compare"),"com.atlassian.bitbucket.server.bitbucket-server-web-fragments:bitbucket.repository.nav.pull-requests":a.constant(1===b(".pull-requests-table").length?"pull-request-list":"pull-request-view"),"com.atlassian.bitbucket.server.bitbucket-server-web-fragments:bitbucket.repository.nav.settings":a.constant("admin"),"com.atlassian.bitbucket.server.bitbucket-server-web-fragments:projects-repositories-tab":a.constant("project-list"),
"com.atlassian.bitbucket.server.bitbucket-server-web-fragments:projects-settings-tab":a.constant("admin")};return{getPageContext:function(){var a=b("#aui-sidebar-content .aui-nav-selected");return 1===a.length?(a=a.find("a").attr("data-web-item-key"),(a=c[a])?a():"other"):"global"}}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-common-resources', location = '/bitbucket-plugin-search/internal/feature/search-common/search-request.js' */
define("bitbucket-plugin-search/internal/feature/search-common/search-request",["exports","lodash"],function(b,f){Object.defineProperty(b,"__esModule",{value:!0});b.searchFor=function(b,a,c){var d={};(0,f.forEach)(a,function(a){d[a]={}});return{query:b,entities:d,limits:c}};b.nextSearchFor=function(b,a,c,d){var e={};c={start:d[a].nextStart,limit:c};a in e?Object.defineProperty(e,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):e[a]=c;return{query:b,entities:e}}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-common-resources', location = '/bitbucket-plugin-search/internal/feature/search-common/search-entities.js' */
define("bitbucket-plugin-search/internal/feature/search-common/search-entities",["module","exports"],function(b,a){Object.defineProperty(a,"__esModule",{value:!0});a.default={CODE:"code",REPOSITORIES:"repositories"};b.exports=a["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-common-resources', location = '/bitbucket-plugin-search/internal/feature/search-common/transformer.js' */
define("bitbucket-plugin-search/internal/feature/search-common/transformer",["exports","lodash","bitbucket-plugin-search/internal/component/search-urls"],function(e,h,f){function l(a,d){if(Array.isArray(d)&&0<d.length){var g=[],c=[];d.forEach(function(a){a.text.split(/(\/)/g).forEach(function(b){"/"===b?(g.push(c),c=[]):0!==b.length&&c.push({part:b,match:!0===a.match})})});g.push(c);return g}return a.map(function(a){return[{part:a,match:!1}]})}Object.defineProperty(e,"__esModule",{value:!0});e.transformCodeResult=
void 0;var k=f&&f.__esModule?f:{default:f},n=function(){return function(a,d){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a)){var g=[],c=!0,b=!1,f=void 0;try{for(var e=a[Symbol.iterator](),h;!(c=(h=e.next()).done)&&(g.push(h.value),!d||g.length!==d);c=!0);}catch(m){b=!0,f=m}finally{try{if(!c&&e["return"])e["return"]()}finally{if(b)throw f;}}return g}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),p=/<\/?em>/;e.transformCodeResult=function(a){var d=a.file.split("/");
a.filename=d.slice(-1);a.fileParts=l(d,a.pathMatches);a.hitContexts?(a.firstLineNumber=(0,h.get)(a,"hitContexts.0.0",-1),d=(0,h.flatten)(a.hitContexts.map(function(a){return a.filter(function(a){return 0!==a.line&&p.test(a.text)}).map(function(a){return a.line})})).reduce(function(a,c){var b=n(a,2);a=b[0];b=b[1];c===a+1?Array.isArray(b[b.length-1])?b[b.length-1].push(c):(b.pop(),b.push([a,c])):b.push(c);return[c,b]},[-1,[]])[1].map(function(a){return Array.isArray(a)?a[0]+"-"+a[a.length-1]:a}).join(","),
a.fileUrl=k.default.fileUrl(a.repository,a.file,d)):a.fileUrl=k.default.fileUrl(a.repository,a.file);return a}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-common-resources', location = '/bitbucket-plugin-search/internal/feature/search-common/search-common.soy' */
// This file was automatically generated from search-common.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.
 */

if (typeof bitbucketPluginSearch == 'undefined') { var bitbucketPluginSearch = {}; }
if (typeof bitbucketPluginSearch.internal == 'undefined') { bitbucketPluginSearch.internal = {}; }
if (typeof bitbucketPluginSearch.internal.feature == 'undefined') { bitbucketPluginSearch.internal.feature = {}; }
if (typeof bitbucketPluginSearch.internal.feature.searchCommon == 'undefined') { bitbucketPluginSearch.internal.feature.searchCommon = {}; }
if (typeof bitbucketPluginSearch.internal.feature.searchCommon.searchCommon == 'undefined') { bitbucketPluginSearch.internal.feature.searchCommon.searchCommon = {}; }


bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.quickCodeResult = function(opt_data, opt_ignored) {
  return '<li class="code result navigable"><a id="code-result" class="code-link" role="option" title=""><div class="code-search-hint" aria-hidden="true"><span class="aui-icon aui-icon-small aui-iconfont-search"></span>' + soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml('\x3cspan class\x3d\x22start\x22\x3eSearch for \x26lsquo;\x3c/span\x3e\x3cspan class\x3d\x22terms\x22\x3e{0}\x3c/span\x3e\x3cspan class\x3d\x22end\x22\x3e\x26rsquo; in code\x3c/span\x3e')) + '</div></a></li>';
};
if (goog.DEBUG) {
  bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.quickCodeResult.soyTemplateName = 'bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.quickCodeResult';
}


bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.codeResult = function(opt_data, opt_ignored) {
  var output = '<li class="search-result code-search-result new-result' + ((opt_data.isTruncated) ? ' truncated' : '') + '"><section><header ' + ((opt_data.result.firstLineNumber > 1) ? 'class="code-search-result-header not-first-line"' : '') + '>';
  var url__soy16 = require('bitbucket/util/navbuilder').project(opt_data.result.repository.project).repo(opt_data.result.repository).browse().build();
  output += '<a href="' + soy.$$escapeHtml(url__soy16) + '" class="code-search-repo-link code-search-header-link">' + ((opt_data.result.repository.owner) ? bitbucket.internal.bbui.avatars.avatar.avatar({size: 'small', person: opt_data.result.repository.owner, extraClasses: 'code-search-result-avatar', title: '' + ((opt_data.result.repository.owner) ? soy.$$escapeHtml(opt_data.result.repository.owner.name) + bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.fileSeparator(null) : '') + ((opt_data.result.repository.project) ? soy.$$escapeHtml(opt_data.result.repository.project.name) + bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.fileSeparator(null) : '') + soy.$$escapeHtml(opt_data.result.repository.name)}) : (opt_data.result.repository.project) ? bitbucket.internal.bbui.avatars.avatar.projectAvatar({size: 'small', project: opt_data.result.repository.project, extraClasses: 'code-search-result-avatar', title: '' + ((opt_data.result.repository.owner) ? soy.$$escapeHtml(opt_data.result.repository.owner.name) + bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.fileSeparator(null) : '') + ((opt_data.result.repository.project) ? soy.$$escapeHtml(opt_data.result.repository.project.name) + bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.fileSeparator(null) : '') + soy.$$escapeHtml(opt_data.result.repository.name)}) : '') + ((opt_data.result.repository.owner) ? '<div class="code-search-owner">' + soy.$$escapeHtml(opt_data.result.repository.owner.name) + '</div>' : '') + ((opt_data.result.repository.project) ? '<div class="code-search-project' + ((opt_data.result.repository.owner) ? ' with-owner' : '') + '">' + soy.$$escapeHtml(opt_data.result.repository.project.name) + '</div>' : '') + '<div class="code-search-repository">' + soy.$$escapeHtml(opt_data.result.repository.name) + '</div></a><div class="code-search-header-separator non-collapsible">&mdash;</div>';
  var filePartList68 = opt_data.result.fileParts;
  var filePartListLen68 = filePartList68.length;
  for (var filePartIndex68 = 0; filePartIndex68 < filePartListLen68; filePartIndex68++) {
    var filePartData68 = filePartList68[filePartIndex68];
    output += (! (filePartIndex68 == filePartListLen68 - 1)) ? '<span class="code-search-filepart">' + bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.printFileSegment({filePart: filePartData68}) + bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.fileSeparator(null) + '</span>' : '<a href="' + soy.$$escapeHtml(opt_data.result.fileUrl) + '" class="non-collapsible code-search-filename">' + bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.printFileSegment({filePart: filePartData68}) + '</a>';
  }
  output += '</header>';
  if (opt_data.result.hitContexts) {
    output += '<ul class="hit-contexts">';
    if (opt_data.result.hitContexts.length > 0) {
      var hitContextList90 = opt_data.result.hitContexts;
      var hitContextListLen90 = hitContextList90.length;
      for (var hitContextIndex90 = 0; hitContextIndex90 < hitContextListLen90; hitContextIndex90++) {
        var hitContextData90 = hitContextList90[hitContextIndex90];
        output += '<li class="hit-context"><ol class="hit-context-lines">';
        var lineList92 = hitContextData90;
        var lineListLen92 = lineList92.length;
        for (var lineIndex92 = 0; lineIndex92 < lineListLen92; lineIndex92++) {
          var lineData92 = lineList92[lineIndex92];
          output += (lineData92.line > 0) ? '<li class="numbered-line">' + soy.$$escapeHtml(lineData92.line) + '</li>' : '<li>&nbsp;</li>';
        }
        output += '</ol><code>';
        var lineList102 = hitContextData90;
        var lineListLen102 = lineList102.length;
        for (var lineIndex102 = 0; lineIndex102 < lineListLen102; lineIndex102++) {
          var lineData102 = lineList102[lineIndex102];
          output += ((lineData102.text.length > 0) ? soy.$$filterNoAutoescape(lineData102.text) : '&nbsp;') + '\n';
        }
        output += '</code></li>';
      }
    }
    output += '</ul>' + ((opt_data.isTruncated) ? '<a href="#" class="context-toggler"><span class="inner expander"><span class="aui-icon aui-icon-small aui-iconfont-arrow-down"></span><span class="text">' + soy.$$escapeHtml(AJS.format('{0,choice,1#View|1\x3cView all} {0} {0,choice,1#match|1\x3cmatches}',opt_data.result.hitCount)) + '</span></span><span class="inner contracter"><span class="aui-icon aui-icon-small aui-iconfont-arrow-up"></span><span class="text">' + soy.$$escapeHtml('Hide matches') + '</span></span></a>' : '');
  }
  output += '</section></li>';
  return output;
};
if (goog.DEBUG) {
  bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.codeResult.soyTemplateName = 'bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.codeResult';
}


bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.fileSeparator = function(opt_data, opt_ignored) {
  return '<span class="code-search-file-separator">/</span>';
};
if (goog.DEBUG) {
  bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.fileSeparator.soyTemplateName = 'bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.fileSeparator';
}


bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.printFileSegment = function(opt_data, opt_ignored) {
  var output = '';
  var segmentList125 = opt_data.filePart;
  var segmentListLen125 = segmentList125.length;
  for (var segmentIndex125 = 0; segmentIndex125 < segmentListLen125; segmentIndex125++) {
    var segmentData125 = segmentList125[segmentIndex125];
    output += (segmentData125.match) ? '<em>' + soy.$$escapeHtml(segmentData125.part) + '</em>' : soy.$$escapeHtml(segmentData125.part);
  }
  return output;
};
if (goog.DEBUG) {
  bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.printFileSegment.soyTemplateName = 'bitbucketPluginSearch.internal.feature.searchCommon.searchCommon.printFileSegment';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-common-resources', location = '/bitbucket-plugin-search/internal/feature/search-common/analytics.js' */
define("bitbucket-plugin-search/internal/feature/search-common/analytics",["exports","lodash","./search-entities"],function(b,d,e){function c(a,b){return(a=a.match(new RegExp(b+":\\S+","g")))&&a.length||0}Object.defineProperty(b,"__esModule",{value:!0});b.resultType=void 0;b.queryAttributes=function(a){return{"query.length":a.length,"term.count":a.split(" ").length,"mod.ext":c(a,"ext"),"mod.lang":c(a,"lang"),"mod.path":c(a,"path"),"mod.project":c(a,"project"),"mod.repo":c(a,"repo")}};b.entityAttributes=
function(a){var b={};f.default.forEach(g.default,function(c,d){a.hasOwnProperty(c)&&(b[c+".start"]=a[c].start,b[c+".count"]=a[c].count)});return b};var f=d&&d.__esModule?d:{default:d},g=e&&e.__esModule?e:{default:e};b.resultType={CODE:"code",COMMIT:"commit",REPOSITORY:"repositories"}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-avatars', location = '/static/bitbucket/internal/bbui/avatars/avatar.soy' */
// This file was automatically generated from avatar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace bitbucket.internal.bbui.avatars.avatar.
 */

if (typeof bitbucket == 'undefined') { var bitbucket = {}; }
if (typeof bitbucket.internal == 'undefined') { bitbucket.internal = {}; }
if (typeof bitbucket.internal.bbui == 'undefined') { bitbucket.internal.bbui = {}; }
if (typeof bitbucket.internal.bbui.avatars == 'undefined') { bitbucket.internal.bbui.avatars = {}; }
if (typeof bitbucket.internal.bbui.avatars.avatar == 'undefined') { bitbucket.internal.bbui.avatars.avatar = {}; }


bitbucket.internal.bbui.avatars.avatar.avatar = function(opt_data, opt_ignored) {
  var output = '';
  var user__soy3 = opt_data.person.user || opt_data.person;
  output += aui.avatar.avatar({size: opt_data.size, avatarImageUrl: require('bitbucket/util/navbuilder')._avatarUrl(user__soy3, ({XSMALL:32,SMALL:48,MEDIUM:64,LARGE:96,XLARGE:128,XXLARGE:192,XXXLARGE:256})[opt_data.size.toUpperCase()]).build(), id: opt_data.id, tagName: opt_data.tagName, accessibilityText: user__soy3.displayName || user__soy3.name, title: opt_data.title, isProject: opt_data.isProject, badgeContent: opt_data.badgeContent, imageClasses: opt_data.imageClasses, extraClasses: 'user-avatar' + (opt_data.hideBadge ? ' badge-hidden' : '') + (opt_data.extraClasses ? ' ' + opt_data.extraClasses : '') + (opt_data.showTitleWithTipsy && opt_data.title ? ' avatar-tooltip' : ''), extraAttributes: {'data-username': user__soy3.name}});
  return output;
};
if (goog.DEBUG) {
  bitbucket.internal.bbui.avatars.avatar.avatar.soyTemplateName = 'bitbucket.internal.bbui.avatars.avatar.avatar';
}


bitbucket.internal.bbui.avatars.avatar.avatarWithName = function(opt_data, opt_ignored) {
  var output = '';
  var user__soy17 = opt_data.person.user || opt_data.person;
  var personName__soy18 = user__soy17.displayName || user__soy17.name;
  output += '<div class="avatar-with-name' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" title="' + soy.$$escapeHtml(personName__soy18) + '">' + bitbucket.internal.bbui.avatars.avatar.avatar({size: opt_data.size, person: user__soy17, imageClasses: opt_data.imageClasses, extraClasses: opt_data.avatarClasses, badgeContent: opt_data.badgeContent, hideBadge: opt_data.hideBadge, id: opt_data.id}) + ((opt_data.link) ? bitbucket.internal.widget.user.userLink.userLink({user: user__soy17, href: opt_data.href, extraClasses: opt_data.linkExtraClasses, skipTitle: true}) : soy.$$escapeHtml(personName__soy18)) + '</div>';
  return output;
};
if (goog.DEBUG) {
  bitbucket.internal.bbui.avatars.avatar.avatarWithName.soyTemplateName = 'bitbucket.internal.bbui.avatars.avatar.avatarWithName';
}


bitbucket.internal.bbui.avatars.avatar.avatarWithBadge = function(opt_data, opt_ignored) {
  return '' + bitbucket.internal.bbui.avatars.avatar.avatar({size: opt_data.size, person: opt_data.person, title: opt_data.title, imageClasses: opt_data.imageClasses, extraClasses: opt_data.extraClasses, id: opt_data.id, hideBadge: opt_data.hideBadge, badgeContent: '<span class="badge' + soy.$$escapeHtml(opt_data.badgeClasses ? ' ' + opt_data.badgeClasses : '') + '">' + soy.$$escapeHtml(opt_data.badgeText) + '</span>'});
};
if (goog.DEBUG) {
  bitbucket.internal.bbui.avatars.avatar.avatarWithBadge.soyTemplateName = 'bitbucket.internal.bbui.avatars.avatar.avatarWithBadge';
}


bitbucket.internal.bbui.avatars.avatar.avatarWithNameAndBadge = function(opt_data, opt_ignored) {
  return '' + bitbucket.internal.bbui.avatars.avatar.avatarWithName({size: opt_data.size, person: opt_data.person, extraClasses: opt_data.extraClasses, avatarClasses: opt_data.avatarClasses, imageClasses: opt_data.imageClasses, id: opt_data.id, hideBadge: opt_data.hideBadge, badgeContent: '<span class="badge' + soy.$$escapeHtml(opt_data.badgeClasses ? ' ' + opt_data.badgeClasses : '') + '">' + soy.$$escapeHtml(opt_data.badgeText) + '</span>'});
};
if (goog.DEBUG) {
  bitbucket.internal.bbui.avatars.avatar.avatarWithNameAndBadge.soyTemplateName = 'bitbucket.internal.bbui.avatars.avatar.avatarWithNameAndBadge';
}


bitbucket.internal.bbui.avatars.avatar.projectAvatar = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.imageUrl ? opt_data.imageUrl : opt_data.project ? require('bitbucket/util/navbuilder')._avatarUrl(opt_data.project, ({XSMALL:32,SMALL:48,MEDIUM:64,LARGE:96,XLARGE:128,XXLARGE:192,XXXLARGE:256})[opt_data.size.toUpperCase()]).build() : '', id: opt_data.id, tagName: opt_data.tagName, accessibilityText: opt_data.project ? opt_data.project.name : '', title: opt_data.title, isProject: ! opt_data.project.owner, badgeContent: opt_data.badgeContent, imageClasses: opt_data.imageClasses, extraClasses: (opt_data.hideBadge ? ' badge-hidden' : '') + (opt_data.extraClasses ? ' ' + opt_data.extraClasses : ''), extraAttributes: opt_data.extraAttributes});
};
if (goog.DEBUG) {
  bitbucket.internal.bbui.avatars.avatar.projectAvatar.soyTemplateName = 'bitbucket.internal.bbui.avatars.avatar.projectAvatar';
}
;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-avatars', location = '/static/bitbucket/internal/bbui/avatars/avatars.js' */
define("bitbucket/internal/bbui/avatars/avatars",["module","exports","jquery","lodash"],function(e,c,a,b){Object.defineProperty(c,"__esModule",{value:!0});var d=a&&a.__esModule?a:{default:a};c.default={init:(b&&b.__esModule?b:{default:b}).default.once(function(){(0,d.default)(document).tooltip({hoverable:!1,offset:5,gravity:function(){return d.default.fn.tipsy.autoNS.call(this)+d.default.fn.tipsy.autoWE.call(this)},delayIn:0,live:".avatar-tooltip \x3e .aui-avatar-inner \x3e img"})})};e.exports=c["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:i18n-html-react-util', location = '/static/bitbucket/internal/util/i18n-html.js' */
define("bitbucket/internal/util/i18n-html",["module","exports","@atlassian/aui","prop-types","react"],function(m,f,g,a,c){function n(b){if(Array.isArray(b)){for(var e=0,a=Array(b.length);e<b.length;e++)a[e]=b[e];return a}return Array.from(b)}Object.defineProperty(f,"__esModule",{value:!0});a=a&&a.__esModule?a:{default:a};var k=c&&c.__esModule?c:{default:c},l=Object.assign||function(b){for(var e=1;e<arguments.length;e++){var a=arguments[e],c;for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=
a[c])}return b},p=function(b,a){return a.length?g.format.apply(void 0,[b].concat(n(a.map(String).map(g.escapeHtml)))):b},d=function(b){var a=b.tag,c=b.children,d=b.params,f=["tag","children","params"],g={},h;for(h in b)0<=f.indexOf(h)||Object.prototype.hasOwnProperty.call(b,h)&&(g[h]=b[h]);return k.default.createElement(a,l({dangerouslySetInnerHTML:{__html:p(c,d)}},g))};d.defaultProps={tag:"span",params:[]};d.propTypes={attributes:a.default.any,children:a.default.string.isRequired,tag:a.default.string,
params:a.default.array};c=function(a){return function(b){return k.default.createElement(d,l({},b,{tag:a}))}};d.p=c("p");d.span=c("span");d.div=c("div");d.a=c("a");f.default=d;m.exports=f["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bbui-analytics', location = '/static/bitbucket/internal/bbui/analytics/analytics.js' */
define("bitbucket/internal/bbui/analytics/analytics",["module","exports","../javascript-errors/javascript-errors"],function(g,e,h){Object.defineProperty(e,"__esModule",{value:!0});var k=function(){function a(a,c){for(var d=0;d<c.length;d++){var b=c[d];b.enumerable=b.enumerable||!1;b.configurable=!0;"value"in b&&(b.writable=!0);Object.defineProperty(a,b.key,b)}}return function(f,c,d){c&&a(f.prototype,c);d&&a(f,d);return f}}(),l=function(){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
}k(a,[{key:"trigger",value:function(a,c){throw new h.NotImplementedError;}}]);return a}();e.default=l;g.exports=e["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bitbucket-analytics', location = '/static/bitbucket/internal/impl/analytics.js' */
define("bitbucket/internal/impl/analytics",["module","exports","@atlassian/aui","bitbucket/internal/bbui/analytics/analytics","bitbucket/internal/util/object"],function(h,d,k,a,c){function e(){g.default.call(this)}Object.defineProperty(d,"__esModule",{value:!0});var l=function(b){if(b&&b.__esModule)return b;var f={};if(null!=b)for(var a in b)Object.prototype.hasOwnProperty.call(b,a)&&(f[a]=b[a]);f.default=b;return f}(k),g=a&&a.__esModule?a:{default:a};(c&&c.__esModule?c:{default:c}).default.inherits(e,
g.default);e.prototype.trigger=function(b,a){l.trigger("analytics",{name:b,data:a})};d.default=new e;h.exports=d["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:bitbucket-request', location = '/static/bitbucket/internal/impl/request.js' */
define("bitbucket/internal/impl/request",["module","exports","bitbucket/util/server"],function(c,b,a){Object.defineProperty(b,"__esModule",{value:!0});b.default={rest:(a&&a.__esModule?a:{default:a}).default.rest};c.exports=b["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/component/quick-search/quick-search-loader.js' */
define("bitbucket-plugin-search/internal/component/quick-search/quick-search-loader",["exports","react","react-dom","bitbucket-plugin-search/internal/feature/quick-search/quick-search","bitbucket/util/state"],function(c,e,f,g,h){function b(a){return a&&a.__esModule?a:{default:a}}Object.defineProperty(c,"__esModule",{value:!0});c.onReady=function(a){k.default.render(l.default.createElement(m.default,{project:d.default.getProject()||null,repository:d.default.getRepository()||null}),document.querySelector(a))};
var l=b(e),k=b(f),m=b(g),d=b(h)});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/feature/quick-search/quick-search.js' */
define("bitbucket-plugin-search/internal/feature/quick-search/quick-search","exports @atlassian/aui lodash prop-types react bitbucket/internal/impl/urls ./components/code-search-provider ./components/commit-provider ./components/repository-provider ./components/results-panel ./components/search-form ./constants ./internal/analytics ./internal/search-context ./request-status".split(" "),function(m,g,n,l,k,t,u,v,w,x,y,q,z,A,B){function f(a){return a&&a.__esModule?a:{default:a}}function C(a){if(Array.isArray(a)){for(var c=
0,d=Array(a.length);c<a.length;c++)d[c]=a[c];return d}return Array.from(a)}function D(a,c){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!c||"object"!==typeof c&&"function"!==typeof c?a:c}function E(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?
Object.setPrototypeOf(a,c):a.__proto__=c)}function r(a,c,d){d=d?-1:1;for(var b=c;;){b+=d;if(0>b||b>=a.length)return c;if(a[b].selectable)return b}}Object.defineProperty(m,"__esModule",{value:!0});m.calculateNextFocusedIndex=r;l=f(l);var p=f(k),F=f(t),G=f(u),H=f(v),I=f(w),J=f(x),K=f(y),L=f(z),M=f(A),h=function(a){if(a&&a.__esModule)return a;var c={};if(null!=a)for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);c.default=a;return c}(B),N=function(){function a(c,a){for(var b=0;b<a.length;b++){var d=
a[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(c,d.key,d)}}return function(c,d,b){d&&a(c.prototype,d);b&&a(c,b);return c}}();k=function(a){function c(a){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");var b=D(this,(c.__proto__||Object.getPrototypeOf(c)).call(this,a));b.onNewItems=function(e,a){b.onProviderUpdate(e,"items",a)};b.onStatusUpdate=function(e,a){b.onProviderUpdate(e,"status",a)};b.onProviderUpdate=
function(a,c,d){b.setState(function(b){b=[].concat(C(b[c]));b[a]=d;var e={};c in e?Object.defineProperty(e,c,{value:b,enumerable:!0,configurable:!0,writable:!0}):e[c]=b;return e})};b.onChange=function(a){var e=a.target.value;b.setState(function(b){var a={query:e};b.query!==e&&(a.focusedIndex=0);return a},function(){b.providers.forEach(function(a){return a.updateQuery(b.state.query)})});b._updatePanel(e.length>=q.DEFAULT_MIN_QUERY_LENGTH)};b.onKeyDown=function(a){if(a.keyCode===g.keyCode.DOWN||a.keyCode===
g.keyCode.UP)a.preventDefault(),b._handleUpAndDownKeys(a.keyCode===g.keyCode.UP);else if(a.keyCode===g.keyCode.ENTER){a.preventDefault();a.nativeEvent.stopImmediatePropagation();var c=b.state;a=c.focusedIndex;c=c.items;(a=(0,n.flatten)(c)[a])&&document.getElementById(a.id).click()}else a.keyCode===g.keyCode.ESCAPE&&(a.preventDefault(),a.target&&a.target.blur(),b.setState({panelOpen:!1}))};b._handleUpAndDownKeys=function(a){b.setState(function(b){var c=b.focusedIndex;b=b.items;return{focusedIndex:r((0,
n.flatten)(b),c,a)}})};var d=new M.default(b.props.project,b.props.repository);b.providers=[function(a){return new G.default(function(c){return b.onStatusUpdate(a,c)},function(c){return b.onNewItems(a,c)},d)},function(a){return new H.default(function(c){return b.onStatusUpdate(a,c)},function(c){return b.onNewItems(a,c)},d)},function(a){return new I.default(function(c){return b.onStatusUpdate(a,c)},function(c){return b.onNewItems(a,c)},d)}].map(function(a,b){return a(b)});b.state={focusedIndex:0,panelOpen:!1,
currentSearchTerms:"",items:b.providers.map(function(){return[]}),status:b.providers.map(function(){return h.OK})};return b}E(c,a);N(c,[{key:"_updatePanel",value:function(a){this.setState(function(b){var c=b.query;c=void 0===c?"":c;b=b.currentSearchTerms;var d={currentSearchTerms:c,panelOpen:a};a&&b!==c&&(d.repos=null,d.totalRepoCount=0);return d})}},{key:"_onFocus",value:function(){var a=this.props,b=a.project;a=a.repository;this._updatePanel((0<arguments.length&&void 0!==arguments[0]?arguments[0]:
"").length>=q.DEFAULT_MIN_QUERY_LENGTH);L.default.focused({project:b,repository:a})}},{key:"render",value:function(){var a=this,b=this.state,c=b.currentSearchTerms,e=b.focusedIndex,f=b.panelOpen,g=b.items;b=b.status.reduce(function(a,b){return a===h.ERROR||b===h.ERROR?h.ERROR:a===h.WAITING||b===h.WAITING?h.WAITING:h.OK},h.OK);g=(0,n.flatten)(g);var k=g[e],l="";k&&(l=k.id);return p.default.createElement("div",null,p.default.createElement(K.default,{activeDescendant:f?l:"",expanded:f,onChange:this.onChange,
onFocus:function(){return a._onFocus(c)},onKeyDown:this.onKeyDown,searchUrl:F.default.search(),status:b}),p.default.createElement(J.default,{expanded:f,focusedIndex:e,items:g,status:b,onHide:function(){return a._updatePanel(!1)}}))}}]);return c}(k.PureComponent);k.propTypes={repository:l.default.object,project:l.default.object};m.default=k});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/feature/quick-search/internal/search-context.js' */
define("bitbucket-plugin-search/internal/feature/quick-search/internal/search-context",["module","exports"],function(f,e){Object.defineProperty(e,"__esModule",{value:!0});var g=function(){function a(b,c){for(var a=0;a<c.length;a++){var d=c[a];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,c,e){c&&a(b.prototype,c);e&&a(b,e);return b}}(),h=function(){function a(b,c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
this.project=b;this.repository=c}g(a,[{key:"queryTerms",get:function(){return this.repository?"project:"+this.project.key+" repo:"+this.repository.slug:this.project?"project:"+this.project.key:""}}]);return a}();e.default=h;f.exports=e["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/feature/quick-search/components/search-form.js' */
define("bitbucket-plugin-search/internal/feature/quick-search/components/search-form","module exports @atlassian/aui classnames react bitbucket/internal/bbui/aui-react/spinner bitbucket/internal/util/shortcuts ../request-status".split(" "),function(k,g,n,h,l,m,p,q){function e(b){return b&&b.__esModule?b:{default:b}}function r(b,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,
enumerable:!1,writable:!0,configurable:!0}});a&&(Object.setPrototypeOf?Object.setPrototypeOf(b,a):b.__proto__=a)}Object.defineProperty(g,"__esModule",{value:!0});var t=e(h),f=e(l),u=e(m),v=e(p),w=function(){function b(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(a,d,c){d&&b(a.prototype,d);c&&b(a,c);return a}}();h=function(b){function a(){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
var d=(a.__proto__||Object.getPrototypeOf(a)).apply(this,arguments);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!d||"object"!==typeof d&&"function"!==typeof d?this:d}r(a,b);w(a,[{key:"componentDidMount",value:function(){var a=this;v.default.bind("focusQuickSearch",function(){return a.inputElement.focus()})}},{key:"render",value:function(){var a=this,c=this.props,b=c.searchUrl,e=c.onKeyDown,g=c.onChange,h=c.onKeyUp,k=c.activeDescendant,l=c.expanded,
m=c.onFocus;c=c.status===q.WAITING;return f.default.createElement("form",{className:(0,t.default)("aui-quicksearch",{loading:c}),method:"GET",action:b,onSubmit:function(a){return a.preventDefault()}},f.default.createElement("div",{className:"quick-search-trigger"},f.default.createElement("label",{className:"assistive",htmlFor:"quick-search"},"Search for code, commits or repositories"),f.default.createElement("input",{id:"quick-search",name:"q",type:"text",autoComplete:"off",placeholder:"Search for code, commits or repositories\u2026",
"aria-activedescendant":k,"aria-autocomplete":"both","aria-busy":c,"aria-controls":"quick-search-dialog","aria-expanded":l,"aria-haspopup":!0,role:"combobox",onKeyDown:e,onKeyUp:h,onChange:g,onFocus:m,ref:function(b){return a.inputElement=b}}),c?f.default.createElement(u.default,{size:"small"}):null))}}]);return a}(f.default.Component);g.default=h;k.exports=g["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/feature/quick-search/components/results-panel.js' */
define("bitbucket-plugin-search/internal/feature/quick-search/components/results-panel","module exports @atlassian/aui prop-types react ../request-status".split(" "),function(p,l,g,e,h,q){function m(c,b){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?c:b}function r(c,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);c.prototype=
Object.create(b&&b.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(c,b):c.__proto__=b)}Object.defineProperty(l,"__esModule",{value:!0});e=e&&e.__esModule?e:{default:e};var f=h&&h.__esModule?h:{default:h},t=Object.assign||function(c){for(var b=1;b<arguments.length;b++){var a=arguments[b],k;for(k in a)Object.prototype.hasOwnProperty.call(a,k)&&(c[k]=a[k])}return c},u=function(){function c(b,a){for(var c=0;c<a.length;c++){var d=
a[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(b,a,e){a&&c(b.prototype,a);e&&c(b,e);return b}}(),v=function(){return f.default.createElement("div",{className:"quick-search-error"},f.default.createElement("div",{className:"content"},f.default.createElement("div",{className:"warning-icon"}),f.default.createElement("div",{className:"error-text"},f.default.createElement("div",{className:"error-text-primary"},"Search is currently unavailable"),
f.default.createElement("div",{className:"error-text-secondary"},"Refresh the page and try again"))),f.default.createElement("div",{className:"footer"},"Need help? Troubleshoot search"))},n=function(c){function b(){var a,c,d,e;if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");for(var f=arguments.length,h=Array(f),g=0;g<f;g++)h[g]=arguments[g];return e=(c=(d=m(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,
[this].concat(h))),d),d.position=d.props.expanded&&d.getPosition()||{x:null,y:null},d.layerUpdateNeeded=!1,d.externalLayerHide=!1,d.onResize=function(){d.props.expanded&&d.updatePosition()},d.onRef=function(a){d.ref=a;d.ref.addEventListener("aui-hide",function(){d.externalLayerHide=!0;d.props.onHide()});d.layerUpdateNeeded=!0},c),m(d,e)}r(b,c);u(b,[{key:"componentDidMount",value:function(){this.props.expanded&&this.ref&&((0,g.layer)(this.ref).show(),this.layerUpdateNeeded=!1);window.addEventListener("resize",
this.onResize)}},{key:"componentDidUpdate",value:function(a){!this.props.expanded||a.expanded&&null!==this.position.x&&this.props.anchorTo===a.anchorTo||this.updatePosition();this.ref&&(!this.props.expanded||a.expanded&&!this.layerUpdateNeeded?!this.props.expanded&&a.expanded&&(this.externalLayerHide||(0,g.layer)(this.ref).hide(),this.externalLayerHide=this.layerUpdateNeeded=!1):((0,g.layer)(this.ref).show(),this.externalLayerHide=this.layerUpdateNeeded=!1))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",
this.onResize);this.ref&&this.props.expanded&&(0,g.layer)(this.ref).hide()}},{key:"getPosition",value:function(){if(this.props.anchorTo){var a=document.getElementById(this.props.anchorTo).getBoundingClientRect();return{y:Math.floor(a.bottom+window.pageYOffset-document.documentElement.clientTop),x:Math.floor(a.left+window.pageXOffset-document.documentElement.clientLeft)}}}},{key:"getTransform",value:function(){var a=this.position;return"translate3d("+a.x+"px, "+a.y+"px, 0)"}},{key:"updatePosition",
value:function(){var a=this.getPosition();!a||a.x===this.position.x&&a.y===this.position.y||(this.position=a,this.ref&&(this.ref.style.transform=this.getTransform()))}},{key:"render",value:function(){if(null==this.position.x)return null;var a=this.props,b=a.children,d=a.expanded;a=a.id;var c={left:0,top:0,position:"absolute",transform:this.getTransform()};return f.default.createElement("div",{id:a,ref:this.onRef,className:"aui-layer",style:c,"aria-hidden":d},b)}}]);return b}(h.Component);n.propTypes=
{anchorTo:e.default.string,expanded:e.default.bool.isRequired,onHide:e.default.func.isRequired,children:e.default.node.isRequired,id:e.default.string};h=function(c){var b=c.focusedIndex,a=c.items,e=c.status===q.ERROR;return f.default.createElement(n,{id:"quick-search-dialog",anchorTo:"quick-search",onHide:c.onHide,expanded:c.expanded},e&&f.default.createElement(v,null),!e&&f.default.createElement("div",{className:"quick-search-main repository-list-container"},f.default.createElement("ul",{id:"quick-search-results",
className:"quick-search-results repository-list search-results-container",role:"presentation"},a.map(function(a,c){var d=a.id;return f.default.createElement(a.ItemComponent,t({},a.props,{id:d,key:d,focused:b===c}))}))))};h.propTypes={expanded:e.default.bool.isRequired,focusedIndex:e.default.number.isRequired,items:e.default.array.isRequired,status:e.default.string.isRequired,onHide:e.default.func.isRequired};h.defaultProps={expanded:!1};l.default=h;p.exports=l["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/feature/quick-search/request-status.js' */
define("bitbucket-plugin-search/internal/feature/quick-search/request-status",["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});a.OK="OK";a.ERROR="ERROR";a.WAITING="WAITING"});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/feature/quick-search/components/provider-common.js' */
define("bitbucket-plugin-search/internal/feature/quick-search/components/provider-common","exports lodash react bitbucket/internal/bbui/javascript-errors/javascript-errors bitbucket/internal/impl/request ../constants ../request-status".split(" "),function(e,v,g,w,x,n,y){function h(a){return a&&a.__esModule?a:{default:a}}function p(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function z(a,b){if("function"!==
typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function q(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}Object.defineProperty(e,"__esModule",{value:!0});e.headerItemData=e.defaultItemProps=e.AbstractRestQuickSearchProvider=e.AbstractQuickSearchProvider=
void 0;var r=h(g),m=h(w),A=h(x),k=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(y),t=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],f;for(f in c)Object.prototype.hasOwnProperty.call(c,f)&&(a[f]=c[f])}return a},u=function(){function a(b,a){for(var c=0;c<a.length;c++){var d=a[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,
d.key,d)}}return function(b,c,f){c&&a(b.prototype,c);f&&a(b,f);return b}}();g=e.AbstractQuickSearchProvider=function(){function a(b,c){var f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:n.DEFAULT_MIN_QUERY_LENGTH;q(this,a);this.onStatusUpdate=b;this.onNewItems=c;this.minQueryLength=f}u(a,[{key:"queryIsValid",value:function(a){return a.length>=this.minQueryLength}},{key:"updateForValidQuery",value:function(a){throw new m.default.NotImplementedError("updateForValidQuery is abstract and must be implemented.");
}},{key:"updateQuery",value:function(a){this.queryIsValid(a)?this.updateForValidQuery(a):(this.onStatusUpdate(k.OK),this.onNewItems([]))}}]);return a}();e.AbstractRestQuickSearchProvider=function(a){function b(){var a,f,d,e;q(this,b);for(var g=arguments.length,h=Array(g),l=0;l<g;l++)h[l]=arguments[l];return e=(f=(d=p(this,(a=b.__proto__||Object.getPrototypeOf(b)).call.apply(a,[this].concat(h))),d),d.doSearch=(0,v.debounce)(function(a){var b=Date.now();d.currentSearchRequest=A.default.rest(t({statusCode:{"*":!1}},
d.restParameters(a))).done(function(c){d.onStatusUpdate(k.OK);d.onResponse({query:a,requestDuration:Date.now()-b,response:c})}).fail(function(a,b){if("abort"!==b)d.onStatusUpdate(k.ERROR)}).always(function(){d.currentSearchRequest=null})},n.QUICKSEARCH_DEBOUNCE_TIMEOUT),f),p(d,e)}z(b,a);u(b,[{key:"restParameters",value:function(a){throw new m.default.NotImplementedError("restParameters is abstract and must be implemented.");}},{key:"onResponse",value:function(a){throw new m.default.NotImplementedError("onResponse is abstract and must be implemented.");
}},{key:"updateForValidQuery",value:function(a){this.onStatusUpdate(k.WAITING);this.onNewItems([]);this.currentSearchRequest&&this.currentSearchRequest.abort&&(this.currentSearchRequest.abort(),this.currentSearchRequest=null);this.doSearch(a)}}]);return b}(g);var B=e.defaultItemProps={selectable:!0};e.headerItemData=function(a){return t({},B,{ItemComponent:C,id:"quick-search-header-"+a.headerShortKey,selectable:!1,props:{headerText:a.headerText}})};var C=function(a){return r.default.createElement("li",
{id:a.id,className:"repository-heading"},r.default.createElement("h2",{className:"section-title"},a.headerText))}});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/feature/quick-search/navigation-item-context.js' */
define("bitbucket-plugin-search/internal/feature/quick-search/navigation-item-context",["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});a.CODE="code-results";a.SHOW_MORE_REPOS="show-more-repos"});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/feature/quick-search/components/commit-provider.js' */
define("bitbucket-plugin-search/internal/feature/quick-search/components/commit-provider","module exports @atlassian/aui classnames react bitbucket-plugin-search/internal/component/search-urls bitbucket/internal/bbui/aui-react/avatar bitbucket/internal/enums bitbucket/internal/util/time ../../search-common/analytics ../constants ../internal/analytics ./provider-common".split(" "),function(u,h,v,l,w,x,y,z,p,A,k,B,m){function g(d){return d&&d.__esModule?d:{default:d}}function C(d,a){if(!d)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
return!a||"object"!==typeof a&&"function"!==typeof a?d:a}function D(d,a){if("function"!==typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);d.prototype=Object.create(a&&a.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}});a&&(Object.setPrototypeOf?Object.setPrototypeOf(d,a):d.__proto__=a)}Object.defineProperty(h,"__esModule",{value:!0});var E=g(l),e=g(w),q=g(x),r=g(B),n=Object.assign||function(d){for(var a=1;a<arguments.length;a++){var b=
arguments[a],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d[c]=b[c])}return d},F=function(){function d(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(a,b,c){b&&d(a.prototype,b);c&&d(a,c);return a}}(),G=function a(b,c,e){null===b&&(b=Function.prototype);var f=Object.getOwnPropertyDescriptor(b,c);if(void 0===f){if(b=Object.getPrototypeOf(b),null!==b)return a(b,c,e)}else{if("value"in
f)return f.value;c=f.get;return void 0===c?void 0:c.call(e)}};l=function(a){function b(a,e,f){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");a=C(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,e,k.MIN_COMMIT_QUERY_LENGTH));a.restParameters=function(a){return{url:q.default.commitSearchRestUrl(),data:{query:a,avatarSize:z.AvatarSize.MEDIUM,limit:k.MAX_QUICKSEARCH_ITEMS}}};a.analyticsProperties={project:f.project,repository:f.repository,resultType:A.resultType.COMMIT};
return a}D(b,a);F(b,[{key:"queryIsValid",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";a=a.trim();return G(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"queryIsValid",this).call(this,a)&&/^[0-9a-f]+$/i.test(a)}},{key:"onResponse",value:function(a){var b=this,c=a.response.values,e=c.length;r.default.resultsLoaded(n({},this.analyticsProperties,{time:a.requestDuration,query:a.query,numResults:e}));a=[];0<e&&(a.push((0,m.headerItemData)({headerShortKey:"commits",
headerText:"Commits"})),a=a.concat(c.map(function(a,c){return H({commit:a,onClick:function(){return r.default.resultClicked(n({},b.analyticsProperties,{index:c}))},url:q.default.commitUrl(a),repository:a.repository})})));this.onNewItems(a)}}]);return b}(m.AbstractRestQuickSearchProvider);h.default=l;var H=function(a){var b=a.commit,c=a.repository;return n({},m.defaultItemProps,{ItemComponent:I,id:"quick-search-commit-"+c.id+"-"+b.id,props:{commit:b,
url:a.url,onClick:a.onClick,repository:c}})},J=function(a){a=a.split("\n")[0];return a.length<=k.MAX_COMMIT_MESSAGE_LENGTH?a:a.slice(0,k.MAX_COMMIT_MESSAGE_LENGTH)+"\u2026"},I=function(a){var b=a.commit,c=a.focused,g=a.url,f=a.id,h=a.onClick;a=a.repository;return e.default.createElement("li",{className:(0,E.default)("search-results-item","commit",{focused:c})},e.default.createElement("a",{href:g,className:"commit-link","data-entity":"commit","data-commit-id":b.id,id:f,title:b.id.slice(0,k.COMMIT_HASH_LENGTH)+
" - "+J(b.message),onClick:h},e.default.createElement(y.UserAvatar,{person:b.author,size:"medium",tooltip:!1}),e.default.createElement("div",{className:"item-wrapper"},e.default.createElement("strong",{className:"item-name"},e.default.createElement("span",null,b.message.split("\n")[0])),e.default.createElement("p",{className:"item-description"},e.default.createElement("span",null,b.author.name,e.default.createElement(t,null),a.name,e.default.createElement(t,null),e.default.createElement("time",{dateTime:(0,
p.format)(b.authorTimestamp,"timestamp")},(0,p.format)(b.authorTimestamp,"shortAge")))))))},t=function(){return e.default.createElement("span",null," \u00b7 ")};u.exports=h["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/feature/quick-search/constants.js' */
define("bitbucket-plugin-search/internal/feature/quick-search/constants",["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});a.DEFAULT_MIN_QUERY_LENGTH=3;a.MIN_COMMIT_QUERY_LENGTH=7;a.QUICKSEARCH_DEBOUNCE_TIMEOUT=200;a.MAX_QUICKSEARCH_ITEMS=10;a.MAX_REPO_COUNT=999;a.CODE_RESULT_ID="code-result";a.REPO_RESULT_COUNT_ID="repo-result-count";a.MAX_COMMIT_MESSAGE_LENGTH=50;a.COMMIT_HASH_LENGTH=11});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/feature/quick-search/components/code-search-provider.js' */
define("bitbucket-plugin-search/internal/feature/quick-search/components/code-search-provider","module exports @atlassian/aui classnames react bitbucket/internal/impl/urls bitbucket/internal/util/i18n-html ../../search-common/search-entities ../constants ../internal/analytics ./provider-common".split(" "),function(p,h,l,k,q,r,t,u,v,w,m){function f(a){return a&&a.__esModule?a:{default:a}}function x(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(h,"__esModule",{value:!0});var n=f(k),g=f(q),y=f(r),z=f(t),A=f(u),B=f(w),C=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],d;for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},D=function(){function a(a,c){for(var b=0;b<c.length;b++){var e=
c[b];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();k=function(a){function b(a,d,e){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");a=(b.__proto__||Object.getPrototypeOf(b)).call(this,a,d);if(!this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");a=!a||"object"!==typeof a&&"function"!==typeof a?this:
a;a.searchContext=e;return a}x(b,a);D(b,[{key:"updateForValidQuery",value:function(a){var b=this;this.onNewItems([E({url:y.default.search((this.searchContext.queryTerms+" "+a).trim()),onClick:function(){return B.default.navigationClick({searchContext:b.searchContext,context:A.default.CODE})},query:a,title:l.format("Search for \u0022{0}\u0022 in code",a)})])}}]);return b}(m.AbstractQuickSearchProvider);h.default=k;var E=function(a){return C({},m.defaultItemProps,{ItemComponent:F,id:v.CODE_RESULT_ID,
props:{url:a.url,onClick:a.onClick,query:a.query,title:a.title}})},F=function(a){var b=a.focused,c=a.url,d=a.id,e=a.onClick,f=a.query;a=a.title;return g.default.createElement("li",{className:(0,n.default)("search-results-item","code",{focused:b})},g.default.createElement("a",{id:d,className:(0,n.default)("code-link",{hidden:!1}),title:a||null,href:c||null,"aria-hidden":!1,onClick:e},g.default.createElement("div",{className:"code-search-hint","aria-hidden":"true"},g.default.createElement("span",{className:"aui-icon aui-icon-small aui-iconfont-search"}),
g.default.createElement(z.default,{className:"code-search-hint-text",params:[f]},"\u003cspan class=\u0022start\u0022\u003eSearch for &lsquo;\u003c/span\u003e\u003cspan class=\u0022terms\u0022\u003e{0}\u003c/span\u003e\u003cspan class=\u0022end\u0022\u003e&rsquo; in code\u003c/span\u003e"))))};p.exports=h["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/feature/quick-search/components/repository-provider.js' */
define("bitbucket-plugin-search/internal/feature/quick-search/components/repository-provider","module exports @atlassian/aui classnames react bitbucket-plugin-search/internal/component/search-urls bitbucket/internal/feature/repository/search-results/search-results-item bitbucket/internal/impl/urls bitbucket/internal/util/text ../../search-common/analytics ../../search-common/search-entities ../../search-common/search-request ../constants ../internal/analytics ../navigation-item-context ./provider-common".split(" "),
function(t,m,r,n,u,v,w,x,y,z,A,B,p,C,D,k){function d(a){return a&&a.__esModule?a:{default:a}}function E(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?a:b}function F(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});
b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(m,"__esModule",{value:!0});var G=d(n),g=d(u),H=d(v),I=d(w),J=d(x),K=d(A),q=d(C),L=function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);b.default=a;return b}(D),l=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],f;for(f in c)Object.prototype.hasOwnProperty.call(c,f)&&(a[f]=c[f])}return a},M=function(){function a(a,
c){for(var b=0;b<c.length;b++){var e=c[b];e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(b,c,f){c&&a(b.prototype,c);f&&a(b,f);return b}}();n=function(a){function b(a,f,e){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");a=E(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a,f));a.restParameters=function(a){return{type:"POST",url:H.default.searchRestUrl(),data:(0,B.searchFor)(a,[K.default.REPOSITORIES],
{primary:p.MAX_QUICKSEARCH_ITEMS})}};a.searchContext=e;a.analyticsProperties={project:a.searchContext.project,repository:a.searchContext.repository,resultType:z.resultType.REPOSITORY};return a}F(b,a);M(b,[{key:"onResponse",value:function(a){var b=this,c=a.query,d=a.response.repositories,g=d.count;q.default.resultsLoaded(l({},this.analyticsProperties,{time:a.requestDuration,query:c,numResults:g}));a=d.values.length;var h=[];0<a&&(h.push((0,k.headerItemData)({headerShortKey:"repositories",headerText:"Repositories"})),
h=h.concat(d.values.map(function(a,d){return N({onClick:function(){return q.default.resultClicked(l({},b.analyticsProperties,{clickedRepository:a,index:d}))},query:c,repository:a})})),g>a&&h.push(O({url:J.default.search(c),onClick:function(){return q.default.navigationClick({searchContext:b.searchContext,context:L.SHOW_MORE_REPOS})},totalRepoCount:g})));this.onNewItems(h)}}]);return b}(k.AbstractRestQuickSearchProvider);m.default=n;var N=function(a){var b=a.repository;return l({},k.defaultItemProps,
{ItemComponent:I.default,id:"quick-search-repository-"+b.id,props:{onItemClick:a.onClick,query:a.query,repository:b}})},O=function(a){return l({},k.defaultItemProps,{ItemComponent:P,id:p.REPO_RESULT_COUNT_ID,props:{url:a.url,onClick:a.onClick,totalRepoCount:a.totalRepoCount}})},P=function(a){var b=a.focused,c=a.url,d=a.id,e=a.onClick;a=a.totalRepoCount;return g.default.createElement("li",{className:(0,G.default)("search-results-item","count",{focused:b})},g.default.createElement("a",{id:d,href:c,
onClick:e},g.default.createElement("span",{className:"aui-icon icon-repository"}),g.default.createElement("div",{dangerouslySetInnerHTML:{__html:r.format("Show \u003cstrong\u003e{0}\u003c/strong\u003e {0,choice,1#repository|1\u003crepositories}",(0,y.capInt)(a,p.MAX_REPO_COUNT))}})))};t.exports=m["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-search:quick-search-client-resources', location = '/bitbucket-plugin-search/internal/feature/quick-search/internal/analytics.js' */
define("bitbucket-plugin-search/internal/feature/quick-search/internal/analytics",["module","exports","bitbucket-plugin-search/internal/component/search-analytics-utils","bitbucket/internal/impl/analytics","../../search-common/analytics"],function(l,h,b,e,m){function f(a,d){var c={context:n.default.getPageContext()};d&&(c["repository.id"]=d.id);a&&(c["project.id"]=a.id);return c}Object.defineProperty(h,"__esModule",{value:!0});var n=b&&b.__esModule?b:{default:b},g=e&&e.__esModule?e:{default:e},k=
Object.assign||function(a){for(var d=1;d<arguments.length;d++){var c=arguments[d],b;for(b in c)Object.prototype.hasOwnProperty.call(c,b)&&(a[b]=c[b])}return a};h.default={focused:function(a){a=f(a.project,a.repository);g.default.trigger("bitbucket.ui.quick-search.focused",a)},resultsLoaded:function(a){a=k({time:a.time,"repositories.count":a.numResults,"result.count":a.numResults,"result.type":a.resultType},(0,m.queryAttributes)(a.query),f(a.project,a.repository));g.default.trigger("bitbucket.ui.quick-search.results.loaded",
a)},resultClicked:function(a){a=k({"clicked.index":a.index},a.clickedRepository?{"clicked.project.id":a.clickedRepository.project.id,"clicked.repository.id":a.clickedRepository.id}:{},f(a.project,a.repository),{"repository.index":a.index,"result.type":a.resultType});g.default.trigger("bitbucket.ui.quick-search.result.clicked",a)},navigationClick:function(a){a=k({},f(a.searchContext.project,a.searchContext.repository),{context:a.context});g.default.trigger("bitbucket.ui.quick-search.navigation.clicked",
a)}};l.exports=h["default"]});;
;
/* module-key = 'com.atlassian.bitbucket.server.bitbucket-webpack-INTERNAL:admin-layout', location = '/static/bitbucket/internal/layout/admin/admin.js' */
define("bitbucket/internal/layout/admin/admin",["module","exports","jquery"],function(e,b,a){Object.defineProperty(b,"__esModule",{value:!0});var c=a&&a.__esModule?a:{default:a},f=function(){var a=(0,c.default)(".tabs-menu .menu-item");a.children(".aui-dd-trigger").mouseenter(function(){var b=a.filter(".active"),d=(0,c.default)(this);0<b.length&&b[0]!==d.parent()[0]&&d.click()})};b.default={onReady:function(){f()}};e.exports=b["default"]});;